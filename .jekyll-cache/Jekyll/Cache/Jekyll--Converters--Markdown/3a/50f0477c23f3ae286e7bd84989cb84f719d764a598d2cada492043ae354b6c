I"—<p>ythoné‡Œé¢æœ‰å¾ˆå¤šçš„ä»¥__å¼€å§‹å’Œç»“å°¾çš„å‡½æ•°ï¼Œåˆ©ç”¨å®ƒä»¬å¯ä»¥å®Œæˆå¾ˆå¤šå¤æ‚çš„é€»è¾‘ä»£ç ï¼Œè€Œä¸”æé«˜äº†ä»£ç çš„ç®€æ´æ€§ï¼Œæœ¬æ–‡ä¸»è¦æ€»ç»“äº†è¿­ä»£å™¨ç”¨åˆ°çš„é­”æœ¯æ–¹æ³•ï¼Œå¹¶ä¸”ä¸»è¦ä»¥ä»£ç ä¾‹å­è¿›è¡Œè§£é‡Šã€‚</p>

<p><strong>iter</strong> å’Œ <strong>next</strong>
å…¶å®è¿™é‡Œéœ€è¦å¼•å…¥ä¸€ä¸ªæ¦‚å¿µï¼Œå«è¿­ä»£å™¨ï¼Œå¸¸è§çš„å°±æ˜¯æˆ‘ä»¬åœ¨ä½¿ç”¨forè¯­å¥çš„æ—¶å€™ï¼Œpythonå†…éƒ¨å…¶å®æ˜¯æŠŠforåé¢çš„å¯¹è±¡ä¸Šä½¿ç”¨äº†å†…å»ºå‡½æ•°iterï¼Œæ¯”å¦‚ï¼š</p>

<p>a = [1, 2, 3]
for i in a:
    do_something()
å…¶å®åœ¨pythonå†…éƒ¨è¿›è¡Œäº†ç±»ä¼¼å¦‚ä¸‹çš„è½¬æ¢ï¼š</p>

<p>a = [1, 2, 3]
for i in iter(a):
    do_something()
é‚£ä¹ˆiterè¿”å›çš„æ˜¯ä»€ä¹ˆå‘¢ï¼Œå°±æ˜¯ä¸€ä¸ªè¿­ä»£å¯¹è±¡ï¼Œå®ƒä¸»è¦æ˜ å°„åˆ°äº†ç±»é‡Œé¢çš„__iter__å‡½æ•°ï¼Œæ­¤å‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ªå®ç°äº†__next__çš„å¯¹è±¡ã€‚æ³¨æ„ç†è§£è¿™å¥è¯ï¼Œæ¯”å¦‚ï¼š</p>

<p>class B(object):
    def <strong>next</strong>(self):
        raise StopIteration</p>

<p>class A(object):
    def <strong>iter</strong>(self):
        return B()
æˆ‘ä»¬å¯ä»¥çœ‹è§ï¼ŒAè¿™ä¸ªç±»å®ç°äº†ä¸€ä¸ª__iter__å‡½æ•°ï¼Œè¿”å›çš„æ˜¯B()çš„å®ä¾‹å¯¹è±¡ï¼Œå…¶ä¸­Bé‡Œé¢å®ç°äº†__next__è¿™ä¸ªå‡½æ•°ã€‚</p>

<p>ä¸‹é¢å¼•å…¥å‡ ä¸ªæ¦‚å¿µï¼š
Iterable: æœ‰è¿­ä»£èƒ½åŠ›çš„å¯¹è±¡ï¼Œä¸€ä¸ªç±»ï¼Œå®ç°äº†__iter__ï¼Œé‚£ä¹ˆå°±è®¤ä¸ºå®ƒæœ‰è¿­ä»£èƒ½åŠ›ï¼Œé€šå¸¸æ­¤å‡½æ•°å¿…é¡»è¿”å›ä¸€ä¸ªå®ç°äº†__next__çš„å¯¹è±¡ï¼Œå¦‚æœè‡ªå·±å®ç°äº†ï¼Œä½ å¯ä»¥è¿”å›selfï¼Œå½“ç„¶è¿™ä¸ªè¿”å›å€¼ä¸æ˜¯å¿…é¡»çš„ï¼›
Iterator: è¿­ä»£å™¨(å½“ç„¶ä¹Ÿæ˜¯Iterable)ï¼ŒåŒæ—¶å®ç°äº†__iter__å’Œ__next__çš„å¯¹è±¡ï¼Œç¼ºå°‘ä»»ä½•ä¸€ä¸ªéƒ½ä¸ç®—æ˜¯Iteratorï¼Œæ¯”å¦‚ä¸Šé¢ä¾‹å­ä¸­ï¼ŒA()å¯ä»¥æ˜¯ä¸€ä¸ªIterableï¼Œä½†æ˜¯A()å’ŒB()éƒ½ä¸èƒ½ç®—æ˜¯å’ŒIteratorï¼Œå› ä¸ºAåªå®ç°äº†__iter__ï¼Œè€ŒBåªå®ç°äº†__next__()ã€‚</p>

<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨collectionsé‡Œé¢çš„ç±»å‹æ¥è¿›è¡ŒéªŒè¯ï¼š</p>

<p>class B(object):
    def <strong>next</strong>(self):
        raise StopIteration</p>

<p>class A(object):
    def <strong>iter</strong>(self):
        return B()</p>

<p>from collections.abc import *</p>

<p>a = A()
b = B()
print(isinstance(a, Iterable))
print(isinstance(a, Iterator))</p>

<p>print(isinstance(b, Iterable))
print(isinstance(b, Iterator))
ç»“æœæ˜¯ï¼š</p>

<p>True
False
False
False
<!-- more --></p>

<p>è®©æˆ‘ä»¬ç¨å¾®å¯¹Bè¿™ä¸ªç±»åšä¸€ç‚¹ä¿®æ”¹ï¼š</p>

<p>class B(object):
    def <strong>next</strong>(self):
        raise StopIteration</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>def __iter__(self):
    return None
</code></pre></div></div>

<p>class A(object):
    def <strong>iter</strong>(self):
        return B()</p>

<p>from collections.abc import *</p>

<p>a = A()
b = B()
print(isinstance(a, Iterable))
print(isinstance(a, Iterator))</p>

<p>print(isinstance(b, Iterable))
print(isinstance(b, Iterator))
ç»“æœæ˜¯ï¼š</p>

<p>True
False
True
True
çœŸæ­£çš„è¿­ä»£å™¨
ä¸Šé¢åªæ˜¯åšäº†å‡ ä¸ªæ¼”ç¤ºï¼Œè¿™é‡Œå…·ä½“è¯´æ˜ä¸€ä¸‹:
å½“è°ƒç”¨iterå‡½æ•°çš„æ—¶å€™ï¼Œç”Ÿæˆäº†ä¸€ä¸ªè¿­ä»£å¯¹è±¡ï¼Œè¦æ±‚__iter__å¿…é¡»è¿”å›ä¸€ä¸ªå®ç°äº†__next__çš„å¯¹è±¡ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡nextå‡½æ•°è®¿é—®è¿™ä¸ªå¯¹è±¡çš„ä¸‹ä¸€ä¸ªå…ƒç´ äº†ï¼Œå¹¶ä¸”åœ¨ä½ ä¸æƒ³ç»§ç»­æœ‰è¿­ä»£çš„æƒ…å†µä¸‹æŠ›å‡ºä¸€ä¸ªStopIterationçš„å¼‚å¸¸(forè¯­å¥ä¼šæ•è·è¿™ä¸ªå¼‚å¸¸ï¼Œå¹¶ä¸”è‡ªåŠ¨ç»“æŸfor)ï¼Œä¸‹é¢å®ç°äº†ä¸€ä¸ªè‡ªå·±çš„ç±»ä¼¼rangeå‡½æ•°çš„åŠŸèƒ½ã€‚</p>

<p>class MyRange(object):
    def <strong>init</strong>(self, end):
        self.start = 0
        self.end = end</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>def __iter__(self):
    return self

def __next__(self):
    if self.start &lt; self.end:
        ret = self.start
        self.start += 1
        return ret
    else:
        raise StopIteration
</code></pre></div></div>

<p>from collections.abc import *</p>

<p>a = MyRange(5)
print(isinstance(a, Iterable))
print(isinstance(a, Iterator))</p>

<p>for i in a:
    print(i)
ç»“æœæ˜¯ï¼š</p>

<p>True
True
0
1
2
3
4
æ¥ä¸‹æ¥æˆ‘ä»¬ä½¿ç”¨nextå‡½æ•°æ¨¡æ‹Ÿä¸€æ¬¡ï¼š</p>

<p>class MyRange(object):
    def <strong>init</strong>(self, end):
        self.start = 0
        self.end = end</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>def __iter__(self):
    return self

def __next__(self):
    if self.start &lt; self.end:
        ret = self.start
        self.start += 1
        return ret
    else:
        raise StopIteration
</code></pre></div></div>

<p>a = MyRange(5)
print(next(a))
print(next(a))
print(next(a))
print(next(a))
print(next(a))
print(next(a)) # å…¶å®åˆ°è¿™é‡Œå·²ç»å®Œæˆäº†ï¼Œæˆ‘ä»¬åœ¨è¿è¡Œä¸€æ¬¡æŸ¥çœ‹å¼‚å¸¸
å¯ä»¥çœ‹è§ä¸€ä¸ªå¾ˆæ˜æ˜¾çš„å¥½å¤„æ˜¯ï¼Œæ¯æ¬¡äº§ç”Ÿçš„æ•°æ®ï¼Œæ˜¯äº§ç”Ÿä¸€ä¸ªç”¨ä¸€ä¸ªï¼Œä»€ä¹ˆæ„æ€å‘¢ï¼Œæ¯”å¦‚æˆ‘è¦éå†[0, 1, 2, 3â€¦..]ä¸€ç›´åˆ°10äº¿ï¼Œå¦‚æœä½¿ç”¨åˆ—è¡¨çš„æ–¹å¼ï¼Œé‚£ä¹ˆæ˜¯ä¼šå…¨éƒ¨è½½å…¥å†…å­˜çš„ï¼Œä½†æ˜¯å¦‚æœä½¿ç”¨è¿­ä»£å™¨ï¼Œå¯ä»¥çœ‹è§ï¼Œå½“ç”¨åˆ°äº†(ä¹Ÿå°±æ˜¯åœ¨è°ƒç”¨äº†next)æ‰ä¼šäº§ç”Ÿå¯¹åº”çš„æ•°å­—ï¼Œè¿™æ ·å°±å¯ä»¥èŠ‚çº¦å†…å­˜äº†ï¼Œè¿™æ˜¯ä¸€ç§æ‡’æƒ°çš„åŠ è½½æ–¹å¼ã€‚</p>

<p>æ€»ç»“
å¯ä»¥ä½¿ç”¨collection.absé‡Œé¢çš„Iteratorå’ŒIterableé…åˆisinstanceå‡½æ•°æ¥åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦æ˜¯å¯è¿­ä»£çš„ï¼Œæ˜¯å¦æ˜¯è¿­ä»£å™¨å¯¹è±¡
iterå®é™…æ˜¯æ˜ å°„åˆ°äº†__iter__å‡½æ•°
åªè¦å®ç°äº†__iter__çš„å¯¹è±¡å°±æ˜¯å¯è¿­ä»£å¯¹è±¡(Iterable)ï¼Œæ­£å¸¸æƒ…å†µä¸‹ï¼Œåº”è¯¥è¿”å›ä¸€ä¸ªå®ç°äº†__next__çš„å¯¹è±¡(è™½ç„¶è¿™ä¸ªè¦æ±‚ä¸å¼ºåˆ¶)ï¼Œå¦‚æœè‡ªå·±å®ç°äº†__next__ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥è¿”å›è‡ªå·±
åŒæ—¶å®ç°äº†__iter__å’Œ__next__çš„æ˜¯è¿­ä»£å™¨(Iterator)ï¼Œå½“ç„¶ä¹Ÿæ˜¯ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡äº†ï¼Œå…¶ä¸­__next__åº”è¯¥åœ¨è¿­ä»£å®Œæˆåï¼ŒæŠ›å‡ºä¸€ä¸ªStopIterationå¼‚å¸¸
forè¯­å¥ä¼šè‡ªåŠ¨å¤„ç†è¿™ä¸ªStopIterationå¼‚å¸¸ä»¥ä¾¿ç»“æŸforå¾ªç¯</p>

<p>https://www.jianshu.com/p/1b0686bc166d</p>
:ET