I"ˆ-<p>FBI-Analyzeræ˜¯ä¸€ä¸ªçµæ´»çš„æ—¥å¿—åˆ†æç³»ç»Ÿï¼ŒåŸºäºgolangå’Œluaï¼Œæ’ä»¶é£æ ¼ç±»ä¼¼ngx-luaã€‚</p>

<p>ä½¿ç”¨è€…åªéœ€è¦ç¼–å†™ç®€å•çš„luaé€»è¾‘å°±å¯ä»¥å®ç°golangèƒ½å®ç°çš„æ‰€æœ‰éœ€æ±‚ï¼Œç‚¹å‡»è·³è½¬å®ç°åŸç†ã€‚ç°å®ä¸­å¯ä½œä¸ºWAFçš„è¾…åŠ©ç³»ç»Ÿè¿›è¡Œå®‰å…¨åˆ†æï¼Œç‚¹å‡»è·³è½¬å®ä¾‹ã€‚</p>

<p>å¯å¿«é€Ÿè¿ç§»wafä¸­è¡Œä¸ºåˆ†ææ’ä»¶(éå®æ—¶æ‹¦æˆªéœ€æ±‚ï¼Œéœ€è¦ç¼“å­˜è®¡ç®—æ•°æ®çš„é€»è¾‘)è‡³æœ¬ç³»ç»Ÿï¼Œé¿å…æ’ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶å‘èµ·è¿‡å¤šå¯¹æ•°æ®ç¼“å­˜(redisç­‰)çš„è¯·æ±‚è€Œå¯¼è‡´WAFæ€§èƒ½ä¸‹é™ï¼Œå¸®åŠ©wafå‡è´Ÿã€‚</p>

<p>å®ç°è¿™ä¸ªé¡¹ç›®çš„ç›®çš„å…¶å®ä¹Ÿæ˜¯åŠ æ·±ä¸‹å¯¹luaè™šæ‹Ÿæœºçš„è®¤è¯†ï¼Œä»¥åŠå…¶ä»–è¯­è¨€é€šè¿‡æ’ä»¶çš„æ–¹å¼è°ƒç”¨luaè„šæœ¬çš„å·¥ä½œåŸç†ï¼Œæœ¬é¡¹ç›®å› ä¸ºåªæ˜¯å•çº¯çš„luaè™šæ‹Ÿæœºï¼Œä¸æ˜¯luaJITï¼Œæ‰€ä»¥ä¸èƒ½ä½¿ç”¨ffiä¹Ÿä¸èƒ½å¼•ç”¨ä¸‰æ–¹soçš„æ–¹æ³•ã€‚</p>

<p>å½“ç„¶ä½¿ç”¨luaæ’ä»¶åŒ–çš„æ€§èƒ½æœ€ä½³çš„è¯­è¨€è‚¯å®šæ˜¯Cï¼Œä½†æ˜¯å› ä¸ºå¤ªèœäº†ï¼Œæ‰€ä»¥åªèƒ½ä»¥golangæ¥å®ç°ï¼Œä½†æ˜¯å°±ç›®å‰è§‚å¯Ÿçœ‹ä¸‹æ¥ï¼Œå¤„ç†æ€§èƒ½è¿˜æ˜¯å¯ä»¥çš„ã€‚
<!-- more -->
æ’ä»¶ç¼–å†™çµæ´»
ç®€å•çš„éœ€æ±‚åœ¨é…ç½®æ–‡ä»¶ä¸­å®Œæˆå…¶å®æŒºä¸é”™çš„ï¼Œä½†æ˜¯åœ¨ä¸€äº›è¾ƒä¸ºå¤æ‚çš„éœ€æ±‚é¢å‰ï¼Œé…ç½®æ–‡ä»¶å†™å‡ºæ¥çš„å¯èƒ½æ¯”è¾ƒæŠ½è±¡ï¼Œæˆ–è€…è¯´ä¸ºäº†ç®€åŒ–é…ç½®å°±è¦ä¸ºæŸä¸ªå•ç‹¬çš„éœ€æ±‚ä¸“é—¨åœ¨ä¸»é¡¹ç›®é‡Œå†™ä¸€æ®µä¸“é—¨ç”¨æ¥å¤„ç†çš„é€»è¾‘ï¼Œå¯ä»¥æ˜¯å¯ä»¥ï¼Œä½†æ²¡å¿…è¦ã€‚</p>

<p>åœ¨ä½¿ç”¨openrestyä¸€æ®µæ—¶é—´åï¼Œå‘ç°çµæ´»çš„æ’ä»¶çœŸçš„ä¼šå‡è½»ä¸å°‘çš„å·¥ä½œé‡ã€‚æ¥ä¸‹æ¥åŸºäºä¸€ä¸ªç›¸å¯¹å¤æ‚çš„å°éœ€æ±‚æ¥è¿›è¡Œæ’ä»¶ç¼–å†™ï¼Œç‚¹å‡»è·³è½¬æ’ä»¶ç¤ºä¾‹ã€‚</p>

<p>éœ€æ±‚ï¼šå¯¹5åˆ†é’Ÿå†…çš„è®¿é—®çŠ¶æ€ç 40xçš„ipè¿›è¡Œé’ˆå¯¹ç»Ÿè®¡ï¼Œ5åˆ†é’Ÿå†…è¶…è¿‡100æ¬¡çš„æ‰“ä¸Šæ ‡ç­¾é”å®š10åˆ†é’Ÿï¼Œä¾›WAFè¿›è¡Œæ‹¦æˆªã€‚</p>

<p>è¿™ç§è‚¯å®šä¹Ÿå¯ä»¥åœ¨wafä¸­å†™æ’ä»¶ï¼Œä½†æ˜¯å½“ç±»ä¼¼éœ€æ±‚å¤šäº†ï¼Œé‚£ä¹ˆä¸€æ¡è¯·æ±‚å¤„ç†å°±å¯èƒ½ä¼šäº§ç”Ÿå¤šæ¬¡è¯·æ±‚ï¼Œå½±å“wafæ€§èƒ½ã€‚</p>

<p>è¿™æ ·çš„è¯åªè®©wafå‘èµ·ä¸€æ¡è¯·æ±‚è¯»å–ä¸‹åˆ†æç»“æœå°±å¯ä»¥ç›´æ¥è¿›è¡Œæ‹¦æˆªï¼Œå°†å·¥ä½œé‡è½¬ç§»ç»™æ—è·¯ç³»ç»Ÿï¼Œä¸å½±å“çº¿ä¸ŠæœåŠ¡ã€‚</p>

<p>æ’ä»¶ç§’çº§ç”Ÿæ•ˆ
åœ¨çº¿ä¸Šç¯å¢ƒè¿è¡Œç¤ºä¾‹é£æ§æ’ä»¶ï¼Œèƒ½æ¶‰åŠåˆ°çš„ä¸šåŠ¡æ€»QPSé«˜å³°å¤§æ¦‚æœ‰åä¸‡ã€‚(è™½ç„¶æ˜¯èƒŒç€é¢†å¯¼å·å·è·‘çš„ï¼Œä½†æ˜¯å› ä¸ºå®Œå…¨æ—è·¯äºä¸šåŠ¡ï¼Œæ‰€ä»¥é—®é¢˜ä¸å¤§ã€‚</p>

<p>æ’ä»¶ç›®å‰ä½¿ç”¨ä¸»åŠ¨ç›‘æµ‹çš„æ–¹å¼è¿›è¡Œæ›´æ–°(è¯´ç™½äº†ï¼Œforå¾ªç¯)ï¼Œä½†æ˜¯å…¶å®å¯ä»¥ä½¿ç”¨inotifyé€šè¿‡ä¿®æ”¹äº‹ä»¶æ¥é©±åŠ¨æ’ä»¶æ›´æ–°ï¼Œæˆ‘è¿™é‡Œæ²¡å†™æ˜¯å› ä¸ºæˆ‘è¿˜æ²¡å†™å®ŒæœåŠ¡ç«¯æ›´æ–°çš„æ“ä½œï¼Œvimç¼–è¾‘ä¿å­˜æ–‡ä»¶ä¼šåˆ é™¤æ—§æ–‡ä»¶åˆ›å»ºæ–°æ–‡ä»¶å¯¼è‡´æ–‡ä»¶ç›‘æ§å¤±è´¥ï¼Œæœ‰ç‚¹æ†¨æ‰¹æ‰€ä»¥æ²¡æã€‚LogFarmerä¸­å®æ—¶ä¼ æ—¥å¿—çš„æ–¹å¼å°±æ˜¯ä½¿ç”¨äº‹ä»¶é©±åŠ¨ï¼Œå®ç°æ¯”è¾ƒç®€å•ã€‚</p>

<p>æ’ä»¶æ›´æ–°æ—¶ä¼šè‡ªåŠ¨ç¼–è¯‘ç¼“å­˜ï¼Œä¾›åç¨‹è°ƒç”¨ï¼Œé¿å…æ¯æ¬¡éƒ½ä¼šè¦ç¼–è¯‘è„šæœ¬è¿è¡Œã€‚</p>

<p>åŠ¨å›¾ä¸­æ¼”ç¤ºæ³¨é‡Šå’Œè¿è¡Œæ‰“å°æ—¥å¿—æ–¹æ³•æ¥æ£€æµ‹æ’ä»¶ç”Ÿæ•ˆçš„é€Ÿåº¦ã€‚</p>

<p>t01cfba4b44c7c893fa.gif</p>

<p>çµæ´»è‡ªå®šä¹‰çš„å‡½æ•°åº“
ä»¥æ‰“å°æ—¥å¿—ä¸ºä¾‹</p>

<p>func logging(L *lua.LState) int {
    buf := new(bytes.Buffer)
    n := L.GetTop()
    for i := 2; i &lt; n+1; i++ {
        buf.WriteString(L.CheckString(i))
        buf.WriteString(â€œ â€œ)
    }
    logger.Println(L.CheckInt(1), buf.String())
    return 0
}
ä¸°å¯Œçš„ä¸‰æ–¹ä¾èµ–æ”¯æ’‘
golangèƒ½å¤Ÿä½¿ç”¨çš„æ‰€æœ‰æ–¹æ³•éƒ½å¯ä»¥è¢«luaä½¿ç”¨ï¼Œé€šè¿‡å¦‚ä¸Šçš„å®šä¹‰æ–¹å¼ï¼Œæ·»åŠ è¿›luaè™šæ‹Ÿæœºä¾›luaä½¿ç”¨ã€‚</p>

<p>ä¾‹å¦‚æ ·ä¾‹luaç­–ç•¥è„šæœ¬ä¸­ï¼Œä½¿ç”¨çš„redisæ¨¡å—å’Œæ–¹æ³•å®é™…æ˜¯ä½¿ç”¨çš„golangå†…çš„redisä¸‰æ–¹åº“ã€‚</p>

<p>// æ³¨å†Œç»™luaè™šæ‹Ÿæœºçš„golangå‡½æ•°
var rdsFns = map[string]lua.LGFunction{
        â€œincrâ€:   incr,
        â€œhmgetâ€:  hmget,
        â€œhmsetâ€:  hmset,
        â€œexpireâ€: expire,
        â€œdeleteâ€: delete,
    }
// redisçš„é€’å¢å‡½æ•°
func incr(L *lua.LState) int {
    var err error
    var result int64
    result, err = db.RedSess.HIncrBy(L.CheckString(1), L.CheckString(2), 1).Result()
    L.Push(lua.LNumber(result))
    pushErr(L, err)
    return 2
}
å·²å†…ç½®çš„luaå‡½æ•°åº“å’Œå˜é‡
â€“ å¯¹äºæ–¹æ³•çš„è°ƒç”¨ï¼Œéƒ½æ˜¯é€šè¿‡<code class="language-plaintext highlighter-rouge">.</code> è€Œä¸æ˜¯<code class="language-plaintext highlighter-rouge">:</code>
â€“ åŸå› åœ¨ä¸é€šè¿‡<code class="language-plaintext highlighter-rouge">:</code>è°ƒç”¨æ–¹æ³•ä¼šé»˜è®¤å¸¦å’Œselfçš„tableä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ï¼Œæ‰€ä»¥é¿å…æ¯æ¬¡è°ƒç”¨å‡½æ•°éƒ½åˆ¤æ–­æ ˆé¡¶æ•°æ®æ˜¯ä¸æ˜¯è¿™ä¸ªtableï¼Œå°±åªç”¨<code class="language-plaintext highlighter-rouge">.</code>å¥½äº†ã€‚
â€“ example
local redis = require(â€œredisâ€)
local ok, err = redis.incr(â€œkeyâ€, â€œfieldâ€)
å†…ç½®å…¨å±€å˜é‡
fbi</p>

<p>â€“ é¡¹ç›®å˜é‡
â€“ ä¸‹é¢åŒ…å«varå˜é‡ï¼Œç±»ä¼¼openresty
local var = fbi.var
print(var.status) 
â€“ é¡¹ç›®å›æ˜¾æ‰“å° 200
â€“ logæ–¹æ³•å’Œlogç­‰çº§å‚æ•°
local log = fbi.log
local ERROR = fbi.ERROR
local DEBUG = fbi.DEBUG
local INFO = fbi.INFO
log(ERROR, â€œs1â€, â€œs2â€, â€œs3â€, â€¦, â€œsnâ€) 
â€“ é¡¹ç›®æ—¥å¿—ä¸­æ‰“å° [error] s1s2s3â€¦sn
â€“ å†™æˆluaçš„tableæ˜¯è¿™æ ·
fbi = {
    var = {
        __metatable = {
            __index = getVarFunctin
        }
    },
    log = logFunction,
    ERROR = level_error,
}
å†…ç½®UserDataå˜é‡
ç”¨äºåœ¨å•ä¸ªluaåç¨‹ä¸­ä¼ é€’å˜é‡</p>

<p>access</p>

<p>ç±»å‹æ˜¯è‡ªå®šä¹‰çš„accessæ—¥å¿—GoStruct
pipeline</p>

<p>ç±»å‹æ˜¯redis.pipeliner
å†…ç½®æ¨¡å—
redis</p>

<p>â€“ ç±»å‹éƒ½æ˜¯luaä¸­çš„ç±»å‹ã€‚okæ˜¯boolç±»å‹ï¼Œerræ˜¯nilæˆ–è€…stringç±»å‹ï¼Œresultæ˜¯stringæˆ–numberç±»å‹ï¼Œstræ˜¯stringç±»å‹
â€“ rediså•æ¡è¯·æ±‚æ–¹æ³•
local redis = require(â€œredisâ€)
â€“ æ–¹æ³•åéƒ½å’Œredisæ–¹æ³•ç±»ä¼¼
local result, err = redis.hmget(key, field)
local ok, err = redis.hmset(key, field, value)
local result, err = redis.incr(key, field)
local ok, err = redis.expire(key, second)
local ok, err = redis.delete(key)
â€“ redisæ‰¹é‡è¯·æ±‚æ–¹æ³•
local redis = require(â€œredisâ€)
local pipeline = redis.pipeline
â€“ æ–°å»ºä¸€ä¸ªpipeline
pipeline.new()
local result, err = pipeline.hmget(key, field)
local ok, err = pipeline.hmset(key, field, value)
local result, err = pipeline.incr(key, field)
local ok, err = pipeline.expire(key, second)
local ok, err = pipeline.delete(key)
local err = pipeline.exec()
pipeline.close()
re</p>

<p>â€“ ç±»å‹éƒ½æ˜¯luaä¸­çš„ç±»å‹ã€‚okæ˜¯boolç±»å‹ï¼Œerræ˜¯nilæˆ–è€…stringç±»å‹ï¼Œstræ˜¯stringç±»å‹
â€“ é¡¹ç›®åœ¨å®šä¹‰ç»™luaç”¨çš„golangæ­£åˆ™æ–¹æ³•æ—¶ï¼Œç¼“å­˜äº†æ¯ä¸ªå¾…åŒ¹é…æ¨¡å¼ï¼Œæ¯”å¦‚â€^abâ€ï¼Œæå‡é€Ÿåº¦å’Œæ€§èƒ½
local re = require(â€œreâ€)
local ok, err = re.match(â€œabcabcdâ€, â€œ^abâ€)
local str, err = re.find(â€œabcabcdâ€, â€œ^abâ€)
time</p>

<p>local time = require(â€œtimeâ€)
local tu = time.unix() â€“ æ—¶é—´æˆ³
local tf = time.format() â€“ æ ¼å¼åŒ–æ—¶é—´ 2020-05-31 00:15
local zero = time.zero â€“ 1590829200, åŸºå‡†æ—¶é—´ï¼Œç”¨äºè·Ÿå½“å‰æ—¶é—´åšå·®å–ä½™ç®—æ—¶é—´æ®µ
é¡¹ç›®è¿è¡Œæµç¨‹å’Œæ‰‹å†Œ
è¯´æ˜
ç›®å‰åªå†™äº†kafkaçš„æ•°æ®è¾“å…¥ï¼Œä¸”æ—¥å¿—æ ¼å¼ä¸ºjsonï¼ŒåæœŸçœ‹æƒ…å†µåŠ ã€‚</p>

<p>å¦‚éœ€å¯¹æ¥è‡ªå®¶æ—¥å¿—ï¼Œéœ€è¦åœ¨rule/struct.goä¸­å®šä¹‰ä¸‹æ—¥å¿—æ ¼å¼ï¼Œå¯ä»¥ç½‘ä¸Šæ‰¾json2gostrcutçš„è½¬æ¢ï¼›å†åœ¨lua/http.goå¯¹ç…§æ—¥å¿—structè¿›è¡Œå¯¹åº”å‚æ•°å¯¹æ¥å³å¯ã€‚</p>

<p>type AccessLog struct {
    Host    string  <code class="language-plaintext highlighter-rouge">json:"host"</code>    // WAFå­—æ®µï¼ŒåŸŸå
    Status  int     <code class="language-plaintext highlighter-rouge">json:"status"</code>  // WAFå­—æ®µï¼ŒçŠ¶æ€ç 
    XFF     string  <code class="language-plaintext highlighter-rouge">json:"XFF"</code>     // WAFå­—æ®µï¼ŒX-Forwarded-for
    â€¦
}
// æ³¨æ„ä¸‹ç±»å‹å°±å¥½,luaé‡Œé¢æ•°å­—éƒ½æ˜¯numberç±»å‹ã€‚
func GetReqVar(L <em>lua.LState) int {
    access := L.GetGlobal(â€œaccessâ€).(</em>lua.LUserData).Value.(*rule.AccessLog)
    _ = L.CheckAny(1)
    switch L.CheckString(2) {
    case â€œhostâ€:
        L.Push(lua.LString(access.Host))
    case â€œstatusâ€:
        L.Push(lua.LNumber(access.Status))
    case â€œXFFâ€:
        L.Push(lua.LString(access.XFF))
    â€¦
    default:
        L.Push(lua.LNil)
}
åˆæ¬¡ä½¿ç”¨å¯é€šè¿‡æ‰“å°ä¸€äº›å˜é‡æ¥æµ‹è¯•ï¼Œä¾‹å¦‚</p>

<p>local var = fbi.var
local log = fbi.log
local ERROR = fbi.ERROR
log(ERROR, â€œstatus is â€œ, tostring(var.status), â€œ, req is â€œ, var.host, var,uri, â€œ?â€, var.query)
â€“ å¯èƒ½è¾“å‡º [error] status is 200, req is www.test.com/path/a?id=1
é¡¹ç›®è¿è¡Œæµç¨‹
t01321ba01cb5c35b40.png</p>

<p>å®‰è£…
æŒ‰ç…§go.modé‡Œçš„é…ç½®å°±è¡Œ
kafkaä¸‰æ–¹åº“éœ€è¦å®‰è£…librdkafkaï¼Œå‚ç…§</p>

<p>https://github.com/confluentinc/confluent-kafka-go#installing-librdkafka</p>

<p>redisä¸‰æ–¹åº“å‰å‡ å¤©åˆšæ›´æ–°ï¼Œæ¯ä¸ªæ‰§è¡Œå‡½æ•°çš„å‚æ•°éƒ½åŠ äº†ä¸ªctxï¼Œå¦‚æœä¸ä¼šæ”¹çš„è¯ï¼Œgo get 7.3ç‰ˆæœ¬å³å¯
https://github.com/go-redis/redis/tree/v7
ç°é˜¶æ®µè½¯ä»¶é…ç½®
æ—¥å¿—æºï¼šKafka</p>

<p>æ•°æ®ç¼“å­˜ï¼šRedis</p>

<p>é…ç½®æ–‡ä»¶æ ·ä¾‹</p>
<h1 id="redisé…ç½®">redisé…ç½®</h1>
<p>redis: â€œ127.0.0.1:6379â€
password: â€œâ€
db: 9</p>
<h1 id="kafkaé…ç½®">kafkaé…ç½®</h1>
<p>broker: 192.168.1.1:9092
groupid: group-access-test-v1
topic:</p>
<ul>
  <li>waflog
offset: latest
    <h1 id="é¡¹ç›®æ—¥å¿—é…ç½®">é¡¹ç›®æ—¥å¿—é…ç½®</h1>
    <p>path: Analyzer.log
ä½¿ç”¨æ–¹å¼
git clone https://github.com/C4o/FBI-Analyzer
go build main.go
./main
1.å¦‚æœæ²¡æœ‰rediså’Œkafkaï¼Œæ²¡æœ‰å…³ç³»ï¼Œä¿®æ”¹main.goçš„æœ€åå‡ è¡Œå³å¯ã€‚é€šè¿‡printæˆ–logæ–¹æ³•è¿›è¡Œè¾“å‡ºã€‚</p>
  </li>
</ul>

<p>åŸå§‹ä»£ç </p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// åˆå§‹åŒ–redis,è¿æ¥å’Œå¥åº·æ£€æŸ¥
red := db.Redis{
    RedisAddr: conf.Cfg.RedAddr,
    RedisPass: conf.Cfg.RedPass,
    RedisDB:   conf.Cfg.DB,
}
// åˆå§‹åŒ–kafkaé…ç½®
kaf := db.Kafka{
    Broker:  conf.Cfg.Broker,
    GroupID: conf.Cfg.GroupID,
    Topic:   conf.Cfg.Topic,
    Offset:  conf.Cfg.Offset,
}
// å¯åŠ¨luaè¿›ç¨‹
for i := 0; i &lt; runtime.NumCPU(); i++ {
    go lua.LuaThread(i)
    go kaf.Consumer(lua.Kchan, i)
}
// æœ¬åœ°æ¨¡æ‹Ÿæ¶ˆè´¹è€…ï¼Œä¸ä½¿ç”¨kafka
//go lua.TestConsumer()
// rediså¥åº·æ£€æŸ¥å¡ä½ä¸»è¿›ç¨‹ï¼Œrediså¼‚å¸¸æ–­å¼€ç¨‹åºç»ˆæ­¢
red.Health() æ›´æ–°ä»£ç 

// åˆå§‹åŒ–redis,è¿æ¥å’Œå¥åº·æ£€æŸ¥
//red := db.Redis{
//    RedisAddr: conf.Cfg.RedAddr,
//    RedisPass: conf.Cfg.RedPass,
//    RedisDB:   conf.Cfg.DB,
//}
// åˆå§‹åŒ–kafkaé…ç½®
//kaf := db.Kafka{
//Broker:  conf.Cfg.Broker,
//GroupID: conf.Cfg.GroupID,
//Topic:   conf.Cfg.Topic,
//Offset:  conf.Cfg.Offset,
//}
// å¯åŠ¨luaè¿›ç¨‹
for i := 0; i &lt; runtime.NumCPU(); i++ {
    go lua.LuaThread(i)
    //go kaf.Consumer(lua.Kchan, i)
}
// æœ¬åœ°æ¨¡æ‹Ÿæ¶ˆè´¹è€…ï¼Œä¸ä½¿ç”¨kafka
lua.TestConsumer()
// rediså¥åº·æ£€æŸ¥å¡ä½ä¸»è¿›ç¨‹ï¼Œrediså¼‚å¸¸æ–­å¼€ç¨‹åºç»ˆæ­¢
// red.Health() 2.å¦‚æœæ¨¡å—æˆ–å‚æ•°ä½¿ç”¨ä¸å¯¹ï¼Œå¯åœ¨æ—¥å¿—ä¸­æŸ¥çœ‹luaè„šæœ¬å“ªä¸€è¡ŒæŠ¥é”™ã€‚
</code></pre></div></div>

<p>[root@localhost FBI-Analyzer]# cat Analyzer.log | grep â€œ#â€ | head -n 5
2020/05/27 13:28:21 [error] Consumer error: 10.205.241.146:9092/bootstrap: Connect to ipv4#10.205.241.146:9092 failed: No route to host (after 4ms in state CONNECT) (<nil>)
2020/05/27 13:41:44 [error] coroutines failed : scripts/counter.lua:5: bad argument #3 to incr (value expected).
2020/05/27 13:41:49 [error] coroutines failed : scripts/counter.lua:5: bad argument #3 to incr (value expected).
2020/05/27 13:41:54 [error] coroutines failed : scripts/counter.lua:5: bad argument #3 to incr (value expected).
2020/05/27 13:41:59 [error] coroutines failed : scripts/counter.lua:5: bad argument #3 to incr (value expected).
æœ¬é¡¹ç›®åœ¨ç°å®ä¸­çš„åº”ç”¨
WAFä½“ç³»
t015b7079b7b1839010.png</nil></p>

<p>æ‹¦æˆªä¸­å¿ƒ
é¡¹ç›®åœ°å€ï¼šhttps://github.com/C4o/IUS</p>

<p>å®æ—¶æ—¥å¿—ä¼ è¾“æ¨¡å—
é¡¹ç›®åœ°å€ï¼šhttps://github.com/C4o/LogFarmer</p>

:ET