I"ö@<!-- more -->
<p>Master High Availabilityåˆç§°MHAï¼Œæ˜¯ä¸€å¥—ä¼˜ç§€çš„ä½œä¸ºMySQLé«˜å¯ç”¨æ€§ç¯å¢ƒä¸‹æ•…éšœåˆ‡æ¢å’Œä¸»ä»æå‡çš„è½¯ä»¶ã€‚MySQLæ•…éšœåˆ‡æ¢è¿‡ç¨‹ä¸­ï¼ŒMHAèƒ½å¤Ÿåšåˆ°åœ¨30ç§’ä¹‹å†…è‡ªåŠ¨å®Œæˆæ•°æ®åº“çš„æ•…éšœåˆ‡æ¢æ“ä½œï¼Œå¹¶åœ¨è¿›è¡Œæ•…éšœåˆ‡æ¢çš„è¿‡ç¨‹ä¸­ï¼ŒMHAèƒ½åœ¨æœ€å¤§ç¨‹åº¦ä¸Šä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ï¼Œä»¥è¾¾åˆ°çœŸæ­£æ„ä¹‰ä¸Šçš„é«˜å¯ç”¨ã€‚</p>

<p>ä¸»æœºåŠå®ä¾‹IP
Manager : 192.168.18.250
Master : 172.16.18.2:3306
Slave1 : 172.16.18.3:3306
Slave2 : 172.16.18.4:3306
VIP : 172.16.18.5
Slaveçš„é…ç½®å‚æ•°
log_bin=/home/birdteam/log/mysql-bin
read_only=1
relay_log_purge=0
#ä¸€ä¸»ä¸€ä»ä¸ç”¨æ­¤é¡¹ï¼Œä¸¤ä»åŠä»¥ä¸Šå»ºè®®æ‰“å¼€æ­¤å‚æ•°ï¼Œé˜²æ­¢åˆ‡æ¢ä¸ºæˆä¸»åº“çš„ä»åº“è‡ªåŠ¨åˆ é™¤ä¸­ç»§æ—¥å¿—åï¼Œæ— æ³•ç»™å…¶ä»–ä»åº“åº”ç”¨è¿™éƒ¨åˆ†æ—¥å¿—
é…ç½®ä¸»ä»åŒæ­¥
mysql&gt;grant replication slave on <em>.</em> to â€˜repl_17zuoyeâ€™@â€™%â€™ identified by â€˜office.repl.17zuoyeâ€™;
mysql&gt;flush privileges;
#ä¸‰ä¸ªèŠ‚ç‚¹éƒ½è¦é…ç½®ï¼Œç”¨äºå½“æŸä¸ªslaveå‡ä¸ºä¸»åå…¶ä»–çš„ä»è¿›è¡ŒåŒæ­¥
mysql&gt;change master to master_host=â€™172.16.18.2â€™,master_user=â€™dtstackâ€™,master_port=3306,master_password=â€™abc123â€™,master_log_file=â€™logbin.000014â€™,master_log_pos=70980879;
mysql&gt;start slave;
é…ç½®SSHå…ç§˜é’¥ï¼Œå››å°æœåŠ¡å™¨ä¹‹é—´å¯äº’é€š</p>
<h1 id="ssh-keygen--t-rsa">ssh-keygen -t rsa</h1>
<h1 id="ssh-copy-id--i-sshid_rsapub-root17216182">ssh-copy-id -i .ssh/id_rsa.pub root@172.16.18.2</h1>
<p>å››ä¸ªèŠ‚ç‚¹å®‰è£…EPELæºä»¥åŠç›¸å…³yumåŒ…</p>
<h1 id="rpm--ivh-httpdownloadfedoraprojectorgpubepel6x86_64epel-release-6-8noarchrpm">rpm -ivh http://download.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm</h1>
<h1 id="yum--y-install-perl-dbd-mysql-perl-config-tiny-perl-log-dispatch-perl-parallel-forkmanager-perltime-hires">yum -y install perl-DBD-MySQL perl-Config-Tiny perl-Log-Dispatch perl-Parallel-ForkManager perlTime-HiRes</h1>
<p>ä¸‹è½½å®‰è£…mhaåŒ…</p>
<h1 id="wget-httpscodegooglecompmysql-master-hawikidownloadstm2">wget https://code.google.com/p/mysql-master-ha/wiki/Downloads?tm=2</h1>
<p>managerèŠ‚ç‚¹ï¼š</p>
<h1 id="rpm-ivh-mha4mysql-manager-056-0el6noarchrpm">rpm â€“ivh mha4mysql-manager-0.56-0.el6.noarch.rpm</h1>
<h1 id="rpm-ivh-mha4mysql-node-056-0el6noarchrpm">rpm â€“ivh mha4mysql-node-0.56-0.el6.noarch.rpm</h1>
<p>node èŠ‚ç‚¹ï¼š</p>
<h1 id="rpm-ivh-mha4mysql-node-056-0el6noarchrpm-1">rpm â€“ivh mha4mysql-node-0.56-0.el6.noarch.rpm</h1>
<p>å»ºç«‹ä¸æˆæƒmhaç”¨æˆ·
mysql&gt;GRANT ALL PRIVILEGES ON <em>.</em> TO â€˜mhaâ€™@â€™%â€™ IDENTIFIED BY â€˜mhamhaâ€™;
mysql&gt;flush privileges;
managerèŠ‚ç‚¹å»ºç«‹ç›¸å…³ç›®å½•å’Œé…ç½®æ–‡ä»¶</p>
<h1 id="tree-mha">tree /mha</h1>
<p>/mha
â”œâ”€â”€ app1
â”‚   â”œâ”€â”€ app1.conf
â”‚   â””â”€â”€ manager.log
â””â”€â”€ conf
â”œâ”€â”€ master_ip_failover_3306
â”œâ”€â”€ master_ip_online_change
â””â”€â”€ send_report
2 directories, 5 files
ç›¸å…³é…ç½®æ–‡ä»¶å†…å®¹</p>
<h1 id="cat-app1conf">cat app1.conf</h1>
<p>[server default]
manager_workdir = /mha/app1
manager_log = /mha/app1/manager.log
remote_workdir = /mha/app1
master_ip_failover_script=/mha/conf/master_ip_failover_3306
#master failoveræ—¶æ‰§è¡Œ
report_script=/mha/conf/send_report
#master failoveræ—¶æ‰§è¡Œï¼Œå‘é€é‚®ä»¶ä½¿ç”¨
master_ip_online_change_script=/mha/conf/master_ip_online_change
#master_switchoveræ—¶æ‰§è¡Œï¼ˆæ‰‹åŠ¨åˆ‡æ¢ï¼‰
user=mha
password=mhamha
ping_interval=1
ping_type=CONNECT
repl_password=office.repl.17zuoye
repl_user=repl_17zuoye
ssh_port=22
ssh_user=root
[server1]
hostname = 10.200.3.2
port=3306
master_binlog_dir = /database1/data_5.6.17_3306/binlog
candidate_master = 1
#è¿™ä¸ªæœåŠ¡å™¨æœ‰è¾ƒé«˜çš„ä¼˜å…ˆçº§æå‡ä¸ºæ–°çš„masterï¼ˆè¿˜è¦å…·å¤‡ï¼šå¼€å¯binlogä½¿å¤åˆ¶æ²¡æœ‰å»¶è¿Ÿï¼‰
[server2]
hostname = 10.200.3.3
port=3306
master_binlog_dir = /database1/data_5.6.17_3306/binlog
candidate_master =1
ignore_fail=1
[server3]
hostname = 10.200.3.4
port=3306
master_binlog_dir = /database1/data_5.6.17_3306/binlog
candidate_master =1
ignore_fail=1
#å¦‚slaveå­˜åœ¨æ•…éšœï¼Œåœ¨ä¸»åº“å‡ºç°é—®é¢˜æ—¶é»˜è®¤æƒ…å†µä¸‹mhaä¸ä¼šè¿›è¡Œæ•…éšœåˆ‡æ¢ï¼Œè¯¥å‚æ•°å³è®¾å®šMHAä¼šåœ¨æ‰€æœ‰çš„æœºå™¨æœ‰é—®é¢˜çš„æ—¶é—´ä¹Ÿä¼šè¿›è¡Œæ•…éšœåˆ‡æ¢
no_master=1
#ä¸å°†è¿™å°ä¸»æœºè½¬æ¢ä¸ºmaster
ä¸»åº“å¯åŠ¨ä¸€ä¸ªè™šIP</p>
<h1 id="sbinifconfig-em10-102003523-up">/sbin/ifconfig em1:0 10.200.3.5/23 up</h1>
<p>å¤±è´¥åˆ‡æ¢è„šæœ¬</p>
<h1 id="cat-master_ip_failover_3306">cat master_ip_failover_3306</h1>
<p>#!/usr/bin/env perl
use strict;
use warnings FATAL =&gt; â€˜allâ€™;
use Getopt::Long;
my (
    $command,          $ssh_user,        $orig_master_host, $orig_master_ip,
    $orig_master_port, $new_master_host, $new_master_ip,    $new_master_port
);
my $vip = â€˜10.200.3.5/23â€™;  # Virtual IP
my $key = â€œ0â€;
my $ssh_start_vip = â€œ/sbin/ifconfig em1:$key $vipâ€;
my $start_new_master_vip = â€œ/sbin/ifconfig em1:$key $vipâ€;
my $ssh_stop_vip = â€œ/sbin/ifconfig em1:$key downâ€;
my $arp = â€œ/usr/sbin/arping -A -q -c 2 -I em1:$key 10.200.3.5â€;
#è™šIPé…ç½®ï¼Œåœ¨å“ªä¸ªç½‘å¡ä¸Šï¼Œkeyç¼–å·çš„å¯¹åº”
GetOptions(
    â€˜command=sâ€™          =&gt; $command,
    â€˜ssh_user=sâ€™         =&gt; $ssh_user,
    â€˜orig_master_host=sâ€™ =&gt; $orig_master_host,
    â€˜orig_master_ip=sâ€™   =&gt; $orig_master_ip,
    â€˜orig_master_port=iâ€™ =&gt; $orig_master_port,
    â€˜new_master_host=sâ€™  =&gt; $new_master_host,
    â€˜new_master_ip=sâ€™    =&gt; $new_master_ip,
    â€˜new_master_port=iâ€™  =&gt; $new_master_port,
);
exit &amp;main();
sub main {
    print â€œ\n\nIN SCRIPT TEST====$ssh_stop_vip==$start_new_master_vip===\n\nâ€;
    if ( $command eq â€œstopâ€ || $command eq â€œstopsshâ€ ) {
        # $orig_master_host, $orig_master_ip, $orig_master_port are passed.
        # If you manage master ip address at global catalog database,
        # invalidate orig_master_ip here.
        my $exit_code = 1;
        eval {
            print â€œDisabling the VIP on old master: $orig_master_host \nâ€;
            &amp;stop_vip();
            $exit_code = 0;
        };
        if ($@) {
            warn â€œGot Error: $@\nâ€;
            exit $exit_code;
        }
        exit $exit_code;
    }
    elsif ( $command eq â€œstartâ€ ) {
        # all arguments are passed.
        # If you manage master ip address at global catalog database,
        # activate new_master_ip here.
        # You can also grant write access (create user, set read_only=0, etc) here.
        my $exit_code = 10;
        eval {
            print â€œEnabling the VIP - $vip on the new master - $new_master_host \nâ€;
            &amp;start_vip();
            $exit_code = 0;
        };
        if ($@) {
            warn $@;
            exit $exit_code;
        }
        exit $exit_code;
    }
    elsif ( $command eq â€œstatusâ€ ) {
       # print â€œChecking the Status of the script.. OK \nâ€;
       # <code class="language-plaintext highlighter-rouge">ssh $ssh_user\@tm01.okooo.cn \" $ssh_start_vip \"</code>;
        exit 0;
    }
    else {
        &amp;usage();
        exit 1;
    }
}</p>
<h1 id="a-simple-system-call-that-enable-the-vip-on-the-new-master">A simple system call that enable the VIP on the new master</h1>
<p>sub start_vip() {
    <code class="language-plaintext highlighter-rouge">ssh root\@$new_master_host \" $ssh_start_vip \"</code>;
    <code class="language-plaintext highlighter-rouge">ssh root\@$new_master_host \" $arp \"</code>;
}</p>
<h1 id="a-simple-system-call-that-disable-the-vip-on-the-old_master">A simple system call that disable the VIP on the old_master</h1>
<p>sub stop_vip() {
    return 0 unless ($ssh_user);
    <code class="language-plaintext highlighter-rouge">ssh $ssh_user\@$orig_master_host \" $ssh_stop_vip \"</code>;
}
sub usage {
    print
    â€œUsage: master_ip_failover â€“command=start|stop|stopssh|status â€“orig_master_host=host â€“orig_master_ip=ip â€“orig_master_port=port â€“new_master_host=host â€“new_master_ip=ip â€“new_master_port=port\nâ€;
}
æ‰‹åŠ¨åœ¨çº¿åˆ‡æ¢è„šæœ¬</p>
<h1 id="cat-master_ip_online_change">cat master_ip_online_change</h1>
<p>#!/usr/bin/env perl
use strict;
use warnings FATAL =&gt;â€™allâ€™;
use Getopt::Long;
my $vip = â€˜10.200.3.5/23â€™;  # Virtual IP
my $key = â€œ0â€;
my $ssh_start_vip = â€œ/sbin/ifconfig em1:$key $vipâ€;
my $ssh_stop_vip = â€œ/sbin/ifconfig em1:$key downâ€;
my $exit_code = 0;
my (
  $command,              $orig_master_is_new_slave, $orig_master_host,
  $orig_master_ip,       $orig_master_port,         $orig_master_user,
  $orig_master_password, $orig_master_ssh_user,     $new_master_host,
  $new_master_ip,        $new_master_port,          $new_master_user,
  $new_master_password,  $new_master_ssh_user,
);
GetOptions(
  â€˜command=sâ€™                =&gt; $command,
  â€˜orig_master_is_new_slaveâ€™ =&gt; $orig_master_is_new_slave,
  â€˜orig_master_host=sâ€™       =&gt; $orig_master_host,
  â€˜orig_master_ip=sâ€™         =&gt; $orig_master_ip,
  â€˜orig_master_port=iâ€™       =&gt; $orig_master_port,
  â€˜orig_master_user=sâ€™       =&gt; $orig_master_user,
  â€˜orig_master_password=sâ€™   =&gt; $orig_master_password,
  â€˜orig_master_ssh_user=sâ€™   =&gt; $orig_master_ssh_user,
  â€˜new_master_host=sâ€™        =&gt; $new_master_host,
  â€˜new_master_ip=sâ€™          =&gt; $new_master_ip,
  â€˜new_master_port=iâ€™        =&gt; $new_master_port,
  â€˜new_master_user=sâ€™        =&gt; $new_master_user,
  â€˜new_master_password=sâ€™    =&gt; $new_master_password,
  â€˜new_master_ssh_user=sâ€™    =&gt; $new_master_ssh_user,
);
exit &amp;main();
sub main {
#print â€œ\n\nIN SCRIPT TEST====$ssh_stop_vip==$ssh_start_vip===\n\nâ€;
if ( $command eq â€œstopâ€ || $command eq â€œstopsshâ€ ) {
        # $orig_master_host, $orig_master_ip, $orig_master_port are passed.
        # If you manage master ip address at global catalog database,
        # invalidate orig_master_ip here.
        my $exit_code = 1;
        eval {
            print â€œ\n\n\n<strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong><em>\nâ€;
            print â€œDisabling the VIP - $vip on old master: $orig_master_host\nâ€;
            print â€œ</em></strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong>\n\n\n\nâ€;
&amp;stop_vip();
            $exit_code = 0;
        };
        if ($@) {
            warn â€œGot Error: $@\nâ€;
            exit $exit_code;
        }
        exit $exit_code;
}
elsif ( $command eq â€œstartâ€ ) {
        # all arguments are passed.
        # If you manage master ip address at global catalog database,
        # activate new_master_ip here.
        # You can also grant write access (create user, set read_only=0, etc) here.
my $exit_code = 10;
        eval {
            print â€œ\n\n\n<strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong><em>\nâ€;
            print â€œEnabling the VIP - $vip on new master: $new_master_host \nâ€;
            print â€œ</em></strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong>\n\n\n\nâ€;
&amp;start_vip();
            $exit_code = 0;
        };
        if ($@) {
            warn $@;
            exit $exit_code;
        }
        exit $exit_code;
}
elsif ( $command eq â€œstatusâ€ ) {
        print â€œChecking the Status of the script.. OK \nâ€;
        <code class="language-plaintext highlighter-rouge">ssh $orig_master_ssh_user\@$orig_master_host \" $ssh_start_vip \"</code>; 
        exit 0; 
}<br />
else { 
&amp;usage(); 
        exit 1; 
} 
}</p>

<h1 id="a-simple-system-call-that-enable-the-vip-on-the-new-master-1">A simple system call that enable the VIP on the new master</h1>
<p>sub start_vip() { 
<code class="language-plaintext highlighter-rouge">ssh $new_master_ssh_user\@$new_master_host \" $ssh_start_vip \"</code>; 
}</p>
<h1 id="a-simple-system-call-that-disable-the-vip-on-the-old_master-1">A simple system call that disable the VIP on the old_master</h1>
<p>sub stop_vip() { 
<code class="language-plaintext highlighter-rouge">ssh $orig_master_ssh_user\@$orig_master_host \" $ssh_stop_vip \"</code>; 
}</p>

<p>sub usage { 
print 
â€œUsage: master_ip_failover â€“command=start|stop|stopssh|status â€“orig_master_host=host â€“orig_master_ip=ip â€“orig_master_port=po
rt â€“new_master_host=host â€“new_master_ip=ip â€“new_master_port=port\nâ€;
}
failoveråå‘é€é‚®ä»¶è„šæœ¬</p>
<h1 id="cat-send_report">cat send_report</h1>
<p>#!/bin/bash
source /root/.bash_profile
orig_master_host=<code class="language-plaintext highlighter-rouge">echo "$1" | awk -F = '{print $2}'</code>
new_master_host=<code class="language-plaintext highlighter-rouge">echo "$2" | awk -F = '{print $2}'</code>
new_slave_hosts=<code class="language-plaintext highlighter-rouge">echo "$3" | awk -F = '{print $2}'</code>
subject=<code class="language-plaintext highlighter-rouge">echo "$4" | awk -F = '{print $2}'</code>
body=<code class="language-plaintext highlighter-rouge">echo "$5" | awk -F = '{print $2}'</code>
#åˆ¤æ–­æ—¥å¿—ç»“å°¾æ˜¯å¦æœ‰successfullyï¼Œæœ‰åˆ™è¡¨ç¤ºåˆ‡æ¢æˆåŠŸï¼ŒæˆåŠŸä¸å¦éƒ½å‘é‚®ä»¶
tac /mha/app1/manager.log | sed -n 2p | grep â€˜successfullyâ€™ &gt; /dev/null
if [ $? -eq 0 ]
  then
  echo -e â€œMHA $subject ä¸»ä»åˆ‡æ¢æˆåŠŸ\n master:$orig_master_host â€“&gt; $new_master_host \n $body \n å½“å‰ä»åº“:$new_slave_hostsâ€ | mailx -s â€œMySQLå®ä¾‹å®•æ‰,MHA $subject åˆ‡æ¢æˆåŠŸâ€ noreply@birdteam.net
else
  echo -e â€œMHA $subject ä¸»ä»åˆ‡æ¢å¤±è´¥\n master:$orig_master_host â€“&gt; $new_master_host \n $bodyâ€ | mailx -s â€œMySQLå®ä¾‹å®•æ‰,MHA $subject åˆ‡æ¢å¤±è´¥â€ noreply@birdteam.net
fi
ä¿®æ”¹è„šæœ¬å±ä¸»å±ç»„ï¼Œå¹¶ä¸”å¢åŠ æ‰§è¡Œæƒé™</p>
<h1 id="chown-mysqlmysql-">chown mysql.mysql ./*</h1>
<h1 id="chmod-x-">chmod +x ./*</h1>
<p>æ£€æŸ¥SSHçš„é…ç½®</p>
<h1 id="masterha_check_ssh-confmhaapp1app1conf">masterha_check_ssh â€“conf=/mha/app1/app1.conf</h1>
<p>Tue Jan  5 17:16:41 2016 - [info] All SSH connectiontests passed successfully.
æ£€æŸ¥MHAçš„é…ç½®</p>
<h1 id="masterha_check_repl-confmhaapp1app1conf">masterha_check_repl â€“conf=/mha/app1/app1.conf</h1>
<p>MySQL Replication Health is OK.
å¯åŠ¨MHAçš„æœåŠ¡</p>
<h1 id="masterha_manager-confmhaapp1app1conf">masterha_manager â€“conf=/mha/app1/app1.conf</h1>
<p>å‘ç”Ÿfailoverä¸»ä»åˆ‡æ¢åï¼ŒMHAmanageræœåŠ¡ä¼šè‡ªåŠ¨åœæ‰ï¼Œä¸”åœ¨manager_workdirç›®å½•ä¸‹é¢ç”Ÿæˆæ–‡ä»¶app1.failover.completeï¼Œè‹¥æƒ³è¦å¯åŠ¨MHAï¼Œå¿…é¡»å…ˆç¡®ä¿æ²¡æœ‰æ­¤æ–‡ä»¶</p>
<h1 id="ll">ll</h1>
<p>total 80
-rw-râ€“râ€“ 1 mysql mysql   556 Aug 29 11:23 app1.conf
-rw-râ€“râ€“ 1 root  root      0 Aug 29 15:33 app1.failover.complete
-rw-râ€“râ€“ 1 root  root  69838 Aug 29 15:33 manager.log
-rw-râ€“râ€“ 1 root  root    143 Aug 29 15:33 saved_master_binlog_from_192.168.100.111_3306_20160829153340.binlog
åœ¨çº¿æ‰‹åŠ¨åˆ‡æ¢ä¸»ä»ï¼Œå¦‚æœMHAåœ¨è¿è¡Œï¼Œéœ€è¦å…ˆåœæ­¢MHAï¼Œç„¶åå†æ£€æŸ¥MHAå½“å‰è®¾ç½®</p>
<h1 id="masterha_check_repl-confmhaapp1app1conf-1">masterha_check_repl â€“conf=/mha/app1/app1.conf</h1>
<p>æ‰‹åŠ¨åˆ‡æ¢
å¦‚æœä¸æŒ‡å®šnew_master_hostï¼Œåˆ™ä¼šæ ¹æ®é…ç½®æ–‡ä»¶app1.cnfé€‰å‡ºnew_master_hostï¼Œä½†new_master_porté»˜è®¤æ˜¯3306
masterha_master_switch â€“master_state=alive â€“conf=/mha/app1/app1.conf  â€“orig_master_is_new_slave -running_updates_limit=3600 â€“interactive=0
ä»¥ä¸‹ä¸ºåˆ‡æ¢æ—¶æŒ‡å®šäº†new_master_hostå’Œnew_master_port
masterha_master_switch â€“master_state=alive â€“conf=/mha/app1/app1.conf  â€“orig_master_is_new_slave -running_updates_limit=3600 â€“interactive=0 â€“new_master_host=10.200.3.2 â€“new_master_port=3306
å‚æ•°â€“running_updates_limitå¦‚æœç°åœ¨masteræ‰§è¡Œå†™æ“ä½œçš„æ‰§è¡Œæ—¶é—´å¤§äºè¿™ä¸ªå‚æ•°ï¼Œæˆ–ä»»ä½•ä¸€å°slaveçš„Seconds_Behind_Masterå¤§äºè¿™ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆmaster switchå°†è‡ªåŠ¨æ”¾å¼ƒï¼Œé»˜è®¤å‚æ•°ä¸º1sï¼›
å‚æ•°â€“interactive=0éäº¤äº’åˆ‡æ¢ï¼Œå»ºè®®åŠ ä¸Šï¼Œå¯ä»¥å¤§å¤§åŠ å¿«åˆ‡æ¢é€Ÿåº¦ï¼ŒåŠ ä¸Šååº“ä¸å¿™æ—¶å¤§æ¦‚3ç§’å†…åˆ‡æ¢å®Œæˆã€‚
æ³¨æ„
å¦‚æœéœ€è¦å°†ç°æœ‰çš„ä»åº“ä¿®æ”¹ä¸ºä»ï¼Œå†å¯åŠ¨mhaçš„æ—¶å€™å¯èƒ½ä¼šæŠ¥é”™ï¼›
Wed Sep  7 12:18:56 2016 - [error][/usr/share/perl5/vendor_perl/MHA/ServerManager.pm, ln671] Master 192.168.100.111:3306 from which slave 10.200.3.2(10.200.3.2:3306) replicates is not defined in the configuration file!
åˆ‡æ¢è„šæœ¬å¯åœ¨MHAçš„å®˜ç½‘æŸ¥çœ‹ã€‚</p>
:ET