I"Ç4<!-- more -->
<p>åŸºæœ¬çš„åŒ¹é…ï¼ˆQueryï¼‰æŸ¥è¯¢
GET /bookdb_index/book/_search?q=guideã€€#æŸ¥è¯¢ä»»ä¸€å­—æ®µåŒ…å«guideçš„è®°å½•ã€‚</p>

<p>ä¸‹é¢æ˜¯å®Œæ•´bodyç‰ˆçš„æŸ¥è¯¢ï¼š</p>

<p>{
    â€œqueryâ€: {
        â€œmulti_matchâ€: {
            â€œqueryâ€: â€œguideâ€,
            â€œfieldsâ€: [
                â€œ_allâ€
            ]
        }
    }
}
GET /bookdb_index/book/_search?q=title:in action</p>

<p>æŸ¥è¯¢titleå­—æ®µåŒ…å«in actionçš„ä¹¦ã€‚</p>

<p>POST /bookdb_index/book/_search</p>

<p>{
    â€œqueryâ€: {
        â€œmatchâ€: {
            â€œtitleâ€: â€œin actionâ€
        }
    },
    â€œsizeâ€: 2,
    â€œfromâ€: 0,
    â€œ_sourceâ€: [
        â€œtitleâ€,
        â€œsummaryâ€,
        â€œpublish_dateâ€
    ],
    â€œhighlightâ€: {
        â€œfieldsâ€: {
            â€œtitleâ€: {}
        }
    }
}
SizeæŒ‡å®šè¿”å›çš„ç»“æœæ¡æ•°ï¼ŒfromæŒ‡å®šèµ·å§‹ä½å­ï¼Œ_scoreæŒ‡å®šè¦è¿”å›çš„å­—æ®µã€‚</p>

<p>å¤šå­—æ®µï¼ˆMulti-fieldï¼‰æŸ¥è¯¢
POST /bookdb_index/book/_search</p>

<p>{
    â€œqueryâ€: {
        â€œmulti_matchâ€: {
            â€œqueryâ€: â€œelasticsearch guideâ€,
            â€œfieldsâ€: [
                â€œtitleâ€,
                â€œsummaryâ€
            ]
        }
    }
}
Boosting</p>

<p>æŸ¥è¯¢å¤šä¸ªå­—æ®µæ—¶ï¼Œå¯ä»¥æŠŠä¸ªåˆ«å­—æ®µçš„åˆ†æ•°æé«˜å€æ•°ï¼Œä»¥æ­¤æé«˜æ­¤å­—æ®µçš„é‡è¦ç¨‹åº¦ã€‚</p>

<p>POST /bookdb_index/book/_search</p>

<p>{
    â€œqueryâ€: {
        â€œmulti_matchâ€: {
            â€œqueryâ€: â€œelasticsearch guideâ€,
            â€œfieldsâ€: [
                â€œtitleâ€,
                â€œsummary^3â€
            ]
        }
    },
    â€œ_sourceâ€: [
        â€œtitleâ€,
        â€œsummaryâ€,
        â€œpublish_dateâ€
    ]
}
BoolæŸ¥è¯¢</p>

<p>ä¸ºäº†æä¾›æ›´ç›¸å…³æˆ–è€…ç‰¹å®šçš„ç»“æœï¼ŒAND/OR/NOTæ“ä½œç¬¦å¯ä»¥ç”¨æ¥è°ƒæ•´æˆ‘ä»¬çš„æŸ¥è¯¢ã€‚å®ƒæ˜¯ä»¥å¸ƒå°”æŸ¥è¯¢çš„æ–¹å¼æ¥å®ç°çš„ã€‚å¸ƒå°”æŸ¥è¯¢æ¥å—å¦‚ä¸‹å‚æ•°ï¼š</p>

<p>mustç­‰åŒäºANDã€‚
must_notç­‰åŒäºNOTã€‚
shouldç­‰åŒäºORã€‚
å¦‚ï¼šæŸ¥è¯¢ä¹¦ååŒ…å«Elasticsearchæˆ–è€…Solrï¼Œå¹¶ä¸”å®ƒçš„ä½œè€…æ˜¯Clinton Gormleyä¸æ˜¯Radu Gheorgeã€‚</p>

<p>POST /bookdb_index/book/_search</p>

<p>{
    â€œqueryâ€: {
        â€œboolâ€: {
            â€œmustâ€: {
                â€œboolâ€: {
                    â€œshouldâ€: [
                        {
                            â€œmatchâ€: {
                                â€œtitleâ€: â€œElasticsearchâ€
                            }
                        },
                        {
                            â€œmatchâ€: {
                                â€œtitleâ€: â€œSolrâ€
                            }
                        }
                    ]
                }
            },
            â€œmustâ€: {
                â€œmatchâ€: {
                    â€œauthorsâ€: â€œclinton gormelyâ€
                }
            },
            â€œmust_notâ€: {
                â€œmatchâ€: {
                    â€œauthorsâ€: â€œradu gheorgeâ€
                }
            }
        }
    }
}
æ¨¡ç³Šï¼ˆFuzzyï¼‰æŸ¥è¯¢
åœ¨è¿›è¡ŒåŒ¹é…å’Œå¤šé¡¹åŒ¹é…æ—¶ï¼Œå¯ä»¥å¯ç”¨æ¨¡ç³ŠåŒ¹é…æ¥æ•æ‰æ‹¼å†™é”™è¯¯ï¼Œæ¨¡ç³Šåº¦æ˜¯åŸºäºåŸå§‹å•è¯çš„ç¼–è¾‘è·ç¦»æ¥æŒ‡å®šçš„ã€‚</p>

<p>POST /bookdb_index/book/_search</p>

<p>{
    â€œqueryâ€: {
        â€œmulti_matchâ€: {
            â€œqueryâ€: â€œcomprihensiv guideâ€,
            â€œfieldsâ€: [
                â€œtitleâ€,
                â€œsummaryâ€
            ],
            â€œfuzzinessâ€: â€œAUTOâ€
        }
    },
    â€œ_sourceâ€: [
        â€œtitleâ€,
        â€œsummaryâ€,
        â€œpublish_dateâ€
    ],
    â€œsizeâ€: 1
}
é€šé…ç¬¦ï¼ˆWildcardï¼‰æŸ¥è¯¢
é€šé…ç¬¦æŸ¥è¯¢å…è®¸ä½ æŒ‡å®šåŒ¹é…çš„æ¨¡å¼ï¼Œè€Œä¸æ˜¯æ•´ä¸ªæœ¯è¯­ã€‚</p>

<p>?ã€€åŒ¹é…ä»»ä½•å­—ç¬¦ã€‚</p>

<p>*ã€€åŒ¹é…é›¶ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ã€‚</p>

<p>å¦‚ï¼šæŸ¥æ‰¾åç§°ä»¥å­—æ¯tå¼€å¤´çš„æ‰€æœ‰ä½œè€…çš„è®°å½•ã€‚</p>

<p>POST /bookdb_index/book/_search</p>

<p>{
    â€œqueryâ€: {
        â€œwildcardâ€: {
            â€œauthorsâ€: â€œt*â€
        }
    },
    â€œ_sourceâ€: [
        â€œtitleâ€,
        â€œauthorsâ€
    ],
    â€œhighlightâ€: {
        â€œfieldsâ€: {
            â€œauthorsâ€: {}
        }
    }
}
æ­£åˆ™ï¼ˆRegexpï¼‰æŸ¥è¯¢
æ­£åˆ™æŸ¥è¯¢å¯ä»¥æ”¯æŒæ¯”é€šé…ç¬¦æŸ¥è¯¢æ›´å¤æ‚çš„æ¨¡å¼ã€‚</p>

<p>POST /bookdb_index/book/_search</p>

<p>{
    â€œqueryâ€: {
        â€œregexpâ€: {
            â€œauthorsâ€: â€œt[a-z]*yâ€
        }
    },
    â€œ_sourceâ€: [
        â€œtitleâ€,
        â€œauthorsâ€
    ],
    â€œhighlightâ€: {
        â€œfieldsâ€: {
            â€œauthorsâ€: {}
        }
    }
}
çŸ­è¯­åŒ¹é…æŸ¥è¯¢
çŸ­è¯­åŒ¹é…æŸ¥è¯¢ è¦æ±‚åœ¨è¯·æ±‚å­—ç¬¦ä¸²ä¸­çš„æ‰€æœ‰æŸ¥è¯¢é¡¹å¿…é¡»éƒ½åœ¨æ–‡æ¡£ä¸­å­˜åœ¨ï¼Œæ–‡ä¸­é¡ºåºä¹Ÿå¾—å’Œè¯·æ±‚å­—ç¬¦ä¸²ä¸€è‡´ï¼Œä¸”å½¼æ­¤ç›¸è¿ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒæŸ¥è¯¢é¡¹ä¹‹é—´å¿…é¡»ç´§å¯†ç›¸è¿ï¼Œä½†å¯ä»¥è®¾ç½® slop å€¼æ¥æŒ‡å®šæŸ¥è¯¢é¡¹ä¹‹é—´å¯ä»¥åˆ†éš”å¤šè¿œçš„è·ç¦»ï¼Œç»“æœä»å°†è¢«å½“ä½œä¸€æ¬¡æˆåŠŸçš„åŒ¹é…ã€‚</p>

<p>POST /bookdb_index/book/_search</p>

<p>{
    â€œqueryâ€: {
        â€œmulti_matchâ€: {
            â€œqueryâ€: â€œsearch engineâ€,
            â€œfieldsâ€: [
                â€œtitleâ€,
                â€œsummaryâ€
            ],
            â€œtypeâ€: â€œphraseâ€,
            â€œslopâ€: 3
        }
    },
    â€œ_sourceâ€: [
        â€œtitleâ€,
        â€œsummaryâ€,
        â€œpublish_dateâ€
    ]
}
çŸ­è¯­å‰ç¼€ï¼ˆMatch Phrase Prefixï¼‰æŸ¥è¯¢
çŸ­è¯­å‰ç¼€å¼æŸ¥è¯¢ èƒ½å¤Ÿè¿›è¡Œ å³æ—¶æœç´¢ï¼ˆsearch-as-you-typeï¼‰ ç±»å‹çš„åŒ¹é…ï¼Œæˆ–è€…è¯´æä¾›ä¸€ä¸ªæŸ¥è¯¢æ—¶çš„åˆçº§è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½ï¼Œæ— éœ€ä»¥ä»»ä½•æ–¹å¼å‡†å¤‡ä½ çš„æ•°æ®ã€‚å’Œ match_phrase æŸ¥è¯¢ç±»ä¼¼ï¼Œå®ƒæ¥æ”¶slop å‚æ•°ï¼ˆç”¨æ¥è°ƒæ•´å•è¯é¡ºåºå’Œä¸å¤ªä¸¥æ ¼çš„ç›¸å¯¹ä½ç½®ï¼‰å’Œ max_expansions å‚æ•°ï¼ˆç”¨æ¥é™åˆ¶æŸ¥è¯¢é¡¹çš„æ•°é‡ï¼Œé™ä½å¯¹èµ„æºéœ€æ±‚çš„å¼ºåº¦ï¼‰ã€‚</p>

<p>POST /bookdb_index/book/_search</p>

<p>{
    â€œqueryâ€: {
        â€œmatch_phrase_prefixâ€: {
            â€œsummaryâ€: {
                â€œqueryâ€: â€œsearch enâ€,
                â€œslopâ€: 3,
                â€œmax_expansionsâ€: 10
            }
        }
    },
    â€œ_sourceâ€: [
        â€œtitleâ€,
        â€œsummaryâ€,
        â€œpublish_dateâ€
    ]
}
æŸ¥è¯¢å­—ç¬¦ä¸²ï¼ˆQuery Stringï¼‰
æŸ¥è¯¢å­—ç¬¦ä¸² ç±»å‹ï¼ˆquery_stringï¼‰çš„æŸ¥è¯¢æä¾›äº†ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨ç®€æ´çš„ç®€å†™è¯­æ³•æ¥æ‰§è¡Œ å¤šåŒ¹é…æŸ¥è¯¢ã€ å¸ƒå°”æŸ¥è¯¢ ã€ ææƒæŸ¥è¯¢ã€ æ¨¡ç³ŠæŸ¥è¯¢ã€ é€šé…ç¬¦æŸ¥è¯¢ã€ æ­£åˆ™æŸ¥è¯¢ å’ŒèŒƒå›´æŸ¥è¯¢ã€‚ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åœ¨é‚£äº›ä½œè€…æ˜¯ â€œgrant ingersollâ€ æˆ– â€œtom mortonâ€ çš„æŸæœ¬ä¹¦å½“ä¸­ï¼Œä½¿ç”¨æŸ¥è¯¢é¡¹ â€œsearch algorithmâ€ è¿›è¡Œä¸€æ¬¡æ¨¡ç³ŠæŸ¥è¯¢ï¼Œæœç´¢å…¨éƒ¨å­—æ®µï¼Œä½†ç»™ summary çš„æƒé‡æå‡ 2 å€ã€‚</p>

<p>POST /bookdb_index/book/_search</p>

<p>{
    â€œqueryâ€: {
        â€œquery_stringâ€: {
            â€œqueryâ€: â€œ(saerch~1 algorithm~1) AND (grant ingersoll)  OR (tom morton)â€,
            â€œfieldsâ€: [
                â€œ_allâ€,
                â€œsummary^2â€
            ]
        }
    },
    â€œ_sourceâ€: [
        â€œtitleâ€,
        â€œsummaryâ€,
        â€œauthorsâ€
    ],
    â€œhighlightâ€: {
        â€œfieldsâ€: {
            â€œsummaryâ€: {}
        }
    }
}
ç®€å•æŸ¥è¯¢å­—ç¬¦ä¸²ï¼ˆSimple Query Stringï¼‰
ç®€å•è¯·æ±‚å­—ç¬¦ä¸² ç±»å‹ï¼ˆsimple_query_stringï¼‰çš„æŸ¥è¯¢æ˜¯è¯·æ±‚å­—ç¬¦ä¸²ç±»å‹ï¼ˆquery_stringï¼‰æŸ¥è¯¢çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œå®ƒæ›´é€‚åˆé‚£ç§ä»…æš´éœ²ç»™ç”¨æˆ·ä¸€ä¸ªç®€å•æœç´¢æ¡†çš„åœºæ™¯ï¼›å› ä¸ºå®ƒç”¨ +/|/- åˆ†åˆ«æ›¿æ¢äº† AND/OR/NOTï¼Œå¹¶ä¸”è‡ªåŠ¨ä¸¢å¼ƒäº†è¯·æ±‚ä¸­æ— æ•ˆçš„éƒ¨åˆ†ï¼Œä¸ä¼šåœ¨ç”¨æˆ·å‡ºé”™æ—¶ï¼ŒæŠ›å‡ºå¼‚å¸¸ã€‚</p>

<p>POST /bookdb_index/book/_search</p>

<p>{
    â€œqueryâ€: {
        â€œsimple_query_stringâ€: {
            â€œqueryâ€: â€œ(saerch~1 algorithm~1) + (grant ingersoll)  | (tom morton)â€,
            â€œfieldsâ€: [
                â€œ_allâ€,
                â€œsummary^2â€
            ]
        }
    },
    â€œ_sourceâ€: [
        â€œtitleâ€,
        â€œsummaryâ€,
        â€œauthorsâ€
    ],
    â€œhighlightâ€: {
        â€œfieldsâ€: {
            â€œsummaryâ€: {}
        }
    }
}
è¯æ¡ï¼ˆTermï¼‰/å¤šè¯æ¡ï¼ˆTermsï¼‰æŸ¥è¯¢
ä»¥ä¸Šä¾‹å­å‡ä¸º full-text(å…¨æ–‡æ£€ç´¢) çš„ç¤ºä¾‹ã€‚æœ‰æ—¶æˆ‘ä»¬å¯¹ç»“æ„åŒ–æŸ¥è¯¢æ›´æ„Ÿå…´è¶£ï¼Œå¸Œæœ›å¾—åˆ°æ›´å‡†ç¡®çš„åŒ¹é…å¹¶è¿”å›ç»“æœï¼Œè¯æ¡æŸ¥è¯¢ å’Œ å¤šè¯æ¡æŸ¥è¯¢ å¯å¸®æˆ‘ä»¬å®ç°ã€‚åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬è¦åœ¨ç´¢å¼•ä¸­æ‰¾åˆ°æ‰€æœ‰ç”± Manning å‡ºç‰ˆçš„å›¾ä¹¦ã€‚</p>

<p>POST /bookdb_index/book/_search</p>

<p>{
    â€œqueryâ€: {
        â€œtermâ€: {
            â€œpublisherâ€: â€œmanningâ€
        }
    },
    â€œ_sourceâ€: [
        â€œtitleâ€,
        â€œpublish_dateâ€,
        â€œpublisherâ€
    ]
}
å¯ä½¿ç”¨è¯æ¡å…³é”®å­—æ¥æŒ‡å®šå¤šä¸ªè¯æ¡ï¼Œå°†æœç´¢é¡¹ç”¨æ•°ç»„ä¼ å…¥ã€‚</p>

<p>{
    â€œqueryâ€: {
        â€œtermsâ€: {
            â€œpublisherâ€: [
                â€œoreillyâ€,
                â€œpacktâ€
            ]
        }
    }
}
è¯æ¡ï¼ˆTermï¼‰æŸ¥è¯¢-æ’åºï¼ˆSortedï¼‰
è¯æ¡æŸ¥è¯¢ çš„ç»“æœï¼ˆå’Œå…¶ä»–æŸ¥è¯¢ç»“æœä¸€æ ·ï¼‰å¯ä»¥è¢«è½»æ˜“æ’åºï¼Œå¤šçº§æ’åºä¹Ÿè¢«å…è®¸ã€‚</p>

<p>POST /bookdb_index/book/_search</p>

<p>{
    â€œqueryâ€: {
        â€œtermâ€: {
            â€œpublisherâ€: â€œmanningâ€
        }
    },
    â€œ_sourceâ€: [
        â€œtitleâ€,
        â€œpublish_dateâ€,
        â€œpublisherâ€
    ],
    â€œsortâ€: [
        {
            â€œpublish_dateâ€: {
                â€œorderâ€: â€œdescâ€
            }
        },
        {
            â€œtitleâ€: {
                â€œorderâ€: â€œdescâ€
            }
        }
    ]
}
èŒƒå›´æŸ¥è¯¢
å¦ä¸€ä¸ªç»“æ„åŒ–æŸ¥è¯¢çš„ä¾‹å­æ˜¯èŒƒå›´æŸ¥è¯¢ã€‚</p>

<p>æ³¨ï¼šèŒƒå›´æŸ¥è¯¢ ç”¨äºæ—¥æœŸã€æ•°å­—å’Œå­—ç¬¦ä¸²ç±»å‹çš„å­—æ®µã€‚</p>

<p>å¦‚ï¼šæŸ¥æ‰¾2015å¹´å‡ºç‰ˆçš„ä¹¦ã€‚</p>

<p>POST /bookdb_index/book/_search</p>

<p>{
    â€œqueryâ€: {
        â€œrangeâ€: {
            â€œpublish_dateâ€: {
                â€œgteâ€: â€œ2015-01-01â€,
                â€œlteâ€: â€œ2015-12-31â€
            }
        }
    },
    â€œ_sourceâ€: [
        â€œtitleâ€,
        â€œpublish_dateâ€,
        â€œpublisherâ€
    ]
}
è¿‡æ»¤ï¼ˆFilteredï¼‰æŸ¥è¯¢
è¿‡æ»¤æŸ¥è¯¢å…è®¸ä½ å¯ä»¥è¿‡æ»¤æŸ¥è¯¢ç»“æœã€‚å¦‚ï¼šè¦åœ¨æ ‡é¢˜æˆ–æ‘˜è¦ä¸­æ£€ç´¢ä¸€äº›ä¹¦ï¼ŒæŸ¥è¯¢é¡¹ä¸ºElasticsearchï¼Œä½†æˆ‘ä»¬åˆæƒ³ç­›å‡ºé‚£äº›ä»…æœ‰20ä¸ªä»¥ä¸Šè¯„è®ºçš„ã€‚</p>

<p>POST /bookdb_index/book/_search</p>

<p>{
    â€œqueryâ€: {
        â€œfilteredâ€: {
            â€œqueryâ€: {
                â€œmulti_matchâ€: {
                    â€œqueryâ€: â€œelasticsearchâ€,
                    â€œfieldsâ€: [
                        â€œtitleâ€,
                        â€œsummaryâ€
                    ]
                }
            },
            â€œfilterâ€: {
                â€œrangeâ€: {
                    â€œnum_reviewsâ€: {
                        â€œgteâ€: 20
                    }
                }
            }
        }
    },
    â€œ_sourceâ€: [
        â€œtitleâ€,
        â€œsummaryâ€,
        â€œpublisherâ€,
        â€œnum_reviewsâ€
    ]
}
è¿‡æ»¤æŸ¥è¯¢ å°†åœ¨ ElasticSearch 5 ä¸­ç§»é™¤ï¼Œä½¿ç”¨ å¸ƒå°”æŸ¥è¯¢ æ›¿ä»£ã€‚ä¸‹é¢æœ‰ä¸ªä¾‹å­ä½¿ç”¨ å¸ƒå°”æŸ¥è¯¢ é‡å†™ä¸Šé¢çš„ä¾‹å­ã€‚</p>

<p>POST /bookdb_index/book/_search</p>

<p>{
    â€œqueryâ€: {
        â€œboolâ€: {
            â€œmustâ€: {
                â€œmulti_matchâ€: {
                    â€œqueryâ€: â€œelasticsearchâ€,
                    â€œfieldsâ€: [
                        â€œtitleâ€,
                        â€œsummaryâ€
                    ]
                }
            },
            â€œfilterâ€: {
                â€œrangeâ€: {
                    â€œnum_reviewsâ€: {
                        â€œgteâ€: 20
                    }
                }
            }
        }
    },
    â€œ_sourceâ€: [
        â€œtitleâ€,
        â€œsummaryâ€,
        â€œpublisherâ€,
        â€œnum_reviewsâ€
    ]
}
å¤šé‡è¿‡æ»¤ï¼ˆMultiple Filtersï¼‰
å¤šé‡è¿‡æ»¤ å¯ä»¥ç»“åˆ å¸ƒå°”æŸ¥è¯¢ ä½¿ç”¨ï¼Œä¸‹ä¸€ä¸ªä¾‹å­ä¸­ï¼Œè¿‡æ»¤æŸ¥è¯¢å†³å®šåªè¿”å›é‚£äº›åŒ…å«è‡³å°‘20æ¡è¯„è®ºï¼Œä¸”å¿…é¡»åœ¨ 2015 å¹´å‰å‡ºç‰ˆï¼Œä¸”ç”± Oâ€™Reilly å‡ºç‰ˆçš„ç»“æœã€‚</p>

<p>POST /bookdb_index/book/_search</p>

<p>{
    â€œqueryâ€: {
        â€œfilteredâ€: {
            â€œqueryâ€: {
                â€œmulti_matchâ€: {
                    â€œqueryâ€: â€œelasticsearchâ€,
                    â€œfieldsâ€: [
                        â€œtitleâ€,
                        â€œsummaryâ€
                    ]
                }
            },
            â€œfilterâ€: {
                â€œboolâ€: {
                    â€œmustâ€: {
                        â€œrangeâ€: {
                            â€œnum_reviewsâ€: {
                                â€œgteâ€: 20
                            }
                        }
                    },
                    â€œmust_notâ€: {
                        â€œrangeâ€: {
                            â€œpublish_dateâ€: {
                                â€œlteâ€: â€œ2014-12-31â€
                            }
                        }
                    },
                    â€œshouldâ€: {
                        â€œtermâ€: {
                            â€œpublisherâ€: â€œoreillyâ€
                        }
                    }
                }
            }
        }
    },
    â€œ_sourceâ€: [
        â€œtitleâ€,
        â€œsummaryâ€,
        â€œpublisherâ€,
        â€œnum_reviewsâ€,
        â€œpublish_dateâ€
    ]</p>

<p>https://blog.csdn.net/troubleshooter/article/details/122315749</p>
:ET