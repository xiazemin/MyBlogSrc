I"¹E<p><img src="https://xiazemin.github.io/MyBlog/img/mysqlghost.png" />
GHOSTå·¥ä½œåŸç†ï¼š</p>

<p>1ã€é¦–å…ˆæ–°å»ºä¸€å¼ ghostè¡¨ï¼Œç»“æ„ä¸æºè¡¨ç›¸åŒ
2ã€ä½¿ç”¨alterå‘½ä»¤ä¿®æ”¹ghostè¡¨
3.1ã€æ¨¡æ‹Ÿä»åº“å‘½ä»¤è·å–ä¸»åº“ä¸Šè¯¥è¡¨çš„binlog(åŸºäºå…¨é•œåƒçš„è¡Œæ¨¡å¼çš„binlogåŒ…å«æ›´æ”¹å‰å’Œæ›´æ”¹åçš„æ‰€æœ‰æ•°æ®)ï¼Œå¹¶è§£ææˆè¯­å¥åˆ°ghostè¡¨ä¸Šæ‰§è¡Œã€‚
3.2ã€è·å–æºè¡¨çš„æ•°æ®èŒƒå›´ï¼ˆå¦‚æŒ‰ç…§ä¸»é”®è·å–åˆ°æœ€å¤§å€¼å’Œæœ€å°å€¼ï¼‰ï¼Œç„¶åå°†æ•°æ®æ‹†åˆ†ä¸ºå¤šä¸ªæ‰¹æ¬¡æ‹·è´æ’å…¥åˆ°ghostè¡¨ä¸­
4ã€é”ä½æºè¡¨ï¼Œé˜²æ­¢ç”¨æˆ·ä¿®æ”¹æºè¡¨æ•°æ®
5ã€å°†æºè¡¨é‡å‘½åï¼Œå°†ghostè¡¨æ”¹åä¸ºæºè¡¨
6ã€é‡Šæ”¾è¡¨é”ï¼Œæ¸…ç†gh-ostå·¥å…·äº§ç”Ÿçš„è¡¨ã€‚
<!-- more -->
GHOSTæœ‰å·¥ä½œæ¨¡å¼ï¼š</p>

<p>1.è¿æ¥ä¸»åº“ç›´æ¥ä¿®æ”¹
    ç›´è¿ä¸»åº“
    ä¸»åº“ä¸Šåˆ›å»ºghostè¡¨
    æ–°è¡¨(ghostè¡¨)ä¸Šç›´æ¥alterä¿®æ”¹è¡¨ç»“æ„
    è¿ç§»åŸè¡¨æ•°æ®åˆ°æ–°è¡¨
    æ‹‰å–è§£æbinlogäº‹ä»¶,åº”ç”¨åˆ°æ–°è¡¨
    cut-overé˜¶æ®µ,ç”¨æ–°è¡¨æ›¿æ¢æ‰åŸè¡¨
2.è¿æ¥ä»åº“é—´æ¥åº”ç”¨åˆ°ä¸»åº“
    è¿æ¥ä»åº“
    æ ¡éªŒå®Œå,åœ¨ä¸»åº“åˆ›å»ºæ–°è¡¨
    è¿ç§»åŸè¡¨æ•°æ®åˆ°æ–°è¡¨
    æ¨¡æ‹Ÿä»åº“çš„ä»åº“,æ‹‰å–è§£æå¢é‡binlogåº”ç”¨åˆ°ä¸»åº“
    cut-overé˜¶æ®µ,ç”¨æ–°è¡¨æ›¿æ¢æ‰åŸè¡¨</p>

<p>ä¸¤è€…ä¸åŒçš„ç‚¹å°±åœ¨äº,é€šè¿‡è¿æ¥ä»åº“æ¥è¿›è¡Œå˜æ›´,å¯¹ä¸»åº“çš„æ€§èƒ½å½±å“æœ€å°ï¼Œä½†ä½¿ç”¨ä¸»åº“èƒ½å¤Ÿå‡å°‘ç½‘ç»œå½±å“ï¼Œæ“ä½œé€Ÿåº¦æ›´å¿«ã€‚
å¦‚ä½•ä¿è¯æºè¡¨å’Œæ–°è¡¨æ•°æ®ä¸€è‡´ï¼š</p>

<p>ç”±äºä½¿ç”¨binlogè·å¾—çš„æ•°æ®æ€»æ˜¯æ–°äºæˆ–è€…ç­‰äºä»æºè¡¨æ‹·è´çš„æ•°æ®ï¼š
1ã€åœ¨åº”ç”¨binlogå¯¼å‡ºçš„æ•°æ®æ—¶ï¼Œå°†UPDATEå’ŒDELETEç›´æ¥åº”ç”¨ghostè¡¨ï¼Œå°†INSERTä¿®æ”¹ä¸ºREPLACE INTOå†åº”ç”¨åˆ°ghostè¡¨ã€‚
2ã€åœ¨copyæºè¡¨æ•°æ®åˆ°ghostè¡¨æ—¶ï¼Œä½¿ç”¨INSERT IGNOREæ¥å¿½ç•¥æ‰ghostè¡¨å·²å­˜åœ¨çš„è®°å½•
3ã€å¯¹äºåœ¨gh-ostå·¥ä½œæœŸé—´å‘ç”Ÿçš„DELETEæ“ä½œï¼š
    Aï¼šå¦‚æœè®°å½•åœ¨ä»æºè¡¨åˆ é™¤å‰è¢«å¤åˆ¶åˆ°ghostè¡¨ï¼Œ åˆ™ghostè¡¨ä¸­è®°å½•ä¼šåœ¨åº”ç”¨binlogå¯¼å‡ºçš„DELETEå‘½ä»¤æ—¶åˆ é™¤ã€‚
    Bï¼šä½¿ç”¨è®°å½•åœ¨ä»æºè¡¨å¤åˆ¶åˆ°ghostè¡¨ä¹‹å‰è¢«åˆ é™¤ï¼Œåˆ™è®°å½•ä¸ä¼šè¢«å¤åˆ¶åˆ°ghostè¡¨ï¼Œåº”ç”¨binlogå¯¼å‡ºçš„DELETEå‘½ä»¤ä¹Ÿä¸ä¼šæŠ¥é”™ã€‚
GHOSTæ”¯æŒè·¨æœåŠ¡å™¨æ“ä½œ</p>

<p>å‡è®¾æœ‰ä¸€å¥—ä¸»ä»å¤åˆ¶A1â€“&gt;A2ï¼ŒA1ä¸ºä¸»åº“ï¼ŒA2ä¸ºä»åº“ï¼Œå¦æœ‰ä¸€å°æœåŠ¡å™¨B1è£…æœ‰gh-ostï¼Œå¯ä»¥åœ¨B1ä¸Šæ‰§è¡Œå¯¹A1ä¸Šè¡¨çš„ä¿®æ”¹ï¼š
    1ã€å¯¹äºæ•°æ®æ‹·è´æ“ä½œï¼ŒB1å‘é€æŸ¥è¯¢åˆ°A1ä¸Šå…ˆè·å–æœ€å¤§å€¼å’Œæœ€å°å€¼ï¼Œç„¶ååœ¨B1ä¸Šè¿›è¡Œæ‹†åˆ†æˆä¸åŒæ‰¹æ¬¡ï¼Œå†ä»B1ä¸Šå‘é€å‘½ä»¤ç»™A1æ‰§è¡Œå°èŒƒå›´æ•°æ®æ‹·è´
    2ã€å¯¹äºBinlogè§£æï¼Œå…ˆæ¨¡æ‹ŸB1åˆ°A1çš„æ­å»ºå¤åˆ¶ï¼Œä»A1ä¸Šæ‹‰å–binlogåˆ°B1ï¼Œåœ¨B1ä¸Šè§£ææˆSQLå‘½ä»¤ï¼Œå†å‘é€åˆ°A1ä¸Šæ‰§è¡Œã€‚</p>

<p>å¯¹äºè·¨æœåŠ¡å™¨æ‰§è¡Œgh-ostå‘½ä»¤ï¼Œä¼šå¯¼è‡´å¤§é‡æ•°æ®åœ¨æ•°æ®åº“æœåŠ¡å™¨åˆ°å‘½ä»¤æœåŠ¡å™¨ä¹‹é—´ä¼ è¾“ï¼Œéœ€è¦è€ƒè™‘ç½‘ç»œå¸¦å®½å’Œç½‘ç»œç¨³å®š
é‡å‘½ååŸç†</p>

<p>åœ¨pt-oscæˆ–è€…online ddlä¸­,æœ€åçš„renameæ“ä½œä¸€èˆ¬æ˜¯è€—æ—¶æ¯”è¾ƒçŸ­,ä½†å¦‚æœè¡¨ç»“æ„å˜æ›´è¿‡ç¨‹ä¸­,æœ‰å¤§æŸ¥è¯¢è¿›æ¥,é‚£ä¹ˆåœ¨renameæ“ä½œçš„æ—¶å€™,ä¼šè§¦å‘MDLé”çš„ç­‰å¾…,å¦‚æœåœ¨é«˜å³°æœŸ,è¿™å°±æ˜¯ä¸ªä¸¥é‡çš„é—®é¢˜ã€‚æ‰€ä»¥gh-ostæ˜¯æ€ä¹ˆåšçš„å‘¢ï¼Ÿ</p>

<p>gh-oståˆ©ç”¨äº†MySQLçš„ä¸€ä¸ªç‰¹æ€§ï¼Œå°±æ˜¯åŸå­æ€§çš„renameè¯·æ±‚ï¼Œåœ¨æ‰€æœ‰è¢«blockedçš„è¯·æ±‚ä¸­ï¼Œä¼˜å…ˆçº§æ°¸è¿œæ˜¯æœ€é«˜çš„ã€‚gh-oståŸºäºæ­¤è®¾è®¡äº†è¯¥æ–¹æ¡ˆï¼šä¸€ä¸ªè¿æ¥å¯¹åŸè¡¨åŠ é”ï¼Œå¦å¯ä¸€ä¸ªè¿æ¥å°è¯•renameæ“ä½œï¼Œæ­¤æ—¶ä¼šè¢«é˜»å¡ä½ï¼Œå½“é‡Šæ”¾lockçš„æ—¶å€™ï¼Œrenameä¼šé¦–å…ˆè¢«æ‰§è¡Œï¼Œå…¶ä»–è¢«é˜»å¡çš„è¯·æ±‚ä¼šç»§ç»­åº”ç”¨åˆ°æ–°è¡¨ã€‚
å”¯ä¸€ç´¢å¼•é—®é¢˜</p>

<p>å¦‚æœé€šè¿‡gh-ostæ¥æ–°å¢å”¯ä¸€ç´¢å¼•ï¼Œç”±äºREPLACE INTOå’ŒINSERT IGNOREä¼šå—åˆ°ghostè¡¨ä¸Šå”¯ä¸€ç´¢å¼•çš„å½±å“ï¼Œå½“åœ¨å”¯ä¸€ç´¢å¼•ä¸Šå­˜åœ¨æ•°æ®é‡å¤æ—¶ï¼Œä¼šå¯¼è‡´æ•°æ®ä¸¢å¤±ã€‚</p>

<p>å¸¸ç”¨GHOSTæ¨¡æ¿</p>

<p>##================================================##
mysql_ip=â€127.0.0.1â€
mysql_port=3358
ghost_user=â€rootâ€
ghost_password=â€123.comâ€
ghost_database=â€test1â€
ghost_table=â€tb002â€
ghost_command=â€ADD C4 INT COMMENT â€˜æµ‹è¯•åˆ—â€™â€</p>

<p>./gh-ost <br />
â€“allow-on-master <br />
â€“max-load=â€Threads_running=256â€ <br />
â€“critical-load=â€Threads_running=512â€ <br />
â€“chunk-size=1000 <br />
â€“initially-drop-old-table <br />
â€“initially-drop-ghost-table <br />
â€“initially-drop-socket-file <br />
â€“timestamp-old-table <br />
â€“force-table-names=â€â€ <br />
â€“host=â€${mysql_ip}â€ <br />
â€“port=â€${mysql_port}â€ <br />
â€“user=â€${ghost_user}â€ <br />
â€“password=â€${ghost_password}â€ <br />
â€“database=â€${ghost_database}â€ <br />
â€“table=â€${ghost_table}â€ <br />
â€“alter=â€${ghost_command}â€ <br />
â€“verbose <br />
â€“execute 
GHOSTå¸¸ç”¨å‚æ•°ï¼š</p>

<p>1ã€å¦‚æœå¸Œæœ›ç›´æ¥è¯»å–ä¸»åº“BINLOGï¼Œéœ€è¦æŒ‡å®šallow-on-masterå‚æ•°
2ã€å¦‚æœæƒ³é¿å…ä¸Šæ¬¡æ“ä½œå¤±è´¥äº§ç”Ÿçš„ä¸´æ—¶è¡¨å¯¼è‡´æ–°æ“ä½œå¤±è´¥ï¼Œå»ºè®®ä½¿ç”¨initially-drop-ghost-tableå’Œinitially-drop-socket-fileå‚æ•°
3ã€å¦‚æœå¸Œæœ›GHOSTæ“ä½œå®Œæˆååˆ é™¤æºè¡¨ï¼Œä½¿ç”¨ok-to-drop-tableå‚æ•°
4ã€å¦‚æœå¸Œæœ›GHOSTæ“ä½œå®Œæˆåä¿ç•™æºè¡¨ï¼Œå»ºè®®ä½¿ç”¨timestamp-old-tableå‚æ•°ä¸”ä¸ä½¿ç”¨ok-to-drop-tableå‚æ•°
5ã€ä½¿ç”¨å‚æ•°max-loadæ¥æ§åˆ¶ä¸»åº“ç¹å¿™æ—¶æš‚åœGHOSTè¿è¡Œ
6ã€ä½¿ç”¨å‚æ•°critical-loadæ¥æ§åˆ¶ä¸»åº“ç¹å¿™æ—¶ç»ˆæ­¢GHOSTè¿è¡Œ
7ã€ä½¿ç”¨å‚æ•°throttle-flag-fileæˆ–throttle-queryæ¥æ§åˆ¶GHOSTæš‚åœè¿è¡Œ
8ã€ä½¿ç”¨å‚æ•°panic-flag-fileæ¥æ§åˆ¶GHOSTåœæ­¢è¿è¡Œ
9ã€ä½¿ç”¨å‚æ•°throttle-control-replicasæ¥æ§åˆ¶GHOSTå¯¹ä»åº“å¤åˆ¶å»¶è¿Ÿçš„å½±å“
GHOSTå»ºè®®ï¼š</p>

<p>1ã€é¿å…åŒä¸€æ—¶é—´å…è®¸å¤šä¸ªGHOST
2ã€è¯·å‹¿ä½¿ç”¨GHOSTæ¥åˆ›å»ºå”¯ä¸€ç´¢å¼•
3ã€å»ºè®®ä»ä¸»åº“è¯»å–BINLOGï¼Œæ‰§è¡Œæ•ˆç‡è¾ƒé«˜
4ã€å»ºè®®è®¾ç½®critical-loadå’Œmax-loadæ—¶ä»…è€ƒè™‘Threads_runningçš„å€¼ï¼Œä½¿ç”¨Threads_connectedå®¹æ˜“å› è¿æ¥æš´æ¶¨å¯¼è‡´GHOSTæš‚åœæˆ–ä¸­æ­¢
5ã€åœ¨ç£ç›˜ç©ºé—´è¶³å¤Ÿçš„æ¡ä»¶ä¸‹ï¼Œä½¿ç”¨timestamp-old-tableæ¥ä¿å­˜æºè¡¨ï¼Œä¸€æ–¹é¢ç«‹å³åˆ é™¤æºè¡¨ä¼šé€ æˆIOå‹åŠ›ï¼Œå¦ä¸€æ–¹é¢é˜²æ­¢æ‰§è¡Œä¸­å‡ºç°BUGæˆ–è¯¯æ“ä½œã€‚</p>

<p>GHOSTæ‰€æœ‰å‚æ•°ï¼š</p>

<p>Usage of gh-ost:
  -allow-master-master
        å½“è¿è¡ŒMMåŒä¸»æ¨¡å¼æ—¶éœ€è¦æ˜¾ç¤ºè®¾ç½®ã€‚</p>

<p>-allow-nullable-unique-key
        è®¾ç½®æ˜¯å¦è¿è¡Œå”¯ä¸€é”®åˆ—ä¸­ä½¿ç”¨NULLå€¼ï¼Œä½¿ç”¨ghoståˆ›å»ºå”¯ä¸€ç´¢å¼•ï¼Œå­˜åœ¨æ•°æ®ä¸¢å¤±é£é™©ï¼Œæ…ç”¨ï¼</p>

<p>-allow-on-master
        å½“ä½¿ç”¨ä¸»èŠ‚ç‚¹çš„BINLOGæ¥æ“ä½œæ—¶ï¼Œéœ€è¦è®¾ç½®è¯¥å€¼ä¸ºONã€‚</p>

<p>-alter string
        ä¿®æ”¹å‘½ä»¤ï¼Œä¸åŒ…å«ALTER TABLEéƒ¨åˆ†ã€‚</p>

<p>-approve-renamed-columns ALTER
        å½“ä½¿ç”¨ghostè¿›è¡Œä¿®æ”¹åˆ—åæ“ä½œï¼Œéœ€è¦è®¾ç½®è¯¥å€¼</p>

<p>-ask-pass
        æå‡è¾“å…¥å¯†ç </p>

<p>-assume-master-host string
        åœ¨åŒä¸»æˆ–å¤šä¸»å¤åˆ¶åœºæ™¯ä¸‹ï¼Œè®¾ç½®ä»¥å“ªä¸ªä¸»èŠ‚ç‚¹çš„BINLOGä¸ºä¸»ã€‚</p>

<p>-assume-rbr
        å‡å®šä½¿ç”¨åŸºäºROWæ ¼å¼çš„å¤åˆ¶æ¨¡å¼</p>

<p>-check-flag
        Check if another flag exists/supported. This allows for cross-version scripting. Exits with 0 when all additional provided flags exist, nonzero otherwise. You must provide (dummy) values for flags that require a value. Example: gh-ost â€“check-flag â€“cut-over-lock-timeout-seconds â€“nice-ratio 0</p>

<p>-chunk-size int
        è®¾ç½®æ¯ä¸ªæ‰¹æ¬¡å¤åˆ¶æ•°æ®çš„è¡Œæ•°ï¼Œå–å€¼èŒƒå›´100è‡³100000ï¼Œé»˜è®¤ä¸º1000</p>

<p>-concurrent-rowcount
        (with â€“exact-rowcount), when true (default): count rows after row-copy begins, concurrently, and adjust row estimate later on; when false: first count rows, then start row copy (default true)
        è®¾ç½®å¯¹æ‹·è´è®°å½•çš„è®¡æ•°æ–¹å¼ã€‚</p>

<p>-conf string
        é…ç½®æ–‡ä»¶çš„è·¯å¾„</p>

<p>-critical-load string
        Comma delimited status-name=threshold, same format as â€“max-load. When status exceeds threshold, app panics and quits
        è®¾ç½®GHOSTè¿è¡Œçš„æœ€å¤§é˜ˆå€¼ï¼Œå½“è¶…è¿‡è¯¥é˜ˆå€¼åï¼Œç»ˆæ­¢GHOSTè¿è¡Œã€‚</p>

<p>-critical-load-hibernate-seconds int
        When nonzero, critical-load does not panic and bail out; instead, gh-ost goes into hibernate for the specified duration. It will not read/write anything to from/to any server
        å½“è¯¥å€¼ä¸ä¸º0æ—¶ï¼Œå¦‚æœè¾¾åˆ°critical-loadè®¾ç½®çš„é˜ˆå€¼ï¼Œä¼šä¼‘çœ æŒ‡å®šæ—¶é—´ï¼Œç„¶åå†æ¬¡æ£€æŸ¥ã€‚</p>

<p>-critical-load-interval-millis int
        When 0, migration immediately bails out upon meeting critical-load. When non-zero, a second check is done after given interval, and migration only bails out if 2nd check still meets critical load
        è®¾ç½®è¾¾åˆ°critical-loadè®¾ç½®çš„é˜ˆå€¼åçš„æ£€æŸ¥é—´éš”ã€‚</p>

<p>-cut-over string
        choose cut-over type (default|atomic, two-step) (default â€œatomicâ€)
        è®¾ç½®åˆ‡æ¢æºè¡¨å’Œæ–°è¡¨è¡¨åçš„æ“ä½œæ–¹å¼ï¼Œé»˜è®¤ä¸ºè‡ªåŠ¨</p>

<p>-cut-over-lock-timeout-seconds int
        Max number of seconds to hold locks on tables while attempting to cut-over (retry attempted when lock exceeds timeout) (default 3)
        è®¾ç½®åœ¨cut-overæ—¶è·å–è¡¨é”çš„è¶…æ—¶æ—¶é—´ã€‚</p>

<p>-database string
        database name (mandatory)
        æ•°æ®åº“å</p>

<p>-debug
        debug mode (very verbose)
        DEBUGæ¨¡å¼</p>

<p>-default-retries int
        Default number of retries for various operations before panicking (default 60)
        é»˜è®¤é‡è¯•æ¬¡æ•°</p>

<p>-discard-foreign-keys
        DANGER! This flag will migrate a table that has foreign keys and will NOT create foreign keys on the ghost table, thus your altered table will have NO foreign keys. This is useful for intentional dropping of foreign keys
        è®¾ç½®æ˜¯å¦ä¸¢å¼ƒå¤–é”®ï¼Œè°¨æ…è®¾ç½®ã€‚</p>

<p>-dml-batch-size int
        batch size for DML events to apply in a single transaction (range 1-100) (default 10)</p>

<p>-exact-rowcount
        actually count table rows as opposed to estimate them (results in more accurate progress estimation)</p>

<p>-execute
        actually execute the alter &amp; migrate the table. Default is noop: do some tests and exit
        è®¾ç½®è¿è¡ŒGHOSTæ“ä½œï¼Œé»˜è®¤ä¸æ‰§è¡Œï¼Œä»…æ£€æŸ¥å¹¶é€€å‡ºã€‚</p>

<p>-force-named-cut-over
        When true, the â€˜unpostpone|cut-overâ€™ interactive command must name the migrated table</p>

<p>-force-table-names string
        table name prefix to be used on the temporary tables
        è®¾ç½®ä¸´æ—¶è¡¨çš„å‰ç¼€</p>

<p>-heartbeat-interval-millis int
        how frequently would gh-ost inject a heartbeat value (default 100)
        è®¾ç½®æ£€æŸ¥å¿ƒè·³æ—¶é—´é—´éš”</p>

<p>-help
        Display usage</p>

<p>-hooks-hint string
        arbitrary message to be injected to hooks via GH_OST_HOOKS_HINT, for your convenience</p>

<p>-hooks-path string
        directory where hook files are found (default: empty, ie. hooks disabled). Hook files found on this path, and conforming to hook naming conventions will be executed</p>

<p>-host string
        MySQL hostname (preferably a replica, not the master) (default â€œ127.0.0.1â€)</p>

<p>-initially-drop-ghost-table
        Drop a possibly existing Ghost table (remains from a previous run?) before beginning operation. Default is to panic and abort if such table exists
        è®¾ç½®æ˜¯å¦åˆ é™¤å·²å­˜åœ¨çš„ghostè¡¨ï¼Œé»˜è®¤ä¸åˆ é™¤ï¼Œå¦‚æœghostè¡¨å­˜åœ¨ï¼Œåˆ™ç«‹å³é€€å‡ºã€‚</p>

<p>-initially-drop-old-table
        Drop a possibly existing OLD table (remains from a previous run?) before beginning operation. Default is to panic and abort if such table exists
        è®¾ç½®æ˜¯å¦åˆ é™¤å·²å­˜åœ¨çš„OLDè¡¨ï¼Œé»˜è®¤ä¸åˆ é™¤ï¼Œå¦‚æœå­˜åœ¨ï¼Œåˆ™ç«‹å³é€€å‡ºã€‚</p>

<p>-initially-drop-socket-file
        Should gh-ost forcibly delete an existing socket file. Be careful: this might drop the socket file of a running migration!
        è®¾ç½®æ˜¯å¦åˆ é™¤å·²æœ‰çš„socketæ–‡ä»¶</p>

<p>-master-password string
        MySQL password on master, if different from that on replica. Requires â€“assume-master-host</p>

<p>-master-user string
        MySQL user on master, if different from that on replica. Requires â€“assume-master-host</p>

<p>-max-lag-millis int
        replication lag at which to throttle operation (default 1500)
        è®¾ç½®å¤åˆ¶å»¶è¿Ÿé˜ˆå€¼ï¼Œå¦‚æœå¤åˆ¶å»¶è¿Ÿè¶…è¿‡è¯¥é˜ˆå€¼ï¼Œåˆ™æš‚åœGHOSTæ“ä½œã€‚</p>

<p>-max-load string
        Comma delimited status-name=threshold. e.g: â€˜Threads_running=100,Threads_connected=500â€™. When status exceeds threshold, app throttles writes
        è®¾ç½®GHOSTå…è®¸é˜ˆå€¼ï¼Œå¦‚æœè¶…è¿‡è¯¥å€¼ï¼Œåˆ™æš‚åœGHOSTæ“ä½œã€‚</p>

<p>-migrate-on-replica
        Have the migration run on a replica, not on the master. This will do the full migration on the replica including cut-over (as opposed to â€“test-on-replica)</p>

<p>-nice-ratio float
        force being â€˜niceâ€™, imply sleep time per chunk time; range: [0.0..100.0]. Example values: 0 is aggressive. 1: for every 1ms spent copying rows, sleep additional 1ms (effectively doubling runtime); 0.7: for every 10ms spend in a rowcopy chunk, spend 7ms sleeping immediately after
        è®¾ç½®æ˜¾ç¤ºGHOSTè¿›åº¦çš„æ ¼å¼</p>

<p>-ok-to-drop-table
        Shall the tool drop the old table at end of operation. DROPping tables can be a long locking operation, which is why Iâ€™m not doing it by default. Iâ€™m an online tool, yes?
        è®¾ç½®GHOSTå®Œæˆåæ˜¯å¦åˆ é™¤OLDè¡¨ï¼Œå¯¹äºè¶…å¤§è¡¨ï¼Œåˆ é™¤è¡¨æ“ä½œä¼šæŒç»­å¾ˆé•¿æ—¶é—´ï¼Œå¹¶ä¸”é€ æˆæ€§èƒ½é—®é¢˜ï¼Œå»ºè®®å°†è¡¨åˆ é™¤æ“ä½œæ”¾åˆ°ä¸šåŠ¡ä½å³°æœŸæ“ä½œã€‚</p>

<p>-panic-flag-file string
        when this file is created, gh-ost will immediately terminate, without cleanup
        å½“GHOSTæ£€æŸ¥åˆ°è¯¥æ–‡ä»¶å­˜åœ¨æ—¶ï¼Œä¼šç«‹å³é€€å‡ºè€Œä¸åšä»»ä½•æ¸…ç†ã€‚</p>

<p>-password string
        MySQL password</p>

<p>-port int
        MySQL port (preferably a replica, not the master) (default 3306)</p>

<p>-postpone-cut-over-flag-file string
        while this file exists, migration will postpone the final stage of swapping tables, and will keep on syncing the ghost table. Cut-over/swapping would be ready to perform the moment the file is deleted.
        å½“GHOSTæ£€æŸ¥åˆ°è¯¥æ–‡ä»¶å­˜åœ¨æ—¶ï¼Œä¼šå°†åˆ‡æ¢è¡¨åæ“ä½œå»¶æœŸï¼Œç›´åˆ°è¯¥æ–‡ä»¶è¢«åˆ é™¤ã€‚</p>

<p>-quiet
        quiet
  -replica-server-id uint
        server id used by gh-ost process. Default: 99999 (default 99999)
        æŒ‡å®šGHOSTæ“ä½œå®ä¾‹çš„server-id</p>

<p>-replication-lag-query string
        Deprecated. gh-ost uses an internal, subsecond resolution query
        å·²å¼ƒç”¨ã€‚</p>

<p>-serve-socket-file string
        Unix socket file to serve on. Default: auto-determined and advertised upon startup
        æŒ‡å®šå®ä¾‹ä½¿ç”¨çš„socketæ–‡ä»¶è·¯å¾„</p>

<p>-serve-tcp-port int
        TCP port to serve on. Default: disabled</p>

<p>-skip-foreign-key-checks
        set to â€˜trueâ€™ when you know for certain there are no foreign keys on your table, and wish to skip the time it takes for gh-ost to verify that
        å¿½ç•¥å¤–é”®æ£€æŸ¥</p>

<p>-skip-renamed-columns ALTER
        in case your ALTER statement renames columns, gh-ost will note that and offer its interpretation of the rename. By default gh-ost does not proceed to execute. This flag tells gh-ost to skip the renamed columns, i.e. to treat what gh-ost thinks are renamed columns as unrelated columns. NOTE: you may lose column data
        å¿½ç•¥åˆ—åä¿®æ”¹æ“ä½œ</p>

<p>-stack
        add stack trace upon error</p>

<p>-switch-to-rbr
        let this tool automatically switch binary log format to â€˜ROWâ€™ on the replica, if needed. The format will NOT be switched back. Iâ€™m too scared to do that, and wish to protect you if you happen to execute another migration while this one is running
        ä½¿ç”¨GHOSTå·¥å…·ä¿®æ”¹å¤åˆ¶æ ¼å¼ä¸ºROWæ¨¡å¼</p>

<p>-table string
        table name (mandatory)
        ä¿®æ”¹è¡¨çš„è¡¨å</p>

<p>-test-on-replica
        Have the migration run on a replica, not on the master. At the end of migration replication is stopped, and tables are swapped and immediately swap-revert. Replication remains stopped and you can compare the two tables for building trust
        åœ¨å¤åˆ¶èŠ‚ç‚¹ä¸Šè¿›è¡Œæµ‹è¯•</p>

<p>-test-on-replica-skip-replica-stop
        When â€“test-on-replica is enabled, do not issue commands stop replication (requires â€“test-on-replica)</p>

<p>-throttle-additional-flag-file string
        operation pauses when this file exists; hint: keep default, use for throttling multiple gh-ost operations (default â€œ/tmp/gh-ost.throttleâ€)
        å½“è¯¥æ–‡ä»¶å­˜åœ¨æ—¶ï¼ŒGHOSTæ“ä½œä¼šæš‚åœï¼Œé»˜è®¤å€¼ä¸º/tmp/gh-ost.throttle</p>

<p>-throttle-control-replicas string
        List of replicas on which to check for lag; comma delimited. Example: myhost1.com:3306,myhost2.com,myhost3.com:3307
        è®¾ç½®è¦å¤åˆ¶å»¶è¿Ÿçš„ä»åº“</p>

<p>-throttle-flag-file string
        operation pauses when this file exists; hint: use a file that is specific to the table being altered
        å½“è¯¥æ–‡ä»¶å­˜åœ¨æ—¶ï¼ŒGHOSTæ“ä½œä¼šæš‚åœ</p>

<p>-throttle-http string
        when given, gh-ost checks given URL via HEAD request; any response code other than 200 (OK) causes throttling; make sure it has low latency response
        åŸºäºHTTPæ–¹å¼æ¥å†³å®šGHOSTæš‚åœ</p>

<p>-throttle-query string
        when given, issued (every second) to check if operation should throttle. Expecting to return zero for no-throttle, &gt;0 for throttle. Query is issued on the migrated server. Make sure this query is lightweight
        åŸºäºQUERYæ–¹å¼æ¥å†³å®šGHOSTæš‚åœ</p>

<p>-timestamp-old-table
        Use a timestamp in old table name. This makes old table names unique and non conflicting cross migrations
        GHOSTæ“ä½œå®Œæˆåï¼Œå°†è€è¡¨è®¾ç½®å¸¦æœ‰æ—¶é—´æˆ³</p>

<p>-tungsten
        explicitly let gh-ost know that you are running on a tungsten-replication based topology (you are likely to also provide â€“assume-master-host)
        tungsten-replicationæ˜¯ä¸€ç§å¼‚æ„å¤åˆ¶æŠ€æœ¯ï¼Œå¦‚MySQLåˆ°MongoDBçš„å¤åˆ¶</p>

<p>-user string
        MySQL user</p>

<p>-verbose
        verbose
        è®¾ç½®è¯¥å‚æ•°ä¼šå¯¼è‡´GHOSTè¾“å‡ºæ›´å¤šè¯¦ç»†ä¿¡æ¯</p>

<p>-version
        Print version &amp; exit</p>
:ET