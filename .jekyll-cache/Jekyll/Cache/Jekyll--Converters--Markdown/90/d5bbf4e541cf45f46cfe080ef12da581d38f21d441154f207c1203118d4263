I"ä9<p>https://github.com/go-redis/redis
https://github.com/gomodule/redigo</p>

<p>https://segmentfault.com/a/1190000017879129</p>

<!-- more -->
<p>go get github.com/alphazero/Go-Redis
go get github.com/simonz05/godis
go get github.com/garyburd/redigo
go get github.com/gosexy/redis
go get cgl.tideland.biz/redis</p>

<p>https://my.oschina.net/mickelfeng/blog/1580960</p>

<p>go-rediså®¢æˆ·ç«¯å¯¹sentinelæ¨¡å¼ä¸‹ï¼ˆéé›†ç¾¤clusterï¼‰redis-serverä¸»ä»åˆ‡æ¢çš„æ”¯æŒ</p>

<p>https://blog.csdn.net/pengpengzhou/article/details/109363155</p>

<p>package app</p>

<p>import (
	â€œfmtâ€
	â€œgit.qutoutiao.net/framework/autumn-lib-cacheâ€
	â€œgithub.com/go-redis/redisâ€
	â€œstringsâ€
)</p>

<p>var redisSentinelManager = cache.CreateRedisClientManager()</p>

<p>type Sentinel struct {
	masterName string
	masterIp string
	masterPort string
	masterManager *cache.RedisClientManager
	slaveManager *cache.RedisClientManager
}</p>

<p>var sentinelClient *redis.SentinelClient</p>

<p>var masterClient *redis.Client</p>

<p>func init()  {
	fmt.Println(â€œdddddâ€)
	RedisSentinel()
}</p>

<p>/*
è·å–sentienl å®¢æˆ·ç«¯
 <em>/
func RedisSentinel() *redis.SentinelClient {
	/</em>rdb := redis.NewFailoverClient(&amp;redis.FailoverOptions{
		MasterName:    â€œmymasterâ€,
		SentinelAddrs: []string{â€œ127.0.0.1:26379â€,â€127.0.0.1:26480â€,â€127.0.0.1:26481â€},
	})*/
	if sentinelClient != nil {
		return  sentinelClient
	}
	/**
	è¿æ¥26379ç«¯å£çš„sentinelï¼›å¤šä¸ªsentinelåº”å¾ªç¯è·å–å¯ç”¨çš„sentinelï¼›
	è¿™é‡Œç®€å•å®ç°
	 */
	sentinelClient = redis.NewSentinelClient(&amp;redis.Options{
		Network:    â€œtcpâ€,
		Addr:       â€œ127.0.0.1:26379â€,
	})</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>//è®¢é˜…åˆ‡æ¢ä¸»æ¶ˆæ¯
go subScribe(sentinelClient)
 
return  sentinelClient }
</code></pre></div></div>

<p>//å¤„ç† åˆ‡ä¸»æ“ä½œ
/**
è¿™é‡Œéšä¾¿ è®¢é˜…ä¸€ä¸ªsentinelçš„ +switch-master
åˆ‡æ¢masterä¼š sentinel ä¼šå‘+switch-masterå‘å¸ƒä¸€ä¸ªæ¶ˆæ¯
 */
func subScribe(sentinelClient *redis.SentinelClient)  {
	fmt.Println(â€œcccâ€)
	pubsub := sentinelClient.Subscribe(â€œ+switch-masterâ€)
	fmt.Println(â€œdddâ€)
	_, err := pubsub.Receive()
	if err != nil {
		return
	}
	ch := pubsub.Channel()
	for msg := range ch {
		fmt.Println(â€œnewMasterâ€,msg.Channel, msg.Payload, â€œ\r\nâ€)
		master := strings.Split(msg.Payload, â€œ â€œ)
		fmt.Println(master)
		masterClient = redis.NewClient(&amp;redis.Options{
			Network:    â€œtcpâ€,
			Addr:       master[1]+â€:â€+master[2],
		})
	}
}</p>

<p>/**
è·å–ä¸»èŠ‚ç‚¹ä¿¡æ¯
 <em>/
func GetMasterClient(sentinelClient *redis.SentinelClient) *redis.Client {
	/</em>if masterClient !=nil {
		return masterClient
	}*/</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>masterInfo, _ := sentinelClient.GetMasterAddrByName("mymaster").Result()
 
fmt.Println("masterInfo",masterInfo )
 
masterClient = redis.NewClient(&amp;redis.Options{
	Network:    "tcp",
	Addr:      masterInfo[0]+":"+masterInfo[1],
})
fmt.Println("master", masterInfo[0]+masterInfo[1])
return masterClient }
</code></pre></div></div>

<p>func Subscribe(){
	client := redis.NewClient(&amp;redis.Options{
		Network:    â€œtcpâ€,
		Addr:       â€œ127.0.0.1:26379â€,
	})</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>//å‚æ•°1 é¢‘é“å å­—ç¬¦ä¸²ç±»å‹
pubsub := client.Subscribe("+switch-master")
_, err := pubsub.Receive()
if err != nil {
	return
}
ch := pubsub.Channel()
for msg := range ch {
	fmt.Println( msg.Channel, msg.Payload, "\r\n")
} }
</code></pre></div></div>

<p>go redis å¸¸ç”¨å®¢æˆ·ç«¯åˆ—è¡¨
godisï¼šä½¿ç”¨golangå®ç°çš„rediså®¢æˆ·ç«¯ï¼Œçµæ„Ÿæ¥æºäºjedis
redigo:æ˜¯ä¸€ä¸ªRedisæ•°æ®åº“å®ç°çš„goè¯­è¨€å®¢æˆ·ç«¯
redis: ç”¨Golangå®ç°çš„Rediså®¢æˆ·ç«¯
xredis:æ˜¯ä¸€ä¸ªç±»å‹å®‰å…¨ã€å¯å®šåˆ¶åŒ–ã€å¹²å‡€æ˜“ç”¨çš„å®¢æˆ·ç«¯Rediså·¥å…·
ä¸Šè¿°ä¸­ï¼Œä¸ªäººæ¯”è¾ƒæ¨ègodiså’Œredigoï¼Œä¹Ÿæ˜¯rediså®˜ç½‘ä¸Šæ¨èã€‚å› ä¸ºgo-rediså°è£…äº†redisçš„å¤§éƒ¨åˆ†å‘½ä»¤ï¼Œä¸ç”¨å…³å¿ƒredisçš„å‘½ä»¤çš„ç»†èŠ‚ï¼Œç›´æ¥è°ƒç”¨ç›¸åº”æ¥å£å°±è¡Œï¼›redigoæ˜¯åŸºäºå‘½ä»¤çš„ï¼Œå‘é€ä¸€ä¸ªå‘½ä»¤ï¼Œç„¶ååœ¨è§£æreplyï¼›æ‰€ä»¥ç›¸å¯¹è€Œè¨€ï¼Œç¬”è€…è§‰å¾—go-redisæ¥å£æ›´å‹å¥½</p>

<p>https://blog.csdn.net/enjoy_sun_moon/article/details/103614313</p>

<p>https://github.com/gistao/RedisGo-Async</p>

<p>https://www.jianshu.com/p/aeb27a6aa42d</p>

<p>https://www.cnblogs.com/zhangxiaoj/p/11291251.html</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>å¼€æºåº“redigoçš„ä½¿ç”¨ githubåœ°å€ï¼š https://github.com/garyburd/redigo
</code></pre></div></div>

<p>æ–‡æ¡£åœ°å€ï¼š
http://godoc.org/github.com/garyburd/redigo/redis</p>

<p>è·å–ï¼š</p>

<p>go get github.com/garyburd/redigo/redis
è¿æ¥redis</p>

<p>package main
import (
    â€œfmtâ€
    â€œgithub.com/garyburd/redigo/redisâ€
)</p>

<p>func main() {
    c, err := redis.Dial(â€œtcpâ€, â€œ127.0.0.1:6379â€)
    if err != nil {
        fmt.Println(â€œConnect to redis errorâ€, err)
        return
    }
    defer c.Close()
}
è¯»å†™
è¿™é‡Œå†™å…¥çš„å€¼æ°¸è¿œä¸ä¼šè¿‡æœŸ</p>

<p>package main</p>

<p>import (
    â€œfmtâ€</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"github.com/garyburd/redigo/redis" )
</code></pre></div></div>

<p>func main() {
    c, err := redis.Dial(â€œtcpâ€, â€œ127.0.0.1:6379â€)
    if err != nil {
        fmt.Println(â€œConnect to redis errorâ€, err)
        return
    }
    defer c.Close()</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>_, err = c.Do("SET", "mykey", "superWang")
if err != nil {
    fmt.Println("redis set failed:", err)
}

username, err := redis.String(c.Do("GET", "mykey"))
if err != nil {
    fmt.Println("redis get failed:", err)
} else {
    fmt.Printf("Get mykey: %v \n", username)
} }
</code></pre></div></div>

<p>å¦‚ä½•è®¾ç½®è¿‡æœŸå‘¢ï¼Œå¯ä»¥ä½¿ç”¨SETçš„é™„åŠ å‚æ•°ï¼š</p>

<p>package main</p>

<p>import (
    â€œfmtâ€
    â€œtimeâ€</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"github.com/garyburd/redigo/redis" )
</code></pre></div></div>

<p>func main() {
    c, err := redis.Dial(â€œtcpâ€, â€œ127.0.0.1:6379â€)
    if err != nil {
        fmt.Println(â€œConnect to redis errorâ€, err)
        return
    }
    defer c.Close()</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>_, err = c.Do("SET", "mykey", "superWang", "EX", "5")
if err != nil {
    fmt.Println("redis set failed:", err)
}

username, err := redis.String(c.Do("GET", "mykey"))
if err != nil {
    fmt.Println("redis get failed:", err)
} else {
    fmt.Printf("Get mykey: %v \n", username)
}

time.Sleep(8 * time.Second)

username, err = redis.String(c.Do("GET", "mykey"))
if err != nil {
    fmt.Println("redis get failed:", err)
} else {
    fmt.Printf("Get mykey: %v \n", username)
} }
</code></pre></div></div>

<p>è¾“å‡ºï¼š
Get mykey: superWang
redis get failed: redigo: nil returned</p>

<p>æ‰¹é‡å†™å…¥è¯»å–</p>

<p>MGET key [key â€¦]
MSET key value [key value â€¦]</p>

<p>æ‰¹é‡å†™å…¥è¯»å–å¯¹è±¡(Hashtable)
HMSET key field value [field value â€¦]
HMGET key field [field â€¦]</p>

<p>æ£€æµ‹å€¼æ˜¯å¦å­˜åœ¨
EXISTS key</p>

<p>package main</p>

<p>import (
    â€œfmtâ€</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"github.com/garyburd/redigo/redis" )
</code></pre></div></div>

<p>func main() {
    c, err := redis.Dial(â€œtcpâ€, â€œ127.0.0.1:6379â€)
    if err != nil {
        fmt.Println(â€œConnect to redis errorâ€, err)
        return
    }
    defer c.Close()</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>_, err = c.Do("SET", "mykey", "superWang")
if err != nil {
    fmt.Println("redis set failed:", err)
}

is_key_exit, err := redis.Bool(c.Do("EXISTS", "mykey1"))
if err != nil {
    fmt.Println("error:", err)
} else {
    fmt.Printf("exists or not: %v \n", is_key_exit)
}
</code></pre></div></div>

<p>}</p>

<p>è¾“å‡ºï¼š
exists or not: false</p>

<p>åˆ é™¤
DEL key [key â€¦]</p>

<p>package main</p>

<p>import (
    â€œfmtâ€</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"github.com/garyburd/redigo/redis" )
</code></pre></div></div>

<p>func main() {
    c, err := redis.Dial(â€œtcpâ€, â€œ127.0.0.1:6379â€)
    if err != nil {
        fmt.Println(â€œConnect to redis errorâ€, err)
        return
    }
    defer c.Close()</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>_, err = c.Do("SET", "mykey", "superWang")
if err != nil {
    fmt.Println("redis set failed:", err)
}

username, err := redis.String(c.Do("GET", "mykey"))
if err != nil {
    fmt.Println("redis get failed:", err)
} else {
    fmt.Printf("Get mykey: %v \n", username)
}

_, err = c.Do("DEL", "mykey")
if err != nil {
    fmt.Println("redis delelte failed:", err)
}

username, err = redis.String(c.Do("GET", "mykey"))
if err != nil {
    fmt.Println("redis get failed:", err)
} else {
    fmt.Printf("Get mykey: %v \n", username)
} } è¾“å‡ºï¼š Get mykey: superWang redis get failed: redigo: nil returned
</code></pre></div></div>

<p>è¯»å†™jsonåˆ°redis</p>

<p>package main</p>

<p>import (
    â€œencoding/jsonâ€
    â€œfmtâ€</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"github.com/garyburd/redigo/redis" )
</code></pre></div></div>

<p>func main() {
    c, err := redis.Dial(â€œtcpâ€, â€œ127.0.0.1:6379â€)
    if err != nil {
        fmt.Println(â€œConnect to redis errorâ€, err)
        return
    }
    defer c.Close()</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>key := "profile"
imap := map[string]string{"username": "666", "phonenumber": "888"}
value, _ := json.Marshal(imap)

n, err := c.Do("SETNX", key, value)
if err != nil {
    fmt.Println(err)
}
if n == int64(1) {
    fmt.Println("success")
}

var imapGet map[string]string

valueGet, err := redis.Bytes(c.Do("GET", key))
if err != nil {
    fmt.Println(err)
}

errShal := json.Unmarshal(valueGet, &amp;imapGet)
if errShal != nil {
    fmt.Println(err)
}
fmt.Println(imapGet["username"])
fmt.Println(imapGet["phonenumber"]) } è®¾ç½®è¿‡æœŸæ—¶é—´ EXPIRE key seconds
</code></pre></div></div>

<p>// è®¾ç½®è¿‡æœŸæ—¶é—´ä¸º24å°æ—¶<br />
n, _ := rs.Do(â€œEXPIREâ€, key, 24*3600)<br />
if n == int64(1) {<br />
    fmt.Println(â€œsuccessâ€)<br />
}<br />
åˆ—è¡¨æ“ä½œ
å‘½ä»¤ï¼š</p>

<p>redis 127.0.0.1:6379&gt; LPUSH runoobkey redis
(integer) 1
redis 127.0.0.1:6379&gt; LPUSH runoobkey mongodb
(integer) 2
redis 127.0.0.1:6379&gt; LPUSH runoobkey mysql
(integer) 3
redis 127.0.0.1:6379&gt; LRANGE runoobkey 0 10</p>

<p>1) â€œmysqlâ€
2) â€œmongodbâ€
3) â€œredisâ€
ä»£ç å®ç°ï¼š</p>

<p>package main</p>

<p>import (
    â€œfmtâ€</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"github.com/garyburd/redigo/redis" )
</code></pre></div></div>

<p>func main() {
    c, err := redis.Dial(â€œtcpâ€, â€œ127.0.0.1:6379â€)
    if err != nil {
        fmt.Println(â€œConnect to redis errorâ€, err)
        return
    }
    defer c.Close()</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>_, err = c.Do("lpush", "runoobkey", "redis")
if err != nil {
    fmt.Println("redis set failed:", err)
}

_, err = c.Do("lpush", "runoobkey", "mongodb")
if err != nil {
    fmt.Println("redis set failed:", err)
}
_, err = c.Do("lpush", "runoobkey", "mysql")
if err != nil {
    fmt.Println("redis set failed:", err)
}

values, _ := redis.Values(c.Do("lrange", "runoobkey", "0", "100"))

for _, v := range values {
    fmt.Println(string(v.([]byte)))
} } è¾“å‡ºï¼š mysql mongodb redis
</code></pre></div></div>

<p>ç®¡é“</p>

<p>è¯·æ±‚/å“åº”æœåŠ¡å¯ä»¥å®ç°æŒç»­å¤„ç†æ–°è¯·æ±‚ï¼Œå³ä½¿å®¢æˆ·ç«¯æ²¡æœ‰å‡†å¤‡å¥½è¯»å–æ—§å“åº”ã€‚è¿™æ ·å®¢æˆ·ç«¯å¯ä»¥å‘é€å¤šä¸ªå‘½ä»¤åˆ°æœåŠ¡å™¨è€Œæ— éœ€ç­‰å¾…å“åº”ï¼Œæœ€ååœ¨ä¸€æ¬¡è¯»å–å¤šä¸ªå“åº”ã€‚è¿™å°±æ˜¯ç®¡é“åŒ–(pipelining)ï¼Œè¿™ä¸ªæŠ€æœ¯åœ¨å¤šå¹´å°±è¢«å¹¿æ³›ä½¿ç”¨äº†ã€‚è·ç¦»ï¼Œå¾ˆå¤šPOP3åè®®å®ç°å·²ç»æ”¯æŒæ­¤ç‰¹æ€§ï¼Œæ˜¾è‘—åŠ é€Ÿäº†ä»æœåŠ¡å™¨ä¸‹è½½æ–°é‚®ä»¶çš„è¿‡ç¨‹ã€‚
Rediså¾ˆæ—©å°±æ”¯æŒç®¡é“åŒ–ï¼Œæ‰€ä»¥æ— è®ºä½ ä½¿ç”¨ä»»ä½•ç‰ˆæœ¬ï¼Œä½ éƒ½å¯ä»¥ä½¿ç”¨ç®¡é“åŒ–æŠ€æœ¯</p>

<p>è¿æ¥æ”¯æŒä½¿ç”¨Send()ï¼ŒFlush()ï¼ŒReceive()æ–¹æ³•æ”¯æŒç®¡é“åŒ–æ“ä½œ</p>

<p>Send(commandName string, args â€¦interface{}) error
Flush() error
Receive() (reply interface{}, err error)
Sendå‘è¿æ¥çš„è¾“å‡ºç¼“å†²ä¸­å†™å…¥å‘½ä»¤ã€‚Flushå°†è¿æ¥çš„è¾“å‡ºç¼“å†²æ¸…ç©ºå¹¶å†™å…¥æœåŠ¡å™¨ç«¯ã€‚RecevieæŒ‰ç…§FIFOé¡ºåºä¾æ¬¡è¯»å–æœåŠ¡å™¨çš„å“åº”ã€‚ä¸‹ä¾‹å±•ç¤ºäº†ä¸€ä¸ªç®€å•çš„ç®¡é“ï¼š</p>

<p>c.Send(â€œSETâ€, â€œfooâ€, â€œbarâ€)
c.Send(â€œGETâ€, â€œfooâ€)
c.Flush()
c.Receive() // reply from SET
v, err = c.Receive() // reply from GET
Doæ–¹æ³•ç»„åˆäº†Send,Flushå’Œ Receiveæ–¹æ³•ã€‚Doæ–¹æ³•å…ˆå†™å…¥å‘½ä»¤ï¼Œç„¶åæ¸…ç©ºè¾“å‡ºbufferï¼Œæœ€åæ¥æ”¶å…¨éƒ¨æŒ‚èµ·å“åº”åŒ…æ‹¬Doæ–¹å‘å‡ºçš„å‘½ä»¤çš„ç»“æœã€‚å¦‚æœä»»ä½•å“åº”ä¸­åŒ…å«ä¸€ä¸ªé”™è¯¯ï¼ŒDoè¿”å›é”™è¯¯ã€‚å¦‚æœæ²¡æœ‰é”™è¯¯ï¼ŒDoæ–¹æ³•è¿”å›æœ€åä¸€ä¸ªå“åº”ã€‚</p>

<p>å¼€æºåº“go-redis/redisçš„ä½¿ç”¨
githubåœ°å€ï¼š
https://github.com/go-redis/redis</p>

<p>æ–‡æ¡£åœ°å€ï¼š
https://godoc.org/github.com/go-redis/redis</p>

<p>è·å–ï¼š</p>

<p>go get -u github.com/go-redis/redis
åº”ç”¨ï¼š</p>

<p>package main</p>

<p>import (
    â€œfmtâ€</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"github.com/go-redis/redis" )
</code></pre></div></div>

<p>func main() {
    client := redis.NewClient(&amp;redis.Options{
        Addr:     â€œ127.0.0.1:6379â€,
        Password: â€œâ€, // no password set
        DB:       0,  // use default DB
    })</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pong, err := client.Ping().Result()
fmt.Println(pong, err)

err = client.Set("key", "value", 0).Err()
if err != nil {
    panic(err)
}

val, err := client.Get("key").Result()
if err != nil {
    panic(err)
}
fmt.Println("key", val)

val2, err := client.Get("key2").Result()
if err == redis.Nil {
    fmt.Println("key2 does not exists")
} else if err != nil {
    panic(err)
} else {
    fmt.Println("key2", val2)
} }
</code></pre></div></div>

<p>è¾“å‡ºï¼š
PONG
key value
key2 does not exists</p>

<p>http://www.manongjc.com/detail/9-nkutfxsmwxfvwni.html</p>

:ET