I"ı<p>åˆ›å»ºkafka topic
æŸ¥çœ‹æ‰€æœ‰topicåˆ—è¡¨
æŸ¥çœ‹æŒ‡å®štopicä¿¡æ¯
æ§åˆ¶å°å‘topicç”Ÿäº§æ•°æ®
æ§åˆ¶å°æ¶ˆè´¹topicçš„æ•°æ®
æŸ¥çœ‹topicæŸåˆ†åŒºåç§»é‡æœ€å¤§ï¼ˆå°ï¼‰å€¼
å¢åŠ topicåˆ†åŒºæ•°
åˆ é™¤topicï¼Œæ…ç”¨ï¼Œåªä¼šåˆ é™¤zookeeperä¸­çš„å…ƒæ•°æ®ï¼Œæ¶ˆæ¯æ–‡ä»¶é¡»æ‰‹åŠ¨åˆ é™¤
æŸ¥çœ‹topicæ¶ˆè´¹è¿›åº¦</p>

<p>åˆ›å»ºkafka topic
bin/kafka-topics.sh â€“zookeeper node01:2181 â€“create â€“topic t_cdr â€“partitions 30  â€“replication-factor 2
æ³¨ï¼š partitionsæŒ‡å®štopicåˆ†åŒºæ•°ï¼Œreplication-factoræŒ‡å®štopicæ¯ä¸ªåˆ†åŒºçš„å‰¯æœ¬æ•°</p>

<p>partitionsåˆ†åŒºæ•°:
partitions ï¼šåˆ†åŒºæ•°ï¼Œæ§åˆ¶topicå°†åˆ†ç‰‡æˆå¤šå°‘ä¸ªlogã€‚å¯ä»¥æ˜¾ç¤ºæŒ‡å®šï¼Œå¦‚æœä¸æŒ‡å®šåˆ™ä¼šä½¿ç”¨broker(server.properties)ä¸­çš„num.partitionsé…ç½®çš„æ•°é‡
è™½ç„¶å¢åŠ åˆ†åŒºæ•°å¯ä»¥æä¾›kafkaé›†ç¾¤çš„ååé‡ã€ä½†æ˜¯è¿‡å¤šçš„åˆ†åŒºæ•°æˆ–è€…æˆ–æ˜¯å•å°æœåŠ¡å™¨ä¸Šçš„åˆ†åŒºæ•°è¿‡å¤šï¼Œä¼šå¢åŠ ä¸å¯ç”¨åŠå»¶è¿Ÿçš„é£é™©ã€‚å› ä¸ºå¤šçš„åˆ†åŒºæ•°ï¼Œæ„å‘³ç€éœ€è¦æ‰“å¼€æ›´å¤šçš„æ–‡ä»¶å¥æŸ„ã€å¢åŠ ç‚¹åˆ°ç‚¹çš„å»¶æ—¶ã€å¢åŠ å®¢æˆ·ç«¯çš„å†…å­˜æ¶ˆè€—ã€‚
åˆ†åŒºæ•°ä¹Ÿé™åˆ¶äº†consumerçš„å¹¶è¡Œåº¦ï¼Œå³é™åˆ¶äº†å¹¶è¡Œconsumeræ¶ˆæ¯çš„çº¿ç¨‹æ•°ä¸èƒ½å¤§äºåˆ†åŒºæ•°
åˆ†åŒºæ•°ä¹Ÿé™åˆ¶äº†producerå‘é€æ¶ˆæ¯æ˜¯æŒ‡å®šçš„åˆ†åŒºã€‚å¦‚åˆ›å»ºtopicæ—¶åˆ†åŒºè®¾ç½®ä¸º1ï¼Œproducerå‘é€æ¶ˆæ¯æ—¶é€šè¿‡è‡ªå®šä¹‰çš„åˆ†åŒºæ–¹æ³•æŒ‡å®šåˆ†åŒºä¸º2æˆ–ä»¥ä¸Šçš„æ•°éƒ½ä¼šå‡ºé”™çš„ï¼›è¿™ç§æƒ…å†µå¯ä»¥é€šè¿‡alter â€“partitions æ¥å¢åŠ åˆ†åŒºæ•°ã€‚
replication-factorå‰¯æœ¬
replication factor æ§åˆ¶æ¶ˆæ¯ä¿å­˜åœ¨å‡ ä¸ªbroker(æœåŠ¡å™¨)ä¸Šï¼Œä¸€èˆ¬æƒ…å†µä¸‹ç­‰äºbrokerçš„ä¸ªæ•°ã€‚
å¦‚æœæ²¡æœ‰åœ¨åˆ›å»ºæ—¶æ˜¾ç¤ºæŒ‡å®šæˆ–é€šè¿‡APIå‘ä¸€ä¸ªä¸å­˜åœ¨çš„topicç”Ÿäº§æ¶ˆæ¯æ—¶ä¼šä½¿ç”¨broker(server.properties)ä¸­çš„default.replication.factoré…ç½®çš„æ•°é‡</p>

<p>æŸ¥çœ‹æ‰€æœ‰topicåˆ—è¡¨
bin/kafka-topics.sh â€“zookeeper node01:2181 â€“list</p>

<p>æŸ¥çœ‹æŒ‡å®štopicä¿¡æ¯
bin/kafka-topics.sh â€“zookeeper node01:2181 â€“describe â€“topic t_cdr</p>

<p>æ§åˆ¶å°å‘topicç”Ÿäº§æ•°æ®
bin/kafka-console-producer.sh â€“broker-list node86:9092 â€“topic t_cdr</p>

<p>æ§åˆ¶å°æ¶ˆè´¹topicçš„æ•°æ®
bin/kafka-console-consumer.sh  â€“zookeeper node01:2181  â€“topic t_cdr â€“from-beginning</p>

<p>æŸ¥çœ‹topicæŸåˆ†åŒºåç§»é‡æœ€å¤§ï¼ˆå°ï¼‰å€¼
bin/kafka-run-class.sh kafka.tools.GetOffsetShell â€“topic hive-mdatabase-hostsltable  â€“time -1 â€“broker-list node86:9092 â€“partitions 0
æ³¨ï¼š timeä¸º-1æ—¶è¡¨ç¤ºæœ€å¤§å€¼ï¼Œtimeä¸º-2æ—¶è¡¨ç¤ºæœ€å°å€¼</p>

<p>å¢åŠ topicåˆ†åŒºæ•°
ä¸ºtopic t_cdr å¢åŠ 10ä¸ªåˆ†åŒº</p>

<p>bin/kafka-topics.sh â€“zookeeper node01:2181  â€“alter â€“topic t_cdr â€“partitions 10</p>

<p>åˆ é™¤topicï¼Œæ…ç”¨ï¼Œåªä¼šåˆ é™¤zookeeperä¸­çš„å…ƒæ•°æ®ï¼Œæ¶ˆæ¯æ–‡ä»¶é¡»æ‰‹åŠ¨åˆ é™¤
bin/kafka-run-class.sh kafka.admin.DeleteTopicCommand â€“zookeeper node01:2181 â€“topic t_cdr</p>

<p>æŸ¥çœ‹topicæ¶ˆè´¹è¿›åº¦
è¿™ä¸ªä¼šæ˜¾ç¤ºå‡ºconsumer groupçš„offsetæƒ…å†µï¼Œ å¿…é¡»å‚æ•°ä¸ºâ€“groupï¼Œ ä¸æŒ‡å®šâ€“topicï¼Œé»˜è®¤ä¸ºæ‰€æœ‰topic</p>

<p>Displays the: Consumer Group, Topic, Partitions, Offset, logSize, Lag, Owner for the specified set of Topics and Consumer Group</p>

<p>bin/kafka-run-class.sh kafka.tools.ConsumerOffsetChecker</p>

<p>required argument: [group] 
Option Description 
â€”â€” â€”â€”â€”â€“ 
â€“broker-info Print broker info 
â€“group Consumer group. 
â€“help Print this message. 
â€“topic Comma-separated list of consumer 
   topics (all topics if absent). 
â€“zkconnect ZooKeeper connect string. (default: localhost:2181)</p>

<p>Example,</p>

<p>bin/kafka-run-class.sh kafka.tools.ConsumerOffsetChecker â€“group pv</p>

<p>Group           Topic              Pid Offset   logSize    Lag    Owner 
pv              page_visits        0   21       21         0      none 
pv              page_visits        1   19       19         0      none 
pv              page_visits        2   20       20         0      none
<!-- more --></p>
:ET