I" <p>1.CMakeç¼–è¯‘åŸç†</p>

<p>CMakeæ˜¯ä¸€ç§è·¨å¹³å°ç¼–è¯‘å·¥å…·ï¼Œæ¯”makeæ›´ä¸ºé«˜çº§ï¼Œä½¿ç”¨èµ·æ¥è¦æ–¹ä¾¿å¾—å¤šã€‚CMakeä¸»è¦æ˜¯ç¼–å†™CMakeLists.txtæ–‡ä»¶ï¼Œç„¶åç”¨cmakeå‘½ä»¤å°†CMakeLists.txtæ–‡ä»¶è½¬åŒ–ä¸ºmakeæ‰€éœ€è¦çš„makefileæ–‡ä»¶ï¼Œæœ€åç”¨makeå‘½ä»¤ç¼–è¯‘æºç ç”Ÿæˆå¯æ‰§è¡Œç¨‹åºæˆ–å…±äº«åº“ï¼ˆso(shared object)ï¼‰ã€‚å› æ­¤CMakeçš„ç¼–è¯‘åŸºæœ¬å°±ä¸¤ä¸ªæ­¥éª¤ï¼š</p>

<ol>
  <li>cmake</li>
  <li>make
cmake  æŒ‡å‘CMakeLists.txtæ‰€åœ¨çš„ç›®å½•ï¼Œä¾‹å¦‚cmake .. è¡¨ç¤ºCMakeLists.txtåœ¨å½“å‰ç›®å½•çš„ä¸Šä¸€çº§ç›®å½•ã€‚cmakeåä¼šç”Ÿæˆå¾ˆå¤šç¼–è¯‘çš„ä¸­é—´æ–‡ä»¶ä»¥åŠmakefileæ–‡ä»¶ï¼Œæ‰€ä»¥ä¸€èˆ¬å»ºè®®æ–°å»ºä¸€ä¸ªæ–°çš„ç›®å½•ï¼Œä¸“é—¨ç”¨æ¥ç¼–è¯‘ï¼Œä¾‹å¦‚</li>
</ol>

<p>mkdir build
cd build
cmake ..
make
makeæ ¹æ®ç”Ÿæˆmakefileæ–‡ä»¶ï¼Œç¼–è¯‘ç¨‹åºã€‚</p>

<p>2.ä½¿ç”¨Cmakeç¼–è¯‘ç¨‹åº</p>

<p>æˆ‘ä»¬ç¼–å†™ä¸€ä¸ªå…³äºå¼€å¹³æ–¹çš„C/C++ç¨‹åºé¡¹ç›®ï¼Œå³b= sqrt(a)ï¼Œä»¥æ­¤ç†è§£æ•´ä¸ªCMakeç¼–è¯‘çš„è¿‡ç¨‹ã€‚</p>

<p>a.å‡†å¤‡ç¨‹åºæ–‡ä»¶</p>

<p>æ–‡ä»¶ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š</p>

<p>å¤åˆ¶ä»£ç 
.
â”œâ”€â”€ build
â”œâ”€â”€ CMakeLists.txt
â”œâ”€â”€ include
â”‚   â””â”€â”€ b.h
â””â”€â”€ src
    â”œâ”€â”€ b.c
    â””â”€â”€ main.c
å¤åˆ¶ä»£ç 
å¤´æ–‡ä»¶b.hï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>

<p>å¤åˆ¶ä»£ç 
#ifndef B_FILE_HEADER_INC
#define B_FIEL_HEADER_INC</p>

<p>#include<math.h></math.h></p>

<p>double cal_sqrt(double value);</p>

<p>#endif
å¤åˆ¶ä»£ç </p>

<p>å¤´æ–‡ä»¶b.cï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>

<p>å¤åˆ¶ä»£ç 
#include â€œ../include/b.hâ€</p>

<p>double cal_sqrt(double value)
{
    return sqrt(value);
}
å¤åˆ¶ä»£ç </p>

<p>main.cä¸»å‡½æ•°ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>

<p>å¤åˆ¶ä»£ç 
#include â€œ../include/b.hâ€
#include <stdio.h>
int main(int argc, char** argv)
{
    double a = 49.0; 
    double b = 0.0;</stdio.h></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>printf("input a:%f\n",a);
b = cal_sqrt(a);
printf("sqrt result:%f\n",b);
return 0; } å¤åˆ¶ä»£ç 
</code></pre></div></div>

<p>b.ç¼–å†™CMakeLists.txt</p>

<p>æ¥ä¸‹æ¥ç¼–å†™CMakeLists.txtæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶æ”¾åœ¨å’Œsrcï¼Œincludeçš„åŒçº§ç›®å½•ï¼Œå®é™…æ–¹å“ªé‡Œéƒ½å¯ä»¥ï¼Œåªè¦é‡Œé¢ç¼–å†™çš„è·¯å¾„èƒ½å¤Ÿæ­£ç¡®æŒ‡å‘å°±å¥½äº†ã€‚CMakeLists.txtæ–‡ä»¶ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>

<p>å¤åˆ¶ä»£ç 
 1 #1.cmake versonï¼ŒæŒ‡å®šcmakeç‰ˆæœ¬ 
 2 cmake_minimum_required(VERSION 3.2)
 3 
 4 #2.project nameï¼ŒæŒ‡å®šé¡¹ç›®çš„åç§°ï¼Œä¸€èˆ¬å’Œé¡¹ç›®çš„æ–‡ä»¶å¤¹åç§°å¯¹åº”
 5 PROJECT(test_sqrt)
 6 
 7 #3.head file pathï¼Œå¤´æ–‡ä»¶ç›®å½•
 8 INCLUDE_DIRECTORIES(
 9 include
10 )
11 
12 #4.source directoryï¼Œæºæ–‡ä»¶ç›®å½•
13 AUX_SOURCE_DIRECTORY(src DIR_SRCS)
14 
15 #5.set environment variableï¼Œè®¾ç½®ç¯å¢ƒå˜é‡ï¼Œç¼–è¯‘ç”¨åˆ°çš„æºæ–‡ä»¶å…¨éƒ¨éƒ½è¦æ”¾åˆ°è¿™é‡Œï¼Œå¦åˆ™ç¼–è¯‘èƒ½å¤Ÿé€šè¿‡ï¼Œä½†æ˜¯æ‰§è¡Œçš„æ—¶å€™ä¼šå‡ºç°å„ç§é—®é¢˜ï¼Œæ¯”å¦‚â€symbol lookup error xxxxx , undefined symbolâ€
16 SET(TEST_MATH
17 ${DIR_SRCS}
18 )
19 
20 #6.add executable fileï¼Œæ·»åŠ è¦ç¼–è¯‘çš„å¯æ‰§è¡Œæ–‡ä»¶
21 ADD_EXECUTABLE(${PROJECT_NAME} ${TEST_MATH})
22 
23 #7.add link libraryï¼Œæ·»åŠ å¯æ‰§è¡Œæ–‡ä»¶æ‰€éœ€è¦çš„åº“ï¼Œæ¯”å¦‚æˆ‘ä»¬ç”¨åˆ°äº†libm.soï¼ˆå‘½åè§„åˆ™ï¼šlib+name+.soï¼‰ï¼Œå°±æ·»åŠ è¯¥åº“çš„åç§°
24 TARGET_LINK_LIBRARIES(${PROJECT_NAME} m)
å¤åˆ¶ä»£ç 
 CMakeLists.txtä¸»è¦åŒ…å«ä»¥ä¸Šçš„7ä¸ªæ­¥éª¤ï¼Œå…·ä½“çš„æ„ä¹‰ï¼Œè¯·é˜…è¯»ç›¸åº”çš„æ³¨é‡Šã€‚</p>

<p>c.ç¼–è¯‘å’Œè¿è¡Œç¨‹åº</p>

<p>å‡†å¤‡å¥½äº†ä»¥ä¸Šçš„æ‰€æœ‰ææ–™ï¼Œæ¥ä¸‹æ¥ï¼Œå°±å¯ä»¥ç¼–è¯‘äº†ï¼Œç”±äºç¼–è¯‘ä¸­å‡ºç°è®¸å¤šä¸­é—´çš„æ–‡ä»¶ï¼Œå› æ­¤æœ€å¥½æ–°å»ºä¸€ä¸ªç‹¬ç«‹çš„ç›®å½•buildï¼Œåœ¨è¯¥ç›®å½•ä¸‹è¿›è¡Œç¼–è¯‘ï¼Œç¼–è¯‘æ­¥éª¤å¦‚ä¸‹æ‰€ç¤ºï¼š</p>

<p>mkdir build
cd build
cmake ..
make
æ“ä½œåï¼Œåœ¨buildä¸‹ç”Ÿæˆçš„ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š</p>

<p>å¤åˆ¶ä»£ç 
â”œâ”€â”€ build
â”‚   â”œâ”€â”€ CMakeCache.txt
â”‚   â”œâ”€â”€ CMakeFiles
â”‚   â”‚   â”œâ”€â”€ 3.2.2
â”‚   â”‚   â”‚   â”œâ”€â”€ CMakeCCompiler.cmake
â”‚   â”‚   â”‚   â”œâ”€â”€ CMakeCXXCompiler.cmake</p>
:ET