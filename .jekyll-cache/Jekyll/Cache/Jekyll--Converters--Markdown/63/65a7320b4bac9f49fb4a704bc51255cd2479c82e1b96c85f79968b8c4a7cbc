I"Ã^<p>â€ƒinterface(æ¥å£)æ˜¯golangæœ€é‡è¦çš„ç‰¹æ€§ä¹‹ä¸€ï¼ŒInterfaceç±»å‹å¯ä»¥å®šä¹‰ä¸€ç»„æ–¹æ³•ï¼Œä½†æ˜¯è¿™äº›ä¸éœ€è¦å®ç°ã€‚è¯·æ³¨æ„ï¼šæ­¤å¤„é™å®šæ˜¯ä¸€ç»„æ–¹æ³•ï¼Œæ—¢ç„¶æ˜¯æ–¹æ³•ï¼Œå°±ä¸èƒ½æ˜¯å˜é‡ï¼›è€Œä¸”æ˜¯ä¸€ç»„ï¼Œè¡¨æ˜å¯ä»¥æœ‰å¤šä¸ªæ–¹æ³•ã€‚å†å¤šå£°æ˜ä¸€ç‚¹ï¼Œinterfaceæœ¬è´¨ä¸Šæ˜¯ä¸€ç§ç±»å‹ï¼Œç¡®åˆ‡çš„è¯´ï¼Œæ˜¯æŒ‡é’ˆç±»å‹ï¼Œæ­¤å¤„æš‚ä¸”ä¸å¤šè¡¨ï¼Œåæ–‡ä¸­è‡ªç„¶èƒ½ä½“ä¼šåˆ°ã€‚
â€ƒâ€ƒinterfaceæ˜¯ä¸ºå®ç°å¤šæ€åŠŸèƒ½ï¼Œå¤šæ€æ˜¯æŒ‡ä»£ç å¯ä»¥æ ¹æ®ç±»å‹çš„å…·ä½“å®ç°é‡‡å–ä¸åŒè¡Œä¸ºçš„èƒ½åŠ›ã€‚å¦‚æœä¸€ä¸ªç±»å‹å®ç°äº†æŸä¸ªæ¥å£ï¼Œæ‰€æœ‰ä½¿ç”¨è¿™ä¸ªæ¥å£çš„åœ°æ–¹ï¼Œéƒ½å¯ä»¥æ”¯æŒè¿™ç§ç±»å‹çš„å€¼ã€‚</p>

<p>type  æ¥å£åç§° interface {
    method1(å‚æ•°åˆ—è¡¨) è¿”å›å€¼åˆ—è¡¨
    method2(å‚æ•°åˆ—è¡¨) è¿”å›å€¼åˆ—è¡¨
    â€¦
    methodn(å‚æ•°åˆ—è¡¨) è¿”å›å€¼åˆ—è¡¨
}
<!-- more -->
å¦‚æœæ¥å£æ²¡æœ‰ä»»ä½•æ–¹æ³•å£°æ˜ï¼Œé‚£ä¹ˆå°±æ˜¯ä¸€ä¸ªç©ºæ¥å£ï¼ˆinterface{}ï¼‰ï¼Œå®ƒçš„ç”¨é€”ç±»ä¼¼é¢å‘å¯¹è±¡é‡Œçš„æ ¹ç±»å‹Objectï¼Œå¯è¢«èµ‹å€¼ä¸ºä»»ä½•ç±»å‹çš„å¯¹è±¡ã€‚æ¥å£å˜é‡é»˜è®¤å€¼æ˜¯nilã€‚å¦‚æœå®ç°æ¥å£çš„ç±»å‹æ”¯æŒï¼Œå¯åšç›¸ç­‰è¿ç®—ã€‚</p>

<p>ç®€å•çš„è¯´ï¼š</p>

<p>interfaceæ˜¯æ–¹æ³•çš„é›†åˆ
interfaceæ˜¯ä¸€ç§ç±»å‹ï¼Œå¹¶ä¸”æ˜¯æŒ‡é’ˆç±»å‹
interfaceçš„æ›´é‡è¦çš„ä½œç”¨åœ¨äºå¤šæ€å®ç°</p>

<p>æ¥å£çš„ä½¿ç”¨ä¸ä»…ä»…é’ˆå¯¹ç»“æ„ä½“ï¼Œè‡ªå®šä¹‰ç±»å‹ã€å˜é‡ç­‰ç­‰éƒ½å¯ä»¥å®ç°æ¥å£ã€‚
å¦‚æœä¸€ä¸ªæ¥å£æ²¡æœ‰ä»»ä½•æ–¹æ³•ï¼Œæˆ‘ä»¬ç§°ä¸ºç©ºæ¥å£ï¼Œç”±äºç©ºæ¥å£æ²¡æœ‰æ–¹æ³•ï¼Œæ‰€ä»¥ä»»ä½•ç±»å‹éƒ½å®ç°äº†ç©ºæ¥å£ã€‚
è¦å®ç°ä¸€ä¸ªæ¥å£ï¼Œå¿…é¡»å®ç°è¯¥æ¥å£é‡Œé¢çš„æ‰€æœ‰æ–¹æ³•ã€‚</p>

<p>Under the covers, interfaces are implemented as two elements, a type and a value. The value, called the interfaceâ€™s dynamic value, is an arbitrary concrete value and the type is that of the value. For the int value 3, an interface value contains, schematically, (int, 3).</p>

<p>interfaceåœ¨Goåº•å±‚ï¼Œè¢«è¡¨ç¤ºä¸ºä¸€ä¸ªå€¼å’Œå€¼å¯¹åº”çš„ç±»å‹çš„é›†åˆä½“
go å…è®¸ä¸å¸¦ä»»ä½•æ–¹æ³•çš„ interface ï¼Œè¿™ç§ç±»å‹çš„ interface å«empty interfaceã€‚</p>

<p>å¦‚æœä¸€ä¸ªç±»å‹å®ç°äº†ä¸€ä¸ª interface ä¸­æ‰€æœ‰æ–¹æ³•ï¼Œæˆ‘ä»¬è¯´ç±»å‹å®ç°äº†è¯¥ interfaceï¼Œæ‰€ä»¥æ‰€æœ‰ç±»å‹éƒ½å®ç°äº† empty interfaceï¼Œå› ä¸ºä»»ä½•ä¸€ç§ç±»å‹è‡³å°‘å®ç°äº† 0 ä¸ªæ–¹æ³•ã€‚go æ²¡æœ‰æ˜¾å¼çš„å…³é”®å­—ç”¨æ¥å®ç° interfaceï¼Œåªéœ€è¦å®ç° interface åŒ…å«çš„æ–¹æ³•å³å¯ã€‚</p>

<p>å¦‚æœå®šä¹‰ä¸€ä¸ªå‡½æ•°å‚æ•°æ˜¯ interface{} ç±»å‹ï¼Œè¿™ä¸ªå‡½æ•°åº”è¯¥å¯ä»¥æ¥å—ä»»ä½•ç±»å‹ä½œä¸ºå®ƒçš„å‚æ•°ã€‚</p>

<p>æ—¢ç„¶ç©ºçš„ interface å¯ä»¥æ¥å—ä»»ä½•ç±»å‹çš„å‚æ•°ï¼Œé‚£ä¹ˆä¸€ä¸ª interface{}ç±»å‹çš„ slice æ˜¯ä¸æ˜¯å°±å¯ä»¥æ¥å—ä»»ä½•ç±»å‹çš„ slice ?</p>

<p>func printAll(vals []interface{}) { 
names := []string{â€œstanleyâ€, â€œdavidâ€, â€œoscarâ€}
printAll(names)</p>

<p>æ‰§è¡Œä¹‹åç«Ÿç„¶ä¼šæŠ¥cannot use names (type []string) as type []interface {} in argument to printAll é”™è¯¯ï¼Œwhyï¼Ÿ</p>

<p>è¿™ä¸ªé”™è¯¯è¯´æ˜ go æ²¡æœ‰å¸®åŠ©æˆ‘ä»¬è‡ªåŠ¨æŠŠ slice è½¬æ¢æˆ interface{} ç±»å‹çš„ sliceï¼Œæ‰€ä»¥å‡ºé”™äº†ã€‚go ä¸ä¼šå¯¹ ç±»å‹æ˜¯interface{} çš„ slice è¿›è¡Œè½¬æ¢ã€‚ä¸ºä»€ä¹ˆ go ä¸å¸®æˆ‘ä»¬è‡ªåŠ¨è½¬æ¢ï¼Œä¸€å¼€å§‹æˆ‘ä¹Ÿå¾ˆå¥½å¥‡ï¼Œæœ€åç»ˆäºåœ¨ go çš„ wiki ä¸­æ‰¾åˆ°äº†ç­”æ¡ˆhttps://github.com/golang/go/wiki/InterfaceSliceå¤§æ„æ˜¯ interface{} ä¼šå ç”¨ä¸¤ä¸ªå­—é•¿çš„å­˜å‚¨ç©ºé—´ï¼Œä¸€ä¸ªæ˜¯è‡ªèº«çš„ methods æ•°æ®ï¼Œä¸€ä¸ªæ˜¯æŒ‡å‘å…¶å­˜å‚¨å€¼çš„æŒ‡é’ˆï¼Œä¹Ÿå°±æ˜¯ interface å˜é‡å­˜å‚¨çš„å€¼ï¼Œå› è€Œ slice []interface{} å…¶é•¿åº¦æ˜¯å›ºå®šçš„N<em>2ï¼Œä½†æ˜¯ []T çš„é•¿åº¦æ˜¯N</em>sizeof(T)ï¼Œä¸¤ç§ slice å®é™…å­˜å‚¨å€¼çš„å¤§å°æ˜¯æœ‰åŒºåˆ«çš„(æ–‡ä¸­åªä»‹ç»ä¸¤ç§ slice çš„ä¸åŒï¼Œè‡³äºä¸ºä»€ä¹ˆä¸èƒ½è½¬æ¢çŒœæµ‹å¯èƒ½æ˜¯ runtime è½¬æ¢ä»£ä»·æ¯”è¾ƒå¤§)ã€‚</p>

<p>ä½†æ˜¯æˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨è¿›è¡Œè½¬æ¢æ¥è¾¾åˆ°æˆ‘ä»¬çš„ç›®çš„ã€‚</p>

<p>var dataSlice []int = foo()</p>

<p>var interfaceSlice []interface{} = make([]interface{}, len(dataSlice))</p>

<p>for i, d := range dataSlice {</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    interfaceSlice[i] = d
</code></pre></div></div>

<p>go ä¸­å‡½æ•°éƒ½æ˜¯æŒ‰å€¼ä¼ é€’å³ passed by valueã€‚</p>

<p>å¦‚æœæ˜¯æŒ‰ pointer è°ƒç”¨ï¼Œgo ä¼šè‡ªåŠ¨è¿›è¡Œè½¬æ¢ï¼Œå› ä¸ºæœ‰äº†æŒ‡é’ˆæ€»æ˜¯èƒ½å¾—åˆ°æŒ‡é’ˆæŒ‡å‘çš„å€¼æ˜¯ä»€ä¹ˆï¼Œå¦‚æœæ˜¯ value è°ƒç”¨ï¼Œgo å°†æ— ä»å¾—çŸ¥ value çš„åŸå§‹å€¼æ˜¯ä»€ä¹ˆï¼Œå› ä¸º value æ˜¯ä»½æ‹·è´ã€‚go ä¼šæŠŠæŒ‡é’ˆè¿›è¡Œéšå¼è½¬æ¢å¾—åˆ° valueï¼Œä½†åè¿‡æ¥åˆ™ä¸è¡Œã€‚</p>

<p>å¯¹äº receiver æ˜¯ value çš„ methodï¼Œä»»ä½•åœ¨ method å†…éƒ¨å¯¹ value åšå‡ºçš„æ”¹å˜éƒ½ä¸å½±å“è°ƒç”¨è€…çœ‹åˆ°çš„ valueï¼Œè¿™å°±æ˜¯æŒ‰å€¼ä¼ é€’ã€‚</p>

<p>https://research.swtch.com/interfaces</p>

<p>åœ¨Goè¯­è¨€ä¸­interfaceæ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„æ¦‚å¿µï¼Œä¹Ÿæ˜¯ä¸å…¶å®ƒè¯­è¨€ç›¸æ¯”å­˜åœ¨å¾ˆå¤§ç‰¹è‰²çš„åœ°æ–¹ã€‚interfaceä¹Ÿæ˜¯ä¸€ä¸ªGoè¯­è¨€ä¸­çš„ä¸€ç§ç±»å‹ï¼Œæ˜¯ä¸€ç§æ¯”è¾ƒç‰¹æ®Šçš„ç±»å‹ï¼Œå­˜åœ¨ä¸¤ç§interfaceï¼Œä¸€ç§æ˜¯å¸¦æœ‰æ–¹æ³•çš„interfaceï¼Œä¸€ç§æ˜¯ä¸å¸¦æ–¹æ³•çš„interfaceã€‚Goè¯­è¨€ä¸­çš„æ‰€æœ‰å˜é‡éƒ½å¯ä»¥èµ‹å€¼ç»™ç©ºinterfaceå˜é‡ï¼Œå®ç°äº†interfaceä¸­å®šä¹‰æ–¹æ³•çš„å˜é‡å¯ä»¥èµ‹å€¼ç»™å¸¦æ–¹æ³•çš„interfaceå˜é‡ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡interfaceç›´æ¥è°ƒç”¨å¯¹åº”çš„æ–¹æ³•ï¼Œå®ç°äº†å…¶å®ƒé¢å‘å¯¹è±¡è¯­è¨€çš„å¤šæ€çš„æ¦‚å¿µã€‚</p>

<p>ä¸¤ç§ä¸åŒçš„interfaceåœ¨Goè¯­è¨€å†…éƒ¨è¢«å®šä¹‰æˆå¦‚ä¸‹çš„ä¸¤ç§ç»“æ„ä½“</p>

<p>// æ²¡æœ‰æ–¹æ³•çš„interface
type eface struct {
    _type *_type
    data  unsafe.Pointer
}</p>

<p>// è®°å½•ç€Goè¯­è¨€ä¸­æŸä¸ªæ•°æ®ç±»å‹çš„åŸºæœ¬ç‰¹å¾
type _type struct {
    size       uintptr
    ptrdata    uintptr
    hash       uint32
    tflag      tflag
    align      uint8
    fieldalign uint8
    kind       uint8
    alg        *typeAlg
    gcdata    *byte
    str       nameOff
    ptrToThis typeOff
}</p>

<p>// æœ‰æ–¹æ³•çš„interface
type iface struct {
    tab  *itab
    data unsafe.Pointer
}</p>

<p>type itab struct {
    inter  *interfacetype
    _type  *_type
    link   *itab
    hash   uint32
    bad    bool
    inhash bool
    unused [2]byte
    fun    [1]uintptr
}</p>

<p>// interfaceæ•°æ®ç±»å‹å¯¹åº”çš„type
type interfacetype struct {
    typ     _type
    pkgpath name
    mhdr    []imethod
}</p>

<p>å¯ä»¥çœ‹åˆ°ä¸¤ç§ç±»å‹çš„interfaceåœ¨å†…éƒ¨å®ç°æ—¶éƒ½æ˜¯å®šä¹‰æˆäº†ä¸€ä¸ª2ä¸ªå­—æ®µçš„ç»“æ„ä½“ï¼Œæ‰€ä»¥ä»»ä½•ä¸€ä¸ªinterfaceå˜é‡éƒ½æ˜¯å ç”¨16ä¸ªbyteçš„å†…å­˜ç©ºé—´ã€‚
â€ƒåœ¨Goè¯­è¨€ä¸­_typeè¿™ä¸ªç»“æ„ä½“éå¸¸é‡è¦ï¼Œè®°å½•ç€æŸç§æ•°æ®ç±»å‹çš„ä¸€äº›åŸºæœ¬ç‰¹å¾ï¼Œæ¯”å¦‚è¿™ä¸ªæ•°æ®ç±»å‹å ç”¨çš„å†…å­˜å¤§å°ï¼ˆsizeå­—æ®µï¼‰ï¼Œæ•°æ®ç±»å‹çš„åç§°ï¼ˆnameOffå­—æ®µï¼‰ç­‰ç­‰ã€‚æ¯ç§æ•°æ®ç±»å‹éƒ½å­˜åœ¨ä¸€ä¸ªä¸ä¹‹å¯¹åº”çš„_typeç»“æ„ä½“ï¼ˆGoè¯­è¨€åŸç”Ÿçš„å„ç§æ•°æ®ç±»å‹ï¼Œç”¨æˆ·è‡ªå®šä¹‰çš„ç»“æ„ä½“ï¼Œç”¨æˆ·è‡ªå®šä¹‰çš„interfaceç­‰ç­‰ï¼‰ã€‚å¦‚æœæ˜¯ä¸€äº›æ¯”è¾ƒç‰¹æ®Šçš„æ•°æ®ç±»å‹ï¼Œå¯èƒ½è¿˜ä¼šå¯¹_typeç»“æ„ä½“è¿›è¡Œæ‰©å±•ï¼Œè®°å½•æ›´å¤šçš„ä¿¡æ¯ï¼Œæ¯”å¦‚interfaceç±»å‹ï¼Œå°±ä¼šå­˜åœ¨ä¸€ä¸ªinterfacetypeç»“æ„ä½“ï¼Œé™¤äº†é€šç”¨çš„_typeå¤–ï¼Œè¿˜åŒ…å«äº†å¦å¤–ä¸¤ä¸ªå­—æ®µpkgpathå’Œmhdrï¼Œåæ–‡åœ¨å¯¹è¿™ä¸¤ä¸ªå­—æ®µçš„ä½œç”¨è¿›è¡Œè§£æã€‚é™¤æ­¤ä¹‹å¤–è¿˜æœ‰å…¶å®ƒç±»å‹çš„æ•°æ®ç»“æ„å¯¹åº”çš„ç»“æ„ä½“ï¼Œæ¯”å¦‚structtypeï¼Œchantypeï¼Œslicetypeï¼Œæœ‰å…´è¶£çš„å¯ä»¥åœ¨$GOROOT/src/runtime/type.goæ–‡ä»¶ä¸­æŸ¥çœ‹ã€‚
â€ƒimg src=â€https://xiazemin.github.io/MyBlog/img/eface.webpâ€/&gt;
â€ƒ
â€ƒèµ‹å€¼
â€ƒå­˜åœ¨å¯¹æ²¡æœ‰æ–¹æ³•çš„interfaceå˜é‡å’Œæœ‰æ–¹æ³•çš„interfaceå˜é‡èµ‹å€¼è¿™ä¸¤ç§ä¸åŒçš„æƒ…å†µã€‚åˆ†åˆ«è¯¦è§£è¿™ä¸¤ç§ä¸åŒçš„èµ‹å€¼è¿‡ç¨‹ã€‚</p>

<p>æ²¡æœ‰æ–¹æ³•çš„interfaceå˜é‡èµ‹å€¼
â€ƒå¯¹æ²¡æœ‰æ–¹æ³•çš„interfaceå˜é‡èµ‹å€¼æ—¶ç¼–è¯‘å™¨åšäº†ä»€ä¹ˆå·¥ä½œï¼Ÿ
â€ƒ
â€ƒ èµ‹å€¼
â€ƒå­˜åœ¨å¯¹æ²¡æœ‰æ–¹æ³•çš„interfaceå˜é‡å’Œæœ‰æ–¹æ³•çš„interfaceå˜é‡èµ‹å€¼è¿™ä¸¤ç§ä¸åŒçš„æƒ…å†µã€‚åˆ†åˆ«è¯¦è§£è¿™ä¸¤ç§ä¸åŒçš„èµ‹å€¼è¿‡ç¨‹ã€‚</p>

<p>æ²¡æœ‰æ–¹æ³•çš„interfaceå˜é‡èµ‹å€¼
â€ƒå¯¹æ²¡æœ‰æ–¹æ³•çš„interfaceå˜é‡èµ‹å€¼æ—¶ç¼–è¯‘å™¨åšäº†ä»€ä¹ˆå·¥ä½œï¼Ÿåˆ›å»ºä¸€ä¸ªeface.goæ–‡ä»¶ï¼Œä»£ç å¦‚ä¸‹ï¼š
     1  package main
     2
     3  type Struct1 struct {
     4      A int64
     5      B int64
     6  }
     7
     8  func main() {
     9      s := new(Struct1)
    10      var i interface{}
    11      i = a
    12
    13      _ = i
    14  }
â€ƒè¾“å…¥å‘½ä»¤go build -gcflags â€˜-l -Nâ€™ eface.goï¼Œgo tool objdump -s â€œmain.mainâ€ efaceï¼ŒæŸ¥çœ‹æ±‡ç¼–ä»£ç ã€‚</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> 1  TEXT main.main(SB) /Users/didi/Source/Go/src/ppt/eface.go
 2    eface.go:8        0x104f360       4883ec38        SUBQ $0x38, SP
 3    eface.go:8        0x104f364       48896c2430      MOVQ BP, 0x30(SP)
 4    eface.go:8        0x104f369       488d6c2430      LEAQ 0x30(SP), BP
 5    eface.go:9        0x104f36e       48c7042400000000    MOVQ $0x0, 0(SP)
 6    eface.go:9        0x104f376       48c744240800000000  MOVQ $0x0, 0x8(SP)
 7    eface.go:9        0x104f37f       488d0424        LEAQ 0(SP), AX
 8    eface.go:9        0x104f383       4889442410      MOVQ AX, 0x10(SP)
 9    eface.go:10       0x104f388       48c744242000000000  MOVQ $0x0, 0x20(SP)
10    eface.go:10       0x104f391       48c744242800000000  MOVQ $0x0, 0x28(SP)
11    eface.go:11       0x104f39a       488b442410      MOVQ 0x10(SP), AX
12    eface.go:11       0x104f39f       4889442418      MOVQ AX, 0x18(SP)
13    eface.go:11       0x104f3a4       488d0dd5670000      LEAQ 0x67d5(IP), CX
14    eface.go:11       0x104f3ab       48894c2420      MOVQ CX, 0x20(SP)
15    eface.go:11       0x104f3b0       4889442428      MOVQ AX, 0x28(SP)
16    eface.go:14       0x104f3b5       488b6c2430      MOVQ 0x30(SP), BP
17    eface.go:14       0x104f3ba       4883c438        ADDQ $0x38, SP â€ƒæ±‡ç¼–ä»£ç ç¬¬5~6è¡Œç»™ç»“æ„ä½“Struct1åˆ†é…äº†ç©ºé—´SP+0x0å’ŒSP+0x8ï¼Œç¬¬7~8è¡ŒæŠŠè¿™ä¸ªç»“æ„ä½“çš„åœ°å€æ”¾åœ¨å­˜å…¥äº†SP+0x10åœ°å€ï¼Œè¿™ä¸ªåœ°å€å°±æ˜¯å˜é‡sï¼Œç¬¬9~10è¡Œç»™interfaceç±»å‹çš„å˜é‡iåˆ†é…äº†SP+0x20å’ŒSP+0x28ï¼Œç¬¬13~14è¡ŒæŠŠç»“æ„ä½“Aå¯¹åº”çš„_typeçš„åœ°å€èµ‹å€¼åˆ°SP+0x20ï¼Œç„¶åæŠŠaå˜é‡èµ‹å€¼åˆ°äº†SP+0x28ã€‚è¿™å°±æ˜¯å¯¹æ²¡æœ‰æ–¹æ³•çš„interfaceè¿›è¡Œèµ‹å€¼çš„è¿‡ç¨‹ã€‚èµ‹å€¼å®Œä»¥åçš„å†…å­˜åˆ†é…å¦‚ä¸‹å›¾ï¼š â€ƒ&lt;img src="https://xiazemin.github.io/MyBlog/img/eface_no.webp"/&gt; â€ƒæœ‰æ–¹æ³•çš„interfaceå˜é‡èµ‹å€¼ â€ƒå¦‚ä¸‹ä¸€æ®µä»£ç åœ¨å†…å­˜çš„åˆ†å¸ƒ
 1  package main
 2
 3  type I interface {
 4      Add()
 5      Del()
 6  }
 7
 8  type Struct1 struct {
 9      A int64
10      B int64
11  }
12
13  func (a *Struct1) Add() {
14      a.A = a.A + 1
15      a.B = a.B + 1
16  }
17
18  func (a *Struct1) Del() {
19      a.A = a.A - 1
20      a.B = a.B - 1
21  }
22
23  func main() {
24      a := new(Struct1)
25      var i I
26      i = a
27
28      i.Add()
29      i.Del()
30  }  &lt;img src="https://xiazemin.github.io/MyBlog/img/eface_has.webp"/&gt;
</code></pre></div></div>

<p>è¿™äº›å†…å­˜åœ°å€éƒ½å¯ä»¥ä½¿ç”¨gdbè°ƒè¯•æ—¶å¾—åˆ°</p>

<p>(gdb) p i
$11 = {tab = 0x10a70e0 &lt;Struct1,main.I&gt;, data = 0xc42001a0c0}
(gdb) p a
$12 = (struct main.Struct1 <em>) 0xc42001a0c0
(gdb) p i.tab
$13 = (runtime.itab *) 0x10a70e0 &lt;Struct1,main.I&gt;
(gdb) p i.tab.inter
$14 = (runtime.interfacetype *) 0x105dc60 &lt;type.</em>+59232&gt;
(gdb) p i.tab._type
$15 = (runtime._type <em>) 0x105d200 &lt;type.</em>+56576&gt;
â€ƒé€šè¿‡å¯¹å†…å­˜åœ°å€çš„æ‰“å°ï¼Œå¯ä»¥å¾ˆæ¸…æ™°çš„çœ‹å‡ºåœ¨å¯¹æœ‰æ–¹æ³•çš„interfaceå˜é‡è¿›è¡Œèµ‹å€¼æ—¶çš„å†…å­˜åˆ†å¸ƒã€‚Struct1ç±»å‹å’Œinterface Iç±»å‹éƒ½å­˜åœ¨å†…å­˜è®°å½•ç€å„è‡ªçš„_typeç»“æ„ä½“ä¿¡æ¯ï¼Œåœ¨å°†Struct1ç±»å‹çš„å˜é‡èµ‹å€¼ç»™interface Iç±»å‹æ—¶ï¼Œä¼šæœ‰ä¸€ä¸ªitabç±»å‹çš„ç»“æ„ä½“å°†Struct1ç±»å‹å’Œinterface Iç±»å‹å…³è”èµ·æ¥ã€‚
â€ƒä¸Šé¢çš„ä¾‹å­éƒ½æ˜¯å°†ä¸€ä¸ªæŒ‡é’ˆèµ‹å€¼ç»™interfaceå˜é‡ï¼Œå¦‚æœæ˜¯å°†ä¸€ä¸ªå€¼èµ‹å€¼ç»™interfaceå˜é‡ã€‚ä¼šå…ˆå¯¹åˆ†é…ä¸€å—ç©ºé—´ä¿å­˜è¯¥å€¼çš„å‰¯æœ¬ï¼Œç„¶åå°†è¯¥interfaceå˜é‡çš„dataå­—æ®µæŒ‡å‘è¿™ä¸ªæ–°åˆ†é…çš„ç©ºé—´ã€‚å°†ä¸€ä¸ªå€¼èµ‹å€¼ç»™interfaceå˜é‡æ—¶ï¼Œæ“ä½œçš„éƒ½æ˜¯è¯¥å€¼çš„ä¸€ä¸ªå‰¯æœ¬ã€‚</p>

<p>2.3 æ–¹æ³•çš„è°ƒç”¨
â€ƒä¸Šé¢å¯¹æœ‰æ–¹æ³•çš„interfaceè¿›è¡Œèµ‹å€¼åï¼Œæ˜¯å¦‚ä½•å®ç°é€šè¿‡æ¥å£å˜é‡å®ç°äº†å‡½æ•°è°ƒç”¨å‘¢ï¼Ÿå‚è€ƒä¸‹é¢çš„æ±‡ç¼–ä»£ç </p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> 1  TEXT main.main(SB) /Users/didi/Source/Go/src/ppt/iface.go
 2    iface.go:23       0x104f3e0       65488b0c25a0080000  MOVQ GS:0x8a0, CX
 3    iface.go:23       0x104f3e9       483b6110        CMPQ 0x10(CX), SP
 4    iface.go:23       0x104f3ed       0f8687000000        JBE 0x104f47a
 5    iface.go:23       0x104f3f3       4883ec38        SUBQ $0x38, SP
 6    iface.go:23       0x104f3f7       48896c2430      MOVQ BP, 0x30(SP)
 7    iface.go:23       0x104f3fc       488d6c2430      LEAQ 0x30(SP), BP
 8    iface.go:23       0x104f401       488d0578ff0000      LEAQ 0xff78(IP), AX
 9    iface.go:24       0x104f408       48890424        MOVQ AX, 0(SP)
10    iface.go:24       0x104f40c       e86fcefbff      CALL runtime.newobject(SB)
11    iface.go:24       0x104f411       488b442408      MOVQ 0x8(SP), AX
12    iface.go:24       0x104f416       4889442410      MOVQ AX, 0x10(SP)
13    iface.go:25       0x104f41b       48c744242000000000  MOVQ $0x0, 0x20(SP)
14    iface.go:25       0x104f424       48c744242800000000  MOVQ $0x0, 0x28(SP)
15    iface.go:26       0x104f42d       488b442410      MOVQ 0x10(SP), AX
16    iface.go:26       0x104f432       4889442418      MOVQ AX, 0x18(SP)
17    iface.go:26       0x104f437       488d0da27c0500      LEAQ 0x57ca2(IP), CX
18    iface.go:26       0x104f43e       48894c2420      MOVQ CX, 0x20(SP)
19    iface.go:26       0x104f443       4889442428      MOVQ AX, 0x28(SP)
20    iface.go:28       0x104f448       488b442420      MOVQ 0x20(SP), AX
21    iface.go:28       0x104f44d       488b4020        MOVQ 0x20(AX), AX
22    iface.go:28       0x104f451       488b4c2428      MOVQ 0x28(SP), CX
23    iface.go:28       0x104f456       48890c24        MOVQ CX, 0(SP)
24    iface.go:28       0x104f45a       ffd0            CALL AX
25    iface.go:29       0x104f45c       488b442420      MOVQ 0x20(SP), AX
26    iface.go:29       0x104f461       488b4028        MOVQ 0x28(AX), AX
27    iface.go:29       0x104f465       488b4c2428      MOVQ 0x28(SP), CX
28    iface.go:29       0x104f46a       48890c24        MOVQ CX, 0(SP)
29    iface.go:29       0x104f46e       ffd0            CALL AX
30    iface.go:30       0x104f470       488b6c2430      MOVQ 0x30(SP), BP
31    iface.go:30       0x104f475       4883c438        ADDQ $0x38, SP
32    iface.go:30       0x104f479       c3          RET
33    iface.go:23       0x104f47a       e8f182ffff      CALL runtime.morestack_noctxt(SB)
34    iface.go:23       0x104f47f       e95cffffff      JMP main.main(SB) â€ƒæ±‡ç¼–ä»£ç çš„ç¬¬17è¡Œå’Œ18è¡Œï¼Œå°†itabçš„åœ°å€åŠ è½½åˆ°SP+0x20åœ°å€å¤„ï¼Œç¬¬20ï¼Œ21è¡Œï¼Œ24è¡Œå°†SP+0x20çš„å€¼åŠ è½½åˆ°AXå¯„å­˜å™¨ï¼Œç„¶åå°†AX+0x20åœ°å€çš„å€¼åŠ è½½åˆ°AXå¯„å­˜å™¨ï¼ŒCALL AXå°±å®ç°äº†addæ–¹æ³•çš„è°ƒç”¨ï¼Œå…¶ä¸­ç¬¬22è¡Œå’Œ23è¡Œçš„ä½œç”¨æ˜¯å°†interfaceé‡Œé¢dataå­—æ®µçš„åœ°å€ä¼ é€’ç»™äº†addæ–¹æ³•ã€‚ â€ƒ&lt;img src="https://xiazemin.github.io/MyBlog/img/eface_call.webp"/&gt; â€ƒ â€ƒé€šè¿‡å¯¹itabç»“æ„ä½“è¿›è¡Œåˆ†æï¼Œå¯ä»¥çœ‹åˆ°åç§»0x20å¤„ä¸ºfunå­—æ®µï¼Œå…¶ä¸­0x20å¤„ä¸ºaddå‡½æ•°çš„å…¥å£åœ°å€ï¼Œ0x28å¤„å°±æ˜¯delå‡½æ•°çš„å…¥å£åœ°å€ã€‚
</code></pre></div></div>

<p>2.4 æ–­è¨€çš„å®ç°
â€ƒåœ¨Goè¯­è¨€ä¸­ï¼Œç»å¸¸éœ€è¦å¯¹ä¸€ä¸ªinterfaceå˜é‡è¿›è¡Œæ–­è¨€</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> 1  package main
 2
 3  type Struct1 struct {
 4      A int64
 5  }
 6
 7  func main() {
 8      a := new(Struct1)
 9
10      var i interface{}
11      i = a
12
13      b, ok := i.(Struct1)
14      if ok {
15          _ = b
16      }
17  } â€ƒç”Ÿæˆæ±‡ç¼–ä»£ç è¿›è¡Œåˆ†æ

 1  TEXT main.main(SB) /Users/didi/Source/Go/src/ppt/assert.go
 2    assert.go:7       0x104f360       4883ec48        SUBQ $0x48, SP
 3    assert.go:7       0x104f364       48896c2440      MOVQ BP, 0x40(SP)
 4    assert.go:7       0x104f369       488d6c2440      LEAQ 0x40(SP), BP
 5    assert.go:8       0x104f36e       48c744241000000000  MOVQ $0x0, 0x10(SP)
 6    assert.go:8       0x104f377       488d442410      LEAQ 0x10(SP), AX
 7    assert.go:8       0x104f37c       4889442420      MOVQ AX, 0x20(SP)
 8    assert.go:10      0x104f381       48c744243000000000  MOVQ $0x0, 0x30(SP)
 9    assert.go:10      0x104f38a       48c744243800000000  MOVQ $0x0, 0x38(SP)
10    assert.go:11      0x104f393       488b442420      MOVQ 0x20(SP), AX
11    assert.go:11      0x104f398       4889442428      MOVQ AX, 0x28(SP)
12    assert.go:11      0x104f39d       488d0d1c680000      LEAQ 0x681c(IP), CX
13    assert.go:11      0x104f3a4       48894c2430      MOVQ CX, 0x30(SP)
14    assert.go:11      0x104f3a9       4889442438      MOVQ AX, 0x38(SP)
15    assert.go:13      0x104f3ae       488b442438      MOVQ 0x38(SP), AX
16    assert.go:13      0x104f3b3       488b4c2430      MOVQ 0x30(SP), CX
17    assert.go:13      0x104f3b8       488d1581ed0000      LEAQ 0xed81(IP), DX
18    assert.go:13      0x104f3bf       4839d1          CMPQ DX, CX
19    assert.go:13      0x104f3c2       7402            JE 0x104f3c6
20    assert.go:13      0x104f3c4       eb3f            JMP 0x104f405
21    assert.go:13      0x104f3c6       488b00          MOVQ 0(AX), AX
22    assert.go:13      0x104f3c9       b901000000      MOVL $0x1, CX
23    assert.go:13      0x104f3ce       eb00            JMP 0x104f3d0 â€ƒæ±‡ç¼–çš„ç¬¬12è¡Œï¼Œ17è¡Œï¼Œ18è¡Œå¯ä»¥çœ‹å‡ºï¼Œå°†Struct1å¯¹åº”çš„_typeç»“æ„ä½“çš„åœ°å€èµ‹å€¼ç»™interfaceä»¥åã€‚åœ¨è¿›è¡Œæ–­è¨€çš„æ—¶å€™ï¼ŒåŸç†å°±æ˜¯å°†interfaceå˜é‡_typeå­—æ®µçš„ä¸Struct1å¯¹åº”çš„_typeç»“æ„åœ°å€è¿›è¡Œå¯¹æ¯”ã€‚ â€ƒåœ¨æœ¬ä¾‹å­ä¸­ï¼Œç¬¬12è¡Œçš„IPå¯„å­˜å™¨å¯¹åº”çš„å€¼æ˜¯0x104f39dï¼Œ0x681c(IP)å¯¹åº”çš„åœ°å€ä¸º0x1055BB9ï¼Œç¬¬17è¡Œçš„IPå¯„å­˜å™¨å¯¹åº”çš„å€¼æ˜¯0x104f3b8ï¼Œ0xed81(IP)å¯¹åº”çš„åœ°å€ä¸º0x105E139ï¼Œè²Œä¼¼å¹¶ä¸ç›¸åŒã€‚å¯èƒ½æ˜¯å¯¹Goçš„æ±‡ç¼–ä¸­å¯¹IPå¯„å­˜å™¨çš„ç†è§£å­˜åœ¨åå·® â€ƒ â€ƒ3 Goçš„åå°„ â€ƒåå°„æ˜¯ä¸€ç§å¼ºå¤§çš„è¯­è¨€ç‰¹æ€§ï¼Œå¯ä»¥â€œåŠ¨æ€â€çš„è°ƒç”¨æ–¹æ³•ï¼Œè·å–ç»“æ„ä½“è¿è¡Œæ—¶çš„ä¸€äº›ç‰¹å¾ï¼Œå¾ˆå¤šæ¡†æ¶çš„å®ç°éƒ½ç¦»ä¸å¼€åå°„ã€‚Goçš„åå°„å°±æ˜¯é€šè¿‡interfaceç±»å‹æ¥å®ç°çš„ã€‚
</code></pre></div></div>

<p>3.1 åå°„è·å–å˜é‡çš„ä¿¡æ¯
â€ƒGoçš„åå°„åŒ…ä¸»è¦å­˜åœ¨ä¸¤ä¸ªé‡è¦çš„ç»“æ„ä½“ã€‚</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> 1  type Value struct {
 2      typ *rtype
 3      ptr unsafe.Pointer
 4      flag
 5  }
 6
 7  func ValueOf(i interface{}) Value {
 8  }
 9
10  type Type interface {
11      Align() int
12      FieldAlign() int
13      Method(int) Method
14      Name() string
15      //ä¸€å †æ–¹æ³•
16      //....
17  }
18
19  func TypeOf(i interface{}) Type {
20      eface := *(*emptyInterface)(unsafe.Pointer(&amp;i))
21      return toType(eface.typ)
22  }
23
24  type emptyInterface struct {
25      typ  *rtype
26      word unsafe.Pointer
27  } â€ƒä»»ä½•ä¸€ä¸ªå˜é‡å¯ä»¥é€šè¿‡è°ƒç”¨ValueOfæ¥è·å–åˆ°å˜é‡çš„Valueç»“æ„ä½“ï¼Œé€šè¿‡TypeOfæ–¹æ³•æ¥è·å–å˜é‡çš„Typeæ¥å£ç±»å‹ã€‚é€šè¿‡TypeOfæ–¹æ³•è·å–åˆ°çš„Typeæ¥å£å®é™…ä¸Šå°±æ˜¯è¯¥å˜é‡å¯¹åº”çš„_typeã€‚ â€ƒé€šè¿‡å‰é¢çš„åˆ†æï¼Œå½“é€šè¿‡TypeOfæ–¹æ³•è·å–åˆ°å˜é‡çš„_typeç»“æ„ä½“åï¼Œå¾ˆå®¹æ˜“è·å–åˆ°è¯¥å˜é‡çš„ä¸€äº›åŸºæœ¬ä¿¡æ¯ï¼Œæ¯”å¦‚_typeç»“æ„ä½“ä¸­çš„å„ç§å­—æ®µéƒ½å¯ä»¥ç›´æ¥è·å–åˆ°ã€‚
</code></pre></div></div>

<p>3.2 åå°„ä¿®æ”¹å˜é‡çš„å€¼
     1  package main
     2
     3  import (
     4      â€œreflectâ€
     5  )
     6
     7  func main() {
     8      var x int64 = 10
     9
    10      reflect.ValueOf(x).SetInt(20)
    11
    12      reflect.ValueOf(&amp;x).SetInt(20)
    13
    14      reflect.ValueOf(&amp;x).Elem().SetInt(20)
    15  }
â€ƒä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œç¬¬10è¡Œï¼Œ12è¡Œéƒ½ä¼šæŠ¥panicï¼Œåªæœ‰ç¬¬14è¡Œèƒ½ä¿®æ”¹å˜é‡çš„å€¼ã€‚åœ¨ä½¿ç”¨ValueOfè·å–åˆ°Valueç»“æ„ä½“ä»¥åï¼Œflagå­—æ®µè®°å½•ç€å€¼èƒ½å¦è¿›è¡Œä¿®æ”¹ï¼Œè¿™æ ·åº”è¯¥æ˜¯ä¸ºäº†é¿å…è¯¯æ“ä½œï¼Œä¿è¯apiè°ƒç”¨è€…æ˜ç¡®äº†è§£åˆ°æ˜¯å¦éœ€è¦ä¿®æ”¹å€¼ã€‚</p>

<p>3.3 åå°„ä¿®æ”¹ç»“æ„ä½“å˜é‡å­—æ®µçš„å€¼
â€ƒå¦‚æœéœ€è¦é€šè¿‡åå°„ä¿®æ”¹æŸç»“æ„ä½“é‡Œé¢å„ä¸ªå­—æ®µçš„å€¼ã€‚</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> 1  package main
 2
 3  import (
 4      "reflect"
 5      "fmt"
 6  )
 7
 8  type Struct1 struct {
 9      A int64
10      B int64
11      C int64
12  }
13
14  func main() {
15      P := new(Struct1)
16
17      V := reflect.ValueOf(P).Elem()
18      V.FieldByName("A").SetInt(100)
19      V.FieldByName("B").SetInt(200)
20      V.FieldByName("C").SetInt(300)
21
22      fmt.Printf("%v", P)
23  } â€ƒä¸Šé¢çš„ä»£ç ä¸­ï¼Œéœ€è¦æ ¹æ®ç»“æ„ä½“å­—æ®µçš„åç§°å¯¹å„ä¸ªå­—æ®µçš„å€¼è¿›è¡Œä¿®æ”¹ï¼Œå†…éƒ¨æ˜¯å¦‚ä½•å®ç°çš„å‘¢ï¼Ÿ â€ƒ&lt;img src="https://xiazemin.github.io/MyBlog/img/eface_reflect.webp"/&gt; â€ƒ â€ƒæ¯ä¸€ä¸ªè‡ªå®šä¹‰çš„structç±»å‹éƒ½å­˜åœ¨è¿™ä¸€ä¸ªå¯¹åº”çš„structTypeç»“æ„ä½“ï¼Œè¯¥ç»“æ„ä½“è®°å½•äº†æ¯ä¸ªå­—æ®µstructFieldã€‚é€šè¿‡å¯¹æ¯”structFieldé‡Œé¢çš„nameå­—æ®µï¼Œå°±å¯ä»¥è·å–åˆ°æŸä¸ªå­—æ®µçš„typeå’Œåç§»é‡ã€‚ä»è€Œå¯¹å…·ä½“çš„å€¼è¿›è¡Œä¿®æ”¹ã€‚
</code></pre></div></div>

<p>3.4 åå°„åŠ¨æ€è°ƒç”¨æ–¹æ³•
â€ƒåŠ¨æ€çš„è°ƒç”¨æ–¹æ³•æ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> 1  package main
 2
 3  import (
 4      "reflect"
 5  )
 6
 7  type Struct1 struct {
 8      A int64
 9      B int64
10      C int64
11  }
12
13  func (p *Struct1) Set() {
14      p.A = 200
15  }
16
17  func main() {
18      P := new(Struct1)
19      P.A = 100
20      P.B = 200
21      P.C = 300
22
23      V := reflect.ValueOf(P)
24
25      params := make([]reflect.Value, 0)
26      V.MethodByName("Set").Call(params)
27  } â€ƒç»“æ„ä½“çš„æ–¹æ³•åœ¨å†…å­˜ä¸­å­˜åœ¨å¦‚ä¸‹çš„åˆ†å¸ƒ â€ƒ&lt;img src="https://xiazemin.github.io/MyBlog/img/eface_rc.webp"/&gt; â€ƒåœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­ï¼Œç»“æ„ä½“å¯¹åº”æ–¹æ³•çš„ç›¸å…³ä¿¡æ¯éƒ½å·²ç»å­˜åœ¨äºå†…å­˜ä¸­ï¼Œåˆ†é…äº†ä¸€å—uncommonTypeçš„ç»“æ„ä½“è·Ÿåœ¨fieldså­—æ®µåé¢ã€‚æ ¹æ®å†…å­˜çš„åˆ†å¸ƒï¼Œå¦‚æœéœ€è¦æ ¹æ®ä¸€ä¸ªç»“æ„ä½“çš„åç§°è·å–åˆ°æ–¹æ³•å¹¶ä¸”æ‰§è¡Œï¼Œåªéœ€è¦æ ¹æ®uncommonTypeç»“æ„ä¸­çš„moffå­—æ®µå»è·å–æ–¹æ³•ç›¸å…³ä¿¡æ¯çš„åœ°å€å—ï¼Œç„¶åé€ä¸ªå¯¹æ¯”åç§°æ˜¯å¦ä¸ºæƒ³è¦è·å–çš„æ–¹æ³•è¿›è¡Œè°ƒç”¨ã€‚ â€ƒ â€ƒ â€ƒ     ç©ºinterface ç©ºinterface(interface{})ä¸åŒ…å«ä»»ä½•çš„methodï¼Œæ­£å› ä¸ºå¦‚æ­¤ï¼Œæ‰€æœ‰çš„ç±»å‹éƒ½å®ç°äº†ç©ºinterfaceã€‚ç©ºinterfaceå¯¹äºæè¿°èµ·ä¸åˆ°ä»»ä½•çš„ä½œç”¨(å› ä¸ºå®ƒä¸åŒ…å«ä»»ä½•çš„methodï¼‰ï¼Œä½†æ˜¯ç©ºinterfaceåœ¨æˆ‘ä»¬éœ€è¦å­˜å‚¨ä»»æ„ç±»å‹çš„æ•°å€¼çš„æ—¶å€™ç›¸å½“æœ‰ç”¨ï¼Œå› ä¸ºå®ƒå¯ä»¥å­˜å‚¨ä»»æ„ç±»å‹çš„æ•°å€¼ã€‚å®ƒæœ‰ç‚¹ç±»ä¼¼äºCè¯­è¨€çš„void*ç±»å‹
</code></pre></div></div>

<p>// å®šä¹‰aä¸ºç©ºæ¥å£
var a interface{}
var i int = 5
s := â€œHello worldâ€
// aå¯ä»¥å­˜å‚¨ä»»æ„ç±»å‹çš„æ•°å€¼
a = i
a = s
ä¸€ä¸ªå‡½æ•°æŠŠinterface{}ä½œä¸ºå‚æ•°ï¼Œé‚£ä¹ˆä»–å¯ä»¥æ¥å—ä»»æ„ç±»å‹çš„å€¼ä½œä¸ºå‚æ•°ï¼Œå¦‚æœä¸€ä¸ªå‡½æ•°è¿”å›interface{},é‚£ä¹ˆä¹Ÿå°±å¯ä»¥è¿”å›ä»»æ„ç±»å‹çš„å€¼ã€‚</p>

<p>â€ƒ
package main</p>

<p>import (
    â€œfmtâ€
    â€œreflectâ€
)</p>

<p>func main() {
    a := (<em>interface{})(nil)
    fmt.Println(reflect.TypeOf(a), reflect.ValueOf(a))
    var b interface{} = (</em>interface{})(nil)
    fmt.Println(reflect.TypeOf(b), reflect.ValueOf(b))
    fmt.Println(a == nil, b == nil)
}
è¾“å‡ºå¦‚ä¸‹ï¼š</p>

<p>*interface {} <nil>
*interface {} <nil>
true false</nil></nil></p>

<p>åœ¨å°é¢ä¸‹ï¼Œæ¥å£è¢«å®ç°ä¸ºä¸¤ä¸ªå…ƒç´ ï¼Œä¸€ä¸ªç±»å‹å’Œä¸€ä¸ªå€¼ã€‚è¯¥å€¼ç§°ä¸ºæ¥å£çš„åŠ¨æ€å€¼ï¼Œæ˜¯ä¸€ä¸ªä»»æ„çš„å…·ä½“å€¼ï¼Œç±»å‹æ˜¯å€¼çš„ç±»å‹ã€‚å¯¹äºintå€¼3ï¼Œæ¥å£å€¼ç¤ºæ„æ€§åœ°åŒ…å«ï¼ˆintï¼Œ3ï¼‰ã€‚ åªæœ‰åœ¨å†…éƒ¨å€¼å’Œç±»å‹éƒ½æœªè®¾ç½®æ—¶ï¼ˆnilï¼Œnilï¼‰ï¼Œæ¥å£å€¼æ‰ä¸ºé›¶ã€‚ç‰¹åˆ«æ˜¯ä¸€ä¸ªnilæ¥å£å°†å§‹ç»ˆä¿æŒä¸ºé›¶ç±»å‹ã€‚å¦‚æœæˆ‘ä»¬åœ¨æ¥å£å€¼ä¸­å­˜å‚¨ä¸€ä¸ªç±»å‹ä¸º* intçš„é›¶æŒ‡é’ˆï¼Œåˆ™æ— è®ºæŒ‡é’ˆçš„å€¼æ˜¯ä»€ä¹ˆï¼Œå†…éƒ¨ç±»å‹éƒ½å°†æ˜¯* intï¼šï¼ˆ* intï¼Œnilï¼‰ã€‚å› æ­¤ï¼Œå³ä½¿å†…éƒ¨æŒ‡é’ˆä¸ºé›¶ï¼Œè¿™æ ·çš„æ¥å£å€¼ä¹Ÿä¸ä¼šä¸ºé›¶ã€‚</p>

<p>a := (*interface{})(nil)ä¸var a *interface{} = nilç›¸ç­‰</p>

<p>ä½†æ˜¯var b interface{} = (<em>interface{})(nil)ï¼Œæ„å‘³ç€bæ˜¯ç±»å‹interface{}ï¼Œinterface{}åªæœ‰nilå½“å®ƒçš„ç±»å‹å’Œå€¼éƒ½æ˜¯å˜é‡æ—¶æ‰æ˜¯å˜é‡nilï¼Œæ˜¾ç„¶ç±»å‹</em>interface{}ä¸æ˜¯nilã€‚</p>
:ET