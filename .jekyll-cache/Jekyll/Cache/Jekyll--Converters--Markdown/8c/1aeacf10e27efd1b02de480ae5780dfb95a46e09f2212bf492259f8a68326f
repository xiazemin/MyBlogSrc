I"ª<p>http://bluebirdjs.com/docs/getting-started.html
https://github.com/petkaantonov/bluebird</p>

<p>https://developer.ibm.com/zh/articles/wa-lo-use-bluebird-implements-power-promise/</p>

<p>https://www.bootcdn.cn/bluebird/
<!-- more --></p>

<p>bluebirdæ˜¯ä¸€ä¸ªç¬¬ä¸‰æ–¹Promiseç±»åº“ï¼Œç›¸æ¯”å…¶å®ƒç¬¬ä¸‰æ–¹ç±»åº“æˆ–æ ‡å‡†å¯¹è±¡æ¥è¯´ï¼ŒåŠŸèƒ½æ›´é½å…¨è€Œä¸è‡ƒè‚¿ã€æµè§ˆå™¨å…¼å®¹æ€§æ›´å¥½ã€‚</p>

<p>æˆ‘ä»¬å¯é€šè¿‡npmå‘½ä»¤æ¥å®‰è£…ï¼šnpm install bluebird</p>

<p>é€šè¿‡requireè·å–å¯¹æ¨¡å—çš„å¼•ç”¨ï¼šcnst Promise = require(â€˜bluebirdâ€™);</p>

<p>var Promise = require(â€œbluebirdâ€);
var fs = require(â€œfsâ€);
//æ–¹æ³•PromiseåŒ–
var readFileAsync = Promise.promisify(fs.readFile);</p>

<p>//.spread([Function fulfilledHandler] [, Function rejectedHandler ]) -&gt; Promise
//ç”¨æ³•:å°†ç»“æœé›†æ‹†åˆ†
//example
Promise.delay(0).then(function () {
    return [
        readFileAsync(â€˜1.txtâ€™, â€˜utf-8â€™),
        readFileAsync(â€˜2.txtâ€™, â€˜utf-8â€™),
        readFileAsync(â€˜3.txtâ€™, â€˜utf-8â€™)
    ];
}).spread(function (file1, file2, file3) {
    console.log(file1);
    console.log(file2);
    console.log(file3);
})</p>

<p>//.finally(Function handler) -&gt; Promise
//ç±»ä¼¼try..catch..finallyä¸­finallyçš„ä½œç”¨
//example
Promise.delay(0).then(function () {
    return [
        readFileAsync(â€˜1.txtâ€™, â€˜utf-8â€™),
        readFileAsync(â€˜2.txtâ€™, â€˜utf-8â€™),
        readFileAsync(â€˜4.txtâ€™, â€˜utf-8â€™)
    ];
}).spread(function (file1, file2, file3) {
    console.log(file1);
    console.log(file2);
    console.log(file3);
}).catch(function (e) {
    console.log(e);
}).finally(function () {
    //æŠ›é”™æœ€åä»æ‰§è¡Œfinallyä¸­çš„å†…å®¹ï¼›
    console.log(4)
})</p>

<p>//Promise.join(Promise|Thenable|value promisesâ€¦, Function handler) -&gt; Promise
//å°†å‡ ä¸ªpromiseåŒ–çš„å‡½æ•°joinèµ·æ¥ï¼Œç”¨æ³•æœ‰ç‚¹ç±»ä¼¼spread
//example
var join = Promise.join;
join(readFileAsync(â€˜1.txtâ€™, â€˜utf-8â€™),
    readFileAsync(â€˜2.txtâ€™, â€˜utf-8â€™),
    readFileAsync(â€˜3.txtâ€™, â€˜utf-8â€™), function (file1, file2, file3) {
        return parseInt(file1) + parseInt(file2) + parseInt(file3);
    }).then(function (content) {
        console.log(â€œSUMç»“æœ:â€ + content);
    })</p>

<p>//Synchronous inspection åŒæ­¥æ£€æµ‹
//example
var rf1 = readFileAsync(â€˜1.txtâ€™, â€˜utf-8â€™);
var rf2 = readFileAsync(â€˜2.txtâ€™, â€˜utf-8â€™);
var rf3 = readFileAsync(â€˜3.txtâ€™, â€˜utf-8â€™);
var join = Promise.join;
join(rf1, rf2, rf3, function (file1, file2, file3) {
    return parseInt(file1) + parseInt(file2) + parseInt(file3);
}).then(function (content) {
    console.log(â€œSUMç»“æœ:â€ + content);
}).finally(function () {
    //.isFulfilled() -&gt; boolean
    //æ£€æµ‹æ˜¯å¦å®Œæˆ
    console.log(â€œsuccess:â€ + rf1.isFulfilled());
    //.isRejected() -&gt; boolean
    //æ£€æµ‹æ˜¯å¦å¤±è´¥
    console.log(â€œfail:â€ + rf1.isRejected());
    //.isPending() -&gt; boolean
    //æ£€æµ‹æ˜¯å¦è¿›è¡Œä¸­
    console.log(â€œPending:â€ + rf1.isRejected());
    //.value() -&gt; dynamic
    //æˆåŠŸçš„ç»“æœ,ä¸€èˆ¬ä½¿ç”¨æ—¶å…ˆåˆ¤å®šæ˜¯å¦å®Œæˆ
    if (rf1.isFulfilled()) {
        console.log(rf1.value());
    }
    //.reason() -&gt; dynamic
    //å¤±è´¥åŸå› ï¼ŒåŒæ ·ä½¿ç”¨æ—¶å…ˆåˆ¤å®šæ˜¯å¦å¤±è´¥
    if (rf1.isRejected()) {
        console.log(rf1.reason());
    }
})</p>

<p>//.all() -&gt; Promise
//å‚æ•°ä¸ºæ•°ç»„ï¼Œå¹¶ä¸”é‡Œé¢çš„å·²promiseåŒ–ï¼Œå…¨éƒ¨æˆåŠŸè¿”å›çš„ä¹Ÿä¸ºæ•°ç»„
//example
var rfAll1 = readFileAsync(â€˜1.txtâ€™, â€˜utf-8â€™);
var rfAll2 = readFileAsync(â€˜2.txtâ€™, â€˜utf-8â€™);
var rfAll3 = readFileAsync(â€˜3.txtâ€™, â€˜utf-8â€™);
var files = [rfAll1, rfAll2, rfAll3];
Promise.all(files).then(function (s) { console.log(â€œall:â€ + s) });</p>

<p>//.props() -&gt; Promise
//ç±»ä¼¼äº.all(),ä¸è¿‡å‚æ•°ä¸ºobjectï¼Œå…¨éƒ¨æˆåŠŸè¿”å›å€¼ä¹Ÿä¸ºobject
//example
Promise.props({
    rfProp1: readFileAsync(â€˜1.txtâ€™, â€˜utf-8â€™),
    rfProp2: readFileAsync(â€˜2.txtâ€™, â€˜utf-8â€™),
    rfProp3: readFileAsync(â€˜3.txtâ€™, â€˜utf-8â€™)
}).then(function(content){
    console.log(JSON.stringify(content));
})</p>

<p>//.settle() -&gt; Promise
//åŸºæœ¬ç­‰åŒäº.all();
//example
var rfsettle1 = readFileAsync(â€˜1.txtâ€™, â€˜utf-8â€™);
var rfsettle2 = readFileAsync(â€˜2.txtâ€™, â€˜utf-8â€™);
var rfsettle3 = readFileAsync(â€˜3.txtâ€™, â€˜utf-8â€™);
var files = [rfsettle1, rfsettle2, rfsettle3];
Promise.all(files).then(function (s) { console.log(â€œsettle:â€ + s) });</p>

<p>//.some(int count) -&gt; Promise
//ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæ•°ç»„ï¼Œç¬¬äºŒä¸ªä¸ºä¸ªæ•°,æŒ‡çš„è¿”å›å€¼æœ€å…ˆè¿”å›æˆåŠŸçš„å€¼
//example
var rfsome1 = readFileAsync(â€˜1.txtâ€™, â€˜utf-8â€™);
var rfsome2 = readFileAsync(â€˜2.txtâ€™, â€˜utf-8â€™);
var rfsome3 = readFileAsync(â€˜3.txtâ€™, â€˜utf-8â€™);
var files = [rfsome1, rfsome2, rfsome3];
Promise.some(files,2).spread(function(first,second){
    console.log(â€œsome:â€ + first);
    console.log(â€œsome:â€ + second);
})</p>

<p>//.map(Function mapper [, Object options]) -&gt; Promise
//å‚æ•°ä¸ºæ•°ç»„,ä¸éœ€è¦promiseåŒ–ï¼Œåªè¦mapé‡Œé¢çš„å‡½æ•°promiseåŒ–å°±è¡Œã€‚ æœ‰ç‚¹ç±»ä¼¼äºæ•°ç»„çš„mapæ–¹æ³•
//example
var files = [â€˜1.txtâ€™,â€™2.txtâ€™,â€™3.txtâ€™];
Promise.map(files,function(file){
    return readFileAsync(file,â€™utf-8â€™);
}).then(function(content){
    console.log(â€œmap:â€ + content) ;
})</p>

<p>//.reduce(Function reducer [, dynamic initialValue]) -&gt; Promise
//æ¦‚å¿µæœ‰ç‚¹åƒæ•°ç»„çš„reduceæ–¹æ³•.   totalä¸ºè¿”å›çš„ç»„è£…å€¼ï¼ŒfileNameä¸ºitem,0ä¸ºåˆå§‹å€¼
//example
Promise.reduce([â€œ1.txtâ€, â€œ2.txtâ€, â€œ3.txtâ€], function(total, fileName) {
    return readFileAsync(fileName, â€œutf8â€).then(function(contents) {
        return total + parseInt(contents, 10);
    });
}, 0).then(function(total) {
    console.log(â€œreduce:â€ + total)
});</p>
:ET