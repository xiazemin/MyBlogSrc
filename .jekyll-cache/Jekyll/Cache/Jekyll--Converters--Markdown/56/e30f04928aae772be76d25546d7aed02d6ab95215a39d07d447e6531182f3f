I"ï$<p>å®‰è£…æ—¶è¿˜æ˜¯ç”¨çš„ boot2docker, å¦‚ä»Šè¿›åŒ–åˆ°äº†åœ¨ Mac OS X ä¸‹ç”¨ Docker Toolbox, è€Œä¸”å‘½ä»¤ä¹Ÿç”± boot2docker æ¢æˆäº† docker-machine. å½“ç„¶ç”±äºæ˜¯é Linux ç³»ç»Ÿ, æ‰€ä»¥ Mac OS X ä»ç„¶éœ€è¦å€ŸåŠ©äº VirtualBox ä¸­çš„ Linux è™šæ‹Ÿæœºä½œä¸ºæ¡¥æ¢, Docker Toolbox åˆ›å»ºçš„è™šæ‹Ÿæœºåæ˜¯ default (boot2docker åˆ›å»ºçš„è™šæ‹Ÿæœºåæ˜¯ boot2docker-vm) å°±æ˜¯è¿™ä¸€æ¡¥æ¢, æˆ‘ä»¬ç§°ä¹‹ä¸º DOCKER_HOST. æ–‡ä¸­çš„ default è™šæ‹ŸæœºæŒ‡çš„å°±æ˜¯è¿™ä¸ª DOCKER_HOST.</p>

<p>//åˆ›å»ºè™šæ‹Ÿæœº
docker-machine create [OPTIONS] [argâ€¦]</p>

<p>//ç§»é™¤è™šæ‹Ÿæœº
docker-machine rm [OPTIONS] [argâ€¦]</p>

<p>//ç™»å½•è™šæ‹Ÿæœº
docker-machine ssh [argâ€¦]</p>

<p>//dockerå®¢æˆ·ç«¯é…ç½®ç¯å¢ƒå˜é‡
docker-machine env [OPTIONS] [argâ€¦]</p>

<p>//æ£€æŸ¥æœºå­ä¿¡æ¯
docker-machine inspect</p>

<p>//æŸ¥çœ‹è™šæ‹Ÿæœºåˆ—è¡¨
docker-machine ls [OPTIONS] [argâ€¦]</p>

<p>//æŸ¥çœ‹è™šæ‹ŸæœºçŠ¶æ€
docker-machine status [argâ€¦]  //ä¸€ä¸ªè™šæ‹Ÿæœºåç§°</p>

<p>//å¯åŠ¨è™šæ‹Ÿæœº
docker-machine start [argâ€¦]  //ä¸€ä¸ªæˆ–å¤šä¸ªè™šæ‹Ÿæœºåç§°</p>

<p>//åœæ­¢è™šæ‹Ÿæœº
docker-machine stop [argâ€¦]  //ä¸€ä¸ªæˆ–å¤šä¸ªè™šæ‹Ÿæœºåç§°</p>

<p>//é‡å¯è™šæ‹Ÿæœº
docker-machine restart [argâ€¦]  //ä¸€ä¸ªæˆ–å¤šä¸ªè™šæ‹Ÿæœºåç§°
<!-- more -->
Docker Machine æ˜¯ Docker å®˜æ–¹ç¼–æ’ï¼ˆOrchestrationï¼‰é¡¹ç›®ä¹‹ä¸€ï¼Œè´Ÿè´£åœ¨å¤šç§å¹³å°ä¸Šå¿«é€Ÿå®‰è£… Docker ç¯å¢ƒã€‚</p>

<p>Docker Machine æ˜¯ä¸€ä¸ªå·¥å…·ï¼Œå®ƒå…è®¸ä½ åœ¨è™šæ‹Ÿå®¿ä¸»æœºä¸Šå®‰è£… Docker Engine ï¼Œå¹¶ä½¿ç”¨ docker-machine å‘½ä»¤ç®¡ç†è¿™äº›å®¿ä¸»æœºã€‚ä½ å¯ä»¥ä½¿ç”¨ Machine åœ¨ä½ æœ¬åœ°çš„ Mac æˆ– Windows boxã€å…¬å¸ç½‘ç»œã€æ•°æ®ä¸­å¿ƒã€æˆ–åƒ AWS æˆ– Digital Ocean è¿™æ ·çš„äº‘æä¾›å•†ä¸Šåˆ›å»º Docker å®¿ä¸»æœºã€‚</p>

<p>ä½¿ç”¨ docker-machine å‘½ä»¤ï¼Œä½ å¯ä»¥å¯åŠ¨ã€å®¡æŸ¥ã€åœæ­¢å’Œé‡æ–°å¯åŠ¨æ‰˜ç®¡çš„å®¿ä¸»æœºã€å‡çº§ Docker å®¢æˆ·ç«¯å’Œå®ˆæŠ¤ç¨‹åºã€å¹¶é…ç½® Docker å®¢æˆ·ç«¯ä¸ä½ çš„å®¿ä¸»æœºé€šä¿¡ã€‚</p>

<p>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å®ƒï¼Ÿ
Docker Machine ä½¿ä½ èƒ½å¤Ÿåœ¨å„ç§ Linux ä¸Šé…ç½®å¤šä¸ªè¿œç¨‹ Docker å®¿ä¸»æœºã€‚ æ­¤å¤–ï¼ŒMachine å…è®¸ä½ åœ¨è¾ƒæ—©çš„ Mac æˆ– Windows ç³»ç»Ÿä¸Šè¿è¡Œ Dockerï¼Œå¦‚ä¸Šä¸€ä¸»é¢˜æ‰€è¿°ã€‚ Docker Machine æœ‰è¿™ä¸¤ä¸ªå¹¿æ³›çš„ç”¨ä¾‹ã€‚</p>

<p>æˆ‘æœ‰ä¸€ä¸ªè¾ƒæ—§çš„æ¡Œé¢ç³»ç»Ÿï¼Œå¹¶å¸Œæœ›åœ¨ Mac æˆ– Windows ä¸Šè¿è¡Œ Docker</p>

<p>å¦‚æœä½ ä¸»è¦åœ¨ä¸ç¬¦åˆæ–°çš„ Docker for Mac å’Œ Docker for Windows åº”ç”¨ç¨‹åºçš„æ—§ Mac æˆ– Windows ç¬”è®°æœ¬ç”µè„‘æˆ–å°å¼æœºä¸Šå·¥ä½œï¼Œåˆ™éœ€è¦ Docker Machine æ¥åœ¨æœ¬åœ°â€œè¿è¡ŒDockerâ€ï¼ˆå³Docker Engineï¼‰ã€‚åœ¨ Mac æˆ– Windows box ä¸­ä½¿ç”¨ Docker Toolbox å®‰è£…ç¨‹åºå®‰è£… Docker Machine å°†ä¸º Docker Engine é…ç½®ä¸€ä¸ªæœ¬åœ°çš„è™šæ‹Ÿæœºï¼Œä½¿ä½ èƒ½å¤Ÿè¿æ¥å®ƒã€å¹¶è¿è¡Œ docker å‘½ä»¤ã€‚</p>

<p>æˆ‘æƒ³åœ¨è¿œç¨‹ç³»ç»Ÿä¸Šé…ç½® Docker å®¿ä¸»æœº</p>

<p>Docker Engine Linux ç³»ç»Ÿä¸ŠåŸç”Ÿåœ°è¿è¡Œã€‚å¦‚æœä½ æœ‰ä¸€ä¸ª Linux ä½œä¸ºä½ çš„ä¸»ç³»ç»Ÿï¼Œå¹¶ä¸”æƒ³è¦è¿è¡Œ docker å‘½ä»¤ï¼Œæ‰€æœ‰ä½ éœ€è¦åšçš„å°±æ˜¯ä¸‹è½½å¹¶å®‰è£… Docker Engine ã€‚ç„¶è€Œï¼Œå¦‚æœä½ æƒ³è¦åœ¨ç½‘ç»œä¸Šã€äº‘ä¸­ç”šè‡³æœ¬åœ°é…ç½®å¤šä¸ª Docker å®¿ä¸»æœºæœ‰ä¸€ä¸ªæœ‰æ•ˆçš„æ–¹å¼ï¼Œä½ éœ€è¦ Docker Machineã€‚</p>

<p>æ— è®ºä½ çš„ä¸»ç³»ç»Ÿæ˜¯ Macã€Windows è¿˜æ˜¯ Linuxï¼Œä½ éƒ½å¯ä»¥åœ¨å…¶ä¸Šå®‰è£… Docker Machineï¼Œå¹¶ä½¿ç”¨ docker-machine å‘½ä»¤æ¥é…ç½®å’Œç®¡ç†å¤§é‡çš„ Docker å®¿ä¸»æœºã€‚å®ƒä¼šè‡ªåŠ¨åˆ›å»ºå®¿ä¸»æœºã€åœ¨å…¶ä¸Šå®‰è£… Docker Engine ã€ç„¶åé…ç½® docker å®¢æˆ·ç«¯ã€‚æ¯ä¸ªè¢«ç®¡ç†çš„å®¿ä¸»æœºï¼ˆâ€œmachineâ€ï¼‰æ˜¯ Docker å®¿ä¸»æœºå’Œé…ç½®å¥½çš„å®¢æˆ·ç«¯çš„ç»“åˆã€‚</p>

<p>Docker Engine å’Œ Docker Machine æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ
å½“äººä»¬è¯´â€œDockerâ€æ—¶ï¼Œä»–ä»¬é€šå¸¸æ˜¯æŒ‡ Docker Engineï¼Œå®ƒæ˜¯ä¸€ä¸ªå®¢æˆ·ç«¯ - æœåŠ¡å™¨åº”ç”¨ç¨‹åºï¼Œç”± Docker å®ˆæŠ¤è¿›ç¨‹ã€ä¸€ä¸ªREST APIæŒ‡å®šä¸å®ˆæŠ¤è¿›ç¨‹äº¤äº’çš„æ¥å£ã€å’Œä¸€ä¸ªå‘½ä»¤è¡Œæ¥å£ï¼ˆCLIï¼‰ä¸å®ˆæŠ¤è¿›ç¨‹é€šä¿¡ï¼ˆé€šè¿‡å°è£…REST APIï¼‰ã€‚Docker Engine ä» CLI ä¸­æ¥å—docker å‘½ä»¤ï¼Œä¾‹å¦‚docker run <image>ã€docker ps æ¥åˆ—å‡ºæ­£åœ¨è¿è¡Œçš„å®¹å™¨ã€docker imagesæ¥åˆ—å‡ºé•œåƒï¼Œç­‰ç­‰ã€‚</image></p>

<p>Docker Machine æ˜¯ä¸€ä¸ªç”¨äºé…ç½®å’Œç®¡ç†ä½ çš„å®¿ä¸»æœºï¼ˆä¸Šé¢å…·æœ‰ Docker Engine çš„ä¸»æœºï¼‰çš„å·¥å…·ã€‚é€šå¸¸ï¼Œä½ åœ¨ä½ çš„æœ¬åœ°ç³»ç»Ÿä¸Šå®‰è£… Docker Machineã€‚Docker Machineæœ‰è‡ªå·±çš„å‘½ä»¤è¡Œå®¢æˆ·ç«¯ docker-machine å’Œ Docker Engine å®¢æˆ·ç«¯ dockerã€‚ä½ å¯ä»¥ä½¿ç”¨ Machine åœ¨ä¸€ä¸ªæˆ–å¤šä¸ªè™šæ‹Ÿç³»ç»Ÿä¸Šå®‰è£… Docker Engineã€‚</p>

<p>è¿™äº›è™šæ‹Ÿç³»ç»Ÿå¯ä»¥æ˜¯æœ¬åœ°çš„ï¼ˆå°±åƒä½ åœ¨ Mac æˆ– Windows ä¸Šä½¿ç”¨ Machine åœ¨ VirtualBox ä¸­å®‰è£…å’Œè¿è¡Œ Docker Engine ä¸€æ ·ï¼‰æˆ–è¿œç¨‹çš„ï¼ˆå°±åƒä½ ä½¿ç”¨ Machine åœ¨äº‘æä¾›å•†ä¸Š provision Dockerized å®¿ä¸»æœºä¸€æ ·ï¼‰ã€‚Dockerized å®¿ä¸»æœºæœ¬èº«å¯ä»¥è®¤ä¸ºæ˜¯ï¼Œä¸”æœ‰æ—¶å°±ç§°ä¸ºï¼Œè¢«ç®¡ç†çš„â€œmachinesâ€ã€‚</p>

<p>å®‰è£…å’Œä½¿ç”¨
Docker Machine å®‰è£…å¾ˆç®€å•</p>

<p>curl -L https://github.com/docker/machine/releases/download/v0.14.0/docker-machine-<code class="language-plaintext highlighter-rouge">uname -s</code>-<code class="language-plaintext highlighter-rouge">uname -m</code> &gt;/tmp/docker-machine &amp;&amp; <br />
install /tmp/docker-machine /usr/local/bin/docker-machine</p>

<p>#å®Œæˆåï¼ŒæŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯ã€‚
docker-machine -v
docker-machine version 0.14.0, build 89b8332</p>

<p>åˆ›å»ºä¸€ä¸ª VirtualBox
æŸ¥çœ‹æ˜¯å¦å­˜åœ¨å¯ç”¨çš„ä¸»æœº</p>

<p>$ docker-machine ls
NAME ACTIVE DRIVER STATE URL SWARM DOCKER ERRORS</p>

<p>åˆ›å»ºä¸€ä¸ªä¸»æœº:</p>

<p>$ docker-machine create â€“driver virtualbox default
Running pre-create checksâ€¦
(default) Default Boot2Docker ISO is out-of-date, downloading the latest releaseâ€¦
(default) Latest release for http://github.com/boot2docker/boot2docker is v17.12.1-ce
(default) Downloading C:\Users\hkrt-neo.docker\machine\cache\boot2docker.iso from https://github.com/boot2docker/boot2docker/releases/download/v17.12.1-ce/boot2docker.isoâ€¦
(default) 0%â€¦.10%â€¦.20%â€¦.30%â€¦.40%â€¦.50%â€¦.60%â€¦.70%â€¦.80%â€¦.90%â€¦.100%
Creating machineâ€¦
(default) Copying C:\Users\hkrt-neo.docker\machine\cache\boot2docker.iso to C:\Users\hkrt-neo.docker\machine\machines\default\boot2docker.isoâ€¦
(default) Creating VirtualBox VMâ€¦
(default) Creating SSH keyâ€¦
(default) Starting the VMâ€¦
(default) Check network to re-create if neededâ€¦
(default) Windows might ask for the permission to configure a dhcp server. Sometimes, such confirmation window is minimized in the taskbar.
(default) Waiting for an IPâ€¦
Waiting for machine to be running, this may take a few minutesâ€¦
Detecting operating system of created instanceâ€¦
Waiting for SSH to be availableâ€¦
Detecting the provisionerâ€¦
Provisioning with boot2dockerâ€¦
Copying certs to the local machine directoryâ€¦
Copying certs to the remote machineâ€¦
Setting Docker configuration on the remote daemonâ€¦
â€¦</p>

<p>è¿™ä¸ªå‘½ä»¤ä¼šä¸‹è½½ boot2dockerï¼ŒåŸºäº boot2docker åˆ›å»ºä¸€ä¸ªè™šæ‹Ÿä¸»æœºã€‚boot2docker æ˜¯ä¸€ä¸ªè½»é‡çº§çš„ linux å‘è¡Œç‰ˆï¼ŒåŸºäºä¸“é—¨ä¸ºè¿è¡Œ docker å®¹å™¨è€Œè®¾è®¡çš„ Tiny Core Linux ç³»ç»Ÿï¼Œå®Œå…¨ä» RAM è¿è¡Œï¼Œ45Mbå·¦å³ï¼Œå¯åŠ¨æ—¶é—´çº¦5sã€‚</p>

<p>å†æ¬¡æŸ¥çœ‹æœåŠ¡åˆ—è¡¨</p>

<p>docker-machine ls
NAME ACTIVE DRIVER STATE URL SWARM DOCKER ERRORS
default * virtualbox Running tcp://192.168.99.100:2376 v17.12.1-ce</p>

<p>å‘ç°å·²ç»å­˜åœ¨ä¸€ä¸ªè™šæ‹Ÿä¸»æœº</p>

<p>åˆ›å»ºä¸»æœºæˆåŠŸåï¼Œå¯ä»¥é€šè¿‡ env å‘½ä»¤æ¥è®©åç»­æ“ä½œå¯¹è±¡éƒ½æ˜¯ç›®æ ‡ä¸»æœºã€‚</p>

<p>$ docker-machine env default
export DOCKER_TLS_VERIFY=â€1â€ export DOCKER_HOST=â€tcp://192.168.99.100:2376â€ export DOCKER_CERT_PATH=â€C:\Users\hkrt-neo.docker\machine\machines\defaultâ€ export DOCKER_MACHINE_NAME=â€defaultâ€ export COMPOSE_CONVERT_WINDOWS_PATHS=â€trueâ€ # Run this command to configure your shell: # eval $(â€œD:\Program Files\Docker Toolbox\docker-machine.exeâ€ env default)</p>

<p>ç›¸å½“äºé…ç½®äº†ä¸€ä¸ªç¯å¢ƒå˜é‡ defaultï¼Œåç»­æ ¹æ®æç¤ºåœ¨å‘½ä»¤è¡Œè¾“å…¥å‘½ä»¤ä¹‹åå°±å¯ä»¥æ“ä½œ default ä¸»æœºã€‚</p>

<p>å¯ä»¥é€šè¿‡ SSH ç™»å½•åˆ°ä¸»æœº</p>

<p>$ docker-machine ssh default</p>

<p>docker@default:~$ docker â€“version
Docker version 17.12.1-ce, build 7390fc6</p>

<p>è¿æ¥åˆ°ä¸»æœºä¹‹åä½ å°±å¯ä»¥åœ¨å…¶ä¸Šä½¿ç”¨ Docker äº†ï¼Œé€€å‡ºè™šæ‹Ÿæœºä½¿ç”¨å‘½ä»¤ï¼šexit</p>

<p>Docker Machine å¸¸ç”¨å‘½ä»¤
//åˆ›å»ºè™šæ‹Ÿæœº
docker-machine create [OPTIONS] [argâ€¦]</p>

<p>//ç§»é™¤è™šæ‹Ÿæœº
docker-machine rm [OPTIONS] [argâ€¦]</p>

<p>//ç™»å½•è™šæ‹Ÿæœº
docker-machine ssh [argâ€¦]</p>

<p>//dockerå®¢æˆ·ç«¯é…ç½®ç¯å¢ƒå˜é‡
docker-machine env [OPTIONS] [argâ€¦]</p>

<p>//æ£€æŸ¥æœºå­ä¿¡æ¯
docker-machine inspect</p>

<p>//æŸ¥çœ‹è™šæ‹Ÿæœºåˆ—è¡¨
docker-machine ls [OPTIONS] [argâ€¦]</p>

<p>//æŸ¥çœ‹è™šæ‹ŸæœºçŠ¶æ€
docker-machine status [argâ€¦] //ä¸€ä¸ªè™šæ‹Ÿæœºåç§°</p>

<p>//å¯åŠ¨è™šæ‹Ÿæœº
docker-machine start [argâ€¦] //ä¸€ä¸ªæˆ–å¤šä¸ªè™šæ‹Ÿæœºåç§°</p>

<p>//åœæ­¢è™šæ‹Ÿæœº
docker-machine stop [argâ€¦] //ä¸€ä¸ªæˆ–å¤šä¸ªè™šæ‹Ÿæœºåç§°</p>

<p>//é‡å¯è™šæ‹Ÿæœº
docker-machine restart [argâ€¦] //ä¸€ä¸ªæˆ–å¤šä¸ªè™šæ‹Ÿæœºåç§°</p>

<p>æ›´å¤šå‚æ•°è¯·ä½¿ç”¨ docker-machine â€“help å‘½ä»¤æŸ¥çœ‹ã€‚
æ€»ç»“
Docker Machine æœ€ä¸»è¦æœ‰ä¸¤ä¸ªä½œç”¨ï¼š</p>

<p>ä½¿ç”¨ Docker Machine æ–¹ä¾¿åœ¨ä¸åŒçš„ç¯å¢ƒä¸­ä½¿ç”¨ Docker ï¼Œæ¯”å¦‚ï¼šWin/Mac
ä½¿ç”¨ Docker Machine æ–¹ä¾¿åœ¨äº‘ç¯å¢ƒä¸‹æ‰¹é‡éƒ¨ç½² Dockerç¯å¢ƒï¼Œæ¯”å¦‚ï¼šç§æœ‰äº‘ï¼Œå…¬æœ‰äº‘æ‰¹é‡å®‰è£…Dockerç¯å¢ƒ
virtualbox å®‰è£…å¾ˆéº»çƒ¦ï¼Œæˆ‘ä½¿ç”¨çš„è™šæ‹Ÿæœºå’Œäº‘ä¸»æœºæ¥åšå®éªŒå‡æ²¡æœ‰å®‰è£…æˆåŠŸï¼Œæœ€åä½¿ç”¨çš„æ˜¯ Docker å®˜æ–¹æä¾›çš„ Windows å®‰è£…åŒ…æ¥å®Œæˆçš„ virtualbox ç›¸å…³æ“ä½œã€‚é™„ virtualbox å®˜ç½‘ï¼šhttps://www.virtualbox.org/wiki/Downloads</p>

:ET