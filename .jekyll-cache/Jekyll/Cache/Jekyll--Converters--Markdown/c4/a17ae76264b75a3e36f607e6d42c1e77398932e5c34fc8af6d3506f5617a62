I"Q’<p>PHP è‡ª5.3çš„ç‰ˆæœ¬ä¹‹åï¼Œå·²ç»é‡ç„•æ–°ç”Ÿï¼Œå‘½åç©ºé—´ã€æ€§çŠ¶ï¼ˆtraitï¼‰ã€é—­åŒ…ã€æ¥å£ã€PSR è§„èŒƒã€ä»¥åŠ composer çš„å‡ºç°å·²ç»è®© PHP å˜æˆäº†ä¸€é—¨ç°ä»£åŒ–çš„è„šæœ¬è¯­è¨€ã€‚PHP çš„ç”Ÿæ€ç³»ç»Ÿä¹Ÿä¸€ç›´åœ¨æ¼”è¿›ï¼Œè€Œ composer çš„å‡ºç°æ›´æ˜¯å½»åº•çš„æ”¹å˜äº†ä»¥å¾€æ„å»º PHP åº”ç”¨çš„æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ® PHP çš„åº”ç”¨éœ€æ±‚æ··åˆæ­é…æœ€åˆé€‚çš„ PHP ç»„ä»¶ã€‚å½“ç„¶è¿™ä¹Ÿå¾—ç›Šäº PSR è§„èŒƒçš„æå‡ºã€‚</p>

<p>å¤§çº²
PHP è‡ªåŠ¨åŠ è½½åŠŸèƒ½
PSR è§„èŒƒ
comoposer çš„è‡ªåŠ¨åŠ è½½è¿‡ç¨‹
composer æºç åˆ†æ
ä¸€ã€PHP è‡ªåŠ¨åŠ è½½åŠŸèƒ½
PHP è‡ªåŠ¨åŠ è½½åŠŸèƒ½çš„ç”±æ¥
åœ¨ PHP å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå¦‚æœå¸Œæœ›ä»å¤–éƒ¨å¼•å…¥ä¸€ä¸ª Class ï¼Œé€šå¸¸ä¼šä½¿ç”¨ include å’Œ require æ–¹æ³•ï¼Œå»æŠŠå®šä¹‰è¿™ä¸ª Class çš„æ–‡ä»¶åŒ…å«è¿›æ¥ã€‚è¿™ä¸ªåœ¨å°è§„æ¨¡å¼€å‘çš„æ—¶å€™ï¼Œæ²¡ä»€ä¹ˆå¤§é—®é¢˜ã€‚ä½†åœ¨å¤§å‹çš„å¼€å‘é¡¹ç›®ä¸­ï¼Œä½¿ç”¨è¿™ç§æ–¹å¼ä¼šå¸¦æ¥ä¸€äº›éšå«çš„é—®é¢˜ï¼šå¦‚æœä¸€ä¸ª PHP æ–‡ä»¶éœ€è¦ä½¿ç”¨å¾ˆå¤šå…¶å®ƒç±»ï¼Œé‚£ä¹ˆå°±éœ€è¦å¾ˆå¤šçš„ require/include è¯­å¥ï¼Œè¿™æ ·æœ‰å¯èƒ½ä¼š é€ æˆé—æ¼ æˆ–è€… åŒ…å«è¿›ä¸å¿…è¦çš„ç±»æ–‡ä»¶ã€‚å¦‚æœå¤§é‡çš„æ–‡ä»¶éƒ½éœ€è¦ä½¿ç”¨å…¶å®ƒçš„ç±»ï¼Œé‚£ä¹ˆè¦ä¿è¯æ¯ä¸ªæ–‡ä»¶éƒ½åŒ…å«æ­£ç¡®çš„ç±»æ–‡ä»¶è‚¯å®šæ˜¯ä¸€ä¸ªå™©æ¢¦ï¼Œ å†µä¸” requireæˆ– incloud çš„æ€§èƒ½ä»£ä»·å¾ˆå¤§ã€‚</p>

<p>PHP5 ä¸ºè¿™ä¸ªé—®é¢˜æä¾›äº†ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œè¿™å°±æ˜¯ ç±»çš„è‡ªåŠ¨åŠ è½½(autoload)æœºåˆ¶ã€‚autoloadæœºåˆ¶ å¯ä»¥ä½¿å¾— PHP ç¨‹åºæœ‰å¯èƒ½åœ¨ä½¿ç”¨ç±»æ—¶æ‰è‡ªåŠ¨åŒ…å«ç±»æ–‡ä»¶ï¼Œè€Œä¸æ˜¯ä¸€å¼€å§‹å°±å°†æ‰€æœ‰çš„ç±»æ–‡ä»¶includeè¿›æ¥ï¼Œè¿™ç§æœºåˆ¶ä¹Ÿç§°ä¸º Lazy loading (æƒ°æ€§åŠ è½½)ã€‚</p>

<p>æ€»ç»“èµ·æ¥ï¼Œè‡ªåŠ¨åŠ è½½åŠŸèƒ½å¸¦æ¥äº†å‡ å¤„ä¼˜ç‚¹ï¼š</p>

<p>ä½¿ç”¨ç±»ä¹‹å‰æ— éœ€ include / require
ä½¿ç”¨ç±»çš„æ—¶å€™æ‰ä¼š include / require æ–‡ä»¶ï¼Œå®ç°äº† lazy loading ï¼Œé¿å…äº† include / require å¤šä½™æ–‡ä»¶ã€‚
æ— éœ€è€ƒè™‘å¼•å…¥ ç±»çš„å®é™…ç£ç›˜åœ°å€ ï¼Œå®ç°äº†é€»è¾‘å’Œå®ä½“æ–‡ä»¶çš„åˆ†ç¦»
<!-- more -->
PHP è‡ªåŠ¨åŠ è½½å‡½æ•° __autoload()
ä» PHP5 å¼€å§‹ï¼Œå½“æˆ‘ä»¬åœ¨ä½¿ç”¨ä¸€ä¸ªç±»æ—¶ï¼Œå¦‚æœå‘ç°è¿™ä¸ªç±»æ²¡æœ‰åŠ è½½ï¼Œå°±ä¼šè‡ªåŠ¨è¿è¡Œ __autoload() å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°æ˜¯æˆ‘ä»¬åœ¨ç¨‹åºä¸­è‡ªå®šä¹‰çš„ï¼Œåœ¨è¿™ä¸ªå‡½æ•°ä¸­æˆ‘ä»¬å¯ä»¥åŠ è½½éœ€è¦ä½¿ç”¨çš„ç±»ã€‚ä¸‹é¢æ˜¯ä¸ªç®€å•çš„ç¤ºä¾‹ï¼š</p>

<p>&lt;?php</p>

<p>function __autoload($classname) {
        require_once ($classname . â€œ.class.phpâ€);
}
åœ¨æˆ‘ä»¬è¿™ä¸ªç®€å•çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ç›´æ¥å°†ç±»ååŠ ä¸Šæ‰©å±•å .class.php æ„æˆäº†ç±»æ–‡ä»¶åï¼Œç„¶åä½¿ç”¨ require_once å°†å…¶åŠ è½½ã€‚</p>

<p>ä»è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡º __autoload è‡³å°‘è¦åšä¸‰ä»¶äº‹æƒ…ï¼š</p>

<p>æ ¹æ®ç±»åç¡®å®šç±»æ–‡ä»¶åï¼›
ç¡®å®šç±»æ–‡ä»¶æ‰€åœ¨çš„ç£ç›˜è·¯å¾„ï¼›
å°†ç±»ä»ç£ç›˜æ–‡ä»¶ä¸­åŠ è½½åˆ°ç³»ç»Ÿä¸­ã€‚
ç¬¬ä¸‰æ­¥æœ€ç®€å•ï¼Œåªéœ€è¦ä½¿ç”¨ include / require å³å¯ã€‚è¦å®ç°ç¬¬ä¸€æ­¥ï¼Œç¬¬äºŒæ­¥çš„åŠŸèƒ½ï¼Œå¿…é¡»åœ¨å¼€å‘æ—¶çº¦å®šç±»åä¸ç£ç›˜æ–‡ä»¶çš„æ˜ å°„æ–¹æ³•ï¼Œåªæœ‰è¿™æ ·æˆ‘ä»¬æ‰èƒ½æ ¹æ®ç±»åæ‰¾åˆ°å®ƒå¯¹åº”çš„ç£ç›˜æ–‡ä»¶ã€‚
å½“æœ‰å¤§é‡çš„ç±»æ–‡ä»¶è¦åŒ…å«çš„æ—¶å€™ï¼Œæˆ‘ä»¬åªè¦ç¡®å®šç›¸åº”çš„è§„åˆ™ï¼Œç„¶ååœ¨ __autoload() å‡½æ•°ä¸­ï¼Œå°†ç±»åä¸å®é™…çš„ç£ç›˜æ–‡ä»¶å¯¹åº”èµ·æ¥ï¼Œå°±å¯ä»¥å®ç° lazy loading çš„æ•ˆæœ ã€‚
å¦‚æœæƒ³è¯¦ç»†çš„äº†è§£å…³äº autoload è‡ªåŠ¨åŠ è½½çš„è¿‡ç¨‹ï¼Œå¯ä»¥æŸ¥çœ‹æ‰‹å†Œèµ„æ–™ï¼šPHP autoloadå‡½æ•°è¯´æ˜
__autoload() å‡½æ•°å­˜åœ¨çš„é—®é¢˜
å¦‚æœåœ¨ä¸€ä¸ªç³»ç»Ÿçš„å®ç°ä¸­ï¼Œå¦‚æœéœ€è¦ä½¿ç”¨å¾ˆå¤šå…¶å®ƒçš„ç±»åº“ï¼Œè¿™äº›ç±»åº“å¯èƒ½æ˜¯ç”±ä¸åŒçš„å¼€å‘äººå‘˜ç¼–å†™çš„ï¼Œ å…¶ç±»åä¸å®é™…çš„ç£ç›˜æ–‡ä»¶çš„æ˜ å°„è§„åˆ™ä¸å°½ç›¸åŒã€‚è¿™æ—¶å¦‚æœè¦å®ç°ç±»åº“æ–‡ä»¶çš„è‡ªåŠ¨åŠ è½½ï¼Œå°±å¿…é¡» åœ¨ __autoload() å‡½æ•°ä¸­å°†æ‰€æœ‰çš„æ˜ å°„è§„åˆ™å…¨éƒ¨å®ç°ï¼Œè¿™æ ·çš„è¯ __autoload() å‡½æ•°æœ‰å¯èƒ½ä¼šéå¸¸å¤æ‚ï¼Œç”šè‡³æ— æ³•å®ç°ã€‚æœ€åå¯èƒ½ä¼šå¯¼è‡´ __autoload() å‡½æ•°ååˆ†è‡ƒè‚¿ï¼Œè¿™æ—¶å³ä¾¿èƒ½å¤Ÿå®ç°ï¼Œä¹Ÿä¼šç»™å°†æ¥çš„ç»´æŠ¤å’Œç³»ç»Ÿæ•ˆç‡å¸¦æ¥å¾ˆå¤§çš„è´Ÿé¢å½±å“ã€‚
é‚£ä¹ˆé—®é¢˜å‡ºç°åœ¨å“ªé‡Œå‘¢ï¼Ÿé—®é¢˜å‡ºç°åœ¨ __autoload() æ˜¯å…¨å±€å‡½æ•°åªèƒ½å®šä¹‰ä¸€æ¬¡ ï¼Œä¸å¤Ÿçµæ´»ï¼Œæ‰€ä»¥æ‰€æœ‰çš„ç±»åä¸æ–‡ä»¶åå¯¹åº”çš„é€»è¾‘è§„åˆ™éƒ½è¦åœ¨ä¸€ä¸ªå‡½æ•°é‡Œé¢å®ç°ï¼Œé€ æˆè¿™ä¸ªå‡½æ•°çš„è‡ƒè‚¿ã€‚é‚£ä¹ˆå¦‚ä½•æ¥è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿç­”æ¡ˆå°±æ˜¯ä½¿ç”¨ä¸€ä¸ª __autoloadè°ƒç”¨å †æ ˆ ï¼Œä¸åŒçš„æ˜ å°„å…³ç³»å†™åˆ°ä¸åŒçš„ __autoloadå‡½æ•° ä¸­å»ï¼Œç„¶åç»Ÿä¸€æ³¨å†Œç»Ÿä¸€ç®¡ç†ï¼Œè¿™ä¸ªå°±æ˜¯ PHP5 å¼•å…¥çš„ SPL Autoload ã€‚
SPL Autoload
SPLæ˜¯ Standard PHP Library(æ ‡å‡†PHPåº“)çš„ç¼©å†™ã€‚å®ƒæ˜¯ PHP5 å¼•å…¥çš„ä¸€ä¸ªæ‰©å±•æ ‡å‡†åº“ï¼ŒåŒ…æ‹¬ spl autoload ç›¸å…³çš„å‡½æ•°ä»¥åŠå„ç§æ•°æ®ç»“æ„å’Œè¿­ä»£å™¨çš„æ¥å£æˆ–ç±»ã€‚spl autoload ç›¸å…³çš„å‡½æ•°å…·ä½“å¯è§ phpä¸­spl_autoload
&lt;?php</p>

<p>// __autoload å‡½æ•°
//
// function __autoload($class) {
//     include â€˜classes/â€™ . $class . â€˜.class.phpâ€™;
// }</p>

<p>function my_autoloader($class) {
    include â€˜classes/â€™ . $class . â€˜.class.phpâ€™;
}</p>

<p>spl_autoload_register(â€˜my_autoloaderâ€™);</p>

<p>// å®šä¹‰çš„ autoload å‡½æ•°åœ¨ class é‡Œ</p>

<p>// é™æ€æ–¹æ³•
class MyClass {
  public static function autoload($className) {
    // â€¦
  }
}</p>

<p>spl_autoload_register(array(â€˜MyClassâ€™, â€˜autoloadâ€™));</p>

<p>// éé™æ€æ–¹æ³•
class MyClass {
  public function autoload($className) {
    // â€¦
  }
}</p>

<p>$instance = new MyClass();
spl_autoload_register(array($instance, â€˜autoloadâ€™));</p>

<p>spl_autoload_register() å°±æ˜¯æˆ‘ä»¬ä¸Šé¢æ‰€è¯´çš„__autoloadè°ƒç”¨å †æ ˆï¼Œæˆ‘ä»¬å¯ä»¥å‘è¿™ä¸ªå‡½æ•°æ³¨å†Œå¤šä¸ªæˆ‘ä»¬è‡ªå·±çš„ autoload() å‡½æ•°ï¼Œå½“ PHP æ‰¾ä¸åˆ°ç±»åæ—¶ï¼ŒPHPå°±ä¼šè°ƒç”¨è¿™ä¸ªå †æ ˆï¼Œç„¶åå»è°ƒç”¨è‡ªå®šä¹‰çš„ autoload() å‡½æ•°ï¼Œå®ç°è‡ªåŠ¨åŠ è½½åŠŸèƒ½ã€‚å¦‚æœæˆ‘ä»¬ä¸å‘è¿™ä¸ªå‡½æ•°è¾“å…¥ä»»ä½•å‚æ•°ï¼Œé‚£ä¹ˆå°±ä¼šé»˜è®¤æ³¨å†Œ spl_autoload() å‡½æ•°ã€‚</p>

<p>äºŒã€PSR è§„èŒƒ
ä¸è‡ªåŠ¨åŠ è½½ç›¸å…³çš„è§„èŒƒæ˜¯ PSR4ï¼Œåœ¨è¯´ PSR4 ä¹‹å‰å…ˆä»‹ç»ä¸€ä¸‹ PSR æ ‡å‡†ã€‚PSR æ ‡å‡†çš„å‘æ˜å’Œæ¨å‡ºç»„ç»‡æ˜¯ï¼šPHP-FIGï¼Œå®ƒçš„ç½‘ç«™æ˜¯ï¼šwww.php-fig.orgã€‚ç”±å‡ ä½å¼€æºæ¡†æ¶çš„å¼€å‘è€…æˆç«‹äº 2009 å¹´ï¼Œä»é‚£å¼€å§‹ä¹Ÿé€‰å–äº†å¾ˆå¤šå…¶ä»–æˆå‘˜è¿›æ¥ï¼Œè™½ç„¶ä¸æ˜¯ â€œå®˜æ–¹â€ ç»„ç»‡ï¼Œä½†ä¹Ÿä»£è¡¨äº†ç¤¾åŒºä¸­ä¸å°çš„ä¸€å—ã€‚ç»„ç»‡çš„ç›®çš„åœ¨äºï¼šä»¥æœ€ä½ç¨‹åº¦çš„é™åˆ¶ï¼Œæ¥ç»Ÿä¸€å„ä¸ªé¡¹ç›®çš„ç¼–ç è§„èŒƒï¼Œé¿å…å„å®¶è‡ªè¡Œå‘å±•çš„é£æ ¼é˜»ç¢äº†ç¨‹åºå‘˜å¼€å‘çš„å›°æ‰°ï¼Œäºæ˜¯å¤§ä¼™å‘æ˜å’Œæ€»ç»“äº† PSRï¼ŒPSR æ˜¯ PHP Standards Recommendation çš„ç¼©å†™ï¼Œæˆªæ­¢åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæ€»å…±æœ‰ 14 å¥— PSR è§„èŒƒï¼Œå…¶ä¸­æœ‰ 7 å¥—PSRè§„èŒƒå·²é€šè¿‡è¡¨å†³å¹¶æ¨å‡ºä½¿ç”¨ï¼Œåˆ†åˆ«æ˜¯ï¼š</p>

<p>PSR-0 è‡ªåŠ¨åŠ è½½æ ‡å‡†ï¼ˆå·²åºŸå¼ƒï¼Œä¸€äº›æ—§çš„ç¬¬ä¸‰æ–¹åº“è¿˜æœ‰åœ¨ä½¿ç”¨ï¼‰
PSR-1 åŸºç¡€ç¼–ç æ ‡å‡†</p>

<p>PSR-2 ç¼–ç é£æ ¼å‘å¯¼</p>

<p>PSR-3 æ—¥å¿—æ¥å£</p>

<p>PSR-4 è‡ªåŠ¨åŠ è½½çš„å¢å¼ºç‰ˆï¼Œæ›¿æ¢æ‰äº† PSR-0</p>

<p>PSR-6 ç¼“å­˜æ¥å£è§„èŒƒ</p>

<p>PSR-7 HTTP æ¶ˆæ¯æ¥å£è§„èŒƒ</p>

<p>å…·ä½“è¯¦ç»†çš„è§„èŒƒæ ‡å‡†å¯ä»¥æŸ¥çœ‹PHP æ ‡å‡†è§„èŒƒ</p>

<p>PSR4 æ ‡å‡†
2013 å¹´åº•ï¼ŒPHP-FIG æ¨å‡ºäº†ç¬¬ 5 ä¸ªè§„èŒƒâ€”â€”PSR-4ã€‚</p>

<p>PSR-4 è§„èŒƒäº†å¦‚ä½•æŒ‡å®šæ–‡ä»¶è·¯å¾„ä»è€Œè‡ªåŠ¨åŠ è½½ç±»å®šä¹‰ï¼ŒåŒæ—¶è§„èŒƒäº†è‡ªåŠ¨åŠ è½½æ–‡ä»¶çš„ä½ç½®ã€‚</p>

<p>1ï¼‰ä¸€ä¸ªå®Œæ•´çš„ç±»åéœ€å…·æœ‰ä»¥ä¸‹ç»“æ„ï¼š
&lt;å‘½åç©ºé—´&gt;&lt;å­å‘½åç©ºé—´&gt;&lt;ç±»å&gt;</p>

<p>å®Œæ•´çš„ç±»åå¿…é¡»è¦æœ‰ä¸€ä¸ªé¡¶çº§å‘½åç©ºé—´ï¼Œè¢«ç§°ä¸º â€œvendor namespaceâ€ï¼›
å®Œæ•´çš„ç±»åå¯ä»¥æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªå­å‘½åç©ºé—´ï¼›
å®Œæ•´çš„ç±»åå¿…é¡»æœ‰ä¸€ä¸ªæœ€ç»ˆçš„ç±»åï¼›
å®Œæ•´çš„ç±»åä¸­ä»»æ„ä¸€éƒ¨åˆ†ä¸­çš„ä¸‹æ»‘çº¿éƒ½æ˜¯æ²¡æœ‰ç‰¹æ®Šå«ä¹‰çš„ï¼›
å®Œæ•´çš„ç±»åå¯ä»¥ç”±ä»»æ„å¤§å°å†™å­—æ¯ç»„æˆï¼›
æ‰€æœ‰ç±»åéƒ½å¿…é¡»æ˜¯å¤§å°å†™æ•æ„Ÿçš„ã€‚
2ï¼‰æ ¹æ®å®Œæ•´çš„ç±»åè½½å…¥ç›¸åº”çš„æ–‡ä»¶
å®Œæ•´çš„ç±»åä¸­ï¼Œå»æ‰æœ€å‰é¢çš„å‘½åç©ºé—´åˆ†éš”ç¬¦ï¼Œå‰é¢è¿ç»­çš„ä¸€ä¸ªæˆ–å¤šä¸ªå‘½åç©ºé—´å’Œå­å‘½åç©ºé—´ï¼Œä½œä¸ºã€Œå‘½åç©ºé—´å‰ç¼€ã€ï¼Œå…¶å¿…é¡»ä¸è‡³å°‘ä¸€ä¸ªã€Œæ–‡ä»¶åŸºç›®å½•ã€ç›¸å¯¹åº”ï¼›
ç´§æ¥å‘½åç©ºé—´å‰ç¼€åçš„å­å‘½åç©ºé—´ å¿…é¡» ä¸ç›¸åº”çš„ã€Œæ–‡ä»¶åŸºç›®å½•ã€ç›¸åŒ¹é…ï¼Œå…¶ä¸­çš„å‘½åç©ºé—´åˆ†éš”ç¬¦å°†ä½œä¸ºç›®å½•åˆ†éš”ç¬¦ã€‚
æœ«å°¾çš„ç±»åå¿…é¡»ä¸å¯¹åº”çš„ä»¥ .php ä¸ºåç¼€çš„æ–‡ä»¶åŒåã€‚
è‡ªåŠ¨åŠ è½½å™¨ï¼ˆautoloaderï¼‰çš„å®ç°ä¸€å®šä¸å¯æŠ›å‡ºå¼‚å¸¸ã€ä¸€å®šä¸å¯è§¦å‘ä»»ä¸€çº§åˆ«çš„é”™è¯¯ä¿¡æ¯ä»¥åŠä¸åº”è¯¥æœ‰è¿”å›å€¼ã€‚
3) ä¾‹å­
PSR-4é£æ ¼</p>

<p>ç±»åï¼šZendAbc
å‘½åç©ºé—´å‰ç¼€ï¼šZend
æ–‡ä»¶åŸºç›®å½•ï¼š/usr/includes/Zend/
æ–‡ä»¶è·¯å¾„ï¼š/usr/includes/Zend/Abc.php
ç±»åï¼šSymfonyCoreRequest
å‘½åç©ºé—´å‰ç¼€ï¼šSymfonyCore
æ–‡ä»¶åŸºç›®å½•ï¼š./vendor/Symfony/Core/
æ–‡ä»¶è·¯å¾„ï¼š./vendor/Symfony/Core/Request.php
ç›®å½•ç»“æ„</p>

<p>-vendor/
| -vendor_name/
| | -package_name/
| | | -src/
| | | | -ClassName.php       # Vendor_Name\Package_Name\ClassName
| | | -tests/
| | | | -ClassNameTest.php   # Vendor_Name\Package_Name\ClassNameTest
Composerè‡ªåŠ¨åŠ è½½è¿‡ç¨‹
Composer åšäº†å“ªäº›äº‹æƒ…
ä½ æœ‰ä¸€ä¸ªé¡¹ç›®ä¾èµ–äºè‹¥å¹²ä¸ªåº“ã€‚
å…¶ä¸­ä¸€äº›åº“ä¾èµ–äºå…¶ä»–åº“ã€‚
ä½ å£°æ˜ä½ æ‰€ä¾èµ–çš„ä¸œè¥¿ã€‚
Composer ä¼šæ‰¾å‡ºå“ªä¸ªç‰ˆæœ¬çš„åŒ…éœ€è¦å®‰è£…ï¼Œå¹¶å®‰è£…å®ƒä»¬ï¼ˆå°†å®ƒä»¬ä¸‹è½½åˆ°ä½ çš„é¡¹ç›®ä¸­ï¼‰ã€‚
ä¾‹å¦‚ï¼Œä½ æ­£åœ¨åˆ›å»ºä¸€ä¸ªé¡¹ç›®ï¼Œéœ€è¦åšä¸€äº›å•å…ƒæµ‹è¯•ã€‚ä½ å†³å®šä½¿ç”¨ phpunit ã€‚ä¸ºäº†å°†å®ƒæ·»åŠ åˆ°ä½ çš„é¡¹ç›®ä¸­ï¼Œä½ æ‰€éœ€è¦åšçš„å°±æ˜¯åœ¨ composer.json æ–‡ä»¶é‡Œæè¿°é¡¹ç›®çš„ä¾èµ–å…³ç³»ã€‚</p>

<p>{
   â€œrequireâ€: {
     â€œphpunit/phpunitâ€:â€~6.0â€,
   }
 }
ç„¶ååœ¨ composer require ä¹‹åæˆ‘ä»¬åªè¦åœ¨é¡¹ç›®é‡Œé¢ç›´æ¥ use phpunit çš„ç±»å³å¯ä½¿ç”¨ã€‚</p>

<p>æ‰§è¡Œ composer require æ—¶å‘ç”Ÿäº†ä»€ä¹ˆ
composer ä¼šæ‰¾åˆ°ç¬¦åˆ PR4 è§„èŒƒçš„ç¬¬ä¸‰æ–¹åº“çš„æº
å°†å…¶åŠ è½½åˆ° vendor ç›®å½•ä¸‹
åˆå§‹åŒ–é¡¶çº§åŸŸåçš„æ˜ å°„å¹¶å†™å…¥åˆ°æŒ‡å®šçš„æ–‡ä»¶é‡Œ
ï¼ˆå¦‚ï¼šâ€™PHPUnit\Framework\Assertâ€™ =&gt; <strong>DIR</strong> . â€˜/..â€™ . â€˜/phpunit/phpunit/src/Framework/Assert.phpâ€™ï¼‰</p>

<p>å†™å¥½ä¸€ä¸ª autoload å‡½æ•°ï¼Œå¹¶ä¸”æ³¨å†Œåˆ° spl_autoload_register()é‡Œ
é¢˜å¤–è¯ï¼šç°åœ¨å¾ˆå¤šæ¡†æ¶éƒ½å·²ç»å¸®æˆ‘ä»¬å†™å¥½äº†é¡¶çº§åŸŸåæ˜ å°„äº†ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨æ¡†æ¶é‡Œé¢æ–°å»ºæ–‡ä»¶ï¼Œåœ¨æ–°å»ºçš„æ–‡ä»¶ä¸­å†™å¥½å‘½åç©ºé—´ï¼Œå°±å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹ use æˆ‘ä»¬çš„å‘½åç©ºé—´äº†ã€‚</p>

<p>Composer æºç åˆ†æ
ä¸‹é¢æˆ‘ä»¬é€šè¿‡å¯¹æºç çš„åˆ†ææ¥çœ‹çœ‹ composer æ˜¯å¦‚ä½•å®ç° PSR4æ ‡å‡† çš„è‡ªåŠ¨åŠ è½½åŠŸèƒ½ã€‚</p>

<p>å¾ˆå¤šæ¡†æ¶åœ¨åˆå§‹åŒ–çš„æ—¶å€™éƒ½ä¼šå¼•å…¥ composer æ¥ååŠ©è‡ªåŠ¨åŠ è½½çš„ï¼Œä»¥ Laravel ä¸ºä¾‹ï¼Œå®ƒå…¥å£æ–‡ä»¶ index.php ç¬¬ä¸€å¥å°±æ˜¯åˆ©ç”¨ composer æ¥å®ç°è‡ªåŠ¨åŠ è½½åŠŸèƒ½ã€‚</p>

<p>å¯åŠ¨
&lt;?php
  define(â€˜LARAVEL_STARTâ€™, microtime(true));</p>

<p>require <strong>DIR</strong> . â€˜/../vendor/autoload.phpâ€™;
å» vendor ç›®å½•ä¸‹çš„ autoload.php ï¼š</p>

<p>&lt;?php
  require_once <strong>DIR</strong> . â€˜/composerâ€™ . â€˜/autoload_real.phpâ€™;</p>

<p>return ComposerAutoloaderInit7b790917ce8899df9af8ed53631a1c29::getLoader();
è¿™é‡Œå°±æ˜¯ Composer çœŸæ­£å¼€å§‹çš„åœ°æ–¹äº†</p>

<p>Composerè‡ªåŠ¨åŠ è½½æ–‡ä»¶
é¦–å…ˆï¼Œæˆ‘ä»¬å…ˆå¤§è‡´äº†è§£ä¸€ä¸‹Composerè‡ªåŠ¨åŠ è½½æ‰€ç”¨åˆ°çš„æºæ–‡ä»¶ã€‚</p>

<p>autoload_real.php: è‡ªåŠ¨åŠ è½½åŠŸèƒ½çš„å¼•å¯¼ç±»ã€‚</p>

<p>composer åŠ è½½ç±»çš„åˆå§‹åŒ–(é¡¶çº§å‘½åç©ºé—´ä¸æ–‡ä»¶è·¯å¾„æ˜ å°„åˆå§‹åŒ–)å’Œæ³¨å†Œ(spl_autoload_register())ã€‚
ClassLoader.php : composer åŠ è½½ç±»ã€‚</p>

<p>composer è‡ªåŠ¨åŠ è½½åŠŸèƒ½çš„æ ¸å¿ƒç±»ã€‚
autoload_static.php : é¡¶çº§å‘½åç©ºé—´åˆå§‹åŒ–ç±»ï¼Œ</p>

<p>ç”¨äºç»™æ ¸å¿ƒç±»åˆå§‹åŒ–é¡¶çº§å‘½åç©ºé—´ã€‚
autoload_classmap.php : è‡ªåŠ¨åŠ è½½çš„æœ€ç®€å•å½¢å¼ï¼Œ</p>

<p>æœ‰å®Œæ•´çš„å‘½åç©ºé—´å’Œæ–‡ä»¶ç›®å½•çš„æ˜ å°„ï¼›
autoload_files.php : ç”¨äºåŠ è½½å…¨å±€å‡½æ•°çš„æ–‡ä»¶ï¼Œ</p>

<p>å­˜æ”¾å„ä¸ªå…¨å±€å‡½æ•°æ‰€åœ¨çš„æ–‡ä»¶è·¯å¾„åï¼›
autoload_namespaces.php : ç¬¦åˆ PSR0 æ ‡å‡†çš„è‡ªåŠ¨åŠ è½½æ–‡ä»¶ï¼Œ</p>

<p>å­˜æ”¾ç€é¡¶çº§å‘½åç©ºé—´ä¸æ–‡ä»¶çš„æ˜ å°„ï¼›
autoload_psr4.php : ç¬¦åˆ PSR4 æ ‡å‡†çš„è‡ªåŠ¨åŠ è½½æ–‡ä»¶ï¼Œ</p>

<p>å­˜æ”¾ç€é¡¶çº§å‘½åç©ºé—´ä¸æ–‡ä»¶çš„æ˜ å°„ï¼›
autoload_real å¼•å¯¼ç±»
åœ¨ vendor ç›®å½•ä¸‹çš„ autoload.php æ–‡ä»¶ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œç¨‹åºä¸»è¦è°ƒç”¨äº†å¼•å¯¼ç±»çš„é™æ€æ–¹æ³• getLoader() ï¼Œæˆ‘ä»¬æ¥ç€çœ‹çœ‹è¿™ä¸ªå‡½æ•°ã€‚</p>

<p>&lt;?php
    public static function getLoader()
    {
      if (null !== self::$loader) {
          return self::$loader;
      }</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  spl_autoload_register(
    array('ComposerAutoloaderInit7b790917ce8899df9af8ed53631a1c29', 'loadClassLoader'), true, true
  );

  self::$loader = $loader = new \Composer\Autoload\ClassLoader();

  spl_autoload_unregister(
    array('ComposerAutoloaderInit7b790917ce8899df9af8ed53631a1c29', 'loadClassLoader')
  );

  $useStaticLoader = PHP_VERSION_ID &gt;= 50600 &amp;&amp; !defined('HHVM_VERSION');

  if ($useStaticLoader) {
      require_once __DIR__ . '/autoload_static.php';

      call_user_func(
      \Composer\Autoload\ComposerStaticInit7b790917ce8899df9af8ed53631a1c29::getInitializer($loader)
      );

  } else {
      $map = require __DIR__ . '/autoload_namespaces.php';
      foreach ($map as $namespace =&gt; $path) {
          $loader-&gt;set($namespace, $path);
      }

      $map = require __DIR__ . '/autoload_psr4.php';
      foreach ($map as $namespace =&gt; $path) {
          $loader-&gt;setPsr4($namespace, $path);
      }

      $classMap = require __DIR__ . '/autoload_classmap.php';
      if ($classMap) {
          $loader-&gt;addClassMap($classMap);
      }
  }

  /***********************æ³¨å†Œè‡ªåŠ¨åŠ è½½æ ¸å¿ƒç±»å¯¹è±¡********************/
  $loader-&gt;register(true);

  /***********************è‡ªåŠ¨åŠ è½½å…¨å±€å‡½æ•°********************/
  if ($useStaticLoader) {
      $includeFiles = Composer\Autoload\ComposerStaticInit7b790917ce8899df9af8ed53631a1c29::$files;
  } else {
      $includeFiles = require __DIR__ . '/autoload_files.php';
  }

  foreach ($includeFiles as $fileIdentifier =&gt; $file) {
      composerRequire7b790917ce8899df9af8ed53631a1c29($fileIdentifier, $file);
  }

  return $loader;
} æˆ‘æŠŠè‡ªåŠ¨åŠ è½½å¼•å¯¼ç±»åˆ†ä¸º 5 ä¸ªéƒ¨åˆ†ã€‚
</code></pre></div></div>

<p>ç¬¬ä¸€éƒ¨åˆ†â€”â€”å•ä¾‹
ç¬¬ä¸€éƒ¨åˆ†å¾ˆç®€å•ï¼Œå°±æ˜¯ä¸ªæœ€ç»å…¸çš„å•ä¾‹æ¨¡å¼ï¼Œè‡ªåŠ¨åŠ è½½ç±»åªèƒ½æœ‰ä¸€ä¸ªã€‚</p>

<p>&lt;?php
  if (null !== self::$loader) {
      return self::$loader;
  }
ç¬¬äºŒéƒ¨åˆ†â€”â€”æ„é€ ClassLoaderæ ¸å¿ƒç±»
ç¬¬äºŒéƒ¨åˆ† new ä¸€ä¸ªè‡ªåŠ¨åŠ è½½çš„æ ¸å¿ƒç±»å¯¹è±¡ã€‚</p>

<p>&lt;?php
  /<strong>**</strong><strong>**</strong><strong>**</strong><strong>**<em>è·å¾—è‡ªåŠ¨åŠ è½½æ ¸å¿ƒç±»å¯¹è±¡</em></strong><strong>**</strong><strong>**</strong>*****/
  spl_autoload_register(
    array(â€˜ComposerAutoloaderInit7b790917ce8899df9af8ed53631a1c29â€™, â€˜loadClassLoaderâ€™), true, true
  );</p>

<p>self::$loader = $loader = new \Composer\Autoload\ClassLoader();</p>

<p>spl_autoload_unregister(
    array(â€˜ComposerAutoloaderInit7b790917ce8899df9af8ed53631a1c29â€™, â€˜loadClassLoaderâ€™)
  );
loadClassLoader()å‡½æ•°ï¼š</p>

<p>&lt;?php
public static function loadClassLoader($class)
{
    if (â€˜Composer\Autoload\ClassLoaderâ€™ === $class) {
        require <strong>DIR</strong> . â€˜/ClassLoader.phpâ€™;
    }
}
ä»ç¨‹åºé‡Œé¢æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œcomposer å…ˆå‘ PHP è‡ªåŠ¨åŠ è½½æœºåˆ¶æ³¨å†Œäº†ä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•° require äº† ClassLoader æ–‡ä»¶ã€‚æˆåŠŸ new å‡ºè¯¥æ–‡ä»¶ä¸­æ ¸å¿ƒç±» ClassLoader() åï¼Œåˆé”€æ¯äº†è¯¥å‡½æ•°ã€‚</p>

<p>ç¬¬ä¸‰éƒ¨åˆ† â€”â€” åˆå§‹åŒ–æ ¸å¿ƒç±»å¯¹è±¡
&lt;?php
  /<strong>**</strong><strong>**</strong><strong>**</strong><strong>**<em>åˆå§‹åŒ–è‡ªåŠ¨åŠ è½½æ ¸å¿ƒç±»å¯¹è±¡</em></strong><strong>**</strong><strong>**</strong>*****/
  $useStaticLoader = PHP_VERSION_ID &gt;= 50600 &amp;&amp; !defined(â€˜HHVM_VERSIONâ€™);
  if ($useStaticLoader) {
     require_once <strong>DIR</strong> . â€˜/autoload_static.phpâ€™;</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> call_user_func(
   \Composer\Autoload\ComposerStaticInit7b790917ce8899df9af8ed53631a1c29::getInitializer($loader)
 );   } else {
  $map = require __DIR__ . '/autoload_namespaces.php';
  foreach ($map as $namespace =&gt; $path) {
     $loader-&gt;set($namespace, $path);
  }

  $map = require __DIR__ . '/autoload_psr4.php';
  foreach ($map as $namespace =&gt; $path) {
     $loader-&gt;setPsr4($namespace, $path);
  }

  $classMap = require __DIR__ . '/autoload_classmap.php';
  if ($classMap) {
      $loader-&gt;addClassMap($classMap);
  }
}
</code></pre></div></div>

<p>è¿™ä¸€éƒ¨åˆ†å°±æ˜¯å¯¹è‡ªåŠ¨åŠ è½½ç±»çš„åˆå§‹åŒ–ï¼Œä¸»è¦æ˜¯ç»™è‡ªåŠ¨åŠ è½½æ ¸å¿ƒç±»åˆå§‹åŒ–é¡¶çº§å‘½åç©ºé—´æ˜ å°„ã€‚</p>

<p>åˆå§‹åŒ–çš„æ–¹æ³•æœ‰ä¸¤ç§ï¼š</p>

<ol>
  <li>ä½¿ç”¨ autoload_static è¿›è¡Œé™æ€åˆå§‹åŒ–ï¼›</li>
  <li>è°ƒç”¨æ ¸å¿ƒç±»æ¥å£åˆå§‹åŒ–ã€‚</li>
</ol>

<p>autoload_static é™æ€åˆå§‹åŒ– ( PHP &gt;= 5.6 )
é™æ€åˆå§‹åŒ–åªæ”¯æŒ PHP5.6 ä»¥ä¸Šç‰ˆæœ¬å¹¶ä¸”ä¸æ”¯æŒ HHVM è™šæ‹Ÿæœºã€‚æˆ‘ä»¬æ·±å…¥ autoload_static.php è¿™ä¸ªæ–‡ä»¶å‘ç°è¿™ä¸ªæ–‡ä»¶å®šä¹‰äº†ä¸€ä¸ªç”¨äºé™æ€åˆå§‹åŒ–çš„ç±»ï¼Œåå­—å« ComposerStaticInit7b790917ce8899df9af8ed53631a1c29ï¼Œä»ç„¶ä¸ºäº†é¿å…å†²çªè€ŒåŠ äº† hash å€¼ã€‚è¿™ä¸ªç±»å¾ˆç®€å•ï¼š</p>

<p>&lt;?php
  class ComposerStaticInit7b790917ce8899df9af8ed53631a1c29{
     public static $files = array(â€¦);
     public static $prefixLengthsPsr4 = array(â€¦);
     public static $prefixDirsPsr4 = array(â€¦);
     public static $prefixesPsr0 = array(â€¦);
     public static $classMap = array (â€¦);</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public static function getInitializer(ClassLoader $loader)
{
  return \Closure::bind(function () use ($loader) {
      $loader-&gt;prefixLengthsPsr4
                      = ComposerStaticInit7b790917ce8899df9af8ed53631a1c29::$prefixLengthsPsr4;

      $loader-&gt;prefixDirsPsr4
                      = ComposerStaticInit7b790917ce8899df9af8ed53631a1c29::$prefixDirsPsr4;

      $loader-&gt;prefixesPsr0
                      = ComposerStaticInit7b790917ce8899df9af8ed53631a1c29::$prefixesPsr0;

      $loader-&gt;classMap
                      = ComposerStaticInit7b790917ce8899df9af8ed53631a1c29::$classMap;

  }, null, ClassLoader::class);   } è¿™ä¸ªé™æ€åˆå§‹åŒ–ç±»çš„æ ¸å¿ƒå°±æ˜¯ getInitializer() å‡½æ•°ï¼Œå®ƒå°†è‡ªå·±ç±»ä¸­çš„é¡¶çº§å‘½åç©ºé—´æ˜ å°„ç»™äº† ClassLoader ç±»ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯è¿™ä¸ªå‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼ŸåŸå› å°±æ˜¯ ClassLoaderç±» ä¸­çš„ prefixLengthsPsr4 ã€prefixDirsPsr4ç­‰ç­‰å˜é‡éƒ½æ˜¯ privateçš„ã€‚åˆ©ç”¨åŒ¿åå‡½æ•°çš„ç»‘å®šåŠŸèƒ½å°±å¯ä»¥å°†è¿™äº› private å˜é‡èµ‹ç»™ ClassLoader ç±» é‡Œçš„æˆå‘˜å˜é‡ã€‚
</code></pre></div></div>

<p>å…³äºåŒ¿åå‡½æ•°çš„ç»‘å®šåŠŸèƒ½ã€‚</p>

<p>æ¥ä¸‹æ¥å°±æ˜¯å‘½åç©ºé—´åˆå§‹åŒ–çš„å…³é”®äº†ã€‚</p>

<p>classMapï¼ˆå‘½åç©ºé—´æ˜ å°„ï¼‰
&lt;?php
  public static $classMap = array (
      â€˜App\Console\Kernelâ€™
              =&gt; <strong>DIR</strong> . â€˜/../..â€™ . â€˜/app/Console/Kernel.phpâ€™,</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  'App\\Exceptions\\Handler'
          =&gt; __DIR__ . '/../..' . '/app/Exceptions/Handler.php',

  'App\\Http\\Controllers\\Auth\\ForgotPasswordController'
          =&gt; __DIR__ . '/../..' . '/app/Http/Controllers/Auth/ForgotPasswordController.php',

  'App\\Http\\Controllers\\Auth\\LoginController'
          =&gt; __DIR__ . '/../..' . '/app/Http/Controllers/Auth/LoginController.php',

  'App\\Http\\Controllers\\Auth\\RegisterController'
          =&gt; __DIR__ . '/../..' . '/app/Http/Controllers/Auth/RegisterController.php',   ...) ç›´æ¥å‘½åç©ºé—´å…¨åä¸ç›®å½•çš„æ˜ å°„ï¼Œç®€å•ç²—æš´ï¼Œä¹Ÿå¯¼è‡´è¿™ä¸ªæ•°ç»„ç›¸å½“çš„å¤§ã€‚
</code></pre></div></div>

<p>PSR4 æ ‡å‡†é¡¶çº§å‘½åç©ºé—´æ˜ å°„æ•°ç»„ï¼š
&lt;?php
  public static $prefixLengthsPsr4 = array(
      â€˜pâ€™ =&gt; array (
        â€˜phpDocumentor\Reflection\â€™ =&gt; 25,
    ),
      â€˜Sâ€™ =&gt; array (
        â€˜Symfony\Polyfill\Mbstring\â€™ =&gt; 26,
        â€˜Symfony\Component\Yaml\â€™ =&gt; 23,
        â€˜Symfony\Component\VarDumper\â€™ =&gt; 28,
        â€¦
    ),
  â€¦);</p>

<p>public static $prefixDirsPsr4 = array (
      â€˜phpDocumentor\Reflection\â€™ =&gt; array (
        0 =&gt; <strong>DIR</strong> . â€˜/..â€™ . â€˜/phpdocumentor/reflection-common/srcâ€™,
        1 =&gt; <strong>DIR</strong> . â€˜/..â€™ . â€˜/phpdocumentor/type-resolver/srcâ€™,
        2 =&gt; <strong>DIR</strong> . â€˜/..â€™ . â€˜/phpdocumentor/reflection-docblock/srcâ€™,
    ),
       â€˜Symfony\Polyfill\Mbstring\â€™ =&gt; array (
        0 =&gt; <strong>DIR</strong> . â€˜/..â€™ . â€˜/symfony/polyfill-mbstringâ€™,
    ),
      â€˜Symfony\Component\Yaml\â€™ =&gt; array (
        0 =&gt; <strong>DIR</strong> . â€˜/..â€™ . â€˜/symfony/yamlâ€™,
    ),
  â€¦)
PSR4 æ ‡å‡†é¡¶çº§å‘½åç©ºé—´æ˜ å°„ç”¨äº†ä¸¤ä¸ªæ•°ç»„ï¼Œç¬¬ä¸€ä¸ªæ˜¯ç”¨å‘½åç©ºé—´ç¬¬ä¸€ä¸ªå­—æ¯ä½œä¸ºå‰ç¼€ç´¢å¼•ï¼Œç„¶åæ˜¯ é¡¶çº§å‘½åç©ºé—´ï¼Œä½†æ˜¯æœ€ç»ˆå¹¶ä¸æ˜¯æ–‡ä»¶è·¯å¾„ï¼Œè€Œæ˜¯ é¡¶çº§å‘½åç©ºé—´çš„é•¿åº¦ã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p>

<p>å› ä¸º PSR4 æ ‡å‡†æ˜¯ç”¨é¡¶çº§å‘½åç©ºé—´ç›®å½•æ›¿æ¢é¡¶çº§å‘½åç©ºé—´ï¼Œæ‰€ä»¥è·å¾—é¡¶çº§å‘½åç©ºé—´çš„é•¿åº¦å¾ˆé‡è¦ã€‚</p>

<p>å…·ä½“è¯´æ˜è¿™äº›æ•°ç»„çš„ä½œç”¨ï¼š</p>

<p>å‡å¦‚æˆ‘ä»¬æ‰¾ Symfony\Polyfill\Mbstring\example è¿™ä¸ªå‘½åç©ºé—´ï¼Œé€šè¿‡å‰ç¼€ç´¢å¼•å’Œå­—ç¬¦ä¸²åŒ¹é…æˆ‘ä»¬å¾—åˆ°äº†</p>

<p>&lt;?php
    â€˜Symfony\Polyfill\Mbstring\â€™ =&gt; 26,
è¿™æ¡è®°å½•ï¼Œé”®æ˜¯é¡¶çº§å‘½åç©ºé—´ï¼Œå€¼æ˜¯å‘½åç©ºé—´çš„é•¿åº¦ã€‚æ‹¿åˆ°é¡¶çº§å‘½åç©ºé—´åå» $prefixDirsPsr4æ•°ç»„ è·å–å®ƒçš„æ˜ å°„ç›®å½•æ•°ç»„ï¼š(æ³¨æ„æ˜ å°„ç›®å½•å¯èƒ½ä¸æ­¢ä¸€æ¡)</p>

<p>&lt;?php
  â€˜Symfony\Polyfill\Mbstring\â€™ =&gt; array (
              0 =&gt; <strong>DIR</strong> . â€˜/..â€™ . â€˜/symfony/polyfill-mbstringâ€™,
          )
ç„¶åæˆ‘ä»¬å°±å¯ä»¥å°†å‘½åç©ºé—´ Symfony\Polyfill\Mbstring\example å‰26ä¸ªå­—ç¬¦æ›¿æ¢æˆç›®å½• <strong>DIR</strong> . â€˜/..â€™ . â€˜/symfony/polyfill-mbstring ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†__DIR__ . â€˜/..â€™ . â€˜/symfony/polyfill-mbstring/example.phpï¼Œå…ˆéªŒè¯ç£ç›˜ä¸Šè¿™ä¸ªæ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨æ¥ç€éå†ã€‚å¦‚æœéå†åæ²¡æœ‰æ‰¾åˆ°ï¼Œåˆ™åŠ è½½å¤±è´¥ã€‚</p>

<p>ClassLoader æ¥å£åˆå§‹åŒ–ï¼ˆ PHP &lt; 5.6 ï¼‰
å¦‚æœPHPç‰ˆæœ¬ä½äº 5.6 æˆ–è€…ä½¿ç”¨ HHVM è™šæ‹Ÿæœºç¯å¢ƒï¼Œé‚£ä¹ˆå°±è¦ä½¿ç”¨æ ¸å¿ƒç±»çš„æ¥å£è¿›è¡Œåˆå§‹åŒ–ã€‚</p>

<p>&lt;?php
    // PSR0 æ ‡å‡†
    $map = require <strong>DIR</strong> . â€˜/autoload_namespaces.phpâ€™;
    foreach ($map as $namespace =&gt; $path) {
       $loader-&gt;set($namespace, $path);
    }</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// PSR4 æ ‡å‡†
$map = require __DIR__ . '/autoload_psr4.php';
foreach ($map as $namespace =&gt; $path) {
   $loader-&gt;setPsr4($namespace, $path);
}

$classMap = require __DIR__ . '/autoload_classmap.php';
if ($classMap) {
   $loader-&gt;addClassMap($classMap);
} PSR4 æ ‡å‡†çš„æ˜ å°„ autoload_psr4.php çš„é¡¶çº§å‘½åç©ºé—´æ˜ å°„
</code></pre></div></div>

<p>&lt;?php
    return array(
    â€˜XdgBaseDir\â€™
        =&gt; array($vendorDir . â€˜/dnoegel/php-xdg-base-dir/srcâ€™),</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>'Webmozart\\Assert\\'
    =&gt; array($vendorDir . '/webmozart/assert/src'),

'TijsVerkoyen\\CssToInlineStyles\\'
    =&gt; array($vendorDir . '/tijsverkoyen/css-to-inline-styles/src'),

'Tests\\'
    =&gt; array($baseDir . '/tests'),

'Symfony\\Polyfill\\Mbstring\\'
    =&gt; array($vendorDir . '/symfony/polyfill-mbstring'),
...
) PSR4 æ ‡å‡†çš„åˆå§‹åŒ–æ¥å£:
</code></pre></div></div>

<p>&lt;?php
    public function setPsr4($prefix, $paths)
    {
        if (!$prefix) {
            $this-&gt;fallbackDirsPsr4 = (array) $paths;
        } else {
            $length = strlen($prefix);
            if (â€˜\â€™ !== $prefix[$length - 1]) {
                throw new \InvalidArgumentException(
                  â€œA non-empty PSR-4 prefix must end with a namespace separator.â€
                );
            }
            $this-&gt;prefixLengthsPsr4[$prefix[0]][$prefix] = $length;
            $this-&gt;prefixDirsPsr4[$prefix] = (array) $paths;
        }
    }
æ€»ç»“ä¸‹ä¸Šé¢çš„é¡¶çº§å‘½åç©ºé—´æ˜ å°„è¿‡ç¨‹ï¼š</p>

<p>( å‰ç¼€ -&gt; é¡¶çº§å‘½åç©ºé—´ï¼Œé¡¶çº§å‘½åç©ºé—´ -&gt; é¡¶çº§å‘½åç©ºé—´é•¿åº¦ )
( é¡¶çº§å‘½åç©ºé—´ -&gt; ç›®å½• )
è¿™ä¸¤ä¸ªæ˜ å°„æ•°ç»„ã€‚å…·ä½“å½¢å¼ä¹Ÿå¯ä»¥æŸ¥çœ‹ä¸‹é¢çš„ autoload_static çš„ $prefixLengthsPsr4 ã€ $prefixDirsPsr4 ã€‚</p>

<p>å‘½åç©ºé—´æ˜ å°„
autoload_classmapï¼š</p>

<p>&lt;?php
public static $classMap = array (
    â€˜App\Console\Kernelâ€™
        =&gt; <strong>DIR</strong> . â€˜/../..â€™ . â€˜/app/Console/Kernel.phpâ€™,</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>'App\\Exceptions\\Handler'
    =&gt; __DIR__ . '/../..' . '/app/Exceptions/Handler.php',
... ) addClassMap:
</code></pre></div></div>

<p>&lt;?php
    public function addClassMap(array $classMap)
    {
        if ($this-&gt;classMap) {
            $this-&gt;classMap = array_merge($this-&gt;classMap, $classMap);
        } else {
            $this-&gt;classMap = $classMap;
        }
    }
è‡ªåŠ¨åŠ è½½æ ¸å¿ƒç±» ClassLoader çš„é™æ€åˆå§‹åŒ–åˆ°è¿™é‡Œå°±å®Œæˆäº†ï¼</p>

<p>å…¶å®è¯´æ˜¯5éƒ¨åˆ†ï¼ŒçœŸæ­£é‡è¦çš„å°±ä¸¤éƒ¨åˆ†â€”â€”åˆå§‹åŒ–ä¸æ³¨å†Œã€‚åˆå§‹åŒ–è´Ÿè´£é¡¶å±‚å‘½åç©ºé—´çš„ç›®å½•æ˜ å°„ï¼Œæ³¨å†Œè´Ÿè´£å®ç°é¡¶å±‚ä»¥ä¸‹çš„å‘½åç©ºé—´æ˜ å°„è§„åˆ™ã€‚</p>

<p>ç¬¬å››éƒ¨åˆ† â€”â€” æ³¨å†Œ
è®²å®Œäº† Composer è‡ªåŠ¨åŠ è½½åŠŸèƒ½çš„å¯åŠ¨ä¸åˆå§‹åŒ–ï¼Œç»è¿‡å¯åŠ¨ä¸åˆå§‹åŒ–ï¼Œè‡ªåŠ¨åŠ è½½æ ¸å¿ƒç±»å¯¹è±¡å·²ç»è·å¾—äº†é¡¶çº§å‘½åç©ºé—´ä¸ç›¸åº”ç›®å½•çš„æ˜ å°„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæœ‰å‘½åç©ºé—´ â€˜App\Console\Kernelï¼Œæˆ‘ä»¬å·²ç»å¯ä»¥æ‰¾åˆ°å®ƒå¯¹åº”çš„ç±»æ–‡ä»¶æ‰€åœ¨ä½ç½®ã€‚é‚£ä¹ˆï¼Œå®ƒæ˜¯ä»€ä¹ˆæ—¶å€™è¢«è§¦å‘å»æ‰¾çš„å‘¢ï¼Ÿ</p>

<p>è¿™å°±æ˜¯ composer è‡ªåŠ¨åŠ è½½çš„æ ¸å¿ƒäº†ï¼Œæˆ‘ä»¬å…ˆå›é¡¾ä¸€ä¸‹è‡ªåŠ¨åŠ è½½å¼•å¯¼ç±»ï¼š</p>

<p>public static function getLoader()
 {
    /<strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong><em>ç»å…¸å•ä¾‹æ¨¡å¼</em></strong><strong>**</strong><strong>**</strong>*****/
    if (null !== self::$loader) {
        return self::$loader;
    }</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/***********************è·å¾—è‡ªåŠ¨åŠ è½½æ ¸å¿ƒç±»å¯¹è±¡********************/
spl_autoload_register(array('ComposerAutoloaderInit
7b790917ce8899df9af8ed53631a1c29', 'loadClassLoader'), true, true);

self::$loader = $loader = new \Composer\Autoload\ClassLoader();

spl_autoload_unregister(array('ComposerAutoloaderInit
7b790917ce8899df9af8ed53631a1c29', 'loadClassLoader'));

/***********************åˆå§‹åŒ–è‡ªåŠ¨åŠ è½½æ ¸å¿ƒç±»å¯¹è±¡********************/
$useStaticLoader = PHP_VERSION_ID &gt;= 50600 &amp;&amp; 
!defined('HHVM_VERSION');

if ($useStaticLoader) {
    require_once __DIR__ . '/autoload_static.php';

    call_user_func(\Composer\Autoload\ComposerStaticInit
    7b790917ce8899df9af8ed53631a1c29::getInitializer($loader));
  
} else {
    $map = require __DIR__ . '/autoload_namespaces.php';
    foreach ($map as $namespace =&gt; $path) {
        $loader-&gt;set($namespace, $path);
    }

    $map = require __DIR__ . '/autoload_psr4.php';
    foreach ($map as $namespace =&gt; $path) {
        $loader-&gt;setPsr4($namespace, $path);
    }

    $classMap = require __DIR__ . '/autoload_classmap.php';
    if ($classMap) {
        $loader-&gt;addClassMap($classMap);
    }
}

/***********************æ³¨å†Œè‡ªåŠ¨åŠ è½½æ ¸å¿ƒç±»å¯¹è±¡********************/
$loader-&gt;register(true);

/***********************è‡ªåŠ¨åŠ è½½å…¨å±€å‡½æ•°********************/
if ($useStaticLoader) {
    $includeFiles = Composer\Autoload\ComposerStaticInit
    7b790917ce8899df9af8ed53631a1c29::$files;
} else {
    $includeFiles = require __DIR__ . '/autoload_files.php';
}

foreach ($includeFiles as $fileIdentifier =&gt; $file) {
    composerRequire
    7b790917ce8899df9af8ed53631a1c29($fileIdentifier, $file);
}

return $loader; }  ç°åœ¨æˆ‘ä»¬å¼€å§‹å¼•å¯¼ç±»çš„ç¬¬å››éƒ¨åˆ†ï¼šæ³¨å†Œè‡ªåŠ¨åŠ è½½æ ¸å¿ƒç±»å¯¹è±¡ã€‚æˆ‘ä»¬æ¥çœ‹çœ‹æ ¸å¿ƒç±»çš„ register() å‡½æ•°ï¼š
</code></pre></div></div>

<p>public function register($prepend = false)
{
    spl_autoload_register(array($this, â€˜loadClassâ€™), true, $prepend);
}
å…¶å®å¥¥ç§˜éƒ½åœ¨è‡ªåŠ¨åŠ è½½æ ¸å¿ƒç±» ClassLoader çš„ loadClass() å‡½æ•°ä¸Šï¼š</p>

<p>public function loadClass($class)
    {
        if ($file = $this-&gt;findFile($class)) {
            includeFile($file);</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        return true;
    }
} è¿™ä¸ªå‡½æ•°è´Ÿè´£æŒ‰ç…§ PSR æ ‡å‡†å°†é¡¶å±‚å‘½åç©ºé—´ä»¥ä¸‹çš„å†…å®¹è½¬ä¸ºå¯¹åº”çš„ç›®å½•ï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢æ‰€è¯´çš„å°† 'App\Console\Kernel ä¸­' Console\Kernel è¿™ä¸€æ®µè½¬ä¸ºç›®å½•ï¼Œè‡³äºæ€ä¹ˆè½¬çš„åœ¨ä¸‹é¢ â€œè¿è¡Œâ€çš„éƒ¨åˆ†è®²ã€‚æ ¸å¿ƒç±» ClassLoader å°† loadClass() å‡½æ•°æ³¨å†Œåˆ°PHP SPLä¸­çš„ spl_autoload_register() é‡Œé¢å»ã€‚è¿™æ ·ï¼Œæ¯å½“PHPé‡åˆ°ä¸€ä¸ªä¸è®¤è¯†çš„å‘½åç©ºé—´çš„æ—¶å€™ï¼ŒPHPä¼šè‡ªåŠ¨è°ƒç”¨æ³¨å†Œåˆ° spl_autoload_register é‡Œé¢çš„ loadClass() å‡½æ•°ï¼Œç„¶åæ‰¾åˆ°å‘½åç©ºé—´å¯¹åº”çš„æ–‡ä»¶ã€‚
</code></pre></div></div>

<p>å…¨å±€å‡½æ•°çš„è‡ªåŠ¨åŠ è½½
Composer ä¸æ­¢å¯ä»¥è‡ªåŠ¨åŠ è½½å‘½åç©ºé—´ï¼Œè¿˜å¯ä»¥åŠ è½½å…¨å±€å‡½æ•°ã€‚æ€ä¹ˆå®ç°çš„å‘¢ï¼ŸæŠŠå…¨å±€å‡½æ•°å†™åˆ°ç‰¹å®šçš„æ–‡ä»¶é‡Œé¢å»ï¼Œåœ¨ç¨‹åºè¿è¡Œå‰æŒ¨ä¸ª requireå°±è¡Œäº†ã€‚è¿™ä¸ªå°±æ˜¯ composer è‡ªåŠ¨åŠ è½½çš„ç¬¬äº”æ­¥ï¼ŒåŠ è½½å…¨å±€å‡½æ•°ã€‚</p>

<p>if ($useStaticLoader) {
    $includeFiles = Composer\Autoload\ComposerStaticInit7b790917ce8899df9af8ed53631a1c29::$files;
} else {
    $includeFiles = require <strong>DIR</strong> . â€˜/autoload_files.phpâ€™;
}
foreach ($includeFiles as $fileIdentifier =&gt; $file) {
    composerRequire7b790917ce8899df9af8ed53631a1c29($fileIdentifier, $file);
}
è·Ÿæ ¸å¿ƒç±»çš„åˆå§‹åŒ–ä¸€æ ·ï¼Œå…¨å±€å‡½æ•°è‡ªåŠ¨åŠ è½½ä¹Ÿåˆ†ä¸ºä¸¤ç§ï¼šé™æ€åˆå§‹åŒ–å’Œæ™®é€šåˆå§‹åŒ–ï¼Œé™æ€åŠ è½½åªæ”¯æŒPHP5.6ä»¥ä¸Šå¹¶ä¸”ä¸æ”¯æŒHHVMã€‚</p>

<p>é™æ€åˆå§‹åŒ–ï¼š
ComposerStaticInit7b790917ce8899df9af8ed53631a1c29::$filesï¼š</p>

<p>public static $files = array (
â€˜0e6d7bf4a5811bfa5cf40c5ccd6fae6aâ€™ =&gt; <strong>DIR</strong> . â€˜/..â€™ . â€˜/symfony/polyfill-mbstring/bootstrap.phpâ€™,
â€˜667aeda72477189d0494fecd327c3641â€™ =&gt; <strong>DIR</strong> . â€˜/..â€™ . â€˜/symfony/var-dumper/Resources/functions/dump.phpâ€™,
â€¦
);
æ™®é€šåˆå§‹åŒ–
autoload_files:</p>

<p>$vendorDir = dirname(dirname(<strong>FILE</strong>));
$baseDir = dirname($vendorDir);</p>

<p>return array(
â€˜0e6d7bf4a5811bfa5cf40c5ccd6fae6aâ€™ =&gt; $vendorDir . â€˜/symfony/polyfill-mbstring/bootstrap.phpâ€™,
â€˜667aeda72477189d0494fecd327c3641â€™ =&gt; $vendorDir . â€˜/symfony/var-dumper/Resources/functions/dump.phpâ€™,
   â€¦.
);
å…¶å®è·Ÿé™æ€åˆå§‹åŒ–åŒºåˆ«ä¸å¤§ã€‚</p>

<p>åŠ è½½å…¨å±€å‡½æ•°
class ComposerAutoloaderInit7b790917ce8899df9af8ed53631a1c29{
  public static function getLoader(){
      â€¦
      foreach ($includeFiles as $fileIdentifier =&gt; $file) {
        composerRequire7b790917ce8899df9af8ed53631a1c29($fileIdentifier, $file);
      }
      â€¦
  }
}</p>

<p>function composerRequire7b790917ce8899df9af8ed53631a1c29($fileIdentifier, $file)
 {
    if (empty($GLOBALS[â€˜__composer_autoload_filesâ€™][$fileIdentifier])) {
        require $file;</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    $GLOBALS['__composer_autoload_files'][$fileIdentifier] = true;
} } ç¬¬äº”éƒ¨åˆ† â€”â€” è¿è¡Œ åˆ°è¿™é‡Œï¼Œç»ˆäºæ¥åˆ°äº†æ ¸å¿ƒçš„æ ¸å¿ƒâ€”â€” composer è‡ªåŠ¨åŠ è½½çš„çœŸç›¸ï¼Œå‘½åç©ºé—´å¦‚ä½•é€šè¿‡ composer è½¬ä¸ºå¯¹åº”ç›®å½•æ–‡ä»¶çš„å¥¥ç§˜å°±åœ¨è¿™ä¸€ç« ã€‚ å‰é¢è¯´è¿‡ï¼ŒClassLoader çš„ register() å‡½æ•°å°† loadClass() å‡½æ•°æ³¨å†Œåˆ° PHP çš„ SPL å‡½æ•°å †æ ˆä¸­ï¼Œæ¯å½“ PHP é‡åˆ°ä¸è®¤è¯†çš„å‘½åç©ºé—´æ—¶å°±ä¼šè°ƒç”¨å‡½æ•°å †æ ˆçš„æ¯ä¸ªå‡½æ•°ï¼Œç›´åˆ°åŠ è½½å‘½åç©ºé—´æˆåŠŸã€‚æ‰€ä»¥ loadClass() å‡½æ•°å°±æ˜¯è‡ªåŠ¨åŠ è½½çš„å…³é”®äº†ã€‚
</code></pre></div></div>

<p>çœ‹ä¸‹ loadClass() å‡½æ•°:</p>

<p>public function loadClass($class)
{
    if ($file = $this-&gt;findFile($class)) {
        includeFile($file);</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    return true;
} }
</code></pre></div></div>

<p>public function findFile($class)
{
    // work around for PHP 5.3.0 - 5.3.2 https://bugs.php.net/50731
    if (â€˜\â€™ == $class[0]) {
        $class = substr($class, 1);
    }</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// class map lookup
if (isset($this-&gt;classMap[$class])) {
    return $this-&gt;classMap[$class];
}
if ($this-&gt;classMapAuthoritative) {
    return false;
}

$file = $this-&gt;findFileWithExtension($class, '.php');

// Search for Hack files if we are running on HHVM
if ($file === null &amp;&amp; defined('HHVM_VERSION')) {
    $file = $this-&gt;findFileWithExtension($class, '.hh');
}

if ($file === null) {
    // Remember that this class does not exist.
    return $this-&gt;classMap[$class] = false;
}

return $file; } æˆ‘ä»¬çœ‹åˆ° loadClass() ï¼Œä¸»è¦è°ƒç”¨ findFile() å‡½æ•°ã€‚findFile() åœ¨è§£æå‘½åç©ºé—´çš„æ—¶å€™ä¸»è¦åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼šclassMap å’Œ findFileWithExtension() å‡½æ•°ã€‚classMap å¾ˆç®€å•ï¼Œç›´æ¥çœ‹å‘½åç©ºé—´æ˜¯å¦åœ¨æ˜ å°„æ•°ç»„ä¸­å³å¯ã€‚éº»çƒ¦çš„æ˜¯ findFileWithExtension() å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°åŒ…å«äº† PSR0 å’Œ PSR4 æ ‡å‡†çš„å®ç°ã€‚è¿˜æœ‰ä¸ªå€¼å¾—æˆ‘ä»¬æ³¨æ„çš„æ˜¯æŸ¥æ‰¾è·¯å¾„æˆåŠŸå includeFile() ä»ç„¶æ˜¯å¤–é¢çš„å‡½æ•°ï¼Œå¹¶ä¸æ˜¯ ClassLoader çš„æˆå‘˜å‡½æ•°ï¼ŒåŸç†è·Ÿä¸Šé¢ä¸€æ ·ï¼Œé˜²æ­¢æœ‰ç”¨æˆ·å†™ $this æˆ– selfã€‚è¿˜æœ‰å°±æ˜¯å¦‚æœå‘½åç©ºé—´æ˜¯ä»¥\å¼€å¤´çš„ï¼Œè¦å»æ‰\ç„¶åå†åŒ¹é…ã€‚
</code></pre></div></div>

<p>çœ‹ä¸‹ findFileWithExtension å‡½æ•°ï¼š</p>

<p>private function findFileWithExtension($class, $ext)
{
    // PSR-4 lookup
    $logicalPathPsr4 = strtr($class, â€˜\â€™, DIRECTORY_SEPARATOR) . $ext;</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$first = $class[0];
if (isset($this-&gt;prefixLengthsPsr4[$first])) {
    foreach ($this-&gt;prefixLengthsPsr4[$first] as $prefix =&gt; $length) {
        if (0 === strpos($class, $prefix)) {
            foreach ($this-&gt;prefixDirsPsr4[$prefix] as $dir) {
                if (file_exists($file = $dir . DIRECTORY_SEPARATOR . substr($logicalPathPsr4, $length))) {
                    return $file;
                }
            }
        }
    }
}

// PSR-4 fallback dirs
foreach ($this-&gt;fallbackDirsPsr4 as $dir) {
    if (file_exists($file = $dir . DIRECTORY_SEPARATOR . $logicalPathPsr4)) {
        return $file;
    }
}

// PSR-0 lookup
if (false !== $pos = strrpos($class, '\\')) {
    // namespaced class name
    $logicalPathPsr0 = substr($logicalPathPsr4, 0, $pos + 1)
        . strtr(substr($logicalPathPsr4, $pos + 1), '_', DIRECTORY_SEPARATOR);
} else {
    // PEAR-like class name
    $logicalPathPsr0 = strtr($class, '_', DIRECTORY_SEPARATOR) . $ext;
}

if (isset($this-&gt;prefixesPsr0[$first])) {
    foreach ($this-&gt;prefixesPsr0[$first] as $prefix =&gt; $dirs) {
        if (0 === strpos($class, $prefix)) {
            foreach ($dirs as $dir) {
                if (file_exists($file = $dir . DIRECTORY_SEPARATOR . $logicalPathPsr0)) {
                    return $file;
                }
            }
        }
    }
}

// PSR-0 fallback dirs
foreach ($this-&gt;fallbackDirsPsr0 as $dir) {
    if (file_exists($file = $dir . DIRECTORY_SEPARATOR . $logicalPathPsr0)) {
        return $file;
    }
}

// PSR-0 include paths.
if ($this-&gt;useIncludePath &amp;&amp; $file = stream_resolve_include_path($logicalPathPsr0)) {
    return $file;
} } æœ€åå°ç»“ æˆ‘ä»¬é€šè¿‡ä¸¾ä¾‹æ¥è¯´ä¸‹ä¸Šé¢ä»£ç çš„æµç¨‹ï¼š
</code></pre></div></div>

<p>å¦‚æœæˆ‘ä»¬åœ¨ä»£ç ä¸­å†™ä¸‹ new phpDocumentor\Reflection\Element()ï¼ŒPHP ä¼šé€šè¿‡ SPL_autoload_register è°ƒç”¨ loadClass -&gt; findFile -&gt; findFileWithExtensionã€‚æ­¥éª¤å¦‚ä¸‹ï¼š</p>

<p>å°† \ è½¬ä¸ºæ–‡ä»¶åˆ†éš”ç¬¦/ï¼ŒåŠ ä¸Šåç¼€phpï¼Œå˜æˆ $logicalPathPsr4, å³ phpDocumentor/Reflection//Element.php;
åˆ©ç”¨å‘½åç©ºé—´ç¬¬ä¸€ä¸ªå­—æ¯pä½œä¸ºå‰ç¼€ç´¢å¼•æœç´¢ prefixLengthsPsr4 æ•°ç»„ï¼ŒæŸ¥åˆ°ä¸‹é¢è¿™ä¸ªæ•°ç»„ï¼š
        pâ€™ =&gt; 
            array (
                â€˜phpDocumentor\Reflection\â€™ =&gt; 25,
                â€˜phpDocumentor\Fake\â€™ =&gt; 19,
          )
éå†è¿™ä¸ªæ•°ç»„ï¼Œå¾—åˆ°ä¸¤ä¸ªé¡¶å±‚å‘½åç©ºé—´ phpDocumentor\Reflection\ å’Œ phpDocumentor\Fake<br />
åœ¨è¿™ä¸ªæ•°ç»„ä¸­æŸ¥æ‰¾ phpDocumentor\Reflection\Elementï¼Œæ‰¾å‡º phpDocumentor\Reflection\ è¿™ä¸ªé¡¶å±‚å‘½åç©ºé—´å¹¶ä¸”é•¿åº¦ä¸º25ã€‚
åœ¨prefixDirsPsr4 æ˜ å°„æ•°ç»„ä¸­å¾—åˆ°phpDocumentor\Reflection\ çš„ç›®å½•æ˜ å°„ä¸ºï¼š
    â€˜phpDocumentor\Reflection\â€™ =&gt; 
        array (
            0 =&gt; <strong>DIR</strong> . â€˜/..â€™ . â€˜/phpdocumentor/reflection-common/srcâ€™,
            1 =&gt; <strong>DIR</strong> . â€˜/..â€™ . â€˜/phpdocumentor/type-resolver/srcâ€™,
            2 =&gt; <strong>DIR</strong> . â€˜/..â€™ . â€˜/phpdocumentor/reflection-docblock/srcâ€™,
        ),
éå†è¿™ä¸ªæ˜ å°„æ•°ç»„ï¼Œå¾—åˆ°ä¸‰ä¸ªç›®å½•æ˜ å°„ï¼›
æŸ¥çœ‹ â€œç›®å½•+æ–‡ä»¶åˆ†éš”ç¬¦//+substr(&amp;dollar;logicalPathPsr4, &amp;dollar;length)â€æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œå­˜åœ¨å³è¿”å›ã€‚è¿™é‡Œå°±æ˜¯
â€˜<strong>DIR</strong>/../phpdocumentor/reflection-common/src + substr(phpDocumentor/Reflection/Element.php,25)â€™
å¦‚æœå¤±è´¥ï¼Œåˆ™åˆ©ç”¨ fallbackDirsPsr4 æ•°ç»„é‡Œé¢çš„ç›®å½•ç»§ç»­åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ–‡ä»¶</p>

<p>https://segmentfault.com/a/1190000014948542?utm_source=tag-newest</p>
:ET