I"š<p>æŸäº›åœºæ™¯æˆ‘ä»¬éœ€è¦è·å–å®¢æˆ·ç«¯çš„ipï¼Œæ¯”å¦‚åŸ‹ç‚¹ã€åä½œå¼Šã€å®¡è®¡ç­‰ç­‰</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ip := net.ParseIP(ctx.ClientIP())
ip = ip.To4()
ipInt32 := binary.BigEndian.Uint32(ip)
</code></pre></div></div>
<p>ä¸Šé¢è¿™æ®µä»£ç ä¹çœ‹æ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯å®é™…åº”ç”¨ä¸­å¯èƒ½panic
<!-- more -->
æˆ‘ä»¬æ¥çœ‹ä¸‹echoä¸­ç›¸å…³å‡½æ•°çš„å®ç°</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>func (c *Context) ClientIP() string {
	if c.engine.ForwardedByClientIP {
		clientIP := c.requestHeader("X-Forwarded-For")
		clientIP = strings.TrimSpace(strings.Split(clientIP, ",")[0])
		if clientIP == "" {
			clientIP = strings.TrimSpace(c.requestHeader("X-Real-Ip"))
		}
		if clientIP != "" {
			return clientIP
		}
	}
</code></pre></div></div>
<p>è¿™é‡Œç›´æ¥é€šè¿‡é€—å·åˆ†éš”X-Forwarded-Forï¼Œå–ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä¼—æ‰€å‘¨çŸ¥X-Forwarded-Foræ˜¯å¯ä»¥ç¯¡æ”¹çš„ï¼Œå¦‚æœç”¨æˆ·ä¸éµå®ˆä»£ç†åè®®ï¼ŒæŠŠç¬¬ä¸€ä¸ªipåœ°å€å†™æˆéæ³•çš„ipåœ°å€ï¼Œæ¯”å¦‚ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆè¿™ä¸ªå‡½æ•°è¿”å›çš„å°±æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²</p>
:ET