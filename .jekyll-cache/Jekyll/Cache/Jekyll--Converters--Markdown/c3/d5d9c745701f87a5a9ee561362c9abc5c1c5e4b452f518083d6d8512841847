I"ü<p>https://gocn.vip/topics/10626</p>

<p>è¯»å–å®Œ http.Response çš„ Bodyå¹¶å…³é—­å®ƒï¼Œå¦åˆ™ä¸ä¼šé‡ç”¨åº•å±‚çš„ TCP è¿æ¥ã€‚æˆ‘æƒ³äº†æƒ³ä¸ºä»€ä¹ˆå®ƒè¿™é‡Œä¸€å®šè¦ç‰¹åˆ«æå‡ºæ¥å‘¢ï¼Ÿå…³é—­ http.Response ä¸æ˜¯ä¸€ä¸ªå¸¸è¯†æ€§åŠ¨ä½œä¹ˆï¼Ÿæ¯”å¦‚ä¸€èˆ¬å†™ä»£ç æˆ‘ä»¬éƒ½ä¼šéµå¾ªä¸‹é¢çš„æ¨¡å¼ï¼š</p>

<p>resp, err := http.Get(â€œhttp://www.example.comâ€)
if err != nil {
    return err
}
defer resp.Body.Close()</p>

<p>respBody, err := ioutil.ReadAll(resp.Body)
// â€¦
åœ¨ç»“åˆå®é™…çš„åœºæ™¯ä¹‹åï¼Œæˆ‘å‘ç°å…¶å®æœ‰çš„æ—¶å€™é—®é¢˜å‡ºåœ¨æˆ‘ä»¬å¹¶ä¸æ€»æ˜¯ä¼šå»è¯»å–å®Œæ•´ä¸ªhttp.Response çš„ Bodyã€‚ä¸ºä»€ä¹ˆè¿™ä¹ˆè¯´å‘¢ï¼Ÿ</p>

<p>åœ¨å¸¸è§çš„ API å¼€å‘çš„ä¸šåŠ¡é€»è¾‘ä¸­ï¼Œæˆ‘ä»¬ä¼šå®šä¹‰ä¸€ä¸ª JSON çš„å¯¹è±¡æ¥ååºåˆ—åŒ– http.Response çš„ Bodyï¼Œä½†æ˜¯é€šå¸¸åœ¨ååºåˆ—åŒ–è¿™ä¸ªå›å¤ä¹‹å‰ï¼Œæˆ‘ä»¬ä¼šåšä¸€äº› http çš„ StatusCode æ£€æŸ¥ï¼Œæ¯”å¦‚å½“ StatusCode ä¸º 200 çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ‰å»è¯»å– http.Response çš„ Bodyï¼Œå¦‚æœä¸æ˜¯ 200ï¼Œæˆ‘ä»¬å°±ç›´æ¥è¿”å›ä¸€ä¸ªåŒ…è£…å¥½çš„é”™è¯¯ã€‚æ¯”å¦‚ä¸‹é¢çš„æ¨¡å¼ï¼š</p>

<p>resp, err := http.Get(â€œhttp://www.example.comâ€)
if err != nil {
    return err
}
defer resp.Body.Close()</p>

<p>if resp.StatusCode == http.StatusOK {
    var apiRet APIRet
    decoder := json.NewDecoder(resp.Body)
    err := decoder.Decode(&amp;apiRet)
    // â€¦
}
å¦‚æœä»£ç æ˜¯æŒ‰ç…§ä¸Šé¢çš„è¿™ç§æ–¹å¼å†™çš„è¯ï¼Œé‚£ä¹ˆåœ¨è¯·æ±‚å¼‚å¸¸çš„æ—¶å€™ï¼Œä¼šå¯¼è‡´å¤§é‡çš„åº•å±‚ TCP æ— æ³•é‡ç”¨ï¼Œæ‰€ä»¥æˆ‘ä»¬ç¨å¾®æ”¹è¿›ä¸‹å°±å¯ä»¥äº†ã€‚</p>

<p>resp, err := http.Get(â€œhttp://www.example.comâ€)
if err != nil {
    return err
}
defer resp.Body.Close()</p>

<p>if resp.StatusCode == http.StatusOK {
    var apiRet APIRet
    decoder := json.NewDecoder(resp.Body)
    err := decoder.Decode(&amp;apiRet)
    // â€¦
}else{
    io.Copy(ioutil.Discard, resp.Body)
    // â€¦
}
æˆ‘ä»¬é€šè¿‡ç›´æ¥å°† http.Response çš„ Body ä¸¢å¼ƒæ‰å°±å¯ä»¥äº†ã€‚</p>

<p>åŸå› 
åœ¨ Go çš„æºç ä¸­ï¼Œå…³äºè¿™ä¸ªé—®é¢˜æœ‰ç‰¹åˆ«çš„æ³¨é‡Šã€‚</p>

<p>// Body represents the response body.
//
// The response body is streamed on demand as the Body field
// is read. If the network connection fails or the server
// terminates the response, Body.Read calls return an error.
//
// The http Client and Transport guarantee that Body is always
// non-nil, even on responses without a body or responses with
// a zero-length body. It is the callerâ€™s responsibility to
// close Body. The default HTTP clientâ€™s Transport may not
// reuse HTTP/1.x â€œkeep-aliveâ€ TCP connections if the Body is
// not read to completion and closed.
//
// The Body is automatically dechunked if the server replied
// with a â€œchunkedâ€ Transfer-Encoding.
//
// As of Go 1.12, the Body will also implement io.Writer
// on a successful â€œ101 Switching Protocolsâ€ response,
// as used by WebSockets and HTTP/2â€™s â€œh2câ€ mode.
Body io.ReadCloser
å…¶ä¸­æåˆ°äº†å¿…é¡»å°† http.Response çš„ Body è¯»å–å®Œæ¯•å¹¶ä¸”å…³é—­åï¼Œæ‰ä¼šé‡ç”¨åº•å±‚çš„ TCP è¿æ¥ã€‚
<!-- more -->
https://github.com/webtao520/golang_project/tree/master/%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81context%E5%8C%85</p>

<p>https://www.digitalocean.com/community/books/how-to-code-in-go-ebook</p>

<p>https://mp.weixin.qq.com/s/BkVEuPGDPxYd1xQ_2YrHxQ</p>

<p>https://go.googlesource.com/proposal/+/master/design/draft-gobuild.md</p>
:ET