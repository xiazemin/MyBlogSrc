I"»<p>Express æ˜¯ä¸€ä¸ªç®€æ´è€Œçµæ´»çš„ node.js Webåº”ç”¨æ¡†æ¶, æä¾›äº†ä¸€ç³»åˆ—å¼ºå¤§ç‰¹æ€§å¸®åŠ©ä½ åˆ›å»ºå„ç§ Web åº”ç”¨ï¼Œå’Œä¸°å¯Œçš„ HTTP å·¥å…·ã€‚</p>

<p>ä½¿ç”¨ Express å¯ä»¥å¿«é€Ÿåœ°æ­å»ºä¸€ä¸ªå®Œæ•´åŠŸèƒ½çš„ç½‘ç«™ã€‚</p>

<p>Express æ¡†æ¶æ ¸å¿ƒç‰¹æ€§ï¼š</p>

<p>å¯ä»¥è®¾ç½®ä¸­é—´ä»¶æ¥å“åº” HTTP è¯·æ±‚ã€‚</p>

<p>å®šä¹‰äº†è·¯ç”±è¡¨ç”¨äºæ‰§è¡Œä¸åŒçš„ HTTP è¯·æ±‚åŠ¨ä½œã€‚</p>

<p>å¯ä»¥é€šè¿‡å‘æ¨¡æ¿ä¼ é€’å‚æ•°æ¥åŠ¨æ€æ¸²æŸ“ HTML é¡µé¢ã€‚
<!-- more -->
npm install -g cnpm â€“registry=https://registry.npm.taobao.org</p>

<p>cnpm install express â€“save
ä»¥ä¸Šå‘½ä»¤ä¼šå°† Express æ¡†æ¶å®‰è£…åœ¨å½“å‰ç›®å½•çš„ node_modules ç›®å½•ä¸­ï¼Œ node_modules ç›®å½•ä¸‹ä¼šè‡ªåŠ¨åˆ›å»º express ç›®å½•ã€‚ä»¥ä¸‹å‡ ä¸ªé‡è¦çš„æ¨¡å—æ˜¯éœ€è¦ä¸ express æ¡†æ¶ä¸€èµ·å®‰è£…çš„ï¼š</p>

<p>body-parser - node.js ä¸­é—´ä»¶ï¼Œç”¨äºå¤„ç† JSON, Raw, Text å’Œ URL ç¼–ç çš„æ•°æ®ã€‚</p>

<p>cookie-parser - è¿™å°±æ˜¯ä¸€ä¸ªè§£æCookieçš„å·¥å…·ã€‚é€šè¿‡req.cookieså¯ä»¥å–åˆ°ä¼ è¿‡æ¥çš„cookieï¼Œå¹¶æŠŠå®ƒä»¬è½¬æˆå¯¹è±¡ã€‚</p>

<p>multer - node.js ä¸­é—´ä»¶ï¼Œç”¨äºå¤„ç† enctype=â€multipart/form-dataâ€ï¼ˆè®¾ç½®è¡¨å•çš„MIMEç¼–ç ï¼‰çš„è¡¨å•æ•°æ®ã€‚</p>

<p>å¹¶å°†å…¶ä¿å­˜åˆ°ä¾èµ–åˆ—è¡¨ä¸­ï¼š â€“save</p>

<p>cnpm install express -g â€“save
 cnpm install body-parser -g â€“save
 cnpm install cookie-parser -g â€“save
 cnpm install multer -g â€“save</p>

<p>$ ls
client.js	node_modules	server.js
$ ls node_modules/
_body-parser@1.19.0@body-parser		body-parser
_bytes@3.1.0@bytes			bytes
_content-type@1.0.4@content-type	content-type</p>

<p>$ cnpm list express
/Users/xiazemin/node.js/http/post
â””â”€â”€ (empty)</p>

<p>$ cnpm install express â€“save
âœ” Installed 1 packages
âœ” Linked 41 latest versions
âœ” Run 0 scripts
âœ” All packages installed (30 packages installed from npm registry, used 2s(network 2s), speed 147.7kB/s, json 42(105.25kB), tarball 148.8kB)
bogon:post xiazemin$ cnpm list express
/Users/xiazemin/node.js/http/post
â””â”€â”€ express@4.17.1  -&gt; /Users/xiazemin/node.js/http/post/node_modules/_express@4.17.1@express</p>

<p>$ npm list -g â€“depth 0
/usr/local/lib
â”œâ”€â”€ body-parser@1.19.0
â”œâ”€â”€ browserify@17.0.0
â”œâ”€â”€ cnpm@6.1.1
â”œâ”€â”€ cookie-parser@1.4.5
â”œâ”€â”€ express@4.17.1
â”œâ”€â”€ multer@1.4.2
â””â”€â”€ npm@7.4.0</p>

<p>$ npm list -g express â€“depth 0
/usr/local/lib
â””â”€â”€ express@4.17.1</p>

<p>$ cnpm list -g express â€“depth 0
/usr/local/Cellar/node/15.3.0/lib
â””â”€â”€ (empty)</p>

<p>bogon:express xiazemin$ npm list -g express
/usr/local/lib
â””â”€â”€ express@4.17.1</p>

<p>æ³¨æ„cnpm å’Œnpmçš„åŒºåˆ«</p>

<p>1.å…¨å±€å®‰è£…expressæ¡†æ¶,cmdæ‰“å¼€å‘½ä»¤è¡Œ,è¾“å…¥å¦‚ä¸‹å‘½ä»¤:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    npm install -g express
</code></pre></div></div>

<p>express 4.xç‰ˆæœ¬ä¸­å°†å‘½ä»¤å·¥å…·åˆ†å‡ºæ¥,å®‰è£…ä¸€ä¸ªå‘½ä»¤å·¥å…·,æ‰§è¡Œå‘½ä»¤:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    npm install -g express-generator

 è¾“å…¥express --versionéªŒè¯
</code></pre></div></div>

<p>2.å¦‚æœåœ¨æ‰§è¡Œjsæ–‡ä»¶ä»æŠ¥Error: Cannot find module expressé”™è¯¯ã€‚</p>

<p>è§£å†³åŠæ³•ï¼š
    åœ¨è‡ªå·±çš„å·¥ç¨‹ç›®å½•ä¸‹å†æ¬¡æ‰§è¡Œ:
        npm  install express</p>

<p>The reason for this is that applications always look in their local context for any dependencies. The global installation is only for setting up system-wide available binaries, such as unit test runners or bootstrappers or things like that.</p>

<p>With Express, when you install it globally, you get an express binary that can bootstrap an application for you. For more information, type</p>

<p>$ express â€“help
So, to answer your final question: YES, you need to install it without -g.</p>

<p>https://stackoverflow.com/questions/17162308/node-js-error-cannot-find-module-express</p>

<p>if your node_modules directory is in another place, set NODE_PATH envirnment variable:</p>

<p>set NODE_PATH=your\directory\to\node_modules;%NODE_PATH%</p>

<p>$ ln -s /usr/local/lib/node_modules $(pwd)
 é—®é¢˜è§£å†³
 https://stackoverflow.com/questions/17162308/node-js-error-cannot-find-module-express</p>

<p>req.pathï¼šè·å–è¯·æ±‚è·¯å¾„
req.protocolï¼šè·å–åè®®ç±»å‹
req.queryï¼šè·å–URLçš„æŸ¥è¯¢å‚æ•°ä¸²
req.routeï¼šè·å–å½“å‰åŒ¹é…çš„è·¯ç”±
req.subdomainsï¼šè·å–å­åŸŸå
req.accepts()ï¼šæ£€æŸ¥å¯æ¥å—çš„è¯·æ±‚çš„æ–‡æ¡£ç±»å‹
req.acceptsCharsets / req.acceptsEncodings / req.acceptsLanguagesï¼šè¿”å›æŒ‡å®šå­—ç¬¦é›†çš„ç¬¬ä¸€ä¸ªå¯æ¥å—å­—ç¬¦ç¼–ç 
req.get()ï¼šè·å–æŒ‡å®šçš„HTTPè¯·æ±‚å¤´
req.is()ï¼šåˆ¤æ–­è¯·æ±‚å¤´Content-Typeçš„MIMEç±»å‹
Response å¯¹è±¡ - response å¯¹è±¡è¡¨ç¤º HTTP å“åº”ï¼Œå³åœ¨æ¥æ”¶åˆ°è¯·æ±‚æ—¶å‘å®¢æˆ·ç«¯å‘é€çš„ HTTP å“åº”æ•°æ®ã€‚å¸¸è§å±æ€§æœ‰ï¼š</p>

<p>res.appï¼šåŒreq.appä¸€æ ·
res.append()ï¼šè¿½åŠ æŒ‡å®šHTTPå¤´
res.set()åœ¨res.append()åå°†é‡ç½®ä¹‹å‰è®¾ç½®çš„å¤´
res.cookie(nameï¼Œvalue [ï¼Œoption])ï¼šè®¾ç½®Cookie
opition: domain / expires / httpOnly / maxAge / path / secure / signed
res.clearCookie()ï¼šæ¸…é™¤Cookie
res.download()ï¼šä¼ é€æŒ‡å®šè·¯å¾„çš„æ–‡ä»¶
res.get()ï¼šè¿”å›æŒ‡å®šçš„HTTPå¤´
res.json()ï¼šä¼ é€JSONå“åº”
res.jsonp()ï¼šä¼ é€JSONPå“åº”
res.location()ï¼šåªè®¾ç½®å“åº”çš„Location HTTPå¤´ï¼Œä¸è®¾ç½®çŠ¶æ€ç æˆ–è€…close response
res.redirect()ï¼šè®¾ç½®å“åº”çš„Location HTTPå¤´ï¼Œå¹¶ä¸”è®¾ç½®çŠ¶æ€ç 302
res.render(view,[locals],callback)ï¼šæ¸²æŸ“ä¸€ä¸ªviewï¼ŒåŒæ—¶å‘callbackä¼ é€’æ¸²æŸ“åçš„å­—ç¬¦ä¸²ï¼Œå¦‚æœåœ¨æ¸²æŸ“è¿‡ç¨‹ä¸­æœ‰é”™è¯¯å‘ç”Ÿnext(err)å°†ä¼šè¢«è‡ªåŠ¨è°ƒç”¨ã€‚callbackå°†ä¼šè¢«ä¼ å…¥ä¸€ä¸ªå¯èƒ½å‘ç”Ÿçš„é”™è¯¯ä»¥åŠæ¸²æŸ“åçš„é¡µé¢ï¼Œè¿™æ ·å°±ä¸ä¼šè‡ªåŠ¨è¾“å‡ºäº†ã€‚
res.send()ï¼šä¼ é€HTTPå“åº”
res.sendFile(path [ï¼Œoptions] [ï¼Œfn])ï¼šä¼ é€æŒ‡å®šè·¯å¾„çš„æ–‡ä»¶ -ä¼šè‡ªåŠ¨æ ¹æ®æ–‡ä»¶extensionè®¾å®šContent-Type
res.set()ï¼šè®¾ç½®HTTPå¤´ï¼Œä¼ å…¥objectå¯ä»¥ä¸€æ¬¡è®¾ç½®å¤šä¸ªå¤´
res.status()ï¼šè®¾ç½®HTTPçŠ¶æ€ç 
res.type()ï¼šè®¾ç½®Content-Typeçš„MIMEç±»å‹
è·¯ç”±
æˆ‘ä»¬å·²ç»äº†è§£äº† HTTP è¯·æ±‚çš„åŸºæœ¬åº”ç”¨ï¼Œè€Œè·¯ç”±å†³å®šäº†ç”±è°(æŒ‡å®šè„šæœ¬)å»å“åº”å®¢æˆ·ç«¯è¯·æ±‚ã€‚</p>

<p>åœ¨HTTPè¯·æ±‚ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è·¯ç”±æå–å‡ºè¯·æ±‚çš„URLä»¥åŠGET/POSTå‚æ•°ã€‚
app.get(â€˜/ab*cdâ€™, function(req, res) {  });
Express æä¾›äº†å†…ç½®çš„ä¸­é—´ä»¶ express.static æ¥è®¾ç½®é™æ€æ–‡ä»¶å¦‚ï¼šå›¾ç‰‡ï¼Œ CSS, JavaScript ç­‰ã€‚</p>

<p>ä½ å¯ä»¥ä½¿ç”¨ express.static ä¸­é—´ä»¶æ¥è®¾ç½®é™æ€æ–‡ä»¶è·¯å¾„ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ å°†å›¾ç‰‡ï¼Œ CSS, JavaScript æ–‡ä»¶æ”¾åœ¨ public ç›®å½•ä¸‹ï¼Œä½ å¯ä»¥è¿™ä¹ˆå†™ï¼š</p>

<p>app.use(â€˜/publicâ€™, express.static(â€˜publicâ€™));</p>

:ET