I"Ó	<p>Knuth-Morris-Pratt å­—ç¬¦ä¸²æŸ¥æ‰¾ç®—æ³•ï¼Œç®€ç§°ä¸º KMPç®—æ³•ï¼Œå¸¸ç”¨äºåœ¨ä¸€ä¸ªæ–‡æœ¬ä¸² S å†…æŸ¥æ‰¾ä¸€ä¸ªæ¨¡å¼ä¸² P çš„å‡ºç°ä½ç½®ã€‚
è¿™ä¸ªç®—æ³•ç”± Donald Knuthã€Vaughan Prattã€James H. Morris ä¸‰äººäº 1977 å¹´è”åˆå‘è¡¨ï¼Œæ•…å–è¿™ 3 äººçš„å§“æ°å‘½åæ­¤ç®—æ³•ã€‚
ä¸‹é¢ç›´æ¥ç»™å‡º KMPç®—æ³• çš„æ“ä½œæµç¨‹ï¼š
1.å‡è®¾ç°åœ¨æ–‡æœ¬ä¸² S åŒ¹é…åˆ° i ä½ç½®ï¼Œæ¨¡å¼ä¸² P åŒ¹é…åˆ° j ä½ç½®ã€‚
2.å¦‚æœ j = -1ï¼Œæˆ–è€…å½“å‰å­—ç¬¦åŒ¹é…æˆåŠŸï¼ˆå³ S[i] == P[j] ï¼‰ï¼Œéƒ½ä»¤ i++ï¼Œj++ï¼Œç»§ç»­åŒ¹é…ä¸‹ä¸€ä¸ªå­—ç¬¦ã€‚
3.å¦‚æœ j != -1ï¼Œä¸”å½“å‰å­—ç¬¦åŒ¹é…å¤±è´¥ï¼ˆå³ S[i] != P[j] ï¼‰ï¼Œåˆ™ä»¤ i ä¸å˜ï¼Œj = next[j]ã€‚æ­¤ä¸¾æ„å‘³ç€å¤±é…æ—¶ï¼Œæ¨¡å¼ä¸² Pç›¸å¯¹äºæ–‡æœ¬ä¸² S å‘å³ç§»åŠ¨äº† j - next [j] ä½ã€‚
4.æ¢è¨€ä¹‹ï¼Œå°†æ¨¡å¼ä¸² P å¤±é…ä½ç½®çš„ next æ•°ç»„çš„å€¼å¯¹åº”çš„æ¨¡å¼ä¸² P çš„ç´¢å¼•ä½ç½®ç§»åŠ¨åˆ°å¤±é…å¤„ã€‚</p>

<p>æ³¨æ„ç‚¹ï¼š
1.å­—ç¬¦ä¸²çš„ä½ç½®ä¸€å®šæ˜¯å³ç§»ï¼Œä¸ä¼šå·¦ç§»ã€‚
2.åŒ¹é…ä¸²çš„ä½ç½®æ˜¯ä¸€ä½ä¸€ä½çš„å³ç§»ï¼Œå·¦ç§»æ˜¯æ ¹æ®nextæ•°ç»„ã€‚
3.å­—ç¬¦ä¸²å’ŒåŒ¹é…ä¸²çš„æŸä¸ªä½ç½®ä¸ç­‰çš„æ—¶å€™ï¼Œä¼˜å…ˆåŒ¹é…ä¸²ä½ç½®å·¦ç§»ï¼Œå·¦ç§»ä¸åŠ¨çš„æ—¶å€™ï¼Œå­—ç¬¦ä¸²ä½ç½®æ‰å³ç§»
<!-- more --></p>

<p>func strStr(haystack string, needle string) int {
    if len(needle)&lt;=0{
        return 0
    }
    return GetIndexOf(haystack,needle)
}</p>

<p>func GetNextArray(match string) []int {
    matchLen := len(match)
    if matchLen == 1 {
        return []int{-1}
    }
    next := make([]int, matchLen)
    next[0] = -1
    next[1] = 0
    i := 2
    // cnä»£è¡¨ï¼Œcnä½ç½®çš„å­—ç¬¦ï¼Œæ˜¯å½“å‰å’Œi-1ä½ç½®æ¯”è¾ƒçš„å­—ç¬¦
    cn := 0
    for i &lt; matchLen {
        if match[i-1] == match[cn] { //åŒ¹é…
            cn++
            next[i] = cn
            i++
        } else if cn &gt; 0 {
            cn = next[cn] //å¯å›é€€æŒ‡é’ˆ
        } else {
            next[i] = 0
            i++
        }
    }
    fmt.Println(â€œnext = â€œ, next)
    return next
}
func GetIndexOf(s string, m string) int {
    sLen := len(s)
    mLen := len(m)
    if sLen &lt; len(m) {
        return -1
    }
    next := GetNextArray(m)
    x := 0 //ä»æ¥ä¸å›é€€
    y := 0 //æ ¹æ®nextæ•°ç»„å›é€€
    for x &lt; sLen &amp;&amp; y &lt; mLen {
        if s[x] == m[y] {
            x++
            y++
        } else if next[y] == -1 {
            x++
        } else {
            y = next[y] //å›é€€äº†
        }
    }
    if y == mLen {
        return x - y
    } else {
        return -1
    }
}</p>

<p>https://studygolang.com/articles/33165?fr=sidebar</p>
:ET