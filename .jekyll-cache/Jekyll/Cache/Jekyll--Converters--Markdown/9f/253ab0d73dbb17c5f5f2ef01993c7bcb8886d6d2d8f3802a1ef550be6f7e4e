I"ä<p>ä¸€ã€ patch å’Œdiff çš„åŒºåˆ«
Git æä¾›äº†ä¸¤ç§è¡¥ä¸æ–¹æ¡ˆï¼Œä¸€æ˜¯ç”¨git diffç”Ÿæˆçš„UNIXæ ‡å‡†è¡¥ä¸.diffæ–‡ä»¶ï¼ŒäºŒæ˜¯git format-patchç”Ÿæˆçš„Gitä¸“ç”¨.patch æ–‡ä»¶ã€‚
.diffæ–‡ä»¶åªæ˜¯è®°å½•æ–‡ä»¶æ”¹å˜çš„å†…å®¹ï¼Œä¸å¸¦æœ‰commitè®°å½•ä¿¡æ¯,å¤šä¸ªcommitå¯ä»¥åˆå¹¶æˆä¸€ä¸ªdiffæ–‡ä»¶ã€‚
.patchæ–‡ä»¶å¸¦æœ‰è®°å½•æ–‡ä»¶æ”¹å˜çš„å†…å®¹ï¼Œä¹Ÿå¸¦æœ‰commitè®°å½•ä¿¡æ¯,æ¯ä¸ªcommitå¯¹åº”ä¸€ä¸ªpatchæ–‡ä»¶ã€‚</p>

<p>åœ¨Gitä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨.diffæ–‡ä»¶ä¹Ÿå¯ä»¥ä½¿ç”¨.patch æ–‡ä»¶æ¥æ‰“è¡¥ä¸ï¼Œä¸»è¦åº”ç”¨åœºæ™¯æœ‰ï¼šCodeReviewã€ä»£ç è¿ç§»ç­‰ã€‚</p>

<p>for f in <code class="language-plaintext highlighter-rouge">git status |grep -v 'cmake-build' |grep -v 'ext'|grep -E "(^.*\.c$)|(^.*\.h$)" |awk '{print $2}'</code>; do echo $f; git diff $fÂ Â» zend_vm.diff;done</p>

<p>for f in <code class="language-plaintext highlighter-rouge">git status |grep -E "deleted|modified" |awk '{print $2}'</code>; do echo $f; git checkout $f; done</p>

<p>for f in <code class="language-plaintext highlighter-rouge">git status |grep deleted |awk '{print $2}'</code>; do echo $f; git checkout $f; done</p>

<p>git apply  ../zend_vm.diff</p>

<!-- more -->
<p>äºŒã€åˆ›å»ºpatchå’Œdiff
1ã€åˆ›å»ºpatch æ–‡ä»¶çš„å¸¸ç”¨å‘½ä»¤è¡Œ
*æŸæ¬¡æäº¤ï¼ˆå«ï¼‰ä¹‹å‰çš„å‡ æ¬¡æäº¤ï¼š
git format-patch ã€commit sha1 idã€‘-n
næŒ‡ä»sha1 idå¯¹åº”çš„commitå¼€å§‹ç®—èµ·nä¸ªæäº¤ã€‚
egï¼š</p>

<p>git format-patch  2a2fb4539925bfa4a141fe492d9828d030f7c8a8 -2
*æŸä¸ªæäº¤çš„patchï¼š
git format-patch ã€commit sha1 idã€‘ -1
egï¼š</p>

<p>git format-patch  2a2fb4539925bfa4a141fe492d9828d030f7c8a8 -1
*æŸä¸¤æ¬¡æäº¤ä¹‹é—´çš„æ‰€æœ‰patch:
git format-patch ã€commit sha1 idã€‘..ã€commit sha1 idã€‘ 
egï¼š</p>

<p>git format-patch  2a2fb4539925bfa4a141fe492d9828d030f7c8a8..89aebfcc73bdac8054be1a242598610d8ed5f3c8
2ã€åˆ›å»ºdiffæ–‡ä»¶çš„å¸¸ç”¨æ–¹æ³•
ä½¿ç”¨å‘½ä»¤è¡Œ
git diff  ã€commit sha1 idã€‘ ã€commit sha1 idã€‘ &gt;  ã€diffæ–‡ä»¶åã€‘
egï¼š</p>

<p>git diff  2a2fb4539925bfa4a141fe492d9828d030f7c8a8  89aebfcc73bdac8054be1a242598610d8ed5f3c8 &gt; patch.diff
ä½¿ç”¨SourceTree
é€‰ä¸­è¦ç›®æ ‡commit ,å³å‡»ï¼Œé€‰æ‹©create patch</p>

<p>3ã€å¦‚ä½•è·å–commit sha1 id
git ä¸­çš„æ¯ä¸ªcommitéƒ½æœ‰å¯¹åº”çš„ä¸€ä¸ªsha1 idï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨ç»ˆç«¯è¾“å…¥git logï¼Œç„¶åæ‰¾åˆ°å¯¹åº”çš„commit sha1 id:</p>

<p>å¦‚å›¾ä¸­2a2fb4539925bfa4a141fe492d9828d030f7c8a8ä¾¿æ˜¯sha1 id
å¦‚æœç”¨Sourcetreeçš„è¯ä¹Ÿå¾ˆæ–¹ä¾¿ï¼Œå³å‡»å¯¹åº”çš„commitï¼Œé€‰æ‹©copy SHA-1 toclipboardä¾¿å¤åˆ¶sha1 idåˆ°å‰ªåˆ‡æ¿ä¸­ï¼š</p>

<p>ä¸‰ã€åº”ç”¨patch å’Œ diff
ç›¸å…³å‘½ä»¤è¡Œ
æ£€æŸ¥patch/diffæ˜¯å¦èƒ½æ­£å¸¸æ‰“å…¥:
git apply â€“check ã€path/to/xxx.patchã€‘
git apply â€“check ã€path/to/xxx.diffã€‘
æ‰“å…¥patch/diff:
git apply ã€path/to/xxx.patchã€‘
git apply ã€path/to/xxx.diffã€‘
æˆ–è€…</p>

<p>git  am ã€path/to/xxx.patchã€‘
ä½¿ç”¨SourceTree
é€‰æ‹©SourceTreeï¼Œåœ¨å±å¹•é¡¶éƒ¨é€‰æ‹©Aciotn-Apply patch</p>

<p>é€‰æ‹©patchæˆ–è€…diffçš„è·¯å¾„ï¼Œç„¶åç‚¹OK</p>

<p>å››ã€å†²çªè§£å†³
åœ¨æ‰“è¡¥ä¸è¿‡ç¨‹ä¸­æœ‰æ—¶å€™ä¼šå‡ºç°å†²çªçš„æƒ…å†µï¼Œæœ‰å†²çªæ—¶ä¼šæ‰“å…¥å¤±è´¥ï¼Œå¦‚å›¾ï¼š</p>

<p>æ­¤æ—¶éœ€è¦è§£å†³å†²çªï¼š
1ã€é¦–å…ˆä½¿ç”¨ ä»¥ä¸‹å‘½ä»¤è¡Œï¼Œè‡ªåŠ¨åˆå…¥ patch ä¸­ä¸å†²çªçš„ä»£ç æ”¹åŠ¨ï¼ŒåŒæ—¶ä¿ç•™å†²çªçš„éƒ¨åˆ†ï¼š</p>

<p>git  apply â€“reject  xxxx.patch
å¯ä»¥åœ¨ç»ˆç«¯ä¸­æ˜¾ç¤ºå‡ºå†²çªçš„å¤§è‡´ä»£ç ï¼š</p>

<p>åŒæ—¶ä¼šç”Ÿæˆåç¼€ä¸º .rej çš„æ–‡ä»¶ï¼Œä¿å­˜æ²¡æœ‰åˆå¹¶è¿›å»çš„éƒ¨åˆ†çš„å†…å®¹ï¼Œå¯ä»¥å‚è€ƒè¿™ä¸ªè¿›è¡Œå†²çªè§£å†³ã€‚
2ã€è§£å†³å®Œå†²çªååˆ é™¤åç¼€ä¸º .rej çš„æ–‡ä»¶ï¼Œå¹¶æ‰§è¡Œgit add.æ·»åŠ æ”¹åŠ¨åˆ°æš‚å­˜åŒº.
3ã€æ¥ç€æ‰§è¡Œgit am â€“resolvedæˆ–è€…git am â€“continue
è¯´æ˜ï¼šåœ¨æ‰“å…¥patchå†²çªæ—¶ï¼Œå¯ä»¥æ‰§è¡Œgit am â€“skipè·³è¿‡æ­¤æ¬¡å†²çªï¼Œä¹Ÿå¯ä»¥æ‰§è¡Œgit am â€“abortå›é€€æ‰“å…¥patchçš„åŠ¨ä½œï¼Œè¿˜åŸåˆ°æ“ä½œå‰çš„çŠ¶æ€ã€‚</p>

<p>https://www.jianshu.com/p/ec04de3f95cc</p>
:ET