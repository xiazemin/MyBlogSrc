I"ëš<p>ç±»ä¼¼çš„å·¥å…·æ¯”è¾ƒå¤šï¼Œæ¯”å¦‚prisma ã€qlooã€golang çš„gqlgenã€apollo-codegen
graphql-code-generator ä¹Ÿæ˜¯ä¸€ä¸ªä¸é”™çš„å·¥å…·ï¼ˆçµæ´»ã€æ¨¡ç‰ˆè‡ªå®šä¹‰
<!-- more -->
npm install â€“save-dev graphql-code-generator graphql
 Or
 yarn add -D graphql-code-generator graphql
å‚è€ƒdemo
é¡¹ç›®åˆå§‹åŒ–
yarn init -y 
æ·»åŠ ä¾èµ–
 yarn add â€“dev graphql-code-generator graphql
package.json:</p>

<p>https://github.com/eatonphil/gosql
https://mp.weixin.qq.com/s/jOnqEz31rDcUxSNs_Hjwaw</p>

<p>GraphQLèƒŒæ™¯
REST APIçš„ä½¿ç”¨æ–¹å¼æ˜¯ï¼Œserverå®šä¹‰ä¸€ç³»åˆ—çš„æ¥å£ï¼Œclientè°ƒç”¨è‡ªå·±éœ€è¦çš„æ¥å£ï¼Œè·å–ç›®æ ‡æ•°æ®è¿›è¡Œæ•´åˆã€‚REST APIå¼€å‘ä¸­é‡åˆ°çš„é—®é¢˜ï¼š</p>

<p>æ‰©å±•æ€§ ï¼Œéšç€APIçš„ä¸æ–­å‘å±•ï¼ŒREST APIçš„æ¥å£ä¼šå˜å¾—è¶Šæ¥è‡ƒè‚¿ã€‚
æ— æ³•æŒ‰éœ€è·å– ï¼Œä¸€ä¸ªè¿”å›id, name, age, city, addr, emailçš„æ¥å£ï¼Œå¦‚æœä»…è·å–éƒ¨åˆ†ä¿¡æ¯ï¼Œå¦‚name, ageï¼Œå´å¿…é¡»è¿”å›æ¥å£çš„å…¨éƒ¨ä¿¡æ¯ï¼Œç„¶åä»ä¸­æå–è‡ªå·±éœ€è¦çš„ã€‚åå¤„ä¸ä»…ä¼šå¢åŠ ç½‘ç»œä¼ è¾“é‡ï¼Œå¹¶ä¸”ä¸ä¾¿äºclientå¤„ç†æ•°æ®
ä¸€ä¸ªè¯·æ±‚æ— æ³•è·å–æ‰€éœ€å…¨éƒ¨èµ„æº ï¼Œä¾‹å¦‚clientéœ€è¦æ˜¾ç¤ºä¸€ç¯‡æ–‡ç« çš„å†…å®¹ï¼ŒåŒæ—¶è¦æ˜¾ç¤ºè¯„è®ºï¼Œä½œè€…ä¿¡æ¯ï¼Œé‚£ä¹ˆå°±éœ€è¦è°ƒç”¨æ–‡ç« ã€è¯„è®ºã€ç”¨æˆ·çš„æ¥å£ã€‚åå¤„é€ æˆæœåŠ¡çš„çš„ç»´æŠ¤å›°éš¾ï¼Œä»¥åŠå“åº”æ—¶é—´å˜é•¿ ã€‚
åŸå› ï¼š REST APIé€šå¸¸ç”±å¤šä¸ªç«¯ç‚¹ç»„æˆï¼Œæ¯ä¸ªç«¯ç‚¹ä»£è¡¨ä¸€ç§èµ„æºã€‚æ‰€ä»¥ï¼Œå½“clientéœ€è¦å¤šä¸ªèµ„æºæ˜¯ï¼Œå®ƒéœ€è¦å‘REST APIå‘èµ·å¤šä¸ªè¯·æ±‚ï¼Œæ‰èƒ½è·å–åˆ°æ‰€éœ€è¦çš„æ•°æ®ã€‚
REST APIä¸å¥½å¤„ç†çš„é—®é¢˜ ï¼Œ æ¯”å¦‚ç¡®ä¿clientæä¾›çš„å‚æ•°æ˜¯ç±»å‹å®‰å…¨çš„ï¼Œå¦‚ä½•ä»ä»£ç ç”ŸæˆAPIçš„æ–‡æ¡£ç­‰ã€‚
GraphQLè§£å†³çš„é—®é¢˜ï¼š</p>

<p>è¯·æ±‚ä½ çš„æ•°æ®ä¸å¤šä¸å°‘ ï¼šGraphQLæŸ¥è¯¢æ€»æ˜¯èƒ½å‡†ç¡®è·å¾—ä½ æƒ³è¦çš„æ•°æ®ï¼Œä¸å¤šä¸å°‘ï¼Œæ‰€ä»¥è¿”å›çš„ç»“æœæ˜¯å¯é¢„æµ‹çš„ã€‚
è·å–å¤šä¸ªèµ„æºåªç”¨ä¸€ä¸ªè¯·æ±‚ ï¼šGraphQLæŸ¥è¯¢ä¸ä»…èƒ½å¤Ÿè·å¾—èµ„æºçš„å±æ€§ï¼Œè¿˜èƒ½æ²¿ç€èµ„æºé—´è¿›ä¸€æ­¥æŸ¥è¯¢ï¼Œæ‰€ä»¥GraphQLå¯ä»¥é€šè¿‡ä¸€æ¬¡è¯·æ±‚å°±è·å–ä½ åº”ç”¨æ‰€éœ€çš„æ‰€æœ‰æ•°æ®ã€‚
æè¿°æ‰€æœ‰çš„å¯èƒ½ç±»å‹ç³»ç»Ÿï¼š GraphQL APIåŸºäºç±»å‹å’Œå­—æ®µçš„æ–¹å¼è¿›è¡Œç»„æˆï¼Œä½¿ç”¨ç±»å‹æ¥ä¿è¯åº”ç”¨åªè¯·æ±‚å¯èƒ½çš„ç±»å‹ï¼ŒåŒæ—¶æä¾›äº†æ¸…æ™°çš„è¾…åŠ©æ€§é”™è¯¯ä¿¡æ¯ã€‚
ä½¿ç”¨ä½ ç°æœ‰çš„æ•°æ®å’Œä»£ç ï¼š GraphQLè®©ä½ çš„æ•´ä¸ªåº”ç”¨å…±äº«ä¸€å¥—APIï¼Œé€šè¿‡GraphQL APIèƒ½å¤Ÿæ›´å¥½çš„åˆ©ç”¨ä½ çš„ç°æœ‰æ•°æ®å’Œä»£ç ã€‚GraphQL å¼•æ“å·²ç»æœ‰å¤šç§è¯­è¨€å®ç°ï¼ŒGraphQLä¸é™äºæŸä¸€ç‰¹å®šæ•°æ®åº“ï¼Œå¯ä»¥ä½¿ç”¨å·²ç»å­˜åœ¨çš„æ•°æ®ã€ä»£ç ã€ç”šè‡³å¯ä»¥è¿æ¥ç¬¬ä¸‰æ–¹çš„APIsã€‚
API æ¼”è¿›æ— éœ€åˆ’åˆ†ç‰ˆæœ¬ï¼š ç»™GraphQL APIæ·»åŠ å­—æ®µå’Œç±»å‹è€Œæ— éœ€å½±å“ç°æœ‰æŸ¥è¯¢ã€‚è€æ—§å­—æ®µå¯ä»¥åºŸå¼ƒï¼Œä»å·¥å…·ä¸­éšè—ã€‚
ä»€ä¹ˆæ˜¯GraphQL
GraphQLå®˜ç½‘ç»™å‡ºå®šä¹‰ï¼šGraphQLæ—¢æ˜¯ä¸€ç§ç”¨äºAPIçš„æŸ¥è¯¢è¯­è¨€ ä¹Ÿæ˜¯ä¸€ä¸ªæ»¡è¶³ä½ æ•°æ®æŸ¥è¯¢çš„è¿è¡Œæ—¶ ã€‚GraphQLå¯¹ä½ çš„APIä¸­çš„æ•°æ®æä¾›äº†ä¸€å¥—æ˜“äºç†è§£çš„å®Œæ•´æè¿° ï¼Œä½¿å¾—å®¢æˆ·ç«¯èƒ½å¤Ÿå‡†ç¡®åœ°è·å¾—å®ƒéœ€è¦çš„æ•°æ® ï¼Œè€Œä¸”æ²¡æœ‰ä»»ä½•å†—ä½™ï¼Œä¹Ÿè®©APIæ›´å®¹æ˜“åœ°éšç€æ—¶é—´æ¨ç§»è€Œæ¼”è¿›ï¼Œè¿˜èƒ½ç”¨äºæ„å»ºå¼ºå¤§çš„å¼€å‘è€…å·¥å…·ã€‚</p>

<p>APIä¸æ˜¯ç”¨æ¥è°ƒç”¨çš„å—ï¼Ÿæ˜¯çš„ï¼Œè€…æ­£æ˜¯GraphQLçš„å¼ºå¤§ä¹‹å¤„ï¼Œå¼•ç”¨å®˜æ–¹æ–‡æ¡£çš„ä¸€å¥è¯ask exactly what you want
æœ¬è´¨ä¸Šæ¥è¯´GraphQLæ˜¯ä¸€ç§æŸ¥è¯¢è¯­è¨€
ä¸Šè¿°çš„å®šä¹‰å…¶å®å¾ˆéš¾ç†è§£ï¼Œåªæœ‰çœŸçš„ä½¿ç”¨è¿‡GraphQLæ‰èƒ½å¤Ÿç†è§£ã€‚
åœ¨GraphQLä¸­ï¼Œé€šè¿‡å®šä¹‰ä¸€å¼ Schemaå’Œå£°æ˜ä¸€äº›Typeæ¥è¾¾åˆ°ä¸Šè¿°æè¿°çš„åŠŸèƒ½ï¼Œéœ€è¦å­¦ä¹ ï¼š</p>

<p>å¯¹äºæ•°æ®æ¨¡å‹çš„æŠ½è±¡æ˜¯é€šè¿‡Typeæ¥æè¿°çš„ ï¼Œå¦‚ä½•å®šä¹‰Typeï¼Ÿ
å¯¹äºæ¥å£è·å–æ•°æ®çš„é€»è¾‘æ˜¯é€šè¿‡schemaæ¥æè¿°çš„ ï¼Œå¦‚ä½•å®šä¹‰schemaï¼Ÿ
å¦‚ä½•å®šä¹‰Type
å¯¹äºæ•°æ®æ¨¡å‹çš„æŠ½è±¡æ˜¯é€šè¿‡Typeæ¥æè¿°çš„ï¼Œæ¯ä¸€ä¸ªTypeæœ‰è‹¥å¹²Fieldç»„æˆï¼Œæ¯ä¸ªFieldåˆåˆ†åˆ«æŒ‡å‘æŸä¸ªTypeã€‚</p>

<p>GraphQLçš„Typeç®€å•å¯ä»¥åˆ†ä¸ºä¸¤ç§ï¼Œä¸€ç§æ˜¯scalar typeï¼ˆæ ‡é‡ç±»å‹ï¼‰ ï¼Œå¦ä¸€ç§æ˜¯object typeï¼ˆå¯¹è±¡ç±»å‹ï¼‰ã€‚</p>

<p>scalar type
GraphQLä¸­çš„å†…å»ºçš„æ ‡é‡åŒ…å«ï¼ŒStringã€Intã€Floatã€Booleanã€Enumï¼Œé™¤æ­¤ä¹‹å¤–ï¼ŒGraphQLä¸­å¯ä»¥é€šè¿‡scalarå£°æ˜ä¸€ä¸ªæ–°çš„æ ‡é‡ ï¼Œæ¯”å¦‚ï¼š</p>

<p>prisma â€”â€”ä¸€ä¸ªä½¿ç”¨GraphQLæ¥æŠ½è±¡æ•°æ®åº“æ“ä½œçš„åº“ä¸­ï¼Œè¿˜æœ‰DataTimeï¼ˆæ—¥æœŸæ ¼å¼ï¼‰å’Œä¸»é”®ï¼ˆIDï¼‰ã€‚
åœ¨ä½¿ç”¨GraphQLå®ç°æ–‡ä»¶ä¸Šä¼ æ¥å£æ—¶ï¼Œéœ€è¦å£°æ˜ä¸€ä¸ªUploadæ ‡é‡æ¥ä»£è¡¨è¦ä¸Šä¼ çš„æ–‡ä»¶ã€‚
æ ‡é‡æ˜¯GraphQLç±»å‹ç³»ç»Ÿä¸­æœ€å°çš„é¢—ç²’ã€‚
object type
ä»…æœ‰æ ‡é‡æ˜¯ä¸å¤ŸæŠ½è±¡ä¸€äº›å¤æ‚çš„æ•°æ®æ¨¡å‹ï¼Œè¿™æ—¶éœ€è¦ä½¿ç”¨å¯¹è±¡ç±»å‹ã€‚é€šè¿‡å¯¹è±¡ç±»å‹æ¥æ„å»ºGraphQLä¸­å…³äºä¸€ä¸ªæ•°æ®æ¨¡å‹çš„å½¢çŠ¶ï¼ŒåŒæ—¶è¿˜å¯ä»¥å£°æ˜å„ä¸ªæ¨¡å‹ä¹‹é—´çš„å†…åœ¨å…³è”ï¼ˆä¸€å¯¹å¤šï¼Œä¸€å¯¹ä¸€æˆ–å¤šå¯¹å¤šï¼‰ã€‚</p>

<p>ä¸€å¯¹ä¸€æ¨¡å‹</p>

<p>type Article {
  id: ID
  text: String
  isPublished: Boolean
  author: User
}
1
2
3
4
5
6
ä¸Šè¿°ä»£ç ï¼Œå£°æ˜äº†ä¸€ä¸ªArticleç±»å‹ï¼Œå®ƒæœ‰3ä¸ªFieldï¼Œåˆ†åˆ«æ˜¯idï¼ˆIDç±»å‹ï¼‰ã€textï¼ˆStringç±»å‹ï¼‰ã€isPublishedï¼ˆBooleanç±»å‹ï¼‰ä»¥åŠauthorï¼ˆæ–°å»ºçš„å¯¹è±¡ç±»å‹Userï¼‰ï¼ŒUserç±»å‹çš„å£°æ˜å¦‚ä¸‹ï¼š</p>

<p>type User {
  id: ID
  name: String
}
1
2
3
4
lType Modifier
ç±»å‹ä¿®é¥°ç¬¦ï¼Œå½“å‰çš„ç±»å‹ä¿®é¥°ç¬¦æœ‰ä¸¤ç§ï¼Œåˆ†åˆ«æ˜¯Listå’ŒRequired ï¼Œè¯­æ³•åˆ†åˆ«ä¸º[Type]å’Œ[Type!]ï¼Œä¸¤è€…å¯ä»¥ç»„åˆï¼š</p>

<p>[Type]! ï¼šåˆ—è¡¨æœ¬èº«ä¸ºå¿…å¡«é¡¹ï¼Œä½†å†…éƒ¨å…ƒç´ å¯ä»¥ä¸ºç©º
[Type!] ï¼šåˆ—è¡¨æœ¬èº«å¯ä»¥ä¸ºç©ºï¼Œä½†æ˜¯å…¶å†…éƒ¨å…ƒç´ ä¸ºå¿…å¡«
[Type!]! ï¼šåˆ—è¡¨æœ¬èº«å’Œå†…éƒ¨å…ƒç´ å‡ä¸ºå¿…å¡«
å¦‚ä½•å®šä¹‰Schema
schemaç”¨æ¥æè¿°å¯¹äºæ¥å£è·å–æ•°æ®é€»è¾‘ ï¼ŒGraphQLä¸­ä½¿ç”¨Queryæ¥æŠ½è±¡æ•°æ®çš„æŸ¥è¯¢é€»è¾‘ï¼Œåˆ†ä¸ºä¸‰ç§ï¼Œåˆ†åˆ«æ˜¯queryï¼ˆæŸ¥è¯¢ï¼‰ã€mutationï¼ˆæ›´æ”¹ï¼‰ã€subscriptionï¼ˆè®¢é˜…ï¼‰ ã€‚APIçš„æ¥å£æ¦‚æ‹¬èµ·æ¥æœ‰CRUDï¼ˆåˆ›å»ºã€è·å–ã€æ›´æ”¹ã€åˆ é™¤ï¼‰å››ç±»ï¼Œqueryå¯ä»¥è¦†ç›–Rï¼ˆè·å–ï¼‰çš„åŠŸèƒ½ï¼Œmutationå¯ä»¥è¦†ç›–ï¼ˆCUDåˆ›å»ºã€æ›´æ”¹ã€åˆ é™¤ï¼‰çš„åŠŸèƒ½ã€‚</p>

<p>æ³¨æ„ï¼š Queryç‰¹æŒ‡GraphQLä¸­çš„æŸ¥è¯¢ï¼ˆåŒ…å«ä¸‰ç§ç±»å‹ï¼‰ï¼ŒqueryæŒ‡GraphQLä¸­çš„æŸ¥è¯¢ç±»å‹ï¼ˆä»…æŒ‡æŸ¥è¯¢ç±»å‹ï¼‰ã€‚</p>

<p>Query
queryï¼ˆæŸ¥è¯¢ï¼‰ï¼šå½“è·å–æ•°æ®æ—¶ï¼Œé€‰æ‹©queryç±»å‹
mutationï¼ˆæ›´æ”¹ï¼‰ï¼š å½“å°è¯•ä¿®æ”¹æ•°æ®æ—¶ï¼Œé€‰æ‹©mutationç±»å‹
subscriptionï¼ˆè®¢é˜…ï¼‰ï¼šå½“å¸Œæœ›æ•°æ®æ›´æ”¹æ—¶ï¼Œå¯ä»¥è¿›è¡Œæ¶ˆæ¯æ¨é€ï¼Œä½¿ç”¨subscriptionç±»å‹ï¼ˆé’ˆå¯¹å½“å‰çš„æ—¥è¶‹æµè¡Œçš„real-timeåº”ç”¨æå‡ºçš„ï¼‰ã€‚
ä»¥Articleä¸ºæ•°æ®æ¨¡å‹ï¼Œåˆ†åˆ«ä»¥RESTå’ŒGraphQLçš„è§’åº¦ï¼Œç¼–å†™CURDçš„æ¥å£</p>

<p>Restæ¥å£</p>

<p>GET /api/v1/articles/
GET /api/v1/article/:id/
POST /api/v1/article/
DELETE /api/v1/article/:id/
PATCH /api/v1/article/:id/
GraphQL Query</p>

<p>queryç±»å‹
query {
articles():[Article!]!
article(id: Int!): Article!
}
mutationç±»å‹
mutation {
createArticle(): Article!
updateArticle(id: Int): Article!
deleteArticle(id: Int): Article!
}
æ³¨æ„ï¼š</p>

<p>GraphQLæ˜¯æŒ‰ç…§ç±»å‹æ¥åˆ’åˆ†èŒèƒ½çš„queryã€mutationã€ssubscriptionï¼ŒåŒæ—¶å¿…é¡»æ˜ç¡®å£°æ˜è¿”å›çš„æ•°æ®ç±»å‹ã€‚</p>

<p>å¦‚æœå®é™…åº”ç”¨ä¸­å¯¹äºè¯„è®ºåˆ—è¡¨æœ‰real-time çš„éœ€æ±‚ï¼Œè¯¥å¦‚ä½•å¤„ç†ï¼Ÿ</p>

<p>åœ¨RESTä¸­ï¼Œå¯ä»¥é€šè¿‡é•¿è¿æ¥ï¼Œæˆ–è€…é€šè¿‡æä¾›ä¸€äº›å¸¦éªŒè¯çš„è·å–é•¿è¿æ¥URLçš„æ¥å£ï¼Œæ¯”å¦‚POST /api/v1/messages/ä¹‹åé•¿è¿æ¥ä¼šå°†æ–°çš„æ•°æ®è¿›è¡Œå®æ—¶æ¨é€ã€‚</p>

<p>åœ¨GraphQLä¸­ï¼Œä¼šä»¥æ›´åŠ å£°æ˜å¼çš„æ–¹å¼è¿›è¡Œå£°æ˜ï¼Œå¦‚ä¸‹ï¼š</p>

<p>subscription {
updatedArticle() {
  mutation
  node {
    comments: [Comment!]!
  }
}
}
1
2
3
4
5
6
7
8
æ­¤å¤„å£°æ˜äº†ä¸€ä¸ªsubscriptionï¼Œè¿™ä¸ªsubscriptionä¼šåœ¨æœ‰æ–°çš„Articleè¢«åˆ›å»ºæˆ–è€…æ›´æ–°æ—¶ï¼Œæ¨é€æ–°çš„æ•°æ®å¯¹è±¡ã€‚å®é™…ä¸Šå†…éƒ¨ä»ç„¶æ˜¯å»ºç«‹äºé•¿è¿æ¥ä¹‹ä¸Š ã€‚</p>

<p>Resolve
ä¸Šè¿°çš„æè¿°å¹¶æœªè¯´æ˜å¦‚ä½•è¿”å›ç›¸å…³æ“ä½œï¼ˆqueryã€mutationã€subscriptionï¼‰çš„æ•°æ®é€»è¾‘ã€‚æ‰€æœ‰æ­¤å¤„å¼•å…¥ä¸€ä¸ªæ›´æ ¸å¿ƒçš„æ¦‚å¿µResolve(è§£æå‡½æ•°)</p>

<p>GraphQLä¸­ï¼Œé»˜è®¤æœ‰è¿™æ ·çš„çº¦å®šï¼ŒQueryï¼ˆåŒ…æ‹¬queryã€mutationã€subscriptionï¼‰å’Œä¸ä¹‹å¯¹åº”çš„Resolveæ˜¯åŒåçš„ï¼Œæ¯”å¦‚å…³äºarticles(): [Articles!]!è¿™ä¸ªqueryï¼Œå®ƒçš„Resolveçš„åå­—å¿…ç„¶å«åšarticles</p>

<p>ä»¥å·²ç»å£°æ˜çš„articlesçš„queryä¸ºä¾‹ï¼Œè§£é‡Šä¸‹GraphQLçš„å†…éƒ¨å·¥ä½œæœºåˆ¶ï¼š</p>

<p>Query {
articles {
     id
     author {
        name
     }
     comments {
    id
    desc
    author
  }
}
}
1
2
3
4
5
6
7
8
9
10
11
12
13
æŒ‰ç…§å¦‚ä¸‹æ­¥éª¤è¿›è¡Œè§£æï¼š</p>

<p>é¦–å…ˆè¿›è¡Œç¬¬ä¸€æ¬¡è§£æï¼Œå½“å‰çš„ç±»å‹æ˜¯query ç±»å‹ï¼ŒåŒæ—¶Resolverçš„åå­—ä¸ºarticlesã€‚
ä¹‹åä¼šå°è¯•ä½¿ç”¨articlesçš„Resolverè·å–è§£ææ•°æ®ï¼Œç¬¬ä¸€å±‚è§£æå®Œæ¯•
ä¹‹åå¯¹ç¬¬ä¸€å±‚è§£æçš„è¿”å›å€¼ï¼Œè¿›è¡Œç¬¬äºŒå±‚è§£æï¼Œå½“å‰articlesåŒ…å«ä¸‰ä¸ªå­query ï¼Œåˆ†åˆ«æ˜¯idã€authorå’Œcomments
idåœ¨Authorç±»å‹ä¸­ä¸ºæ ‡é‡ç±»å‹ï¼Œè§£æç»“æŸ
authoråœ¨articlesç±»å‹ä¸­ä¸ºå¯¹è±¡ç±»å‹Userï¼Œå°è¯•ä½¿ç”¨Userçš„Resolverè·å–æ•°æ®ï¼Œå½“å‰fieldè§£æå®Œæ¯•ã€‚
ä¹‹åå¯¹ç¬¬äºŒå±‚è§£æçš„è¿”å›å€¼ï¼Œè¿›è¡Œç¬¬ä¸‰å±‚è§£æï¼Œå½“å‰authorè¿˜åŒ…å«ä¸€ä¸ªqueryï¼Œnameæ˜¯æ ‡é‡ç±»å‹ï¼Œè§£æç»“æŸ
commentsè§£æåŒä¸Š
æ¦‚æ‹¬æ€»ç»“GraphQLå¤§ä½“è§£ææµç¨‹å°±æ˜¯é‡è§ä¸€ä¸ªQueryä¹‹åï¼Œå°è¯•ä½¿ç”¨å®ƒçš„Resolverå–å€¼ï¼Œä¹‹åå†å¯¹è¿”å›å€¼è¿›è¡Œè§£æï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯é€’å½’çš„ï¼Œç›´åˆ°æ‰€æœ‰è§£æFieldç±»å‹æ˜¯Scalar Typeï¼ˆæ ‡é‡ç±»å‹ï¼‰ä¸ºæ­¢ã€‚æ•´ä¸ªè§£æè¿‡ç¨‹å¯ä»¥æƒ³è±¡ä¸ºä¸€ä¸ªå¾ˆé•¿çš„Resolver Chainï¼ˆè§£æé“¾ï¼‰ã€‚</p>

<p>Resolveræœ¬èº«çš„å£°æ˜åœ¨å„ä¸ªè¯­è¨€ä¸­æ˜¯ä¸åŒçš„ï¼Œå®ƒä»£è¡¨æ•°æ®è·å–çš„å…·ä½“é€»è¾‘ã€‚å®ƒçš„å‡½æ•°ç­¾åï¼ˆä»¥golangä¸ºä¾‹ï¼‰ï¼š</p>

<p>func(p graphql.ResolveParams) (interface{}, error) {}</p>

<p>// ResolveParams Params for FieldResolveFn()
type ResolveParams struct {
    // Source is the source value
    Source interface{}</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// Args is a map of arguments for current GraphQL request
Args map[string]interface{}

// Info is a collection of information about the current execution state.
Info ResolveInfo

// Context argument is a context value that is provided to every resolve function within an execution.
// It is commonly
// used to represent an authenticated user, or request-specific caches.
Context context.Context } 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒResolverå†…éƒ¨å®ç°å¯¹äºGraphQLå®Œå…¨æ˜¯é»‘ç›’çŠ¶æ€ã€‚è¿™æ„å‘³ç€Resolverå¦‚ä½•è¿”å›æ•°æ®ã€è¿”å›ä»€ä¹ˆæ ·çš„æ•°æ®ã€ä»å“ªé‡Œè¿”å›æ•°æ®ï¼Œå®Œå…¨å–å†³äºResolveræœ¬èº«ã€‚GraphQLåœ¨å®é™…ä½¿ç”¨ä¸­å¸¸å¸¸ä½œä¸ºä¸­é—´å±‚æ¥ä½¿ç”¨ï¼Œ**æ•°æ®çš„è·å–é€šè¿‡Resolveræ¥å°è£…ï¼Œå†…éƒ¨æ•°æ®è·å–çš„å®ç°å¯èƒ½åŸºäºRPCã€RESTã€WSã€SQLç­‰å¤šç§ä¸åŒçš„æ–¹å¼ã€‚
</code></pre></div></div>

<p>GraphQLä¾‹å­
ä¸‹é¢è¿™éƒ¨åˆ†å°†ä¼šå±•ç¤ºä¸€ä¸ªç”¨graphql-goå®ç°çš„ç”¨æˆ·ç®¡ç†çš„ä¾‹å­ï¼ŒåŒ…æ‹¬è·å–å…¨éƒ¨ç”¨æˆ·ä¿¡æ¯ã€è·å–æŒ‡å®šç”¨æˆ·ä¿¡æ¯ã€ä¿®æ”¹ç”¨æˆ·åç§°ã€åˆ é™¤ç”¨æˆ·çš„åŠŸèƒ½ï¼Œä»¥åŠå¦‚ä½•åˆ›å»ºæšä¸¾ç±»å‹çš„åŠŸèƒ½ï¼Œå®Œæ•´ä»£ç åœ¨è¿™é‡Œã€‚</p>

<p>ç”Ÿæˆåçš„schemaæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š
type Mutation {
  â€œâ€â€œ[ç”¨æˆ·ç®¡ç†] ä¿®æ”¹ç”¨æˆ·åç§°â€â€â€
  changeUserName(
    â€œ"â€ç”¨æˆ·IDâ€â€â€
    userId: Int!</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"""ç”¨æˆ·åç§°"""
userName: String!   ): Boolean
</code></pre></div></div>

<p>â€â€â€œ[ç”¨æˆ·ç®¡ç†] åˆ›å»ºç”¨æˆ·â€â€â€
  createUser(
    â€œ"â€ç”¨æˆ·åç§°â€â€â€
    userName: String!</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"""ç”¨æˆ·é‚®ç®±"""
email: String!

"""ç”¨æˆ·å¯†ç """
pwd: String!

"""ç”¨æˆ·è”ç³»æ–¹å¼"""
phone: Int   ): Boolean
</code></pre></div></div>

<p>â€â€â€œ[ç”¨æˆ·ç®¡ç†] åˆ é™¤ç”¨æˆ·â€â€â€
  deleteUser(
    â€œ"â€ç”¨æˆ·IDâ€â€â€
    userId: Int!
  ): Boolean
}</p>

<p>type Query {
  â€œâ€â€œ[ç”¨æˆ·ç®¡ç†] è·å–æŒ‡å®šç”¨æˆ·çš„ä¿¡æ¯â€â€â€
  UserInfo(
    â€œ"â€ç”¨æˆ·IDâ€â€â€
    userId: Int!
  ): userInfo</p>

<p>â€â€â€œ[ç”¨æˆ·ç®¡ç†] è·å–å…¨éƒ¨ç”¨æˆ·çš„ä¿¡æ¯â€â€â€
  UserListInfo: [userInfo]!
}</p>

<p>â€"â€ç”¨æˆ·ä¿¡æ¯æè¿°â€â€â€
type userInfo {
  â€œ"â€ç”¨æˆ·emailâ€â€â€
  email: String</p>

<p>â€"â€ç”¨æˆ·åç§°â€â€â€
  name: String</p>

<p>â€"â€ç”¨æˆ·æ‰‹æœºå·â€â€â€
  phone: Int</p>

<p>â€"â€ç”¨æˆ·å¯†ç â€â€â€
  pwd: String</p>

<p>â€"â€ç”¨æˆ·çŠ¶æ€â€â€â€
  status: UserStatusEnum</p>

<p>â€"â€ç”¨æˆ·IDâ€â€â€
  userID: Int
}</p>

<p>â€"â€ç”¨æˆ·çŠ¶æ€ä¿¡æ¯â€â€â€
enum UserStatusEnum {
  â€œ"â€ç”¨æˆ·å¯ç”¨â€â€â€
  EnableUser</p>

<p>â€"â€ç”¨æˆ·ä¸å¯ç”¨â€â€â€
  DisableUser
}
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
æ³¨æ„</p>

<p>GraphQLåŸºäºgolangå®ç°çš„ä¾‹å­æ¯”è¾ƒå°‘
GraphQLçš„schemaå¯ä»¥è‡ªåŠ¨ç”Ÿæˆï¼Œå…·ä½“æ“ä½œå¯æŸ¥çœ‹graphq-cliæ–‡æ¡£ï¼Œæ­¥éª¤å¤§è‡´åŒ…æ‹¬npmåŒ…çš„å®‰è£…ã€graphql-cliå·¥å…·çš„å®‰è£…ï¼Œé…ç½®æ–‡ä»¶çš„æ›´æ”¹ï¼ˆæ­¤å¤„éœ€è¦æŒ‡å®šæœåŠ¡å¯¹å¤–æš´éœ²çš„åœ°å€ï¼‰ ï¼Œæ‰§è¡Œgraphql get-schema å‘½ä»¤ã€‚
GraphQL APIä»¥åŠRsolveå‡½æ•°å®šä¹‰</p>

<p>type UserInfo struct {
    UserID uint64               <code class="language-plaintext highlighter-rouge">json:"userID"</code>
    Name   string               <code class="language-plaintext highlighter-rouge">json:"name"</code>
    Email  string               <code class="language-plaintext highlighter-rouge">json:"email"</code>
    Phone  int64                <code class="language-plaintext highlighter-rouge">json:"phone"</code>
    Pwd    string               <code class="language-plaintext highlighter-rouge">json:"pwd"</code>
    Status model.UserStatusType <code class="language-plaintext highlighter-rouge">json:"status"</code>
}
//è¿™æ®µå†…å®¹æ˜¯å¦‚ä½•ä½¿ç”¨GraphQLå®šä¹‰æšä¸¾ç±»å‹
var UserStatusEnumType = graphql.NewEnum(graphql.EnumConfig{
    Name:        â€œUserStatusEnumâ€,
    Description: â€œç”¨æˆ·çŠ¶æ€ä¿¡æ¯â€,
    Values: graphql.EnumValueConfigMap{
        â€œEnableUserâ€: &amp;graphql.EnumValueConfig{
            Value:       model.EnableStatus,
            Description: â€œç”¨æˆ·å¯ç”¨â€,
        },
        â€œDisableUserâ€: &amp;graphql.EnumValueConfig{
            Value:       model.DisableStatus,
            Description: â€œç”¨æˆ·ä¸å¯ç”¨â€,
        },
    },
})</p>

<p>var UserInfoType = graphql.NewObject(graphql.ObjectConfig{
    Name:        â€œuserInfoâ€,
    Description: â€œç”¨æˆ·ä¿¡æ¯æè¿°â€,
    Fields: graphql.Fields{
        â€œuserIDâ€: &amp;graphql.Field{
            Description: â€œç”¨æˆ·IDâ€,
            Type:        graphql.Int,
        },
        â€œnameâ€: &amp;graphql.Field{
            Description: â€œç”¨æˆ·åç§°â€,
            Type:        graphql.String,
        },
        â€œemailâ€: &amp;graphql.Field{
            Description: â€œç”¨æˆ·emailâ€,
            Type:        graphql.String,
        },
        â€œphoneâ€: &amp;graphql.Field{
            Description: â€œç”¨æˆ·æ‰‹æœºå·â€,
            Type:        graphql.Int,
        },
        â€œpwdâ€: &amp;graphql.Field{
            Description: â€œç”¨æˆ·å¯†ç â€,
            Type:        graphql.String,
        },
        â€œstatusâ€: &amp;graphql.Field{
            Description: â€œç”¨æˆ·çŠ¶æ€â€,
            Type:        UserStatusEnumType,
        },
    },
})
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
queryä¸mutationçš„å®šä¹‰
var MutationType = graphql.NewObject(graphql.ObjectConfig{
    Name: â€œMutationâ€,
    Fields: graphql.Fields{
        â€œcreateUserâ€: &amp;graphql.Field{
            Type:        graphql.Boolean,
            Description: â€œ[ç”¨æˆ·ç®¡ç†] åˆ›å»ºç”¨æˆ·â€,
            Args: graphql.FieldConfigArgument{
                â€œuserNameâ€: &amp;graphql.ArgumentConfig{
                    Description: â€œç”¨æˆ·åç§°â€,
                    Type:        graphql.NewNonNull(graphql.String),
                },
                â€œemailâ€: &amp;graphql.ArgumentConfig{
                    Description: â€œç”¨æˆ·é‚®ç®±â€,
                    Type:        graphql.NewNonNull(graphql.String),
                },
                â€œpwdâ€: &amp;graphql.ArgumentConfig{
                    Description: â€œç”¨æˆ·å¯†ç â€,
                    Type:        graphql.NewNonNull(graphql.String),
                },
                â€œphoneâ€: &amp;graphql.ArgumentConfig{
                    Description: â€œç”¨æˆ·è”ç³»æ–¹å¼â€,
                    Type:        graphql.Int,
                },
            },
            Resolve: func(p graphql.ResolveParams) (interface{}, error) {
                userId, _ := strconv.Atoi(GenerateID())
                user := &amp;model.User{
                  //å±•ç¤ºå¦‚ä½•è§£æä¼ å…¥çš„å‚æ•°
                    Name: p.Args[â€œuserNameâ€].(string),
                    Email: sql.NullString{
                        String: p.Args[â€œemailâ€].(string),
                        Valid:  true,
                    },
                    Pwd:    p.Args[â€œpwdâ€].(string),
                    Phone:  int64(p.Args[â€œphoneâ€].(int)),
                    UserID: uint64(userId),
                    Status: int64(model.EnableStatus),
                }
                if err := model.InsertUser(user); err != nil {
                    log.WithError(err).Error(â€œ[mutaition.createUser] invoke InserUser() failedâ€)
                    return false, err
                }
                return true, nil</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        },
    },

}, })
</code></pre></div></div>

<p>var QueryType = graphql.NewObject(graphql.ObjectConfig{
    Name: â€œQueryâ€,
    Fields: graphql.Fields{
        â€œUserListInfoâ€: &amp;graphql.Field{
            Description: â€œ[ç”¨æˆ·ç®¡ç†] è·å–æŒ‡å®šç”¨æˆ·çš„ä¿¡æ¯â€,
          //å®šä¹‰äº†éç©ºçš„listç±»å‹
            Type:        graphql.NewNonNull(graphql.NewList(UserInfoType)),
            Resolve: func(p graphql.ResolveParams) (interface{}, error) {
                users, err := model.GetUsers()
                if err != nil {
                    log.WithError(err).Error(â€œ[query.UserInfo] invoke InserUser() failedâ€)
                    return false, err
                }
                usersList := make([]*UserInfo, 0)
                for _, v := range users {
                    userInfo := new(UserInfo)
                    userInfo.Name = v.Name
                    userInfo.Email = v.Email.String
                    userInfo.Phone = v.Phone
                    userInfo.Pwd = v.Pwd
                    userInfo.Status = model.UserStatusType(v.Status)
                    usersList = append(usersList, userInfo)</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>            }
            return usersList, nil

        },
    },
}, }) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 æ³¨æ„ï¼š
</code></pre></div></div>

<p>æ­¤å¤„ä»…å±•ç¤ºäº†éƒ¨åˆ†ä¾‹å­
æ­¤å¤„ç¬”è€…ä»…åˆ—ä¸¾äº†queryã€mutationç±»å‹çš„å®šä¹‰
å¦‚ä½•å®šä¹‰æœåŠ¡mainå‡½æ•°
type ServerCfg struct {
    Addr      string
    MysqlAddr string
}</p>

<p>func main() {
    //load config info
    m := multiconfig.NewWithPath(â€œconfig.tomlâ€)
    svrCfg := new(ServerCfg)
    m.MustLoad(svrCfg)
    //new graphql schema
    schema, err := graphql.NewSchema(
        graphql.SchemaConfig{
            Query:    object.QueryType,
            Mutation: object.MutationType,
        },
    )
    if err != nil {
        log.WithError(err).Error(â€œ[main] invoke graphql.NewSchema() failedâ€)
        return
    }</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>model.InitSqlxClient(svrCfg.MysqlAddr)
h := handler.New(&amp;handler.Config{
    Schema:   &amp;schema,
    Pretty:   true,
    GraphiQL: true,
})
http.HandleFunc("/graphql", func(w http.ResponseWriter, r *http.Request) {
    ctx := context.Background()
    //read user_id from gateway
    userIDStr := r.Header.Get("user_id")
    if len(userIDStr) &gt; 0 {
        userID, err := strconv.Atoi(userIDStr)
        if err != nil {
            w.WriteHeader(http.StatusBadRequest)
            w.Write([]byte(err.Error()))
            return
        }
        ctx = context.WithValue(ctx, "ContextUserIDKey", userID)
    }
    h.ContextHandler(ctx, w, r)

})
log.Fatal(http.ListenAndServe(svrCfg.Addr, nil)) }
</code></pre></div></div>

<p>http://graphql.cn/
https://juejin.im/post/5ac1b03bf265da237b223e82
https://laravel-china.org/topics/3112/why-did-github-open-a-graphql-version-of-api
http://www.cnblogs.com/sunshine-anycall/p/6357577.html</p>

<p>Golang</p>

<p>Go æ˜¯Googleå¼€å‘çš„ä¸€ç§é™æ€å¼ºç±»å‹ã€ç¼–è¯‘å‹ã€å¹¶å‘å‹ï¼Œå¹¶å…·æœ‰åƒåœ¾å›æ”¶åŠŸèƒ½çš„ç¼–ç¨‹è¯­è¨€ã€‚ä¸ºäº†æ–¹ä¾¿æœç´¢å’Œè¯†åˆ«ï¼Œæœ‰æ—¶ä¼šå°†å…¶ç§°ä¸ºGolangã€‚
GraphQL</p>

<p>GraphQL æ—¢æ˜¯ä¸€ç§ç”¨äº API çš„æŸ¥è¯¢è¯­è¨€ä¹Ÿæ˜¯ä¸€ä¸ªæ»¡è¶³ä½ æ•°æ®æŸ¥è¯¢çš„è¿è¡Œæ—¶ã€‚
Gin</p>

<p>Gin is a HTTP web framework written in Go (Golang).
ä¸ºä»€ä¹ˆè¦ç”¨GraphQLï¼Ÿ</p>

<p>ä¸ºäº†è®©apiå…·æœ‰æ›´å¼ºçš„é€‚åº”æ€§ï¼Œé‡‡ç”¨graphqlæ¥ç¼–å†™æŸ¥è¯¢æ¥å£æ˜¯ä¸ªä¸é”™çš„é€‰æ‹©ã€‚ç°åœ¨çš„apiéœ€è¦é€‚åº”çš„åœºæ™¯å¤ªå¤šäº†ï¼Œè€Œä¸”è¿­ä»£èŠ‚å¥ä¹Ÿå¾ˆå¿«ï¼ŒRESTfulçš„æŸ¥è¯¢æ¥å£åœ¨ä¸€äº›å¤æ‚çš„åœºæ™¯ä¸‹æ˜¾å¾—ç‰¹åˆ«çš„ç¹æ‚ï¼Œå¦‚å¤šé‡åµŒå¥—çš„èµ„æºã€‚</p>

<p>ä¸ºä»€ä¹ˆè¦ç”¨Goï¼Ÿ</p>

<p>åœ¨ Go è¯­è¨€å‡ºç°ä¹‹å‰ï¼Œå¼€å‘è€…ä»¬æ€»æ˜¯é¢ä¸´éå¸¸è‰°éš¾çš„æŠ‰æ‹©ï¼Œç©¶ç«Ÿæ˜¯ä½¿ç”¨æ‰§è¡Œé€Ÿåº¦å¿«ä½†æ˜¯ç¼–è¯‘é€Ÿåº¦å¹¶ä¸ç†æƒ³çš„è¯­è¨€ï¼ˆå¦‚ï¼šC++ï¼‰ï¼Œè¿˜æ˜¯ä½¿ç”¨ç¼–è¯‘é€Ÿåº¦è¾ƒå¿«ä½†æ‰§è¡Œæ•ˆç‡ä¸ä½³çš„è¯­è¨€ï¼ˆå¦‚ï¼š.NETã€Javaï¼‰ï¼Œæˆ–è€…è¯´å¼€å‘éš¾åº¦è¾ƒä½ä½†æ‰§è¡Œé€Ÿåº¦ä¸€èˆ¬çš„åŠ¨æ€è¯­è¨€å‘¢ï¼Ÿæ˜¾ç„¶ï¼ŒGo è¯­è¨€åœ¨è¿™ 3 ä¸ªæ¡ä»¶ä¹‹é—´åšåˆ°äº†æœ€ä½³çš„å¹³è¡¡ï¼šå¿«é€Ÿç¼–è¯‘ï¼Œé«˜æ•ˆæ‰§è¡Œï¼Œæ˜“äºå¼€å‘ã€‚</p>

<p>ä¸ºä»€ä¹ˆè¦ç”¨Ginï¼Ÿ</p>

<p>å› ä¸ºGinå¤Ÿç®€æ´ï¼Œé€‚åˆå®šåˆ¶åˆé€‚è‡ªå·±é£æ ¼çš„æ¡†æ¶ã€‚</p>

<p>åœ¨è¿™é‡Œä¸»è¦è®°å½•é›†æˆGraphQLçš„éƒ¨åˆ†ï¼Œå¯¹äºGinçš„ç›®å½•ç»“æ„ç»„ç»‡å› äººè€Œå¼‚ï¼Œå°±ä¸åšè¯¦ç»†ä»‹ç»ã€‚</p>

<p>åœ¨Goé‡Œé¢é›†æˆgraphqléœ€è¦ç”¨åˆ°graphql-goè¿™ä¸ªpackageï¼Œå½“ç„¶å¯ä»¥å‚è€ƒGraphQLæ–‡æ¡£æä¾›çš„å…¶ä»–ã€‚</p>

<p>// ä»schemaå¼€å§‹
// schema/schema.go
package schema</p>

<p>// å¼•å…¥åŒ…graphql-go
import (
	â€œgithub.com/graphql-go/graphqlâ€
)</p>

<p>// å®šä¹‰è·ŸæŸ¥è¯¢èŠ‚ç‚¹
var rootQuery = graphql.NewObject(graphql.ObjectConfig{
	Name: â€œRootQueryâ€,
	Description: â€œRoot Queryâ€,
	Fields: graphql.Fields{
		â€œhelloâ€: &amp;queryHello, // queryHello å‚è€ƒschema/hello.go
	},
})</p>

<p>// å®šä¹‰Schemaç”¨äºhttp handlerå¤„ç†
var Schema, _ = graphql.NewSchema(graphql.SchemaConfig{
	Query:    rootQuery,
	Mutation: nil, // éœ€è¦é€šè¿‡GraphQLæ›´æ–°æ•°æ®ï¼Œå¯ä»¥å®šä¹‰Mutation
})</p>

<p>// schema/hello.go
package schema</p>

<p>import (
	â€œgolesson/modelâ€</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"github.com/graphql-go/graphql" )
</code></pre></div></div>

<p>// å®šä¹‰æŸ¥è¯¢å¯¹è±¡çš„å­—æ®µï¼Œæ”¯æŒåµŒå¥—
var helloType = graphql.NewObject(graphql.ObjectConfig{
	Name: â€œHelloâ€,
	Description: â€œHello Modelâ€,
	Fields: graphql.Fields{
		â€œidâ€: &amp;graphql.Field{
			Type: graphql.Int,
		},
		â€œnameâ€: &amp;graphql.Field{
			Type: graphql.String,
		},
	},
})</p>

<p>// å¤„ç†æŸ¥è¯¢è¯·æ±‚
var queryHello = graphql.Field{
	Name: â€œQueryHelloâ€,
	Description: â€œQuery Helloâ€,
	Type: graphql.NewList(helloType),
        // Argsæ˜¯å®šä¹‰åœ¨GraphQLæŸ¥è¯¢ä¸­æ”¯æŒçš„æŸ¥è¯¢å­—æ®µï¼Œ
        // å¯è‡ªè¡Œéšæ„å®šä¹‰ï¼Œå¦‚åŠ ä¸Šlimit,startè¿™ç±»
	Args: graphql.FieldConfigArgument{
		â€œidâ€: &amp;graphql.ArgumentConfig{
			Type: graphql.Int,
		},
		â€œnameâ€: &amp;graphql.ArgumentConfig{
			Type: graphql.String,
		},
	},
        // Resolveæ˜¯ä¸€ä¸ªå¤„ç†è¯·æ±‚çš„å‡½æ•°ï¼Œå…·ä½“å¤„ç†é€»è¾‘å¯åœ¨æ­¤è¿›è¡Œ
	Resolve: func(p graphql.ResolveParams) (result interface{}, err error) {
                // Argsé‡Œé¢å®šä¹‰çš„å­—æ®µåœ¨p.Argsé‡Œé¢ï¼Œå¯¹åº”çš„å–å‡ºæ¥
                // å› ä¸ºæ˜¯interface{}çš„å€¼ï¼Œéœ€è¦ç±»å‹è½¬æ¢ï¼Œå¯å‚è€ƒç±»å‹æ–­è¨€(type assertion): https://zengweigang.gitbooks.io/core-go/content/eBook/11.3.html
		id, _ := p.Args[â€œidâ€].(int)
		name, _ := p.Args[â€œnameâ€].(string)</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>            // è°ƒç”¨Helloè¿™ä¸ªmodelé‡Œé¢çš„Queryæ–¹æ³•æŸ¥è¯¢æ•°æ®
	return (&amp;model.Hello{}).Query(id, name)
}, }
</code></pre></div></div>

<p>// å‡†å¤‡å¥½äº†GraphQLåœ¨Goé‡Œé¢éœ€è¦çš„ä¸œè¥¿ä¹‹åï¼Œæ¥çœ‹çœ‹å¦‚ä½•è·ŸGinç»“åˆ
// controller/graphql/graphql.go
package graphql</p>

<p>import (
	â€œgolesson/schemaâ€</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"github.com/gin-gonic/gin"
"github.com/graphql-go/handler" )
</code></pre></div></div>

<p>func GraphqlHandler() gin.HandlerFunc{
	h := handler.New(&amp;handler.Config{
		Schema: &amp;schema.Schema,
		Pretty: true,
		GraphiQL: true,
	})</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    // åªéœ€è¦é€šè¿‡Ginç®€å•å°è£…å³å¯
return func(c *gin.Context) {
	h.ServeHTTP(c.Writer, c.Request)
} }
</code></pre></div></div>

<p>// route/router.go
package router</p>

<p>import (
	â€œgolesson/controller/graphqlâ€</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"github.com/gin-gonic/gin" )
</code></pre></div></div>

<p>var Router *gin.Engine</p>

<p>func init() {
	Router = gin.Default()
}</p>

<p>func SetRouter() {
        // GETæ–¹æ³•ç”¨äºæ”¯æŒGraphQLçš„webç•Œé¢æ“ä½œ
        // å¦‚æœä¸éœ€è¦webç•Œé¢ï¼Œå¯æ ¹æ®è‡ªå·±éœ€æ±‚ç”¨GET/POSTæˆ–è€…å…¶ä»–éƒ½å¯ä»¥
	Router.POST(â€œ/graphqlâ€, graphql.GraphqlHandler())
	Router.GET(â€œ/graphqlâ€, graphql.GraphqlHandler())
}</p>

<p>// main.go
package main</p>

<p>import â€œgolesson/routeâ€</p>

<p>func main () {
	r := router.Router</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>router.SetRouter()

r.Run(":1234") }
</code></pre></div></div>

<p>https://zhuanlan.zhihu.com/p/35792985</p>

<p>Githubæä¾›çš„GraphQLæ¥å£éå¸¸å…¨é¢ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¯¥å¦‚ä½•æ­å»ºå‡ºè‡ªå·±çš„æ¥å£å‘¢ï¼Ÿå¥½åœ¨GraphQLæä¾›äº†å¾ˆå¤šè¯­è¨€çš„è§£å†³æ–¹æ¡ˆã€‚æœ¬æ–‡ä¸»è¦é˜è¿°å¦‚ä½•ç”¨goæ­å»ºè‡ªå·±çš„GraphQLæœåŠ¡å™¨ã€‚å¦‚æœäº†è§£GraphQLå»ºè®®å…ˆé˜…è¯»GraphQL â€” APIæŸ¥è¯¢è¯­è¨€ æˆ–ç›¸å…³èµ„æ–™ã€‚</p>

<p>graphql-go
An implementation of GraphQL in Go. Follows the official reference implementation graphql-js.
ä¸€å¥—æ¯”è¾ƒå®Œå–„çš„æ¡†æ¶ï¼Œä¼—æ‰€å‘¨çŸ¥goçš„ç»“æ„ä½“å¯¹jsonéå¸¸å‹å¥½ï¼Œæ‰€ä»¥å¹¶ä¸éœ€è¦å¯¹æ•°æ®æœ‰ç‰¹æ®Šçš„å¤„ç†ï¼Œè¿˜æ˜¯å¾ˆæ–¹ä¾¿çš„ã€‚æ‰“å¼€ç»ˆç«¯è¾“å…¥å‘½ä»¤</p>

<p>go get github.com/graphql-go/graphql</p>

<p>Object
åœ¨æœåŠ¡ç«¯ç¼–ç¨‹ä¸­ï¼Œç¼–å†™çš„ä¸€åˆ‡éƒ½å¯ä»¥ç§°ä¹‹ä¸ºå¯¹è±¡ï¼ˆObjectï¼‰ã€‚ä¾‹å¦‚ä¸€ä¸ªå•†å“ï¼ˆgoodsï¼‰çš„å®ä¾‹å¯ä»¥æœ‰å•†å“åï¼ˆnameï¼‰ã€ä»·æ ¼ï¼ˆpriceï¼‰ã€è´­ä¹°é“¾æ¥ï¼ˆurlï¼‰ä¸‰ä¸ªå­—æ®µã€‚æ­¤æ—¶å•†å“å¯ä»¥å¾ˆè‡ªç„¶çš„è¢«ç§°ä¸ºä¸€ä¸ªobjectï¼ŒæŸ¥è¯¢çš„è¯­å¥å¯ä»¥å†™æˆï¼š</p>

<p>{
    goods{
        name
        price
        url
    }
}
å¦‚æœæ­¤æ—¶æˆ‘ä»¬è¦æŸ¥è¯¢å•†å“å’Œæ–‡ç« ä¸¤ç§objectçš„ä¿¡æ¯:</p>

<p>/* query å¯ä»¥çœå» */
query{ 
    goods{
        name
    }
    article{
        name
    }
}
æ˜¯å¦ä½ å·²ç»å‘è§‰ï¼Œqueryåƒä¸€ä¸ªå¤§çš„objectï¼Œå®ƒæœ‰goodså’Œarticleä¸¤ä¸ªå­—æ®µã€‚é™¤æ­¤ä¹‹å¤–ï¼Œmutationä¹Ÿæ˜¯å¦‚æ­¤ï¼š</p>

<p>mutation{
    addGoods(input:goodsInput){
        name
    }
}
è¿™é‡Œçš„addGoodså¯ä»¥çœ‹åšæ˜¯ä¸€ä¸ªå¯ä»¥å¤„ç†å‚æ•°çš„å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯æŸç§æ„ä¹‰ä¸Šçš„å‡½æ•°ã€‚</p>

<p>æ€»ä¹‹ï¼ŒGraphQLæœåŠ¡ç«¯çš„ç¼–ç¨‹å°±æ˜¯ä¸€ä¸ªåˆä¸€ä¸ªçš„å¯¹è±¡å°†å½¢æˆçš„åµŒå¥—ç»“æ„ï¼ˆschemaï¼‰ç»„ç»‡èµ·æ¥ï¼Œå¹¶å¯¹å¤–æä¾›æœåŠ¡ã€‚</p>

<p>query&amp;mutation
ä¸ºäº†é˜²æ­¢ä½çº§é”™è¯¯çš„å‘ç”Ÿï¼Œåœ¨å½“å‰pkgä¸‹æ–°å»ºä¸€ä¸ªåä¸ºquery.goï¼ˆéšä¾¿èµ·ï¼‰çš„æ–‡ä»¶ã€‚</p>

<p>import (
    â€œgithub.com/graphql-go/graphqlâ€
    â€œerrorsâ€
)
å®šä¹‰good object</p>

<p>type Goods struct {
    ID    string <code class="language-plaintext highlighter-rouge">json:"id"</code>
    Name  string <code class="language-plaintext highlighter-rouge">json:"name"</code>
    Price float64<code class="language-plaintext highlighter-rouge">json:"price"</code>
    Url   string <code class="language-plaintext highlighter-rouge">json:"url"</code>
}</p>

<p>var goodsType = graphql.NewObject(
    graphql.ObjectConfig{
        Name: â€œGoodsâ€,
        Fields: graphql.Fields{
            â€œidâ€: &amp;graphql.Field{
                Type: graphql.String,
            },
            â€œnameâ€: &amp;graphql.Field{
                Type: graphql.String,
            },
            â€œpriceâ€: &amp;graphql.Field{
                Type: graphql.Float,
            },
            â€œurlâ€: &amp;graphql.Field{
                Type: graphql.String,
            },
        },
    },
)
var goodsListType = graphql.NewList(goodsType)
æ³¨æ„ï¼šæ•°ç»„ç›¸å½“äºæ–°çš„objectç±»å‹ã€‚</p>

<p>å®šä¹‰query object</p>

<p>var queryType = graphql.NewObject(
    graphql.ObjectConfig{
        Name: â€œQueryâ€,
        Fields: graphql.Fields{
            // æ— éœ€å¤„ç†å‚æ•°
            â€œgoodsListâ€: &amp;graphql.Field{
                Type:goodsListType,
                // å¤„ç†ç»“æ„ä½“çš„å›è°ƒå‡½æ•°ï¼Œç›´æ¥è¿”å›å¤„ç†å®Œæˆçš„ç»“æ„ä½“å³å¯
                Resolve: func(p graphql.ResolveParams) (interface{}, error) {
                    return result, err
                },
            },
            // å‚æ•°æ˜¯id
            â€œgoodsâ€: &amp;graphql.Field{
                Type: goodsType,
                Args: graphql.FieldConfigArgument{
                    â€œidâ€: &amp;graphql.ArgumentConfig{
                        Type: graphql.String,
                    },
                },
                Resolve: func(p graphql.ResolveParams) (interface{}, error) {
                    // è·å–å‚æ•°
                    idQuery, isOK := p.Args[â€œidâ€].(string)
                    if isOK {
                        return result, nil
                    }
                    err := errors.New(â€œField â€˜goodsâ€™ is missing required arguments: id. â€œ)
                    return nil, err
                },
            },
        },
    },
)
mutationå®šä¹‰åŸºæœ¬ç›¸åŒï¼Œæ–°å»ºä¸€ä¸ªåä¸ºmutation.goçš„æ–‡ä»¶ï¼š</p>

<p>å®šä¹‰input object</p>

<p>var goodsInputType = graphql.NewInputObject(
    graphql.InputObjectConfig{
        Name: â€œgoodsInputâ€,
        Fields: graphql.InputObjectConfigFieldMap{
            â€œnameâ€: &amp;graphql.InputObjectFieldConfig{
                Type: graphql.String,
            },
            â€œpriceâ€: &amp;graphql.InputObjectFieldConfig{
                Type: graphql.Float,
            },
            â€œurlâ€: &amp;graphql.InputObjectFieldConfig{
                Type: graphql.String,
            },
        },
    },
)
å®šä¹‰ mutation object</p>

<p>var mutationType = graphql.NewObject(
   graphql.ObjectConfig{
      Name: â€œMutationâ€,
      Fields: graphql.Fields{
      â€œaddGoodsâ€:&amp;graphql.Field{
                Type:goodsType,
                Args:graphql.FieldConfigArgument{
                    â€œinputâ€:&amp;graphql.ArgumentConfig{
                        Type:goodsInputType,
                    },
                },
                Resolve: func(p graphql.ResolveParams) (interface{}, error) {
                    input,isOk := p.Args[â€œinputâ€].(map[string]string)
                    if !isOk{
                        err := errors.New(â€œField â€˜addGoodsâ€™ is missing required arguments: input. â€œ)
                        return nil,err
                    }
                    result := Goods{
                        Name:input[â€œnameâ€].(string),
                        Price:input[â€œpriceâ€].(float64),
                        Url:input[â€œurlâ€].(string),
                    }
                    // å¤„ç†æ•°æ®
                    return result,err
                },
            },
        },
    },
)
ç„¶è€Œï¼Œinputç±»å‹å¹¶ä¸èƒ½ç›´æ¥è½¬æ¢ä¸ºstructï¼Œè€Œæ˜¯ä¸€ä¸ªmap[string]interface{}ç±»å‹ï¼Œè¿˜éœ€è¦è¿›è¡Œæ‰‹åŠ¨è½¬æ¢ã€‚</p>

<p>å®šä¹‰schema</p>

<p>var schema, _ = graphql.NewSchema(
   graphql.SchemaConfig{
      Query:    queryType,
      Mutation: mutationType,
   },
)
è‡³æ­¤ï¼Œæˆ‘ä»¬çš„å…¨éƒ¨çš„objectå®šä¹‰å®Œæˆã€‚</p>

<p>æä¾›æœåŠ¡
graphql-goä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªæ–¹ä¾¿çš„æ¥å£ï¼Œå°è£…å¥½çš„handlerå¯ä»¥ç›´æ¥ä¸goè‡ªå¸¦çš„httpåŒ…ç»‘å®šã€‚</p>

<p>package api
import â€œgithub.com/graphql-go/handlerâ€</p>

<p>func Register() *handler.Handler {
   h := handler.New(&amp;handler.Config{
      Schema:   &amp;schema,
      Pretty:   true,
      GraphiQL: true,
   })
   return h
}
func main() {
   h := api.Register()
   handler := cors.Default().Handler(h)
   http.Handle(â€œ/graphqlâ€, handler)
   fmt.Println(â€œThe api server will run on port : â€œ, apiPort)
   http.ListenAndServe(apiPort, nil)
}
æ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—®http://localhost:apiPort/graphql, æŸ¥çœ‹ä½ è‡ªå·±çš„GraphiQLç•Œé¢å§ï¼</p>

<p>ç»“æŸè¯­
å¦‚æœä½ è§‰å¾—è¿™æ ·çš„ä»£ç è°ˆä¸ä¸Šä¼˜é›…ï¼Œç”šè‡³éå¸¸ä¸‘é™‹ï¼Œé‚£å°±å¯¹äº†ã€‚å› ä¸ºæˆ‘ä¹Ÿè¿™æ ·è§‰å¾—ï¼Œçœ‹ä¸€çœ‹éš”å£pythonçš„å®ç°æ–¹å¼ï¼š</p>

<p>import graphene</p>

<p>class Query(graphene.ObjectType):
  hello = graphene.String()</p>

<p>def resolve_hello(self, args, context, info):
    return â€˜Hello world!â€™</p>

<p>schema = graphene.Schema(query=Query)
æœ‰æ²¡æœ‰æ¶Œæ¥ä¸€å£è€è¡€ã€‚</p>

<p>å¯èƒ½æ˜¯å—é™ä¸golangæœ¬èº«åå°„ç³»ç»Ÿå¹¶ä¸å¤Ÿå®Œå–„ï¼Œæ²¡æœ‰pythonå„ç§å„æ ·çš„é­”æœ¯æ–¹æ³•ï¼Œæ²¡æœ‰æ³›å‹ï¼Œæˆ–è€…è¯´goæœ¬èº«ä¸å¤ªé€‚åˆç¼–å†™æ¡†æ¶ç±»çš„ä»£ç ã€‚åœ¨ç¼–å†™çš„è¿‡ç¨‹ä¸­ï¼Œå†—ä½™éå¸¸å¤šï¼Œå½“ç„¶ä¹Ÿå¯èƒ½æ˜¯æ¡†æ¶æœ¬èº«çš„é—®é¢˜</p>

<p>ä¸å¯å¦è®¤çš„æ˜¯ï¼Œgoç¡®å®æ˜¯éå¸¸ä¸é”™çš„ä¸€é—¨è¯­è¨€ï¼Œè™½ç„¶å¼€å‘æ•ˆç‡æ— æ³•ä¸pythonåª²ç¾ï¼Œä½†æ˜¯åœ¨å¤šå¹¶å‘ç¯å¢ƒä¸‹ï¼Œgoè¡¨ç°å‡ºéå¸¸å‡ºè‰²ï¼ŒåŒæ—¶æ‹¥æœ‰ä¸Cçº§åˆ«çš„è¿è¡Œé€Ÿåº¦å’Œä¸°å¯Œçš„ç”Ÿæ€ã€‚</p>

<p>GitHub å®£å¸ƒå¼€æ”¾äº†ä¸€å¥—ä½¿ç”¨ GraphQL å¼€å‘çš„å…¬å…± APIã€‚</p>

<p>GitHub çš„ REST API å·²ç»éå¸¸å®Œå–„ï¼Œè®¾è®¡å¾—å¾ˆä¼˜ç§€ï¼Œå¾ˆå¤šå…¬å¸å¼€å‘è‡ªå·±çš„ REST API æ—¶éƒ½ä¼šå‚è€ƒ GitHubï¼Œä¹Ÿæœ‰å¾ˆå¤šçˆ±å¥½è€…å†™äº†éå¸¸ä¸°å¯Œçš„æ•™ç¨‹ã€‚</p>

<p>GraphQL çš„æ ¸å¿ƒæ˜¯ä¸€å¥—æ•°æ®æŸ¥è¯¢è¯­è¨€çš„è§„èŒƒï¼Œæ˜¯ Facebook åœ¨ 2012 å¹´å¼€å‘çš„ï¼Œ2015 å¹´å¼€æºï¼ŒFacebook å†…éƒ¨å·²ç»å¹¿æ³›åº”ç”¨ï¼Œç”¨äºæ›¿ä»£ RESTã€‚</p>

<p>GitHub ä¸ºä»€ä¹ˆé€‰æ‹© GraphQLï¼Ÿè¿™æ˜¯å¾ˆå¤šç”¨æˆ·å…³å¿ƒçš„é—®é¢˜ï¼ŒGithub å¯¹æ­¤åšäº†è§£é‡Šã€‚</p>

<p>REST API æœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ
é¦–è¦é—®é¢˜å°±æ˜¯æ‰©å±•æ€§æ–¹é¢ï¼Œéšç€ API çš„ä¸æ–­å‘å±•ï¼Œä¼šå˜å¾—è¶Šæ¥è¶Šè‡ƒè‚¿</p>

<p>REST API çš„æ–¹å¼æ˜¯ï¼šserver å®šä¹‰ä¸€ç³»åˆ—çš„æ¥å£ï¼Œclient è°ƒç”¨è‡ªå·±éœ€è¦çš„æ¥å£ï¼Œè·å–ç›®æ ‡æ•°æ®è¿›è¡Œæ•´åˆ</p>

<p>ä¾‹å¦‚ç”¨æˆ·æ¥å£ï¼Œåˆšå¼€å§‹æ—¶ï¼Œè¿”å›çš„ä¿¡æ¯ä¼šæ¯”è¾ƒå°‘ï¼Œä¾‹å¦‚åªæœ‰ id,name</p>

<p>åæ¥ç”¨æˆ·çš„ä¿¡æ¯å¢åŠ äº†ï¼Œå°±åœ¨ç”¨æˆ·æ¥å£ä¸­è¿”å›æ›´å¤šçš„ä¿¡æ¯ï¼Œä¾‹å¦‚ id,name,age,city,addr,email,headimage,nick</p>

<p>ä½†å¯èƒ½å¾ˆå¤š client åªæ˜¯æƒ³è·å–å…¶ä¸­å°‘éƒ¨åˆ†ä¿¡æ¯ï¼Œå¦‚ name,headimageï¼Œå´å¿…é¡»å¾—åˆ°æ‰€æœ‰çš„ç”¨æˆ·ä¿¡æ¯ï¼Œç„¶åä»ä¸­æå–è‡ªå·±æƒ³è¦çš„</p>

<p>è¿™ä¸ªæƒ…å†µä¼šå¢åŠ ç½‘ç»œä¼ è¾“é‡ï¼Œå¹¶ä¸”ä¸ä¾¿äº client å¤„ç†æ•°æ®</p>

<p>è¿˜æœ‰ä¸€ä¸ªä¸æ–¹ä¾¿çš„åœ°æ–¹ï¼Œä¾‹å¦‚ client åœ¨æŸä¸ªéœ€æ±‚ä¸­ï¼Œå¯èƒ½éœ€è¦è°ƒç”¨å¤šä¸ªç‹¬ç«‹çš„ API æ‰èƒ½è·å–åˆ°è¶³å¤Ÿçš„æ•°æ®</p>

<p>ä¾‹å¦‚ client è¦æ˜¾ç¤ºä¸€ç¯‡æ–‡ç« çš„å†…å®¹ï¼ŒåŒæ—¶è¦æ˜¾ç¤ºè¯„è®ºã€ä½œè€…ä¿¡æ¯ï¼Œé‚£ä¹ˆå°±å¯èƒ½éœ€è¦è°ƒç”¨æ–‡ç« æ¥å£ã€è¯„è®ºæ¥å£ã€ç”¨æˆ·æ¥å£</p>

<p>è¿™ç§æ–¹å¼éå¸¸ä¸çµæ´»</p>

<p>GitHub è¿˜é‡åˆ°å…¶ä»–ä¸€äº› REST API ä¸å¥½å¤„ç†çš„é—®é¢˜ï¼Œä¾‹å¦‚</p>

<p>æƒ³è¦ç¡®ä¿ client æä¾›çš„å‚æ•°çš„ç±»å‹å®‰å…¨ï¼›æƒ³è¦ä»ä»£ç ç”Ÿæˆæ–‡æ¡£ï¼›æƒ³è¦è¯†åˆ«æ¯ä¸ªç«¯ç‚¹çš„ OAuth è¯·æ±‚èŒƒå›´ â€¦â€¦</p>

<p>ä½¿ç”¨ GraphQL æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ
GraphQL ç®€å•æ¥è¯´å°±æ˜¯ï¼šå–å“ªäº›æ•°æ®æ˜¯ç”± client æ¥å†³å®š</p>

<p>REST ä¸­ï¼Œç»™å“ªäº›æ•°æ®æ˜¯ server å†³å®šçš„ï¼Œclient åªèƒ½ä»ä¸­æŒ‘é€‰ï¼Œå¦‚æœ A æ¥å£ä¸­çš„æ•°æ®ä¸å¤Ÿï¼Œå†è¯·æ±‚ B æ¥å£ï¼Œç„¶åä»ä»–ä»¬è¿”å›çš„æ•°æ®ä¸­æŒ‘å‡ºè‡ªå·±éœ€è¦çš„</p>

<p>GraphQL ä¸­ï¼Œclient ç›´æ¥å¯¹ server è¯´æƒ³è¦ä»€ä¹ˆæ•°æ®ï¼Œserver è´Ÿè´£ç²¾ç¡®çš„è¿”å›ç›®æ ‡æ•°æ®</p>

<p>ä¾‹å¦‚ï¼Œä½ æƒ³è¦è·å–ç”¨æˆ·çš„å‡ ä¸ªå±æ€§ä¿¡æ¯ï¼Œä½ çš„ GraphQL è¯·æ±‚å°±æ˜¯è¿™æ ·çš„</p>

<p>{
 viewer {
   login
   bio
   location
   isBountyHunter
 }
}
è¿”å›çš„å“åº”ä¿¡æ¯å¦‚ä¸‹</p>

<p>{
 â€œdataâ€: {
   â€œviewerâ€: {
     â€œloginâ€: â€œoctocatâ€,
     â€œbioâ€: â€œIâ€™ve been around the world, from London to the Bay.â€,
     â€œlocationâ€: â€œSan Francisco, CAâ€,
     â€œisBountyHunterâ€: true
   }
 }
}
å†çœ‹ä¸€ä¸ªæ›´å¤æ‚çš„ä¾‹å­ï¼Œä¾‹å¦‚ä½ æƒ³çŸ¥é“ä½ ç»™å¤šå°‘ä¸ªé¡¹ç›®ç‚¹äº®è¿‡æ˜Ÿæ˜Ÿã€æœ€åˆ 3 ä¸ªé¡¹ç›®çš„åå­—ã€åŠä»–ä»¬ star fork watcher çš„æ€»æ•°å¯ä»¥çœ‹åˆ°ï¼Œè¿”å›çš„ JSON æ•°æ®ä¸­ï¼Œkey value æ˜¯å’Œè¯·æ±‚å®Œå…¨ä¸€è‡´çš„</p>

<p>GraphQL è¯·æ±‚å°±æ˜¯è¿™æ ·çš„</p>

<p>{
 viewer {
   login
   starredRepositories {
     totalCount
   }
   repositories(first: 3) {
     edges {
       node {
         name
         stargazers {
           totalCount
         }
         forks {
           totalCount
         }
         watchers {
           totalCount
         }
         issues(states:[OPEN]) {
           totalCount
         }
       }
     }
   }
 }
}
å“åº”ä¿¡æ¯å¦‚ä¸‹</p>

<p>{<br />
 â€œdataâ€:{<br />
   â€œviewerâ€:{<br />
     â€œloginâ€: â€œoctocatâ€,
     â€œstarredRepositoriesâ€: {
       â€œtotalCountâ€: 131
     },
     â€œrepositoriesâ€:{
       â€œedgesâ€:[
         {
           â€œnodeâ€:{
             â€œnameâ€:â€octokit.rbâ€,
             â€œstargazersâ€:{
               â€œtotalCountâ€: 17
             },
             â€œforksâ€:{
               â€œtotalCountâ€: 3
             },
             â€œwatchersâ€:{
               â€œtotalCountâ€: 3
             },
             â€œissuesâ€: {
               â€œtotalCountâ€: 1
             }
           }
         },
         {<br />
           â€œnodeâ€:{<br />
             â€œnameâ€:â€octokit.objcâ€,
             â€œstargazersâ€:{
               â€œtotalCountâ€: 2
             },
             â€œforksâ€:{
               â€œtotalCountâ€: 0
             },
             â€œwatchersâ€:{
               â€œtotalCountâ€: 1
             },
             â€œissuesâ€: {
               â€œtotalCountâ€: 10
             }
           }
         },
         {
           â€œnodeâ€:{
             â€œnameâ€:â€octokit.netâ€,
             â€œstargazersâ€:{
               â€œtotalCountâ€: 19
             },
             â€œforksâ€:{
               â€œtotalCountâ€: 7
             },
             â€œwatchersâ€:{
               â€œtotalCountâ€: 3
             },
             â€œissuesâ€: {
               â€œtotalCountâ€: 4
             }
           }
         }
       ]
     }
   }
 }
}
 ä»£ç å·²è¢«æŠ˜å ï¼Œç‚¹æ­¤å±•å¼€
GraphQL è¿˜æœ‰å¾ˆå¤šå…¶ä»–çš„ç‰¹ç‚¹ï¼Œä¾‹å¦‚ä½ åªéœ€è¦ä¸€ä¸ªè¯·æ±‚ï¼Œå°±å¯ä»¥å¾—åˆ°æ‰€æœ‰éœ€è¦çš„æ•°æ®</p>

<p>æ‰¹é‡è¯·æ±‚ï¼Œå¯ä»¥å®šä¹‰ä¸¤ä¸ªç‹¬ç«‹è¯·æ±‚çš„ä¾èµ–å…³ç³»ï¼Œé«˜æ•ˆçš„è·å–æ•°æ®
åˆ›å»ºè®¢é˜…ï¼Œclient å¯ä»¥æ”¶åˆ°æ–°çš„æ•°æ®
æ•°æ®å»¶è¿Ÿï¼Œå¯ä»¥å¯¹å“åº”ä¸­ä¸€éƒ¨åˆ†æ•°æ®æ ‡è¯†ä¸ºæ—¶é—´ä¸æ•æ„Ÿ
å°ç»“
ä¸åªæ˜¯ Githubï¼Œè¿˜æœ‰å¾ˆå¤šå¤§å…¬å¸å·²ç»ä½¿ç”¨ GraphQLï¼Œä¾‹å¦‚ Pinterest, Coursera, Shopify</p>

<p>Github ä¹Ÿè¡¨è¾¾äº†å¯¹ GraphQL API çš„é‡è§†ï¼Œæ¥ä¸‹æ¥ä¼šæŒç»­å®Œå–„ï¼Œä½¿å…¶æ›´åŠ çµæ´»</p>

:ET