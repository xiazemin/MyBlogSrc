I"ò<p>1ã€é¦–å…ˆæ·»åŠ dockerå®˜æ–¹çš„å›½å†…é•œåƒ
sudo tee /etc/docker/daemon.json Â«-â€˜EOFâ€™
{
  â€œregistry-mirrorsâ€: [â€œhttps://registry.docker-cn.coâ€]
}
EOF
2ã€gcr.ioé•œåƒ
æ ¹æ®å¼€æºé¡¹ç›®ï¼š</p>

<p>https://github.com/anjia0532/gcr.io_mirror</p>

<p>ä½œè€…å°†gcr.ioç›¸å…³é•œåƒpullä¸‹æ¥ï¼Œç„¶åpushåˆ°dockerå®˜æ–¹ä»“åº“ï¼Œç›¸å…³è½¬æ¢è¯­æ³•å¦‚ä¸‹ï¼š</p>

<p>è¯­æ³•
gcr.io/namespace/image_name:image_tag</p>
<h1 id="ç­‰ä»·äº">ç­‰ä»·äº</h1>
<p>anjia0532/namespace.image_name:image_tag</p>

<h1 id="ç‰¹åˆ«çš„">ç‰¹åˆ«çš„</h1>
<p>k8s.gcr.io/{image}/{tag} &lt;==&gt; gcr.io/google-containers/{image}/{tag} &lt;==&gt; anjia0532/google-containers.{image}/{tag}
æ‰¹é‡è½¬æ¢</p>
<h1 id="replace-gcriogoogle-containersfederation-controller-manager-arm64v131-beta1-to-real-image">replace gcr.io/google-containers/federation-controller-manager-arm64:v1.3.1-beta.1 to real image</h1>
<h1 id="this-will-convert-gcriogoogle-containersfederation-controller-manager-arm64v131-beta1">this will convert gcr.io/google-containers/federation-controller-manager-arm64:v1.3.1-beta.1</h1>
<h1 id="to-anjia0532google-containersfederation-controller-manager-arm64v131-beta1-and-pull-it">to anjia0532/google-containers.federation-controller-manager-arm64:v1.3.1-beta.1 and pull it</h1>
<h1 id="k8sgcrioimagetag--gcriogoogle-containersimagetag--anjia0532google-containersimagetag">k8s.gcr.io/{image}/{tag} &lt;==&gt; gcr.io/google-containers/{image}/{tag} &lt;==&gt; anjia0532/google-containers.{image}/{tag}</h1>

<p>images=$(cat img.txt)
#or 
#images=$(cat Â«EOF</p>
<h1 id="gcriogoogle-containersfederation-controller-manager-arm64v131-beta1">gcr.io/google-containers/federation-controller-manager-arm64:v1.3.1-beta.1</h1>
<h1 id="gcriogoogle-containersfederation-controller-manager-arm64v131-beta1-1">gcr.io/google-containers/federation-controller-manager-arm64:v1.3.1-beta.1</h1>
<h1 id="gcriogoogle-containersfederation-controller-manager-arm64v131-beta1-2">gcr.io/google-containers/federation-controller-manager-arm64:v1.3.1-beta.1</h1>
<p>#EOF
#)</p>

<p>eval $(echo ${images}|
        sed â€˜s/k8s.gcr.io/anjia0532\/google-containers/g;s/gcr.io/anjia0532/g;s/\//./g;s/ /\n/g;s/anjia0532./anjia0532\//gâ€™ |
        uniq |
        awk â€˜{print â€œdocker pull â€œ$1â€;â€}â€™
       )</p>

<h1 id="this-code-will-retag-all-of-anjia0532s-image-from-local--eg-anjia0532google-containersfederation-controller-manager-arm64v131-beta1">this code will retag all of anjia0532â€™s image from local  e.g. anjia0532/google-containers.federation-controller-manager-arm64:v1.3.1-beta.1</h1>
<h1 id="to-gcriogoogle-containersfederation-controller-manager-arm64v131-beta1">to gcr.io/google-containers/federation-controller-manager-arm64:v1.3.1-beta.1</h1>
<h1 id="k8sgcrioimagetag--gcriogoogle-containersimagetag--anjia0532google-containersimagetag-1">k8s.gcr.io/{image}/{tag} &lt;==&gt; gcr.io/google-containers/{image}/{tag} &lt;==&gt; anjia0532/google-containers.{image}/{tag}</h1>

<p>for img in $(docker images â€“format â€œ{{.Repository}}:{{.Tag}}â€| grep â€œanjia0532â€); do
  n=$(echo ${img}| awk -Fâ€™[/.:]â€™ â€˜{printf â€œgcr.io/%sâ€,$2}â€™)
  image=$(echo ${img}| awk -Fâ€™[/.:]â€™ â€˜{printf â€œ/%sâ€,$3}â€™)
  tag=$(echo ${img}| awk -Fâ€™[:]â€™ â€˜{printf â€œ:%sâ€,$2}â€™)
  docker tag $img â€œ${n}${image}${tag}â€
  [[ ${n} == â€œgcr.io/google-containersâ€ ]] &amp;&amp; docker tag $img â€œk8s.gcr.io${image}${tag}â€
done
3ã€ pull-google-container å·¥å…·è„šæœ¬
K8Sçš„exapmleé‡Œçš„yamlé»˜è®¤æ˜¯k8s.gcr.ioçš„é•œåƒï¼Œä¸ºäº†æ–¹ä¾¿è¿è¡Œæˆ‘ä»¬å¯ä»¥é¢„å…ˆæ‹‰å–ç›¸å…³é•œåƒï¼š</p>

<p>vim pull-google.sh:</p>

<p>image=$1
  echo $1
  img=<code class="language-plaintext highlighter-rouge">echo $image | sed 's/k8s\.gcr\.io/anjia0532\/google-containers/g;s/gcr\.io/anjia0532/g;s/\//\./g;s/ /\n/g;s/_/-/g;s/anjia0532\./anjia0532\//g' | uniq | awk '{print ""$1""}'</code>
  echo â€œdocker pull $imgâ€
  docker pull $img
  echo  â€œdocker tag $img $imageâ€
  docker tag $img $image
~                         <br />
ç„¶åæ”¾åˆ°/usr/local/bin</p>

<p>chmod +x  pull-google.sh &amp;&amp; cp  pull-google.sh /usr/local/bin/pull-google-container 
å°±å¯ä»¥æ„‰å¿«çš„ä½¿ç”¨pull-google-container å‘½ä»¤äº†</p>

<p>pull-google-container gcr.io/google-samples/gb-frontend:v4
gcr.io/google-samples/gb-frontend:v4
docker pull anjia0532/google-samples.gb-frontend:v4
v4: Pulling from anjia0532/google-samples.gb-frontend
Digest: sha256:aaa5b327ef3b4cb705513ab674fa40df66981616950c7de4912a621f9ee03dd4
Status: Image is up to date for anjia0532/google-samples.gb-frontend:v4
docker tag anjia0532/google-samples.gb-frontend:v4 gcr.io/google-samples/gb-frontend:v4</p>
<ol>
  <li>æ›¿æ¢å·²æœ‰çš„yaml
é™¤äº†é¢„å…ˆæ‹‰å–é•œåƒï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å°†k8s.gcr.io æ›¿æ¢ä¸ºå¯æ‰§è¡Œé•œåƒ
 ä¸ºäº†æ–¹ä¾¿æ›¿æ¢ï¼Œæˆ‘ä»¬ç¼–å†™ä¸€ä¸ªrepair_yaml è„šæœ¬ï¼š</li>
</ol>

<p>vim /usr/local/bin/repair_yaml</p>

<p>cp $1 â€œ$1.bakâ€
  cat $1.bak | sed â€˜s/k8s.gcr.io\/(.<em>)\//anjia0532\/google-containers.\1./g;s/gcr.io\/(.</em>)\//anjia0532\/\1./g;s/google_/google-/g;â€™ &gt; $1
  rm -f â€œ$1.bakâ€
ä¿å­˜é€€å‡ºï¼Œç„¶åchmod +x /usr/local/bin/repair_yaml
<!-- more -->
https://cloud.tencent.com/developer/article/1353088</p>

<p>å€ŸåŠ© Travis CI è®©å…¶æ¯å¤©è‡ªåŠ¨è¿è¡Œï¼Œå°†æ‰€æœ‰ç”¨å¾—åˆ°çš„ gcr.io ä¸‹çš„é•œåƒåŒæ­¥åˆ°äº† Docker Hub ä½¿ç”¨æ–¹æ³• ç›®å‰å¯¹äºä¸€ä¸ª gcr.io ä¸‹çš„é•œåƒï¼Œå¯ä»¥*ç›´æ¥å°† k8s.gcr.io æ›¿æ¢ä¸º gcrxio *ç”¨æˆ·åï¼Œç„¶åä» Docker Hub ç›´æ¥æ‹‰å–
æ–¹æ³•äºŒï¼šç½‘å‹åŒæ­¥æ–¹æ¡ˆï¼ˆæ¨èï¼Œç›´æ¥ä½¿ç”¨ï¼‰</p>

<h1 id="åŸå§‹å‘½ä»¤">åŸå§‹å‘½ä»¤</h1>
<p>docker pull k8s.gcr.io/kubernetes-dashboard-amd64:v1.10.0</p>
<h1 id="ä½¿ç”¨å›½å†…ç¬¬ä¸‰æ–¹ç½‘å‹åŒæ­¥ä»“åº“">ä½¿ç”¨å›½å†…ç¬¬ä¸‰æ–¹ï¼ˆç½‘å‹ï¼‰åŒæ­¥ä»“åº“</h1>
<p>docker pull gcrxio/kubernetes-dashboard-amd64:v1.10.0
docker pull anjia0532/kubernetes-dashboard-amd64:v1.10.0</p>

<p>https://github.com/anjia0532/gcr.io_mirror/tree/master/k8s-minikube/nginx-ingress-controller</p>

<p>https://blog.csdn.net/networken/article/details/84571373</p>

<p>åˆ›å»ºä¸ªäººä»“åº“
æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨dockerhubæˆ–é˜¿é‡Œäº‘åˆ›å»ºä¸ªäººä»“åº“ï¼ŒæŠŠéœ€è¦çš„æœ€æ–°ç‰ˆæœ¬é•œåƒä»googleä»“åº“pushåˆ°ä¸ªäººä»“åº“,ä¸€èˆ¬æœ‰å‡ ä¸‹å‡ ç§æ–¹æ³•ï¼š</p>

<p>1.è´­ä¹°äº‘æœåŠ¡å™¨</p>

<p>è´­ä¹°1å°èƒ½åŒæ—¶è®¿é—®å›½å¤–å’Œå›½å†…ç½‘ç»œçš„äº‘æœåŠ¡å™¨ï¼Œä¾‹å¦‚é˜¿é‡Œäº‘æˆ–è…¾è®¯äº‘é¦™æ¸¯è½»é‡æœåŠ¡å™¨ã€‚</p>

<p>æˆ–è€…ä½¿ç”¨google cloudshellï¼šhttps://console.cloud.google.com/cloudshell
å®ƒç±»ä¼¼ä¸€ä¸ªæ°¸ä¹…å…è´¹çš„æ‹¥æœ‰5Gå­˜å‚¨ç©ºé—´çš„linuxæœåŠ¡å™¨ï¼Œèƒ½å¤Ÿæ‰§è¡Œæ‰€æœ‰dockerå‘½ä»¤å’Œbashå‘½ä»¤ï¼Œæœ€é‡è¦çš„æ˜¯å®ƒèƒ½å¤Ÿè®¿é—®å…¨çƒç½‘ç»œã€‚</p>

<p>2.Githubé•œåƒæ„å»ºåŠŸèƒ½
ä½¿ç”¨githubçš„dockerfileæ„å»ºåŠŸèƒ½ï¼Œå°†é•œåƒæ„å»ºåˆ°å›½å†…ä»“åº“ã€‚
å‚è€ƒï¼šhttps://blog.csdn.net/networken/article/details/85215714</p>

<p>https://blog.csdn.net/networken/article/details/84571373</p>

<p>https://blog.csdn.net/networken/article/details/85215714</p>
:ET