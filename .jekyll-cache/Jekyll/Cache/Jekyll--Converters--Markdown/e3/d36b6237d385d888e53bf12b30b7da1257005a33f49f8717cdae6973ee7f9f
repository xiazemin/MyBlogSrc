I"á<p>tpl, err := template.Parse(filename)å¾—åˆ°æ–‡ä»¶åä¸ºåå­—çš„æ¨¡æ¿ï¼Œå¹¶ä¿å­˜åœ¨tplå˜é‡ä¸­ã€‚tplå¯ä»¥è¢«æ‰§è¡Œæ¥æ˜¾ç¤ºæ¨¡æ¿ã€‚</p>

<p>template.ParseFiles(filenames)å¯ä»¥è§£æä¸€ç»„æ¨¡æ¿ï¼Œä½¿ç”¨æ–‡ä»¶åä½œä¸ºæ¨¡æ¿çš„åå­—ã€‚template.ParseGlob(pattern)ä¼šæ ¹æ®patternè§£ææ‰€æœ‰åŒ¹é…çš„æ¨¡æ¿å¹¶ä¿å­˜ã€‚</p>

<p>ç®€å•çš„æ¨¡æ¿tplå¯ä»¥é€šè¿‡tpl.Execute(io.Writer, data)å»æ‰§è¡Œï¼Œ æ¨¡æ¿æ¸²æŸ“åçš„å†…å®¹å†™å…¥åˆ°io.Writerä¸­ã€‚Dataæ˜¯ä¼ ç»™æ¨¡æ¿çš„åŠ¨æ€æ•°æ®ã€‚</p>

<p>tpl.ExecuteTemplate(io.Writer, name, data)å’Œä¸Šé¢çš„ç®€å•æ¨¡æ¿ç±»ä¼¼ï¼Œåªä¸è¿‡ä¼ å…¥äº†ä¸€ä¸ªæ¨¡æ¿çš„åå­—ï¼ŒæŒ‡å®šè¦æ¸²æŸ“çš„æ¨¡æ¿(å› ä¸ºtplå¯ä»¥åŒ…å«å¤šä¸ªæ¨¡æ¿)ã€‚</p>

<p>åµŒå¥—æ¨¡æ¿å®šä¹‰å¦‚ä¸‹ï¼š
{ {define â€œfooterâ€}}</p>
<footer> 
	<p>Here is the footer</p>
</footer>
<p>{ {end}}</p>

<p>è¿™é‡Œå®šä¹‰äº†ä¸€ä¸ªåä¸ºfooterçš„æ¨¡æ¿ï¼Œå¯ä»¥åœ¨å…¶ä»–æ¨¡æ¿ä¸­ä½¿ç”¨ï¼š
{ {template â€œfooterâ€}}
<!-- more -->
#1,å‡½æ•°å˜é‡ (è°ƒç”¨ç»“æ„ä½“çš„æ–¹æ³•)
æˆ‘ä»¬å¯ä»¥è°ƒç”¨æ¨¡æ¿ä¸­å¯¹è±¡çš„æ–¹æ³•è¿”å›æ•°æ®
type User struct {<br />
  ID    int
  Email string
}
func (u User) HasPermission(feature string) bool {<br />
  if feature == â€œfeature-aâ€ {
    return true
  } else {
    return false
  }
}</p>

<p>{ {if .User.HasPermission â€œfeature-aâ€}}</p>
<div class="feature">
    <h3>Feature A</h3>
    <p>Some other stuff here...</p>
  </div>
<p>{ {else}}</p>
<div class="feature disabled">
    <h3>Feature A</h3>
    <p>To enable Feature A please upgrade your plan</p>
  </div>
<p>{ {end}}</p>

<p>#2,å‡½æ•°å˜é‡ (è°ƒç”¨)
å¦‚æœæœ‰æ—¶HasPermissionæ–¹æ³•çš„è®¾è®¡ä¸å¾—ä¸éœ€è¦æ›´æ”¹ï¼Œä½†æ˜¯å½“å‰çš„å‡½æ•°æ–¹æ³•æœ‰ä¸æ»¡è¶³è¦æ±‚ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å‡½æ•°ï¼ˆfunc(string) boolï¼‰ä½œä¸ºUserç±»å‹çš„å­—æ®µï¼Œè¿™æ ·åœ¨åˆ›å»ºUserçš„æ—¶å€™å¯ä»¥æŒ‡æ´¾ä¸åŒçš„å‡½æ•°å®ç°ï¼š
// Structs
type ViewData struct {<br />
  User User
}
type User struct {<br />
  ID            int
  Email         string
  HasPermission func(string) bool
}
// Example of creating a ViewData
vd := ViewData{
		User: User{
			ID:    1,
			Email: â€œcurtis.vermeeren@gmail.comâ€,
			// Create the HasPermission function
			HasPermission: func(feature string) bool {
				if feature == â€œfeature-bâ€ {
					return true
				}
				return false
			},
		},
	}
// Executing the ViewData with the template
err := testTemplate.Execute(w, vd)
æˆ‘ä»¬éœ€è¦å‘Šè¯‰Goæ¨¡æ¿æˆ‘ä»¬æƒ³è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œè¿™é‡Œä½¿ç”¨callå…³é”®å­—ã€‚æŠŠä¸Šé¢çš„ä¾‹å­ä¿®æ”¹å¦‚ä¸‹ï¼š
{ {if (call .User.HasPermission â€œfeature-bâ€)}}</p>
<div class="feature">
    <h3>Feature B</h3>
    <p>Some other stuff here...</p>
  </div>
<p>{ {else}}</p>
<div class="feature disabled">
    <h3>Feature B</h3>
    <p>To enable Feature B please upgrade your plan</p>
  </div>
<p>{ {end}}</p>

<p>#3ï¼Œè‡ªå®šä¹‰å‡½æ•°
å¦å¤–ä¸€ç§æ–¹å¼æ˜¯ä½¿ç”¨template.FuncMapåˆ›å»ºè‡ªå®šä¹‰çš„å‡½æ•°,å®ƒåˆ›å»ºä¸€ä¸ªå…¨å±€çš„å‡½æ•°ï¼Œå¯ä»¥åœ¨æ•´ä¸ªåº”ç”¨ä¸­ä½¿ç”¨ã€‚FuncMapé€šè¿‡map[string]interface{}å°†å‡½æ•°åæ˜ å°„åˆ°å‡½æ•°ä¸Šã€‚æ³¨æ„æ˜ å°„çš„å‡½æ•°å¿…é¡»åªæœ‰ä¸€ä¸ªè¿”å›å€¼ï¼Œæˆ–è€…æœ‰ä¸¤ä¸ªè¿”å›å€¼ä½†æ˜¯ç¬¬äºŒä¸ªæ˜¯errorç±»å‹ã€‚
// Creating a template with function hasPermission
testTemplate, err = template.New(â€œhello.gohtmlâ€).Funcs(template.FuncMap{
    â€œhasPermissionâ€: func(user User, feature string) bool {
      if user.ID == 1 &amp;&amp; feature == â€œfeature-aâ€ {
        return true
      }
      return false
    },
  }).ParseFiles(â€œhello.gohtmlâ€)
è¿™ä¸ªå‡½æ•°hasPermissionæ£€æŸ¥ç”¨æˆ·æ˜¯å¦æœ‰æŸä¸ªæƒé™ï¼Œå®ƒä¼šè¢«ä¿å­˜åœ¨FuncMapä¸­ã€‚æ³¨æ„è‡ªå®šä¹‰çš„å‡½æ•°å¿…é¡»åœ¨è°ƒç”¨ParseFiles()ä¹‹å‰åˆ›å»ºã€‚</p>

<p>è¿™ä¸ªå‡½æ•°åœ¨æ¨¡æ¿ä¸­çš„ä½¿ç”¨å¦‚ä¸‹ï¼š
{ { if hasPermission .User â€œfeature-aâ€ }}
éœ€è¦ä¼ å…¥.Userå’Œfeature-aå‚æ•°ã€‚</p>

<p>#4ï¼Œè‡ªå®šä¹‰å‡½æ•° (å…¨å±€)
æˆ‘ä»¬å‰é¢å®ç°çš„è‡ªå®šä¹‰æ–¹æ³•éœ€è¦ä¾èµ–.Userç±»å‹ï¼Œå¾ˆå¤šæƒ…å†µä¸‹è¿™ç§æ–¹å¼å·¥ä½œçš„å¾ˆå¥½ï¼Œä½†æ˜¯åœ¨ä¸€ä¸ªå¤§å‹çš„åº”ç”¨ä¸­ä¼ ç»™æ¨¡æ¿å¤ªå¤šçš„å¯¹è±¡ç»´æŠ¤èµ·æ¥å¾ˆå›°éš¾ã€‚æˆ‘ä»¬éœ€è¦æ”¹å˜è‡ªå®šä¹‰çš„å‡½æ•°ï¼Œè®©å®ƒæ— éœ€ä¾èµ–Userå¯¹è±¡ã€‚</p>

<p>å’Œä¸Šé¢çš„å®ç°ç±»ä¼¼ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç¼ºçœçš„hasPermissionå‡½æ•°ï¼Œè¿™æ ·å¯ä»¥æ­£å¸¸è§£ææ¨¡æ¿ã€‚
testTemplate, err = template.New(â€œhello.gohtmlâ€).Funcs(template.FuncMap{
  â€œhasPermissionâ€: func(feature string) bool {
    return false
  },
}).ParseFiles(â€œhello.gohtmlâ€)
è¿™ä¸ªå‡½æ•°åœ¨main()ä¸­æˆ–è€…æŸå¤„åˆ›å»ºï¼Œå¹¶ä¸”ä¿è¯åœ¨è§£ææ–‡ä»¶ä¹‹å‰æ”¾å…¥åˆ° hello.gohtml çš„function mapä¸­ã€‚è¿™ä¸ªç¼ºçœçš„å‡½æ•°æ€»æ˜¯è¿”å›false,ä½†æ˜¯ä¸ç®¡æ€æ ·ï¼Œå‡½æ•°æ˜¯å·²å®šä¹‰çš„ï¼Œè€Œä¸”ä¸éœ€è¦Userï¼Œæ¨¡æ¿ä¹Ÿå¯ä»¥æ­£å¸¸è§£æã€‚</p>

<p>ä¸‹ä¸€ä¸ªæŠ€å·§å°±æ˜¯é‡æ–°å®šä¹‰hasPermissionå‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°å¯ä»¥ä½¿ç”¨Userå¯¹è±¡çš„æ•°æ®ï¼Œä½†æ˜¯å®ƒæ˜¯åœ¨Handlerå¤„ç†ä¸­ä½¿ç”¨çš„ï¼Œè€Œä¸æ˜¯ä¼ ç»™æ¨¡æ¿ï¼Œè¿™é‡Œé‡‡ç”¨çš„æ˜¯é—­åŒ…çš„æ–¹å¼ã€‚æ‰€ä»¥åœ¨æ¨¡æ¿æ‰§è¡Œä¹‹å‰ä½ æ­»æœ‰æœºä¼šé‡æ–°å®šä¹‰å‡½æ•°çš„ã€‚
func handler(w http.ResponseWriter, r *http.Request) {
	w.Header().Set(â€œContent-Typeâ€, â€œtext/htmlâ€)
	user := User{
		ID:    1,
		Email: â€œCurtis.vermeeren@gmail.comâ€,
	}
	vd := ViewData{}
	err := testTemplate.Funcs(template.FuncMap{
		â€œhasPermissionâ€: func(feature string) bool {
			if user.ID == 1 &amp;&amp; feature == â€œfeature-aâ€ {
				return true
			}
			return false
		},
	}).Execute(w, vd)
	if err != nil {
		http.Error(w, err.Error(), http.StatusInternalServerError)
	}
}
åœ¨è¿™ä¸ªHandlerä¸­Userè¢«åˆ›å»ºï¼ŒViewDataä½¿ç”¨è¿™ä¸ªUserå¯¹è±¡ã€‚hasPermissioné‡‡ç”¨é—­åŒ…çš„æ–¹å¼é‡æ–°å®šä¹‰äº†å‡½æ•°ã€‚{ {if hasPermission â€œfeature-aâ€}}çš„çš„ç¡®ç¡®æ²¡æœ‰ä¼ å…¥Userå‚æ•°ã€‚</p>

<p>#5ï¼Œç¬¬ä¸‰æ–¹è‡ªå®šä¹‰å‡½æ•°
é™¤äº†å®˜æ–¹çš„é¢„å®šä¹‰çš„å‡½æ•°å¤–ï¼Œä¸€äº›ç¬¬ä¸‰æ–¹ä¹Ÿå®šä¹‰äº†ä¸€äº›å‡½æ•°ï¼Œä½ å¯ä»¥ä½¿ç”¨è¿™äº›åº“ï¼Œé¿å…é‡å¤é€ è½®å­ã€‚</p>

<p>æ¯”å¦‚sprigåº“ï¼Œå®šä¹‰äº†å¾ˆå¤šçš„å‡½æ•°</p>

<p>https://colobu.com/2019/11/05/Golang-Templates-Cheatsheet/</p>
:ET