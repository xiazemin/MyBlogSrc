I"Ò
<p>go è¯­è¨€æä¾›äº† json çš„ç¼–è§£ç åŒ…ï¼Œjson å­—ç¬¦ä¸²ä½œä¸ºå‚æ•°å€¼ä¼ è¾“æ—¶å‘ç°ï¼Œjson.Marshal ç”Ÿæˆ json ç‰¹æ®Šå­—ç¬¦ &lt;ã€&gt;ã€&amp;ä¼šè¢«è½¬ä¹‰ã€‚</p>

<p>ype Test struct {
	Content string
}</p>

<p>func main() {
	t := new(Test)
	t.Content = â€œhttp://www.baidu.com?id=123&amp;test=1â€
	jsonByte, _ := json.Marshal(t)
	fmt.Println(string(jsonByte))
}</p>

<p>{â€œContentâ€:â€http://www.baidu.com?id=123\u0026test=1â€}
Process finished with exit code 0</p>

<p>GoDoc æè¿°
String values encode as JSON strings coerced to valid UTF-8,
replacing invalid bytes with the Unicode replacement rune.
The angle brackets â€œ&lt;â€ and â€œ&gt;â€ are escaped to â€œ\u003câ€ and â€œ\u003eâ€
to keep some browsers from misinterpreting JSON output as HTML.
Ampersand â€œ&amp;â€ is also escaped to â€œ\u0026â€ for the same reason.
This escaping can be disabled using an Encoder that had SetEscapeHTML(false) alled on it.</p>

<p>json.Marshal é»˜è®¤ escapeHtml ä¸º true,ä¼šè½¬ä¹‰ &lt;ã€&gt;ã€&amp;</p>

<p>func Marshal(v interface{}) ([]byte, error) {
	e := &amp;encodeState{}
	err := e.marshal(v, encOpts{escapeHTML: true})
	if err != nil {
		return nil, err
	}
	return e.Bytes(), nil
}
è§£å†³æ–¹æ¡ˆ
æ–¹æ³•ä¸€ï¼š
content = strings.Replace(content, â€œ\u003câ€, â€œ&lt;â€, -1)
content = strings.Replace(content, â€œ\u003eâ€, â€œ&gt;â€, -1)
content = strings.Replace(content, â€œ\u0026â€, â€œ&amp;â€, -1)
è¿™ç§æ–¹å¼æ¯”è¾ƒç›´æ¥ï¼Œç¡¬æ€§å­—ç¬¦ä¸²æ›¿æ¢ã€‚æ¯”è¾ƒæ†¨åš</p>

<p>æ–¹æ³•äºŒï¼š
æ–‡æ¡£ä¸­å†™åˆ°This escaping can be disabled using an Encoder that had SetEscapeHTML(false) alled on it.</p>

<p>æˆ‘ä»¬å…ˆåˆ›å»ºä¸€ä¸ª buffer ç”¨äºå­˜å‚¨ json
åˆ›å»ºä¸€ä¸ª jsonencoder
è®¾ç½® html ç¼–ç ä¸º false
type Test struct {
	Content string
}</p>

<p>func main() {
	t := new(Test)
	t.Content = â€œhttp://www.baidu.com?id=123&amp;test=1â€
	bf := bytes.NewBuffer([]byte{})
	jsonEncoder := json.NewEncoder(bf)
	jsonEncoder.SetEscapeHTML(false)
	jsonEncoder.Encode(t)
	fmt.Println(bf.String())
}</p>

<p>{â€œContentâ€:â€http://www.baidu.com?id=123&amp;test=1â€}
Process finished with exit code 0</p>

<!-- more -->
<p>https://ld246.com/article/1524558037151</p>

<p>https://github.com/golang/go/issues/28453</p>

<p>encoding/json: add Encoder.DisableHTMLEscaping This provides a way to disable the escaping of &lt;, &gt;, and &amp; in JSON strings.</p>

<p>The relevant function is</p>

<p>func (*Encoder) SetEscapeHTML
That should be applied to a Encoder.</p>

<p>enc := json.NewEncoder(os.Stdout)
enc.SetEscapeHTML(false)</p>

<p>https://stackoverflow.com/questions/24656624/how-to-display-a-character-instead-of-ascii</p>

<p>https://blog.csdn.net/lgh1700/article/details/104522878</p>

<p>https://blog.csdn.net/lgh1700/article/details/104522878</p>

:ET