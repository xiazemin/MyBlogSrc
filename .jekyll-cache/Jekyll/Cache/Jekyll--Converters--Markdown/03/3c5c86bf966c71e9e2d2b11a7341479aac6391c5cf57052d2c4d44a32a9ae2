I"<p>åœ¨ä½¿ç”¨ go è¯­è¨€å¼€å‘è¿‡ç¨‹ä¸­ï¼Œç»å¸¸éœ€è¦ä½¿ç”¨åˆ° json åŒ…æ¥è¿›è¡Œ json å’Œ struct çš„äº’ç›¸è½¬æ¢ï¼Œåœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œé‡åˆ°äº†ä¸€äº›éœ€è¦é¢å¤–æ³¨æ„çš„åœ°æ–¹ï¼Œè®°å½•å¦‚ä¸‹ã€‚</p>

<p>æ•´æ•°å˜æµ®ç‚¹æ•°é—®é¢˜
<!-- more -->
å‡è®¾æœ‰ä¸€ä¸ª Person ç»“æ„ï¼Œå…¶ä¸­åŒ…å« Age int64 å’Œ Weight float64 ä¸¤ä¸ªå­—æ®µï¼Œç°åœ¨é€šè¿‡ json åŒ…å°† Person ç»“æ„è½¬ä¸º map[string]interface{}ï¼Œä»£ç å¦‚ä¸‹ã€‚
type Person struct {
	Name string
	Age int64
	Weight float64
}</p>

<p>func main() {
    person := Person{
        Name: â€œWang Wuâ€,
        Age: 30,
        Weight: 150.07,
    }</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>jsonBytes, _ := json.Marshal(person)
fmt.Println(string(jsonBytes))

var personFromJSON interface{}
json.Unmarshal(jsonBytes, &amp;personFromJSON)

r := personFromJSON.(map[string]interface{}) } ä»£ç æ‰§è¡Œåˆ°è¿™é‡Œçœ‹ä¸Šå»ä¸€åˆ‡æ­£å¸¸ï¼Œä½†æ˜¯æ‰“å°ä¸€ä¸‹ map[string]interface{} å°±ä¼šå‘ç°ä¸å¤ªå¯¹äº†ã€‚ fmt.Println(reflect.TypeOf(r["Age"]).Name())  // float64 fmt.Println(reflect.TypeOf(r["Weight"]).Name())  // float64 è½¬æ¢æˆ map[string]interface{} ä¹‹åï¼ŒåŸå…ˆçš„ uint64 å’Œ float64 ç±»å‹éƒ½è¢«è½¬æ¢æˆäº† float64 ç±»å‹ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸ç¬¦åˆæˆ‘ä»¬çš„é¢„æœŸçš„ã€‚
</code></pre></div></div>

<p>å¹¶ä¸”æ‰“å°çš„æ—¶å€™å¦‚æœæ•°å­—å°äº6ä½æ­£å¸¸ï¼Œå¤§äºç­‰äº6ä½ä¼šå˜æˆç§‘å­¦è®¡æ•°æ³•å±•ç¤º
	var a interface{}
	e := json.Unmarshal([]byte(â€œ999999â€), &amp;a)
	//999999
		var a interface{}
	e := json.Unmarshal([]byte(â€œ9999990â€), &amp;a)
	//9.99999e+06</p>

<p>æŸ¥çœ‹ json çš„è§„èŒƒå¯ä»¥çœ‹åˆ°ï¼Œåœ¨ json ä¸­æ˜¯æ²¡æœ‰æ•´å‹å’Œæµ®ç‚¹å‹ä¹‹åˆ†çš„ï¼Œæ‰€ä»¥ç°åœ¨å¯ä»¥ç†è§£ json åŒ…ä¸­çš„ Unmarshal æ–¹æ³•è½¬å‡ºçš„æ•°å­—ç±»å‹ä¸ºä»€ä¹ˆéƒ½æ˜¯ float64 äº†ï¼Œå› ä¸ºæ ¹æ® json è§„èŒƒï¼Œæ•°å­—éƒ½æ˜¯åŒä¸€ç§ç±»å‹ï¼Œé‚£ä¹ˆå¯¹åº”åˆ° go çš„ç±»å‹ä¸­æœ€æ¥è¿‘çš„å°±æ˜¯ float64 äº†ã€‚</p>

<p>json åŒ…è¿˜é’ˆå¯¹è¿™ä¸ªé—®é¢˜æä¾›äº†æ›´å¥½çš„è§£å†³æ–¹æ¡ˆï¼Œä¸è¿‡éœ€è¦ä½¿ç”¨ json.Decoder æ¥ä»£æ›¿ json.Unmarshal æ–¹æ³•ï¼Œå°† json.Unmarhsal æ›¿æ¢å¦‚ä¸‹ã€‚
var personFromJSON interface{}</p>

<p>decoder := json.NewDecoder(bytes.NewReader(jsonBytes))
decoder.UseNumber()
decoder.Decode(&amp;personFromJSON)</p>

<p>r := personFromJSON.(map[string]interface{})
è¿™ç§æ–¹æ³•é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ª jsonDecoderï¼Œç„¶åè°ƒç”¨äº† UseNumber æ–¹æ³•ï¼Œä»æ–‡æ¡£ä¸­å¯ä»¥çŸ¥é“ï¼Œä½¿ç”¨ UseNumber æ–¹æ³•åï¼Œjson åŒ…ä¼šå°†æ•°å­—è½¬æ¢æˆä¸€ä¸ªå†…ç½®çš„ Number ç±»å‹ï¼ˆè€Œä¸æ˜¯ float64ï¼‰ï¼Œè¿™ä¸ª Number ç±»å‹æä¾›äº†è½¬æ¢ä¸º int64ã€float64 ç­‰å¤šä¸ªæ–¹æ³•ã€‚</p>

<p>æ—¶é—´æ ¼å¼
å¯¹äº json æ ¼å¼ï¼Œæ˜¯æ²¡æœ‰æ—¶é—´ç±»å‹çš„ï¼Œæ—¥æœŸå’Œæ—¶é—´ä»¥ json æ ¼å¼å­˜å‚¨æ—¶ï¼Œéœ€è¦è½¬æ¢ä¸ºå­—ç¬¦ä¸²ç±»å‹ã€‚è¿™å°±å¸¦æ¥äº†ä¸€ä¸ªé—®é¢˜ï¼Œæ—¥æœŸæ—¶é—´çš„å­—ç¬¦ä¸²è¡¨ç¤ºæœ‰å¤šç§å¤šæ ·ï¼Œgo çš„ json åŒ…æ”¯æŒçš„æ˜¯å“ªä¸€ç§å‘¢ï¼Ÿ</p>

<p>ä½¿ç”¨ä¸‹é¢çš„ä»£ç æ¥è¾“å‡º json.Marshal æ–¹æ³•å°† Time ç±»å‹è½¬æ¢ä¸ºå­—ç¬¦ä¸²åçš„æ ¼å¼ã€‚
type Person struct {
	Name string
	Birth time.Time
}</p>

<p>func main() {
	person := Person{
		Name: â€œWang Wuâ€,
		Birth: time.Now(),
	}</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>jsonBytes, _ := json.Marshal(person)
fmt.Println(string(jsonBytes))  // {"Name":"Wang Wu","Birth":"2018-12-20T16:22:02.00287617+08:00"} } æ ¹æ®è¾“å‡ºå¯ä»¥åˆ¤æ–­ï¼Œgo çš„ json åŒ…ä½¿ç”¨çš„æ˜¯ RFC3339 æ ‡å‡†ä¸­å®šä¹‰çš„æ ¼å¼ã€‚æ¥ä¸‹æ¥æµ‹è¯•ä¸€ä¸‹ json.Unmarshal æ–¹æ³•æ‰€æ”¯æŒçš„æ—¥æœŸæ—¶é—´æ ¼å¼ã€‚ dateStr := "2018-10-12"
</code></pre></div></div>

<p>var person Person
jsonStr := fmt.Sprintf(â€œ{"name":"Wang Wu", "Birth": "%s"}â€, dateStr)
json.Unmarshal([]byte(jsonStr), &amp;person)</p>

<p>fmt.Println(person.Birth)  // 0001-01-01 00:00:00 +0000 UTC
å¯¹äºå½¢å¦‚ 2018-10-12 çš„å­—ç¬¦ä¸²ï¼Œjson åŒ…å¹¶æ²¡æœ‰æˆåŠŸå°†å…¶è§£æï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æŠŠ time åŒ…ä¸­æ”¯æŒçš„æ‰€æœ‰æ ¼å¼éƒ½è¯•ä¸€ä¸‹ã€‚</p>

<p>ç»è¿‡è¯•éªŒï¼Œå‘ç° json.Unmarshal æ–¹æ³•åªæ”¯æŒ RFC3339 å’Œ RFC3339Nano ä¸¤ç§æ ¼å¼çš„è½¬æ¢ã€‚è¿˜æœ‰ä¸€ä¸ªéœ€è¦æ³¨æ„çš„åœ°æ–¹ï¼Œä½¿ç”¨ time.Now() ç”Ÿæˆçš„æ—¶é—´æ˜¯å¸¦æœ‰ä¸€ä¸ª Monotonic Time çš„ï¼Œç»è¿‡ json.Marshal è½¬æ¢æ—¶å€™ï¼Œç”±äº RFC3339 è§„èŒƒé‡Œæ²¡æœ‰å­˜æ”¾ Monotonic Time çš„ä½ç½®ï¼Œä¼šä¸¢æ‰è¿™ä¸€éƒ¨åˆ†ã€‚</p>

<p>å¯¹äºå­—æ®µä¸ºç©ºçš„å¤„ç†
json åŒ…å¯¹äºç©ºå€¼çš„å¤„ç†æ˜¯ä¸€ä¸ªéå¸¸å®¹æ˜“å‡ºé”™çš„åœ°æ–¹ï¼Œçœ‹ä¸‹é¢ä»£ç ã€‚
type Person struct {
	Name     string
	Age      int64
	Birth    time.Time
	Children []Person
}</p>

<p>func main() {
	person := Person{}</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>jsonBytes, _ := json.Marshal(person)
fmt.Println(string(jsonBytes))  // {"Name":"","Age":0,"Birth":"0001-01-01T00:00:00Z","Children":null} } å½“ struct ä¸­çš„å­—æ®µæ²¡æœ‰å€¼æ—¶ï¼Œä½¿ç”¨ json.Marshal æ–¹æ³•å¹¶ä¸ä¼šè‡ªåŠ¨å¿½ç•¥è¿™äº›å­—æ®µï¼Œè€Œæ˜¯æ ¹æ®å­—æ®µçš„ç±»å‹è¾“å‡ºäº†ä»–ä»¬çš„é»˜è®¤ç©ºå€¼ï¼Œè¿™å¾€å¾€å’Œæˆ‘ä»¬çš„é¢„æœŸä¸ä¸€è‡´ï¼Œjson åŒ…æä¾›äº†å¯¹å­—æ®µçš„æ§åˆ¶æ‰‹æ®µï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºå­—æ®µå¢åŠ  omitempty tagï¼Œè¿™ä¸ª tag ä¼šåœ¨å­—æ®µå€¼ä¸ºé›¶å€¼ï¼ˆint å’Œ float ç±»å‹é›¶å€¼æ˜¯ 0ï¼Œstring ç±»å‹é›¶å€¼æ˜¯ â€œâ€ï¼Œå¯¹è±¡ç±»å‹é›¶å€¼æ˜¯ nilï¼‰æ—¶ï¼Œå¿½ç•¥è¯¥å­—æ®µã€‚ type PersonAllowEmpty struct {
Name     string             `json:",omitempty"`
Age      int64              `json:",omitempty"`
Birth    time.Time          `json:",omitempty"`
Children []PersonAllowEmpty `json:",omitempty"` }
</code></pre></div></div>

<p>func main() {
	person := PersonAllowEmpty{}
	jsonBytes, _ := json.Marshal(person)
	fmt.Println(string(jsonBytes))  // {â€œBirthâ€:â€0001-01-01T00:00:00Zâ€}
}
å¯ä»¥çœ‹åˆ°ï¼Œè¿™æ¬¡è¾“å‡ºçš„ json ä¸­åªæœ‰ Birth å­—æ®µäº†ï¼Œstringã€intã€å¯¹è±¡ç±»å‹çš„å­—æ®µï¼Œéƒ½å› ä¸ºæ²¡æœ‰èµ‹å€¼ï¼Œé»˜è®¤æ˜¯é›¶å€¼ï¼Œæ‰€ä»¥è¢«å¿½ç•¥ï¼Œå¯¹äºæ—¥æœŸæ—¶é—´ç±»å‹ï¼Œç”±äºä¸å¯ä»¥è®¾ç½®ä¸ºé›¶å€¼ï¼Œä¹Ÿå°±æ˜¯ 0000-00-00 00:00:00ï¼Œä¸ä¼šè¢«å¿½ç•¥ã€‚</p>

<p>éœ€è¦æ³¨æ„è¿™æ ·çš„æƒ…å†µï¼šå¦‚æœä¸€ä¸ªäººçš„å¹´é¾„æ˜¯ 0 ï¼ˆå¯¹äºåˆšå‡ºç”Ÿçš„å©´å„¿ï¼Œè¿™ä¸ªå€¼æ˜¯åˆç†çš„ï¼‰ï¼Œåˆšå¥½æ˜¯ int å­—æ®µçš„é›¶å€¼ï¼Œåœ¨æ·»åŠ  omitempty tag çš„æƒ…å†µä¸‹ï¼Œå¹´é¾„å­—æ®µä¼šè¢«å¿½ç•¥ã€‚</p>

<p>å¦‚æœæƒ³è¦æŸä¸€ä¸ªå­—æ®µåœ¨ä»»ä½•æƒ…å†µä¸‹éƒ½è¢« json åŒ…å¿½ç•¥ï¼Œéœ€è¦ä½¿ç”¨å¦‚ä¸‹çš„å†™æ³•ã€‚
type Person struct {
	Name     string <code class="language-plaintext highlighter-rouge">json:"-"</code>
	Age      int64 <code class="language-plaintext highlighter-rouge">json:"-"</code>
	Birth    time.Time <code class="language-plaintext highlighter-rouge">json:"-"</code>
	Children []string <code class="language-plaintext highlighter-rouge">json:"-"</code>
}</p>

<p>func main() {
    birth, _ := time.Parse(time.RFC3339, â€œ1988-12-02T15:04:27+08:00â€)
	person := Person{
		Name: â€œWang Wuâ€,
		Age: 30,
		Birth: birth,
		Children: []string{},
	}</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>jsonBytes, _ := json.Marshal(person)
fmt.Println(string(jsonBytes))  // {} } å¯ä»¥çœ‹åˆ°ï¼Œä½¿ç”¨ json:â€-â€œ æ ‡ç­¾çš„å­—æ®µéƒ½è¢«å¿½ç•¥äº†ã€‚
</code></pre></div></div>
:ET