I"û<p>golang go-sql-driver æ•°æ®åº“æŠ¥é”™ bad connection</p>

<p>åŸå› 
è¿™æ˜¯å› ä¸ºMysqlæœåŠ¡å™¨ä¸»åŠ¨å…³é—­äº†Mysqlé“¾æ¥ã€‚
åœ¨é¡¹ç›®ä¸­ä½¿ç”¨äº†ä¸€ä¸ªmysqlé“¾æ¥ï¼ŒåŒæ—¶ä½¿ç”¨äº†äº‹åŠ¡ï¼Œå¤„ç†å¤šä¸ªè¡¨æ“ä½œã€‚å¤„ç†æ—¶é—´é•¿ã€‚
å¯¼è‡´ç©ºé—²é“¾æ¥è¶…æ—¶ï¼ŒMysqlå…³é—­äº†é“¾æ¥ã€‚è€Œå®¢æˆ·ç«¯ä¿æŒäº†å·²ç»å…³é—­çš„é“¾æ¥ã€‚</p>

<p>å…·ä½“åŸå› æ˜¯ï¼š
beegoæ²¡æœ‰è°ƒç”¨db.SetConnMaxLifetime è¿™ä¸ªæ–¹æ³•ï¼Œå¯¼è‡´å®¢æˆ·ç«¯ä¿æŒäº†å·²ç»å…³é—­çš„é“¾æ¥ã€‚</p>

<p>https://wwblog.csdn.net/whatday/article/details/103952962</p>

<p>go driver: bad connection
driver: bad connection</p>

<p>åŸå› ï¼šrowsæ²¡Close
<!-- more --></p>

<p>Mysql æŸ¥çœ‹è¿æ¥æ•°,çŠ¶æ€ æœ€å¤§å¹¶å‘æ•°
â€“ show variables like â€˜%max_connections%â€™; æŸ¥çœ‹æœ€å¤§è¿æ¥æ•°
set global max_connections=1000 é‡æ–°è®¾ç½®
mysql&gt; show status like â€˜Threads%â€™;
+â€”â€”â€”â€”â€”â€”-+â€”â€”-+
| Variable_name     | Value |
+â€”â€”â€”â€”â€”â€”-+â€”â€”-+
| Threads_cached    | 58    |
| Threads_connected | 57    |   ###è¿™ä¸ªæ•°å€¼æŒ‡çš„æ˜¯æ‰“å¼€çš„è¿æ¥æ•°
| Threads_created   | 3676  |
| Threads_running   | 4     |   ###è¿™ä¸ªæ•°å€¼æŒ‡çš„æ˜¯æ¿€æ´»çš„è¿æ¥æ•°ï¼Œè¿™ä¸ªæ•°å€¼ä¸€èˆ¬è¿œä½äºconnectedæ•°å€¼
+â€”â€”â€”â€”â€”â€”-+â€”â€”-+</p>

<p>Threads_connected è·Ÿshow processlistç»“æœç›¸åŒï¼Œè¡¨ç¤ºå½“å‰è¿æ¥æ•°ã€‚å‡†ç¡®çš„æ¥è¯´ï¼ŒThreads_runningæ˜¯ä»£è¡¨å½“å‰å¹¶å‘æ•°</p>

<p>å‘½ä»¤ï¼š show processlist; 
å¦‚æœæ˜¯rootå¸å·ï¼Œä½ èƒ½çœ‹åˆ°æ‰€æœ‰ç”¨æˆ·çš„å½“å‰è¿æ¥ã€‚å¦‚æœæ˜¯å…¶å®ƒæ™®é€šå¸å·ï¼Œåªèƒ½çœ‹åˆ°è‡ªå·±å ç”¨çš„è¿æ¥ã€‚ 
show processlist;åªåˆ—å‡ºå‰100æ¡ï¼Œå¦‚æœæƒ³å…¨åˆ—å‡ºè¯·ä½¿ç”¨show full processlist; 
MySQL&gt; show processlist;</p>

<p>https://blog.csdn.net/wsf568582678/article/details/53636747</p>

<p>https://blog.csdn.net/weixin_39862697/article/details/113316610</p>

:ET