I"Ş<p>å†™ä»£ç çš„æ—¶å€™å‘ç°phpå’Œgoè®¡ç®—é‡‘é’±çš„æ—¶å€™å·®äº†1åˆ†ï¼Œè¿½äº†ä¸‹åŸå› 
èƒŒæ™¯çŸ¥è¯†</p>

<p>golangæ±‡ç¼–æŒ‡ä»¤å«ä¹‰
//MOVSD	ä¼ é€ï¼ˆå¤åˆ¶ï¼‰åŒå­—
æµ®ç‚¹ç«‹å³æ•°16è¿›åˆ¶è¡¨ç¤º
 $f64.3fe3777777777777
 å…¶ä¸­$è¡¨ç¤ºç«‹å³æ•°
 f64.è¡¨ç¤º64ä½æµ®ç‚¹æ•°å³ float64
 $f32.42bc0000
 f32.è¡¨ç¤º32ä½æµ®ç‚¹æ•°å³ float32</p>

<p>package main</p>

<p>import (
	â€œfmtâ€
	//â€reflectâ€
	â€œstrconvâ€
	â€œmathâ€
)</p>

<p>func main() {
	f0:=float32(94.0)  // MOVSS   $f32.42bc0000(SB), X0
	fmt.Println(f0)
	f := (93.0 - 20.0) / (140.0 - 20.0)
	f1:=f<em>300.0
	f2:=(93.0-20.0)/(140.0-20.0)</em>300.0
	fmt.Println(f1,f2, (93.0-20.0)/(140.0-20.0)*300.0)
	//fmt.Println(reflect.TypeOf(f1),reflect.TypeOf(f2))
	//182.49999999999997 182.5 182.5
	HexTofloat64(â€œ4066cfffffffffffâ€)
	HexTofloat64(â€œ4066d00000000000â€)</p>

<p>}</p>

<p>func HexTofloat64(hex string)  {
	//
	n, _:= strconv.ParseUint(hex,16,64)
	//fmt.Sprintf(â€œ%016bâ€, n)
	fmt.Println(n)
	//str1 := strconv.FormatFloat(n, â€˜fâ€™, 2, 64)
	//fmt.Println(str1) //3.14</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nf:= math.Float64frombits(uint64(n))
fmt.Println(nf)

//fmt.Printf("%x\n", math.Float32bits(-561.2863)) } &lt;!-- more --&gt; Goå’Œå¤§å¤šæ•°è¯­è¨€ä¸€æ ·, ä½¿ç”¨æ ‡å‡†çš„IEEE754è¡¨ç¤ºæµ®ç‚¹æ•°, 0.1ä½¿ç”¨äºŒè¿›åˆ¶è¡¨ç¤ºç»“æœæ˜¯ä¸€ä¸ªæ— é™å¾ªç¯æ•°, åªèƒ½èˆå…¥åè¡¨ç¤º, ç´¯åŠ 10æ¬¡ä¹‹åå°±ä¼šå‡ºç°åå·®.
</code></pre></div></div>

<p>phpä»£ç ï¼š
php &gt;  $f=(93.000-20.0000)/(140.0-20.0);
php &gt; var_dump($f,$f<em>300.0,(93.0-20.0)/(140.0-20.0)</em>300.0);
float(0.60833333333333)
float(182.5)
float(182.5)
golangä»£ç 1
package main</p>

<p>import â€œfmtâ€</p>

<p>func main() {
    f := (93.0 - 20.0) / (140.0 - 20.0)
    fmt.Println(f,f<em>300.0, (93.0-20.0)/(140.0-20.0)</em>300.0)
}</p>

<p>//0.6083333333333333 182.49999999999997 182.5
golangä»£ç 2
package main</p>

<p>import (
    â€œfmtâ€
)</p>

<p>func main() {</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>fmt.Println((float64(93)-float64(20))/(float64(140)-float64(20))*float64(300), (float32(93)-float32(20))/(float32(140)-float32(20))*float32(300)) } //182.49999999999997 182.5 Aï¼Œä¸åŒè¯­è¨€é—´é»˜è®¤ç±»å‹ä¸ä¸€è‡´ â€œphp ä»£ç â€å’Œâ€œgolangä»£ç 1â€å¾ˆåƒï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªåœ°æ–¹ä¸ä¸€æ ·
</code></pre></div></div>

<p>ç±»å‹</p>

<p>phpé»˜è®¤ç±»å‹æ˜¯floatï¼Œ</p>

<p>golang é»˜è®¤ç±»å‹æ˜¯ float64</p>

<p>golang å’Œphpçš„ç±»å‹å¯¹åº”æ˜¯</p>

<p>float	float32
double	float64
Bï¼ŒåŒä¸€è¯­è¨€floatå’Œdouble è¾“å‡ºç»“æœä¸ä¸€è‡´
å¯¹æ¯”â€œgolangä»£ç 1â€å’Œâ€œgolangä»£ç 2â€å‘ç°ï¼Œfloat32å’Œfloat64 è®¡ç®—ç»“æœä¸ä¸€è‡´</p>

<p>Cï¼Œå››èˆäº”å…¥
åœ¨å››èˆ5äº”å…¥çš„æ—¶å€™ï¼Œä¸€èˆ¬ä¼šç”¨</p>

<p>math.Floor( money+0.5)
è¿™ä¸ªå‡½æ•°çš„å…¥å‚æ˜¯float64ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“è®¡ç®—moneyçš„æ—¶å€™ç”¨float64</p>

<p>3ï¼Œè§£æ³•
1ï¼Œå¦‚æœä¸¤ä¸ªè¯­è¨€ä¸­éƒ½è¦è®¡ç®—ï¼Œé‚£ä¹ˆç±»å‹ä¸€å®šè¦ä¸€è‡´</p>

<p>2ï¼Œè·¨è¯­è¨€ä¼ è¾“çš„æ—¶å€™ç”¨æ•´å‹ï¼ˆjsonï¼xmlï¼‰</p>

<p>3ï¼Œåºåˆ—åŒ–çš„æ—¶å€™ä¹Ÿç”¨æ•´å½¢ï¼ˆmysqlï¼‰</p>

<p>4ï¼Œä¸šç•Œæ–¹æ¡ˆ
1ï¼ŒMySQLæä¾›äº†decimal(p,d)/numberlic(p,d)ç±»å‹çš„å®šç‚¹æ•°è¡¨ç¤ºæ³•, ç”±pä½æ•°å­—(ä¸åŒ…æ‹¬ç¬¦å·ã€å°æ•°ç‚¹)ç»„æˆ, å°æ•°ç‚¹åé¢æœ‰dä½æ•°å­—, å p+2ä¸ªå­—èŠ‚, è®¡ç®—æ€§èƒ½ä¼šæ¯”double/floatç±»å‹å¼±ä¸€äº›</p>

<p>2ï¼ŒJavaæœ‰æˆç†Ÿçš„æ ‡å‡†åº“java.lang.BigDecimal,Pythonæœ‰æ ‡å‡†åº“Decimal, å¯æƒœGOæ²¡æœ‰. åœ¨GitHubæœdecimal, staræ•°é‡æ¯”è¾ƒå¤šçš„æ˜¯TiDBé‡Œçš„MyDecimalå’Œgithub.com/shopspring/decimal</p>

<p>shopspringçš„Decimalå®ç°æ¯”è¾ƒç®€å•, æ€è·¯æ˜¯ä½¿ç”¨åè¿›åˆ¶å®šç‚¹æ•°è¡¨ç¤ºæ³•, æœ‰å¤šå°‘ä½å°æ•°å°±å°æ•°ç‚¹åç§»å¤šå°‘ä½, valueä¿å­˜ç§»ä¹‹åçš„æ•´æ•°, expä¿å­˜å°æ•°ç‚¹åçš„æ•°ä½ä¸ªæ•°,</p>

<p>3ï¼ŒTiDBé‡Œçš„MyDecimalå®šä¹‰ä½äºgithub.com/pingcap/tidb/util/types/mydecimal.go</p>

<p>å…¶æ€è·¯æ˜¯:
digitsIntä¿å­˜æ•°å­—çš„æ•´æ•°éƒ¨åˆ†æ•°å­—ä¸ªæ•°, digitsFracä¿å­˜æ•°å­—çš„å°æ•°éƒ¨åˆ†æ•°å­—ä¸ªæ•°, resultFracä¿å­˜è®¡ç®—åŠåºåˆ—åŒ–æ—¶ä¿ç•™è‡³å°æ•°ç‚¹åå‡ ä½, negativeæ ‡æ˜æ•°å­—æ˜¯å¦ä¸ºè´Ÿæ•°, wordBufæ˜¯ä¸€ä¸ªå®šé•¿çš„int32æ•°ç»„(é•¿åº¦ä¸º9), æ•°å­—å»æ‰å°æ•°ç‚¹çš„ä¸»ä½“ä¿å­˜åœ¨è¿™é‡Œ, ä¸€ä¸ªint32æœ‰32ä¸ªbit, æœ€å¤§å€¼ä¸º(2<em>*31-1)2147483647(10ä¸ªåè¿›åˆ¶æ•°), æ‰€ä»¥ä¸€ä¸ªint32æœ€å¤šèƒ½è¡¨ç¤º9ä¸ªåè¿›åˆ¶æ•°ä½, å› æ­¤wordBuf æœ€å¤šèƒ½å®¹çº³9</em>9ä¸ªåè¿›åˆ¶æ•°ä½.</p>

<p>// MyDecimal represents a decimal value.
type MyDecimal struct {
 digitsInt int8 // the number of <em>decimal</em> digits before the point.</p>

<p>digitsFrac int8 // the number of decimal digits after the point.</p>

<p>resultFrac int8 // result fraction digits.</p>

<p>negative bool</p>

<p>// wordBuf is an array of int32 words.
 // A word is an int32 value can hold 9 digits.(0 &lt;= word &lt; wordBase)
 wordBuf [maxWordBufLen]int32
}</p>

<p>5,æ‹“å±•é—®é¢˜
f := (93.0 - 20.0) / (140.0 - 20.0)
f1:=f<em>300.0
f2:=(93.0-20.0)/(140.0-20.0)</em>300.0
fmt.Println(f1,f2, (93.0-20.0)/(140.0-20.0)*300.0)
//182.49999999999997 182.5 182.5
æ—¢ç„¶éƒ½æ˜¯æµ®ç‚¹æ•°ä¸ºå•¥ç»“æœä¸ä¸€è‡´å‘¢</p>

<p>çœ‹æ±‡ç¼–</p>

<p>0x002f 00047 (main.go:11)       MOVSD   $f64.3fe3777777777777(SB), X1
0x0037 00055 (main.go:11)       MOVSD   X1, â€œâ€œ.f+64(SP)</p>

<p>0x003d 00061 (main.go:12)       MOVSD   $f64.4066cfffffffffff(SB), X1   //182.49999999999997
0x0045 00069 (main.go:12)       MOVSD   X1, â€œâ€œ.f1+56(SP)</p>

<p>0x004b 00075 (main.go:13)       MOVSD   $f64.4066d00000000000(SB), X1   //182.5
0x0053 00083 (main.go:13)       MOVSD   X1, â€œâ€œ.f2+48(SP)
å‘ç°ç¼–è¯‘å™¨åœ¨ç¼–è¯‘çš„æ—¶å€™è¿›è¡Œäº†è§„çº¦ï¼Œä¿å­˜çš„æµ®ç‚¹æ•°å°±ä¸ä¸€æ ·</p>
:ET