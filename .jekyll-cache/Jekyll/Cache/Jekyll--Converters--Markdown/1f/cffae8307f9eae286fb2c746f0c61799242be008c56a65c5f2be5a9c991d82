I"¾#<p>è¡¨å•æäº¤åˆ°æœåŠ¡å™¨ä¸€èˆ¬éƒ½ä½¿ç”¨ GET/POST è¯·æ±‚ã€‚</p>

<p>æœ¬ç« èŠ‚æˆ‘ä»¬å°†ä¸ºå¤§å®¶ä»‹ç» Node.js GET/POSTè¯·æ±‚ã€‚</p>

<p>è·å–GETè¯·æ±‚å†…å®¹
ç”±äºGETè¯·æ±‚ç›´æ¥è¢«åµŒå…¥åœ¨è·¯å¾„ä¸­ï¼ŒURLæ˜¯å®Œæ•´çš„è¯·æ±‚è·¯å¾„ï¼ŒåŒ…æ‹¬äº†?åé¢çš„éƒ¨åˆ†ï¼Œå› æ­¤ä½ å¯ä»¥æ‰‹åŠ¨è§£æåé¢çš„å†…å®¹ä½œä¸ºGETè¯·æ±‚çš„å‚æ•°ã€‚</p>

<p>node.js ä¸­ url æ¨¡å—ä¸­çš„ parse å‡½æ•°æä¾›äº†è¿™ä¸ªåŠŸèƒ½ã€‚</p>

<p>å®ä¾‹
var http = require(â€˜httpâ€™);
var url = require(â€˜urlâ€™);
var util = require(â€˜utilâ€™);</p>

<p>http.createServer(function(req, res){
    res.writeHead(200, {â€˜Content-Typeâ€™: â€˜text/plain; charset=utf-8â€™});
    res.end(util.inspect(url.parse(req.url, true)));
}).listen(3000);
åœ¨æµè§ˆå™¨ä¸­è®¿é—® http://localhost:3000/user?name=èœé¸Ÿæ•™ç¨‹&amp;url=www.runoob.com ç„¶åæŸ¥çœ‹è¿”å›ç»“æœ:
<!-- more -->
è·å– URL çš„å‚æ•°
æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ url.parse æ–¹æ³•æ¥è§£æ URL ä¸­çš„å‚æ•°ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>

<p>å®ä¾‹
var http = require(â€˜httpâ€™);
var url = require(â€˜urlâ€™);
var util = require(â€˜utilâ€™);</p>

<p>http.createServer(function(req, res){
    res.writeHead(200, {â€˜Content-Typeâ€™: â€˜text/plainâ€™});</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// è§£æ url å‚æ•°
var params = url.parse(req.url, true).query;
res.write("ç½‘ç«™åï¼š" + params.name);
res.write("\n");
res.write("ç½‘ç«™ URLï¼š" + params.url);
res.end();
</code></pre></div></div>

<p>}).listen(3000);
åœ¨æµè§ˆå™¨ä¸­è®¿é—® http://localhost:3000/user?name=èœé¸Ÿæ•™ç¨‹&amp;url=www.runoob.com ç„¶åæŸ¥çœ‹è¿”å›ç»“æœ:</p>

<p>è·å– POST è¯·æ±‚å†…å®¹
POST è¯·æ±‚çš„å†…å®¹å…¨éƒ¨çš„éƒ½åœ¨è¯·æ±‚ä½“ä¸­ï¼Œhttp.ServerRequest å¹¶æ²¡æœ‰ä¸€ä¸ªå±æ€§å†…å®¹ä¸ºè¯·æ±‚ä½“ï¼ŒåŸå› æ˜¯ç­‰å¾…è¯·æ±‚ä½“ä¼ è¾“å¯èƒ½æ˜¯ä¸€ä»¶è€—æ—¶çš„å·¥ä½œã€‚</p>

<p>æ¯”å¦‚ä¸Šä¼ æ–‡ä»¶ï¼Œè€Œå¾ˆå¤šæ—¶å€™æˆ‘ä»¬å¯èƒ½å¹¶ä¸éœ€è¦ç†ä¼šè¯·æ±‚ä½“çš„å†…å®¹ï¼Œæ¶æ„çš„POSTè¯·æ±‚ä¼šå¤§å¤§æ¶ˆè€—æœåŠ¡å™¨çš„èµ„æºï¼Œæ‰€ä»¥ node.js é»˜è®¤æ˜¯ä¸ä¼šè§£æè¯·æ±‚ä½“çš„ï¼Œå½“ä½ éœ€è¦çš„æ—¶å€™ï¼Œéœ€è¦æ‰‹åŠ¨æ¥åšã€‚</p>

<p>åŸºæœ¬è¯­æ³•ç»“æ„è¯´æ˜
var http = require(â€˜httpâ€™);
var querystring = require(â€˜querystringâ€™);
var util = require(â€˜utilâ€™);</p>

<p>http.createServer(function(req, res){
    // å®šä¹‰äº†ä¸€ä¸ªpostå˜é‡ï¼Œç”¨äºæš‚å­˜è¯·æ±‚ä½“çš„ä¿¡æ¯
    var post = â€˜â€™;</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// é€šè¿‡reqçš„dataäº‹ä»¶ç›‘å¬å‡½æ•°ï¼Œæ¯å½“æ¥å—åˆ°è¯·æ±‚ä½“çš„æ•°æ®ï¼Œå°±ç´¯åŠ åˆ°postå˜é‡ä¸­
req.on('data', function(chunk){    
    post += chunk;
});
 
// åœ¨endäº‹ä»¶è§¦å‘åï¼Œé€šè¿‡querystring.parseå°†postè§£æä¸ºçœŸæ­£çš„POSTè¯·æ±‚æ ¼å¼ï¼Œç„¶åå‘å®¢æˆ·ç«¯è¿”å›ã€‚
req.on('end', function(){    
    post = querystring.parse(post);
    res.end(util.inspect(post));
}); }).listen(3000); ä»¥ä¸‹å®ä¾‹è¡¨å•é€šè¿‡ POST æäº¤å¹¶è¾“å‡ºæ•°æ®ï¼š
</code></pre></div></div>

<p>å®ä¾‹
var http = require(â€˜httpâ€™);
var querystring = require(â€˜querystringâ€™);</p>

<p>var postHTML = 
  â€˜&lt;html&gt;&lt;head&gt;<meta charset="utf-8" /><title>èœé¸Ÿæ•™ç¨‹ Node.js å®ä¾‹</title>&lt;/head&gt;â€™ +
  â€˜&lt;body&gt;â€™ +
  â€˜&lt;form method="post"&gt;â€™ +
  â€˜ç½‘ç«™åï¼š <input name="name" /><br />â€™ +
  â€˜ç½‘ç«™ URLï¼š <input name="url" /><br />â€™ +
  â€˜<input type="submit" />â€™ +
  â€˜&lt;/form&gt;â€™ +
  â€˜&lt;/body&gt;&lt;/html&gt;â€™;</p>

<p>http.createServer(function (req, res) {
  var body = â€œâ€;
  req.on(â€˜dataâ€™, function (chunk) {
    body += chunk;
  });
  req.on(â€˜endâ€™, function () {
    // è§£æå‚æ•°
    body = querystring.parse(body);
    // è®¾ç½®å“åº”å¤´éƒ¨ä¿¡æ¯åŠç¼–ç 
    res.writeHead(200, {â€˜Content-Typeâ€™: â€˜text/html; charset=utf8â€™});</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>if(body.name &amp;&amp; body.url) { // è¾“å‡ºæäº¤çš„æ•°æ®
    res.write("ç½‘ç«™åï¼š" + body.name);
    res.write("&lt;br&gt;");
    res.write("ç½‘ç«™ URLï¼š" + body.url);
} else {  // è¾“å‡ºè¡¨å•
    res.write(postHTML);
}
res.end();   }); }).listen(3000);
</code></pre></div></div>

<p>Node.js å·¥å…·æ¨¡å—
åœ¨ Node.js æ¨¡å—åº“ä¸­æœ‰å¾ˆå¤šå¥½ç”¨çš„æ¨¡å—ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬ä¸ºå¤§å®¶ä»‹ç»å‡ ç§å¸¸ç”¨æ¨¡å—çš„ä½¿ç”¨ï¼š</p>

<p>åºå·	æ¨¡å—å &amp; æè¿°
1	OS æ¨¡å—
æä¾›åŸºæœ¬çš„ç³»ç»Ÿæ“ä½œå‡½æ•°ã€‚
2	Path æ¨¡å—
æä¾›äº†å¤„ç†å’Œè½¬æ¢æ–‡ä»¶è·¯å¾„çš„å·¥å…·ã€‚
3	Net æ¨¡å—
ç”¨äºåº•å±‚çš„ç½‘ç»œé€šä¿¡ã€‚æä¾›äº†æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯çš„çš„æ“ä½œã€‚
4	DNS æ¨¡å—
ç”¨äºè§£æåŸŸåã€‚
5	Domain æ¨¡å—
ç®€åŒ–å¼‚æ­¥ä»£ç çš„å¼‚å¸¸å¤„ç†ï¼Œå¯ä»¥æ•æ‰å¤„ç†try catchæ— æ³•æ•æ‰çš„ã€‚</p>

<p>Node.js Web æ¨¡å—
ä»€ä¹ˆæ˜¯ Web æœåŠ¡å™¨ï¼Ÿ
WebæœåŠ¡å™¨ä¸€èˆ¬æŒ‡ç½‘ç«™æœåŠ¡å™¨ï¼Œæ˜¯æŒ‡é©»ç•™äºå› ç‰¹ç½‘ä¸ŠæŸç§ç±»å‹è®¡ç®—æœºçš„ç¨‹åºï¼ŒWebæœåŠ¡å™¨çš„åŸºæœ¬åŠŸèƒ½å°±æ˜¯æä¾›Webä¿¡æ¯æµè§ˆæœåŠ¡ã€‚å®ƒåªéœ€æ”¯æŒHTTPåè®®ã€HTMLæ–‡æ¡£æ ¼å¼åŠURLï¼Œä¸å®¢æˆ·ç«¯çš„ç½‘ç»œæµè§ˆå™¨é…åˆã€‚</p>

<p>å¤§å¤šæ•° web æœåŠ¡å™¨éƒ½æ”¯æŒæœåŠ¡ç«¯çš„è„šæœ¬è¯­è¨€ï¼ˆphpã€pythonã€rubyï¼‰ç­‰ï¼Œå¹¶é€šè¿‡è„šæœ¬è¯­è¨€ä»æ•°æ®åº“è·å–æ•°æ®ï¼Œå°†ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯æµè§ˆå™¨ã€‚</p>

<p>ç›®å‰æœ€ä¸»æµçš„ä¸‰ä¸ªWebæœåŠ¡å™¨æ˜¯Apacheã€Nginxã€IISã€‚</p>

<p>Web åº”ç”¨æ¶æ„
Web åº”ç”¨æ¶æ„
Client - å®¢æˆ·ç«¯ï¼Œä¸€èˆ¬æŒ‡æµè§ˆå™¨ï¼Œæµè§ˆå™¨å¯ä»¥é€šè¿‡ HTTP åè®®å‘æœåŠ¡å™¨è¯·æ±‚æ•°æ®ã€‚</p>

<p>Server - æœåŠ¡ç«¯ï¼Œä¸€èˆ¬æŒ‡ Web æœåŠ¡å™¨ï¼Œå¯ä»¥æ¥æ”¶å®¢æˆ·ç«¯è¯·æ±‚ï¼Œå¹¶å‘å®¢æˆ·ç«¯å‘é€å“åº”æ•°æ®ã€‚</p>

<p>Business - ä¸šåŠ¡å±‚ï¼Œ é€šè¿‡ Web æœåŠ¡å™¨å¤„ç†åº”ç”¨ç¨‹åºï¼Œå¦‚ä¸æ•°æ®åº“äº¤äº’ï¼Œé€»è¾‘è¿ç®—ï¼Œè°ƒç”¨å¤–éƒ¨ç¨‹åºç­‰ã€‚</p>

<p>Data - æ•°æ®å±‚ï¼Œä¸€èˆ¬ç”±æ•°æ®åº“ç»„æˆã€‚</p>

<p>ä½¿ç”¨ Node åˆ›å»º Web æœåŠ¡å™¨
Node.js æä¾›äº† http æ¨¡å—ï¼Œhttp æ¨¡å—ä¸»è¦ç”¨äºæ­å»º HTTP æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ï¼Œä½¿ç”¨ HTTP æœåŠ¡å™¨æˆ–å®¢æˆ·ç«¯åŠŸèƒ½å¿…é¡»è°ƒç”¨ http æ¨¡å—ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>

<p>var http = require(â€˜httpâ€™);
ä»¥ä¸‹æ˜¯æ¼”ç¤ºä¸€ä¸ªæœ€åŸºæœ¬çš„ HTTP æœåŠ¡å™¨æ¶æ„(ä½¿ç”¨ 8080 ç«¯å£)ï¼Œåˆ›å»º server.js æ–‡ä»¶ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p>

<p>å®ä¾‹
var http = require(â€˜httpâ€™);
var fs = require(â€˜fsâ€™);
var url = require(â€˜urlâ€™);</p>

<p>// åˆ›å»ºæœåŠ¡å™¨
http.createServer( function (request, response) {<br />
   // è§£æè¯·æ±‚ï¼ŒåŒ…æ‹¬æ–‡ä»¶å
   var pathname = url.parse(request.url).pathname;</p>

<p>// è¾“å‡ºè¯·æ±‚çš„æ–‡ä»¶å
   console.log(â€œRequest for â€œ + pathname + â€œ received.â€);</p>

<p>// ä»æ–‡ä»¶ç³»ç»Ÿä¸­è¯»å–è¯·æ±‚çš„æ–‡ä»¶å†…å®¹
   fs.readFile(pathname.substr(1), function (err, data) {
      if (err) {
         console.log(err);
         // HTTP çŠ¶æ€ç : 404 : NOT FOUND
         // Content Type: text/html
         response.writeHead(404, {â€˜Content-Typeâ€™: â€˜text/htmlâ€™});
      }else{           <br />
         // HTTP çŠ¶æ€ç : 200 : OK
         // Content Type: text/html
         response.writeHead(200, {â€˜Content-Typeâ€™: â€˜text/htmlâ€™});</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>     // å“åº”æ–‡ä»¶å†…å®¹
     response.write(data.toString());        
  }
  //  å‘é€å“åº”æ•°æ®
  response.end();    });    }).listen(8080);
</code></pre></div></div>

<p>// æ§åˆ¶å°ä¼šè¾“å‡ºä»¥ä¸‹ä¿¡æ¯
console.log(â€˜Server running at http://127.0.0.1:8080/â€™);
æ¥ä¸‹æ¥æˆ‘ä»¬åœ¨è¯¥ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª index.html æ–‡ä»¶ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>

<p>index.html æ–‡ä»¶
&lt;!DOCTYPE html&gt;</p>
<html>
<head>
<meta charset="utf-8" />
<title>èœé¸Ÿæ•™ç¨‹(runoob.com)</title>
</head>
<body>
    <h1>æˆ‘çš„ç¬¬ä¸€ä¸ªæ ‡é¢˜</h1>
    <p>æˆ‘çš„ç¬¬ä¸€ä¸ªæ®µè½ã€‚</p>
</body>
</html>
<p>æ‰§è¡Œ server.js æ–‡ä»¶ï¼š</p>

<p>$ node server.js
Server running at http://127.0.0.1:8080/
æ¥ç€æˆ‘ä»¬åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€åœ°å€ï¼šhttp://127.0.0.1:8080/index.htmlï¼Œæ˜¾ç¤ºå¦‚ä¸‹å›¾æ‰€ç¤º:</p>

<p>æ‰§è¡Œ server.js çš„æ§åˆ¶å°è¾“å‡ºä¿¡æ¯å¦‚ä¸‹ï¼š</p>

<p>Server running at http://127.0.0.1:8080/
Request for /index.html received.     #  å®¢æˆ·ç«¯è¯·æ±‚ä¿¡æ¯
ä½¿ç”¨ Node åˆ›å»º Web å®¢æˆ·ç«¯
Node åˆ›å»º Web å®¢æˆ·ç«¯éœ€è¦å¼•å…¥ http æ¨¡å—ï¼Œåˆ›å»º client.js æ–‡ä»¶ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p>

<p>å®ä¾‹
var http = require(â€˜httpâ€™);</p>

<p>// ç”¨äºè¯·æ±‚çš„é€‰é¡¹
var options = {
   host: â€˜localhostâ€™,
   port: â€˜8080â€™,
   path: â€˜/index.htmlâ€™<br />
};</p>

<p>// å¤„ç†å“åº”çš„å›è°ƒå‡½æ•°
var callback = function(response){
   // ä¸æ–­æ›´æ–°æ•°æ®
   var body = â€˜â€™;
   response.on(â€˜dataâ€™, function(data) {
      body += data;
   });</p>

<p>response.on(â€˜endâ€™, function() {
      // æ•°æ®æ¥æ”¶å®Œæˆ
      console.log(body);
   });
}
// å‘æœåŠ¡ç«¯å‘é€è¯·æ±‚
var req = http.request(options, callback);
req.end();
æ–°å¼€ä¸€ä¸ªç»ˆç«¯ï¼Œæ‰§è¡Œ client.js æ–‡ä»¶ï¼Œè¾“å‡ºç»“æœå¦‚ä¸‹ï¼š</p>

<p>$ node  client.js 
&lt;!DOCTYPE html&gt;</p>
<html>
<head>
<meta charset="utf-8" />
<title>èœé¸Ÿæ•™ç¨‹(runoob.com)</title>
</head>
<body>
    <h1>æˆ‘çš„ç¬¬ä¸€ä¸ªæ ‡é¢˜</h1>
    <p>æˆ‘çš„ç¬¬ä¸€ä¸ªæ®µè½ã€‚</p>
</body>
</html>
<p>æ‰§è¡Œ server.js çš„æ§åˆ¶å°è¾“å‡ºä¿¡æ¯å¦‚ä¸‹ï¼š</p>

<p>Server running at http://127.0.0.1:8080/
Request for /index.html received.   # å®¢æˆ·ç«¯è¯·æ±‚ä¿¡æ¯</p>
:ET