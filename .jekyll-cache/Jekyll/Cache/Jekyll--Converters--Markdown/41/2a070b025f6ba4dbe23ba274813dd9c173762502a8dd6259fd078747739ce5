I"ã&<p>ä»¥ç°åœ¨å‰ç«¯jsæ¿€å¢çš„æ€åŠ¿ï¼Œä¸€ä¸ªé¡¹ç›®ä¸‹æ¥å‡ åä¸ªjsæ–‡ä»¶è½»è½»æ¾æ¾
å¯¹äºå¤æ‚ä¸€ç‚¹çš„å•é¡µåº”ç”¨æ¥è¯´ï¼Œæ–‡ä»¶ä¸Šç™¾ç®€ç›´æ˜¯å®¶å¸¸ä¾¿é¥­ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™æˆ‘ä»¬çš„jsæ–‡ä»¶åº”è¯¥æ€ä¹ˆå¤„ç†å‘¢ï¼Ÿ
å¦å¤–ï¼Œå¯¹äºcssæ–‡ä»¶ï¼Œåˆè¯¥å¦‚ä½•å¤„ç†å‘¢ï¼Ÿï¼Ÿ
è¿™äº›éƒ½æ˜¯æˆ‘ä»¬å®é™…å·¥ä½œä¸­è¦é‡åˆ°çš„é—®é¢˜ï¼Œæ¯”å¦‚æˆ‘ä»¬ç°åœ¨æ¡†æ¶ä½¿ç”¨zeptoã€backboneã€underscore
æˆ‘ä»¬è¦å¦‚ä½•å°†ä»–ä»¬åˆæˆä¸€ä¸ªlibsæ–‡ä»¶ï¼Œè¿™éƒ½æ˜¯ä»¤äººå¤´ç–¼çš„é—®é¢˜</p>

<p>grunt
æ˜¯ä¸€å¥—å‰ç«¯è‡ªåŠ¨åŒ–å·¥å…·ï¼Œä¸€ä¸ªåŸºäºnodeJsçš„å‘½ä»¤è¡Œå·¥å…·ï¼Œä¸€èˆ¬ç”¨äºï¼š
â‘  å‹ç¼©æ–‡ä»¶
â‘¡ åˆå¹¶æ–‡ä»¶
â‘¢ ç®€å•è¯­æ³•æ£€æŸ¥</p>

<p>å¯¹äºå…¶ä»–ç”¨æ³•ï¼Œæˆ‘è¿˜ä¸å¤ªæ¸…æ¥šï¼Œæˆ‘ä»¬è¿™é‡Œç®€å•ä»‹ç»ä¸‹gruntçš„å‹ç¼©ã€åˆå¹¶æ–‡ä»¶</p>

<p>åˆå­¦ï¼Œæœ‰è¯¯è¯·åŒ…æ¶µ</p>

<p>å‡†å¤‡é˜¶æ®µ
1ã€nodeJsç¯å¢ƒ
å› ä¸ºgruntæ˜¯åŸºäºnodeJsçš„ï¼Œæ‰€ä»¥é¦–å…ˆå„ä½éœ€è¦å®‰è£…nodeJSç¯å¢ƒ
<!-- more -->
2ã€å®‰è£…grunt
æœ‰äº†nodeJsç¯å¢ƒåï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥å¼€å§‹ægruntäº†ï¼Œå› ä¸ºæˆ‘ä»¬å¯èƒ½åœ¨ä»»ä½•ç›®å½•ä¸‹è¿è¡Œæ‰“åŒ…ç¨‹åºï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å®‰è£…CLI
å®˜æ–¹æ¨èåœ¨å…¨å±€å®‰è£…CLIï¼ˆgruntçš„å‘½ä»¤è¡Œæ¥å£ï¼‰</p>

<p>npm install -g grunt-cli
è¿™æ¡å‘½ä»¤å°†ä¼šæŠŠgruntå‘½ä»¤æ¤å…¥ç³»ç»Ÿè·¯å¾„ï¼Œè¿™æ ·å°±èƒ½åœ¨ä»»æ„ç›®å½•è¿è¡Œä»–ï¼ŒåŸå› æ˜¯</p>

<p>æ¯æ¬¡è¿è¡Œgruntæ—¶ï¼Œå®ƒéƒ½ä¼šä½¿ç”¨nodeçš„requireæŸ¥æ‰¾æœ¬åœ°æ˜¯å¦å®‰è£…gruntï¼Œå¦‚æœæ‰¾åˆ°CLIä¾¿åŠ è½½è¿™ä¸ªæœ¬åœ°gruntåº“
ç„¶ååº”ç”¨æˆ‘ä»¬é¡¹ç›®ä¸­çš„GruntFileé…ç½®ï¼Œå¹¶æ‰§è¡Œä»»åŠ¡</p>

<p>æ–°å»ºä¸€ä¸ªé¡¹ç›®ï¼ˆæ–‡ä»¶å¤¹å°±å¥½ï¼‰
åœ¨é‡Œé¢æ–°å¢ä¸¤ä¸ªæ–‡ä»¶
â‘  package.json
â‘¡ Gruntfile.js
å®Œäº†æˆ‘ä»¬éœ€è¦åœ¨gruntç›®å½•ä¸‹æ‰§è¡Œ npm installå°†ç›¸å…³çš„æ–‡ä»¶ä¸‹è½½ä¸‹æ¥</p>

<p>ç„¶ååœ¨Gruntfileä¸­æ–°å¢ä»¥ä¸‹ä»£ç 
module.exports = function (grunt) {
  // é¡¹ç›®é…ç½®
  grunt.initConfig({
    pkg: grunt.file.readJSON(â€˜package.jsonâ€™),
    uglify: {
      options: {
        banner: â€˜/*! &lt;%= pkg.file %&gt; &lt;%= grunt.template.today(â€œyyyy-mm-ddâ€) %&gt; */\nâ€™
      },
      build: {
        src: â€˜src/&lt;%=pkg.file %&gt;.jsâ€™,
        dest: â€˜dest/&lt;%= pkg.file %&gt;.min.jsâ€™
      }
    }
  });
  // åŠ è½½æä¾›â€uglifyâ€ä»»åŠ¡çš„æ’ä»¶
  grunt.loadNpmTasks(â€˜grunt-contrib-uglifyâ€™);
  // é»˜è®¤ä»»åŠ¡
  grunt.registerTask(â€˜defaultâ€™, [â€˜uglifyâ€™]);
}</p>

<p>ç„¶åè¿è¡Œ gruntå‘½ä»¤å</p>

<p>grunt</p>

<p>è®¤è¯†Gruntdileä¸package.json
ä¸å‡ºæ„å¤–ï¼Œæ¯ä¸€ä¸ªgurntéƒ½ä¼šéœ€è¦è¿™ä¸¤ä¸ªæ–‡ä»¶ï¼Œå¹¶ä¸”å¾ˆå¯èƒ½å°±åªæœ‰è¿™ä¸¤ä¸ªæ–‡ä»¶ï¼ˆå¤æ‚çš„æƒ…å†µæœ‰æ‰€ä¸åŒï¼‰</p>

<p>package.json
è¿™ä¸ªæ–‡ä»¶ç”¨æ¥å­˜å‚¨npmæ¨¡å—çš„ä¾èµ–é¡¹ï¼ˆæ¯”å¦‚æˆ‘ä»¬çš„æ‰“åŒ…è‹¥æ˜¯ä¾èµ–requireJSçš„æ’ä»¶ï¼Œè¿™é‡Œå°±éœ€è¦é…ç½®ï¼‰
ç„¶åï¼Œæˆ‘ä»¬ä¼šåœ¨é‡Œé¢é…ç½®ä¸€äº›ä¸ä¸€æ ·çš„ä¿¡æ¯ï¼Œæ¯”å¦‚æˆ‘ä»¬ä¸Šé¢çš„fileï¼Œè¿™äº›æ•°æ®éƒ½ä¼šæ”¾åˆ°packageä¸­
å¯¹äºpackageçš„çµæ´»é…ç½®ï¼Œæˆ‘ä»¬ä¼šåœ¨åé¢æåˆ°</p>

<p>Gruntfile
è¿™ä¸ªæ–‡ä»¶å°¤å…¶å…³é”®ï¼Œä»–ä¸€èˆ¬å¹²ä¸¤ä»¶äº‹æƒ…ï¼š
â‘  è¯»å–packageä¿¡æ¯
â‘¡ æ’ä»¶åŠ è½½ã€æ³¨å†Œä»»åŠ¡ï¼Œè¿è¡Œä»»åŠ¡ï¼ˆgruntå¯¹å¤–çš„æ¥å£å…¨éƒ¨å†™åœ¨è¿™é‡Œé¢ï¼‰</p>

<p>Gruntfileä¸€èˆ¬ç”±å››ä¸ªéƒ¨åˆ†ç»„æˆ
â‘  åŒ…è£…å‡½æ•°
è¿™ä¸ªåŒ…è£…å‡½æ•°æ²¡ä»€ä¹ˆä¸œè¥¿ï¼Œæ„æ€å°±æ˜¯æˆ‘ä»¬æ‰€æœ‰çš„ä»£ç å¿…é¡»æ”¾åˆ°è¿™ä¸ªå‡½æ•°é‡Œé¢</p>

<p>module.exports = function (grunt) {
//ä½ çš„ä»£ç 
}
è¿™ä¸ªä¸ç”¨çŸ¥é“ä¸ºä»€ä¹ˆï¼Œç›´æ¥å°†ä»£ç æ”¾å…¥å³å¯</p>

<p>â‘¡ é¡¹ç›®/ä»»åŠ¡é…ç½®
æˆ‘ä»¬åœ¨Gruntfileä¸€èˆ¬ç¬¬ä¸€ä¸ªç”¨åˆ°çš„å°±æ˜¯initConfigæ–¹æ³•é…ç½®ä¾èµ–ä¿¡æ¯</p>

<p>pkg: grunt.file.readJSON(â€˜package.jsonâ€™)
è¿™é‡Œçš„ grunt.file.readJSONå°±ä¼šå°†æˆ‘ä»¬çš„é…ç½®æ–‡ä»¶è¯»å‡ºï¼Œå¹¶ä¸”è½¬æ¢ä¸ºjsonå¯¹è±¡</p>

<p>ç„¶åæˆ‘ä»¬åœ¨åé¢çš„åœ°æ–¹å°±å¯ä»¥é‡‡ç”¨pkg.XXXçš„æ–¹å¼è®¿é—®å…¶ä¸­çš„æ•°æ®äº†
å€¼å¾—æ³¨æ„çš„æ˜¯è¿™é‡Œä½¿ç”¨çš„æ˜¯underscoreæ¨¡æ¿å¼•æ“ï¼Œæ‰€ä»¥ä½ åœ¨è¿™é‡Œå¯ä»¥å†™å¾ˆå¤šä¸œè¥¿</p>

<p>uglifyæ˜¯ä¸€ä¸ªæ’ä»¶çš„ï¼Œæˆ‘ä»¬åœ¨packageä¾èµ–é¡¹è¿›è¡Œäº†é…ç½®ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬ä¸ºç³»ç»Ÿé…ç½®äº†ä¸€ä¸ªä»»åŠ¡
uglifyï¼ˆå‹ç¼©ï¼‰ï¼Œä»–ä¼šå¹²è¿™å‡ ä¸ªäº‹æƒ…ï¼š</p>

<p>â‘  åœ¨srcä¸­æ‰¾åˆ°zeptoè¿›è¡Œå‹ç¼©ï¼ˆå…·ä½“åå­—åœ¨packageä¸­æ‰¾åˆ°ï¼‰
â‘¡ æ‰¾åˆ°destç›®å½•ï¼Œæ²¡æœ‰å°±æ–°å»ºï¼Œç„¶åå°†å‹ç¼©æ–‡ä»¶æè¿›å»
â‘¢ åœ¨ä¸Šé¢åŠ å‡ ä¸ªæè¿°è¯­è¨€</p>

<p>è¿™ä¸ªä»»åŠ¡é…ç½®å…¶å®å°±æ˜¯ä¸€ä¸ªæ–¹æ³•æ¥å£è°ƒç”¨ï¼ŒæŒ‰ç…§è§„èŒƒæ¥å°±å¥½ï¼Œæš‚æ—¶ä¸äºˆå…³æ³¨ï¼Œå†…å¹•åæœŸæ¥
è¿™é‡Œåªæ˜¯å®šä¹‰äº†ç›¸å…³å‚æ•°ï¼Œä½†æ˜¯å¹¶æœªåŠ è½½å®é™…å‡½æ•°ï¼Œæ‰€ä»¥åé¢é©¬ä¸Šå°±æœ‰ä¸€å¥ï¼š</p>

<p>grunt.loadNpmTasks(â€˜grunt-contrib-uglifyâ€™);
ç”¨äºåŠ è½½ç›¸å…³æ’ä»¶</p>

<p>æœ€åæ³¨å†Œä¸€ä¸ªè‡ªå®šä¹‰ä»»åŠ¡ï¼ˆå…¶å®ä¹Ÿæ˜¯é»˜è®¤ä»»åŠ¡ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸‹é¢çš„å‘½ä»¤è¡Œæ˜¯ç­‰æ•ˆçš„ï¼š</p>

<p>grunt == grunt uglify
è‡³æ­¤ï¼Œæˆ‘ä»¬å°±ç®€å•è§£æäº†ä¸€ç•ªgruntçš„æ•´ä¸ªæ“ä½œï¼Œä¸‹é¢æ¥åˆå¹¶æ–‡ä»¶çš„ä¾‹å­</p>

<p>åˆå¹¶æ–‡ä»¶
åˆå¹¶æ–‡ä»¶ä¾èµ–äºgrunt-contrib-concatæ’ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„packageä¾èµ–é¡¹è¦æ–°å¢ä¸€é¡¹</p>

<p>â€œdevDependenciesâ€: {
  â€œgruntâ€: â€œ~0.4.1â€,
  â€œgrunt-contrib-jshintâ€: â€œ~0.6.3â€,
  â€œgrunt-contrib-concatâ€: â€œ~0.3.0â€,
  â€œgrunt-contrib-uglifyâ€: â€œ~0.2.1â€,
  â€œgrunt-contrib-requirejsâ€: â€œ~0.4.1â€,
  â€œgrunt-contrib-copyâ€: â€œ~0.4.1â€,
  â€œgrunt-contrib-cleanâ€: â€œ~0.5.0â€,
  â€œgrunt-stripâ€: â€œ~0.2.1â€
},</p>

<p>module.exports = function (grunt) {
  // é¡¹ç›®é…ç½®
  grunt.initConfig({
    pkg: grunt.file.readJSON(â€˜package.jsonâ€™),
    concat: {
      options: {
        separator: â€˜;â€™
      },
      dist: {
        src: [â€˜src/zepto.jsâ€™, â€˜src/underscore.jsâ€™, â€˜src/backbone.jsâ€™],
        dest: â€˜dest/libs.jsâ€™
      }
    }
  });
  grunt.loadNpmTasks(â€˜grunt-contrib-concatâ€™);
  // é»˜è®¤ä»»åŠ¡
  grunt.registerTask(â€˜defaultâ€™, [â€˜concatâ€™]);
}</p>

<p>ä¸‰ä¸ªæ–‡ä»¶è¢«å‹ç¼©æˆäº†ä¸€ä¸ªï¼Œä½†æ˜¯æ²¡æœ‰å‹ç¼©ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬è¿™é‡Œå†åŠ ä¸€æ­¥æ“ä½œï¼Œå°†ä¹‹å‹ç¼©åå†åˆå¹¶</p>

<p>module.exports = function (grunt) {
  // é¡¹ç›®é…ç½®
  grunt.initConfig({
    pkg: grunt.file.readJSON(â€˜package.jsonâ€™),
    concat: {
      options: {
        separator: â€˜;â€™
      },
      dist: {
        src: [â€˜src/zepto.jsâ€™, â€˜src/underscore.jsâ€™, â€˜src/backbone.jsâ€™],
        dest: â€˜dest/libs.jsâ€™
      }
    },
    uglify: {
      build: {
        src: â€˜dest/libs.jsâ€™,
        dest: â€˜dest/libs.min.jsâ€™
      }
    }
  });
  grunt.loadNpmTasks(â€˜grunt-contrib-uglifyâ€™);
  grunt.loadNpmTasks(â€˜grunt-contrib-concatâ€™);
  // é»˜è®¤ä»»åŠ¡
  grunt.registerTask(â€˜defaultâ€™, [â€˜concatâ€™, â€˜uglifyâ€™]);
}</p>

<p>æˆ‘è¿™é‡Œçš„åšæ³•æ˜¯å…ˆåˆå¹¶å½¢æˆä¸€ä¸ªlibsï¼Œç„¶åå†å°†libså‹ç¼©æˆlibs.min.js
æ‰€ä»¥æˆ‘ä»¬è¿™é‡Œæ¢ä¸ªåšæ³•ï¼Œå…ˆå‹ç¼©å†åˆå¹¶ï¼Œå…¶å®unglifyå·²ç»å¹²äº†è¿™äº›äº‹æƒ…äº†
module.exports = function (grunt) {
  // é¡¹ç›®é…ç½®
  grunt.initConfig({
    pkg: grunt.file.readJSON(â€˜package.jsonâ€™),
    uglify: {
      â€œmy_targetâ€: {
        â€œfilesâ€: {
          â€˜dest/libs.min.jsâ€™: [â€˜src/zepto.jsâ€™, â€˜src/underscore.jsâ€™, â€˜src/backbone.jsâ€™]
        }
      }
    }
  });
  grunt.loadNpmTasks(â€˜grunt-contrib-uglifyâ€™);
  // é»˜è®¤ä»»åŠ¡
  grunt.registerTask(â€˜defaultâ€™, [â€˜uglifyâ€™]);
}</p>

<p>åˆå¹¶requireJSç®¡ç†çš„æ–‡ä»¶
æœ‰äº†å‰é¢åŸºç¡€åï¼Œæˆ‘ä»¬æ¥å¹²ä¸€ä»¶å¹³æ—¶å¾ˆå¤´ç–¼çš„äº‹æƒ…ï¼Œä¾¿æ˜¯å°†requireç®¡ç†çš„æ‰€æœ‰jsæ–‡ä»¶ç»™å‹ç¼©äº†åˆå¹¶ä¸ºä¸€ä¸ªæ–‡ä»¶</p>

<p>åœ¨main.jsä¸­æ–°å¢ä»£ç ï¼š
require.config({
 baseUrl: â€˜â€™,
 shim: {
  $: {
      exports: â€˜zeptoâ€™
  },
  <em>: {
   exports: â€˜</em>â€™
  },
  B: {
   deps: [
    â€˜<em>â€™,
    â€˜$â€™
     ],
   exports: â€˜Backboneâ€™
  }
 },
 paths: {
  â€˜$â€™: â€˜src/zeptoâ€™,
  â€˜</em>â€™: â€˜src/underscoreâ€™,
  â€˜Bâ€™: â€˜src/backboneâ€™
 }
});
requirejs([â€˜Bâ€™], function (b) {
});</p>

<p>è¿™æ ·çš„è¯è¿è¡Œä¼šè‡ªåŠ¨åŠ è½½å‡ ä¸ªæ–‡ä»¶ï¼Œæˆ‘ä»¬ç°åœ¨å¸Œæœ›å°†ä¹‹åˆå¹¶ä¸ºä¸€ä¸ªlibs.jsè¯¥æ€ä¹ˆå¹²å‘¢ï¼Ÿï¼Ÿï¼Ÿ</p>

<p>æˆ‘ä»¬è¿™é‡Œä½¿ç”¨è‡ªå®šä¹‰ä»»åŠ¡æ–¹æ³•æ¥åšï¼Œå› ä¸ºæˆ‘ä»¬å¥½åƒæ²¡æœ‰ä»‹ç»ä»–</p>

<p>è¦ä½¿ç”¨requireJSç›¸å…³éœ€è¦æ’ä»¶</p>

<p>grunt.loadNpmTasks(â€˜grunt-contrib-requirejsâ€™);
å› ä¸ºæˆ‘ä»¬ä»¥åå¯èƒ½å­˜åœ¨é…ç½®æ–‡ä»¶å­˜åœ¨å„ä¸ªé¡¹ç›®æ–‡ä»¶çš„æƒ…å†µï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œå°†requireJsç›¸å…³çš„é…ç½®æ”¾å…¥gruntCfg.jsonä¸­</p>

<p>è¿™æ ·æˆ‘ä»¬çš„package.jsonå°±æ²¡æœ‰ä»€ä¹ˆå®é™…æ„ä¹‰äº†ï¼š
æˆ‘ä»¬è¿™é‡Œè®¾ç½®çš„requireç›¸å…³çš„grunté…ç½®æ–‡ä»¶å¦‚ä¸‹ï¼ˆgruntCfg.jsonï¼‰
{
  â€œrequirejsâ€: {
    â€œmainâ€: {
      â€œoptionsâ€: {
        â€œbaseUrlâ€: â€œâ€,
        â€œpathsâ€: {
          â€œ$â€: â€œsrc/zeptoâ€,
          â€œ<em>â€: â€œsrc/underscoreâ€,
          â€œBâ€: â€œsrc/backboneâ€,
          â€œTestâ€: â€œsrc/Testâ€
        },
        â€œwebâ€: {
          â€œincludeâ€: [
            â€œ$â€,
            â€œ</em>â€,
            â€œBâ€,
            â€œTestâ€
          ],
          â€œoutâ€: â€œdest/libs.jsâ€
        }
      }
    }
  }
}</p>

<p>è¿™é‡Œæˆ‘ä»¬è¦æ‰“åŒ…è¿™äº›æ–‡ä»¶æåˆ°destçš„libs.jsæ–‡ä»¶ä¸­ï¼Œè¿™ä¸ªæ–‡ä»¶ç…§åšå°±è¡Œï¼Œæœ€åæ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š</p>

<p>module.exports = function (grunt) {
  grunt.loadNpmTasks(â€˜grunt-contrib-requirejsâ€™);
  //ä¸ºäº†ä»‹ç»è‡ªå®šä¹‰ä»»åŠ¡æäº†ä¸€ä¸ªè¿™ä¸ª
  grunt.registerTask(â€˜buildâ€™, â€˜require demoâ€™, function () {
    //ä»»åŠ¡åˆ—è¡¨
    var tasks = [â€˜requirejsâ€™];
    //æºç æ–‡ä»¶
    var srcDir = â€˜srcâ€™;
    //ç›®æ ‡æ–‡ä»¶
    var destDir = â€˜destâ€™;
    //è®¾ç½®å‚æ•°
    grunt.config.set(â€˜configâ€™, {
      srcDir: srcDir,
      destDir: destDir
    });
    //è®¾ç½®requireJsçš„ä¿¡æ¯
    var taskCfg = grunt.file.readJSON(â€˜gruntCfg.jsonâ€™);
    var options = taskCfg.requirejs.main.options,
        platformCfg = options.web,
        includes = platformCfg.include,
        paths = options.paths;
    var pos = -1;
    var requireTask = taskCfg.requirejs;
    options.path = paths;
    options.out = platformCfg.out;
    options.include = includes;
    //è¿è¡Œä»»åŠ¡
    grunt.task.run(tasks);
    grunt.config.set(â€œrequirejsâ€, requireTask);
  });
}</p>

<p>æå®Œäº†è¿è¡Œå°±å¥½ï¼šgrunt build
1 HTMLæ–‡ä»¶æ‰“åŒ…
2 æ ·å¼æ–‡ä»¶æ‰“åŒ…
3 ç§»åŠ¨æ‰“åŒ…æ–‡ä»¶</p>
:ET