I"ë	<!-- more -->
<p>å‚è€ƒæ–‡æ¡£ï¼š
https://spark.apache.org/docs/latest/structured-streaming-kafka-integration.html</p>

<p>Reading Data from Kafka
Creating a Kafka Source for Streaming Queries
Scala
Java
Python
// Subscribe to 1 topic
val df = spark
  .readStream
  .format(â€œkafkaâ€)
  .option(â€œkafka.bootstrap.serversâ€, â€œhost1:port1,host2:port2â€)
  .option(â€œsubscribeâ€, â€œtopic1â€)
  .load()
df.selectExpr(â€œCAST(key AS STRING)â€, â€œCAST(value AS STRING)â€)
  .as[(String, String)]</p>

<p>// Subscribe to multiple topics
val df = spark
  .readStream
  .format(â€œkafkaâ€)
  .option(â€œkafka.bootstrap.serversâ€, â€œhost1:port1,host2:port2â€)
  .option(â€œsubscribeâ€, â€œtopic1,topic2â€)
  .load()
df.selectExpr(â€œCAST(key AS STRING)â€, â€œCAST(value AS STRING)â€)
  .as[(String, String)]</p>

<p>// Subscribe to a pattern
val df = spark
  .readStream
  .format(â€œkafkaâ€)
  .option(â€œkafka.bootstrap.serversâ€, â€œhost1:port1,host2:port2â€)
  .option(â€œsubscribePatternâ€, â€œtopic.*â€)
  .load()
df.selectExpr(â€œCAST(key AS STRING)â€, â€œCAST(value AS STRING)â€)
  .as[(String, String)]</p>

<p>Writing Data to Kafka</p>

<p>Creating a Kafka Sink for Streaming Queries
Scala
Java
Python
// Write key-value data from a DataFrame to a specific Kafka topic specified in an option
val ds = df
  .selectExpr(â€œCAST(key AS STRING)â€, â€œCAST(value AS STRING)â€)
  .writeStream
  .format(â€œkafkaâ€)
  .option(â€œkafka.bootstrap.serversâ€, â€œhost1:port1,host2:port2â€)
  .option(â€œtopicâ€, â€œtopic1â€)
  .start()</p>

<p>// Write key-value data from a DataFrame to Kafka using a topic specified in the data
val ds = df
  .selectExpr(â€œtopicâ€, â€œCAST(key AS STRING)â€, â€œCAST(value AS STRING)â€)
  .writeStream
  .format(â€œkafkaâ€)
  .option(â€œkafka.bootstrap.serversâ€, â€œhost1:port1,host2:port2â€)
  .start()
Writing the output of Batch Queries to Kafka
Scala
Java
Python
// Write key-value data from a DataFrame to a specific Kafka topic specified in an option
df.selectExpr(â€œCAST(key AS STRING)â€, â€œCAST(value AS STRING)â€)
  .write
  .format(â€œkafkaâ€)
  .option(â€œkafka.bootstrap.serversâ€, â€œhost1:port1,host2:port2â€)
  .option(â€œtopicâ€, â€œtopic1â€)
  .save()</p>

<p>// Write key-value data from a DataFrame to Kafka using a topic specified in the data
df.selectExpr(â€œtopicâ€, â€œCAST(key AS STRING)â€, â€œCAST(value AS STRING)â€)
  .write
  .format(â€œkafkaâ€)
  .option(â€œkafka.bootstrap.serversâ€, â€œhost1:port1,host2:port2â€)
  .save()</p>
:ET