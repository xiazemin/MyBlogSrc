I"Ç<p>https://github.com/phan/phan
https://www.fzb.me/2017-7-18-static-analysis-in-php.html
Phanå€¾å‘äºé¿å…å‡é˜³æ€§ï¼Œè¯•å›¾è¯æ˜ä¸æ­£ç¡®æ€§ï¼Œè€Œä¸æ˜¯æ­£ç¡®æ€§ã€‚</p>

<p>php7æ¨å‡ºäº†è¯­æ³•æ ‘(php-ast extension)ï¼Œäºæ˜¯é™æ€è¯­æ³•åˆ†ææ›´ä¸ºæ–¹ä¾¿ã€‚</p>

<p>å¯ä»¥æ•è·åŸºæœ¬çš„é”™è¯¯
$a = [1,2,3];
if(count($a &gt; 1)) {
    echo â€œTestâ€;
}
% phan test.php
test.php:2 PhanTypeComparisonFromArray array to int comparison
æ£€æŸ¥phpdocæ³¨é‡Š
class C {
    /** @var int $prop */
    public $prop;</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/**
 * @param string $arg
 * @return int
 */
function test($arg) {
    $this-&gt;prop = $arg;
    return $arg;
} } % phan test.php test.php:10 PhanTypeMismatchProperty Assigning string to property but \C::prop is int test.php:11 PhanTypeMismatchReturn Returning type string but test() is declared to return int é‡æ„æ—§ä»£ç  class C {
/**
 * @deprecated
 */
static function legacy_function() { } }
</code></pre></div></div>

<p>C::legacy_function();
% phan test.php
test.php:8 PhanDeprecatedFunction Call to deprecated function \C::legacy_function() defined at test.php:5
ç±»å‹å®‰å…¨
å£°æ˜ä¸ºä¸¥æ ¼ç±»å‹æ—¶ï¼Œé”™è¯¯å°†ä»¥å¼‚å¸¸å½¢å¼æŠ›å‡º</p>

<p>&lt;?php declare(strict_types=1);
 class Data {
     function __construct(array $data) {
         $this-&gt;haystack = $data;
     }
     function find(string $needle):bool {
         return in_array($needle, $this-&gt;haystack, true);
     }
 }
 $storage = new Data([â€˜appleâ€™,â€™orangeâ€™,â€™bananaâ€™]);</p>

<p>$fruit = false;
 $storage-&gt;find($fruit);
Fatal error: Uncaught TypeError: Argument 1 passed to Data::find() must be of the type string, boolean given,
                                 called in test.php on line 13 and defined in test.php:6
Stack trace:
#0 test.php(13): Data-&gt;find(false)
#1 {main}
thrown in test.php on line 6
ä¸­é—´æ­¥éª¤
ä¸ºäº†é¿å…ç±»ä¼¼é—®é¢˜ï¼Œå¯ä»¥æå‰ä½¿ç”¨Phanè·‘ä¸€è¾¹ï¼Œå°±å¯ä»¥å‘ç°æ­¤ç±»é—®é¢˜ã€‚</p>

<p>class Data {
    /** @var array $haystack */
    public $haystack;</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/**
 * @param array $data
 */
function __construct($data) {
    $this-&gt;haystack = $data;
}
/**
 * @param string $needle
 * @return bool
 */
function find($needle) {
    return in_array($needle, $this-&gt;haystack, true);
} } $storage = new Data(['apple','orange','banana']);
</code></pre></div></div>

<p>$fruit = false;
$storage-&gt;find($fruit);
$ phan test.php
test.php:22 PhanTypeMismatchArgument Argument 1 (needle) is bool but \Data::find() takes string defined at test.php:15
æ„Ÿè§‰æœ‰äº†é™æ€åˆ†æï¼Œåœ¨å†™è¿‡ä¸€éä»£ç ä¹‹åï¼Œç›´æ¥ç”¨phanè·‘ä¸€è¾¹ï¼Œå°±èƒ½å…ˆåˆ¨é™¤æ‰ä¸€éƒ¨åˆ†å¼‚å¸¸æˆ–è€…bugã€‚</p>

<!-- more -->

<p>https://github.com/phan/phan
https://github.com/nikic/php-ast</p>

<p>https://www.laruence.com/2015/12/04/3086.html</p>

<p>https://segmentfault.com/a/1190000018631994</p>
:ET