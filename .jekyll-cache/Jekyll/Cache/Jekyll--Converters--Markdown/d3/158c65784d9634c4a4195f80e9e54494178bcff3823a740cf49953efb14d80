I"µ$<p>https://github.com/linuxkit/linuxkit</p>

<p>LinuxKit, a toolkit for building custom minimal, immutable Linux distributions.</p>

<p>On MacOS there is a brew tap available. Detailed instructions are at linuxkit/homebrew-linuxkit, the short summary is</p>

<p>brew tap linuxkit/linuxkit
brew install â€“HEAD linuxkit</p>

<p>linuxkitè¿™ä¸ªå·¥å…·å¯ä»¥ç†è§£ä¸ºæ˜¯ç”¨å¤šä¸ªdockeré•œåƒæ¥ç»„æˆä¸€ä¸ªæœ€å°åŒ–ã€å®šåˆ¶åŒ–çš„æ“ä½œç³»ç»Ÿï¼Œå®šåˆ¶åŒ–åçš„ç³»ç»Ÿåªæœ‰å‡ åMï¼Œé…åˆopenstackç­‰äº‘ç«¯ç”¨ä¼šå¾ˆçˆ½ã€‚
<!-- more --></p>
<ol>
  <li>å®‰è£…moby</li>
  <li>åˆ›å»ºlinuxkitæ–‡ä»¶
è¿™ä¸ªæ–‡ä»¶é‡ŒæŒ‡å®šäº†è¦ç»„åˆæˆä»€ä¹ˆæ ·çš„ç³»ç»Ÿï¼Œkernelã€initã€ onbootã€ servicesã€ filesè¿™ä¸ªé¡ºåºæ˜¯ä¸èƒ½å˜çš„
```
    <h1 id="cat-linuxkitoneyml">cat linuxkitone.yml</h1>
  </li>
</ol>

<p>kernel:</p>

<p>p_w_picpath: â€œmobylinux/kernel:4.9.xâ€                 # å†…æ ¸é•œåƒ</p>

<p>cmdline: â€œconsole=ttyS0 console=tty0 page_poison=1â€ # å†…æ ¸å‘½ä»¤ï¼Œå¯ä»¥ä¸æŒ‡å®š</p>

<p>init:  # åˆå§‹è¿›ç¨‹ï¼Œå¯åŠ¨ç³»ç»Ÿå’Œä¸€äº›åå°å®¹å™¨ã€é…ç½®åŸºç¡€æ–‡ä»¶ç³»ç»ŸæŒ‚è½½ç­‰ã€‚</p>

<ul>
  <li>
    <p>linuxkit/init:42fe8cb1508b3afed39eb89821906e3cc7a70551</p>
  </li>
  <li>
    <p>mobylinux/runc:b0fb122e10dbb7e4e45115177a61a3f8d68c19a9</p>
  </li>
  <li>
    <p>linuxkit/containerd:60e2486a74c665ba4df57e561729aec20758daed</p>
  </li>
  <li>
    <p>mobylinux/ca-certificates:eabc5a6e59f05aa91529d80e9a595b85b046f935</p>
  </li>
</ul>

<p>onboot:  # ç³»ç»ŸæœåŠ¡</p>

<ul>
  <li>
    <p>name: sysctl</p>

    <p>p_w_picpath: â€œmobylinux/sysctl:2cf2f9d5b4d314ba1bfc22b2fe931924af666d8câ€</p>

    <p>net: host</p>

    <p>pid: host</p>

    <p>ipc: host</p>

    <p>capabilities:</p>

    <ul>
      <li>CAP_SYS_ADMIN</li>
    </ul>

    <p>readonly: true</p>
  </li>
  <li>
    <p>name: binfmt</p>

    <p>p_w_picpath: â€œlinuxkit/binfmt:8881283ac627be1542811bd25c85e7782aebc692â€</p>

    <p>binds:</p>

    <ul>
      <li>/proc/sys/fs/binfmt_misc:/binfmt_misc</li>
    </ul>

    <p>readonly: true</p>
  </li>
  <li>
    <p>name: dhcpcd</p>

    <p>p_w_picpath: â€œlinuxkit/dhcpcd:48e249ebef6a521eed886b3bce032db69fbb4afaâ€</p>

    <p>binds:</p>

    <ul>
      <li>
        <p>/var:/var</p>
      </li>
      <li>
        <p>/tmp/etc:/etc</p>
      </li>
    </ul>

    <p>capabilities:</p>

    <ul>
      <li>
        <p>CAP_NET_ADMIN</p>
      </li>
      <li>
        <p>CAP_NET_BIND_SERVICE</p>
      </li>
      <li>
        <p>CAP_NET_RAW</p>
      </li>
    </ul>

    <p>net: host</p>

    <p>command: [â€œ/sbin/dhcpcdâ€, â€œâ€“nobackgroundâ€, â€œ-fâ€, â€œ/dhcpcd.confâ€, â€œ-1â€]
```
        3. åˆ¶ä½œç³»ç»Ÿ
å°†ä¸Šé¢linuxkitå†…å®¹æ”¾åˆ°/opt/linuxkitdemo/linuxkitone.ymlé‡Œï¼Œç„¶åæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œ</p>
  </li>
</ul>

<p>cd /opt/linuxkitdemo/ &amp;&amp;  moby build linuxkitone.yml</p>

<ol>
  <li>ä½¿ç”¨é•œåƒè¿›å…¥ç³»ç»Ÿ
å¯ä»¥ä½¿ç”¨qemuå·¥å…·ï¼Œä¹Ÿå¯ä»¥å°†isoæ–‡ä»¶æ”¾åˆ°vmwareæˆ–virtualboxé‡Œå¯åŠ¨ã€‚
https://blog.51cto.com/u_10546390/1918909</li>
</ol>

<p>LinuxKit æ˜¯ä¸€å¥—å·¥å…·åŒ…ï¼Œç”¨äºä¸ºå®¹å™¨ç»„è£…æ“ä½œç³»ç»Ÿã€‚ä¸ºä¸€å·¥å…·å¥—ä»¶ï¼Œå¯ç”¨æ¥æ‰“é€ åŸºäºå®¹å™¨çš„Linuxå­ç³»ç»Ÿï¼Œè¯¥ç³»ç»Ÿå†…çš„æ‰€æœ‰æœåŠ¡éƒ½æ˜¯ç”±å®¹å™¨ç»„æˆï¼Œä¸ç®¡æ˜¯ç³»ç»Ÿå…ƒä»¶æˆ–æ˜¯åº”ç”¨ç¨‹å¼ï¼Œå› æ­¤ä¹Ÿæ–¹ä¾¿ç½®æ¢åŠç§»é™¤ã€‚ç›®çš„æ˜¯è®©Linuxå®¹å™¨åŠŸèƒ½èƒ½å¤Ÿç›¸å®¹äºæ‰€æœ‰çš„å¹³å°ï¼Œä»ç‰©è”ç½‘è£…ç½®(IoT)åˆ°ä¸»æœºç­‰ã€‚</p>

<p>LinuxKit æä¾›äº†ä¸€ç§åŸºäºå®¹å™¨çš„æ–¹æ³•æ¥ä¸ºæ¯ç§ç±»å‹çš„å®¹å™¨æ„å»ºä¸€ç§å®šåˆ¶çš„ã€ç²¾ç®€çš„ Linux å­ç³»ç»Ÿï¼Œè¿™å¯¹äºå¸Œæœ›ä¸ºä¸“é—¨çš„ç¡¬ä»¶æˆ–éƒ¨ä»¶ç»„è£…è‡ªå·±é€‰æ‹©çš„ Linux åŠŸèƒ½ç‰¹æ€§çš„ç³»ç»Ÿç»„è£…å•†æ¥è¯´å¯èƒ½å¾ˆæœ‰ç”¨ã€‚åŸºäº containerdï¼Œæ¯ä¸ª LinuxKit å­ç³»ç»Ÿéƒ½ä¼šæœ‰å„è‡ªçš„ Linux å†…æ ¸ï¼Œæ¯ä¸ªç³»ç»Ÿå®ˆæŠ¤ç¨‹åºæˆ–ç³»ç»ŸæœåŠ¡éƒ½å¾—åˆ°å„è‡ªçš„å®¹å™¨</p>

<p>LinuxKitæ˜¯Dockeræœ€æ–°å‘å¸ƒçš„ä¸€ä¸ªç”¨äºä¸ºå®¹å™¨æ„å»ºå®‰å…¨ã€ä¾¿æºã€å¯ç§»æ¤æ“ä½œç³»ç»Ÿçš„å·¥å…·åŒ…ã€‚å®ƒæ ¹æ®ç”¨æˆ·ç¼–å†™çš„yamlï¼ˆæŒ‡å®škernelå’ŒåŸºäºdocker imageçš„ä¸€äº›åˆ—æœåŠ¡ï¼‰è‡ªåŠ¨æ„å»ºä¸€ä¸ªå¸¸è§è™šæ‹ŸåŒ–å¹³å°æˆ–äº‘å¹³å°çš„è™šæ‹Ÿæœºé•œåƒï¼Œå¹¶è‡ªåŠ¨è¿è¡Œèµ·æ¥ã€‚ä¸»è¦ç‰¹æ€§åŒ…æ‹¬</p>

<p>å¢å¼ºå®‰å…¨æ€§
ç³»ç»Ÿå®‰å…¨ï¼ŒåŸºäºMirageOS unikernel
ç´§è·Ÿæœ€æ–°kernelå¹¶ç²¾ç®€ä¸å¿…è¦çš„æ¨¡å—
Immutableï¼Œåªè¯»æ ¹æ–‡ä»¶ç³»ç»Ÿï¼Œæ ¹æ–‡ä»¶ç³»ç»Ÿåªèƒ½åœ¨æ„å»ºçš„æ—¶å€™ç”Ÿæˆ
ç¤¾åŒºåˆä½œï¼Œæ¯”å¦‚Kernel Self Protection Project (KSPP)ã€Wireguardã€Landlockã€Mirageã€oKernelã€Clear Containersç­‰
æ˜“ç”¨ã€å¯æ‰©å±•
æ‰€æœ‰æœåŠ¡å‡å¯å®šåˆ¶ï¼Œä¸”ç”¨æˆ·æœåŠ¡å’Œç³»ç»ŸæœåŠ¡éƒ½æ˜¯åŸºäºdocker image
æ„å»ºè¿‡ç¨‹åŸºäºdocker
åŸºäºInfrakitæ–¹ä¾¿éƒ¨ç½²ç”Ÿæˆçš„é•œåƒ
å®‰è£…
git clone https://github.com/linuxkit/linuxkit $GOPATH/src/github.com/linuxkit/linuxkit
make &amp;&amp; make install
åŸç†
ç¼–å†™yaml
LinuxKitéœ€è¦ç¼–å†™ä¸€ä¸ªyamlæ–‡ä»¶ï¼Œæ¥é…ç½®æ‰€éœ€è¦çš„æœåŠ¡ã€‚å¯é€‰çš„é…ç½®åŒ…æ‹¬</p>

<p>kernelï¼šæŒ‡å®šå†…æ ¸é•œåƒï¼Œé•œåƒé‡Œé¢éœ€è¦åŒ…å«bzImageå’Œkernel.tar
initï¼šæŒ‡å®šæ ¹ç³»ç»Ÿçš„dockeré•œåƒï¼ˆ base init process Docker imagesï¼‰ï¼Œæ¯”å¦‚initã€runcã€containerdç­‰ã€‚åœ¨è¿è¡Œæ—¶ï¼Œè¿™äº›éƒ½æ˜¯åªè¯»çš„
onbootï¼šå¯åŠ¨è¿‡ç¨‹ä¸­æ‰§è¡Œçš„ç³»ç»ŸæœåŠ¡ï¼ŒæŒ‰é¡ºåºé€ä¸ªè¿è¡Œ
servicesï¼šåŸºäºdockeré•œåƒçš„ç³»ç»ŸæœåŠ¡ï¼Œè¿™äº›æœåŠ¡åœ¨buildçš„æ—¶å€™ä¼šç”±dockerå°†å…¶è½¬æ¢ä¸ºOCIæ ¼å¼ï¼Œä»¥ä¾¿åç»­runcæ¥å¯åŠ¨
filesï¼šæŒ‡å®šé¢å¤–çš„æ–‡ä»¶
outputsï¼šæ„å»ºå®Œæˆåçš„è¾“å‡º</p>

<p>è¿è¡Œ
LinuxKitç›®å‰æ”¯æŒåœ¨gcp/hyperkit/qemu/vmware/packet/Hyper-Vç­‰å¤šä¸ªå¹³å°ä¸Šè¿è¡Œã€‚æ¯”å¦‚ç”¨qemuçš„æ–¹å¼è¿è¡Œï¼š</p>

<p>https://www.cnblogs.com/allcloud/p/7095065.html
 Docker å‘å¸ƒäº†ä¸€ä¸ªæ–°çš„æ“ä½œç³»ç»Ÿï¼šLinuxKitã€‚è¿™å®¶å®¹å™¨å·¨å¤´å®£å¸ƒçš„æ˜¯ä¸€ä¸ªçµæ´»çš„ã€å¯æ‰©å±•çš„æ“ä½œç³»ç»Ÿï¼Œè€Œä¸ºäº†å¯ç§»æ¤æ€§ï¼Œç³»ç»ŸæœåŠ¡ä¹Ÿæ˜¯è¿è¡Œåœ¨å®¹å™¨ä¹‹ä¸­ã€‚ç”šè‡³ï¼Œä»¤äººæƒŠè®¶çš„æ˜¯ï¼Œå°±è¿ Docker è¿è¡Œæ—¶ç¯å¢ƒä¹Ÿæ˜¯è¿è¡Œåœ¨å®¹å™¨å†…</p>

<p>Alpine Linux æ˜¯ï¼ˆå¹¶ä¸æƒŠäººï¼‰åŸºäº BusyBoxï¼Œè¿™æ˜¯ä¸€å¥—è‘—åçš„æ‰“åŒ…äº† Linux å‘½ä»¤çš„é›†åˆï¼Œè®¸å¤šäººä¸ä¼šæ„è¯†åˆ°ä»–ä»¬çš„å®½å¸¦è·¯ç”±å™¨ã€æ™ºèƒ½ç”µè§†ï¼Œå½“ç„¶è¿˜æœ‰ä»–ä»¬å®¶åº­ä¸­çš„ç‰©è”ç½‘è®¾å¤‡å°±æœ‰å®ƒã€‚</p>

<p>LinuxKit æ³¨å®šä¸ä¼šä»£æ›¿ Alpineï¼Œè€Œæ˜¯ä½äºå®¹å™¨ä¸‹å±‚ï¼Œå¹¶ä½œä¸ºä¸€ä¸ªå®Œæ•´çš„æ“ä½œç³»ç»Ÿå‡ºç°ï¼Œä½ å¯ä»¥é«˜å…´åœ°å¯åŠ¨ä½ çš„è¿è¡Œæ—¶å®ˆæŠ¤ç¨‹åºï¼ˆåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ˜¯ç”Ÿæˆä½ çš„å®¹å™¨çš„Docker å®ˆæŠ¤ç¨‹åº ï¼‰ã€‚
https://www.sohu.com/a/143713954_630789</p>

<p>åœ¨linuxkitä¸Šè¿è¡Œdocker
å› ä¸ºlinuxkitè®¾ç½®ä¸ºåªè¯»ï¼Œä½ ä¸èƒ½åœ¨ä¸Šé¢åšä»»ä½•ç¼–è¾‘æˆ–è€…å†™æ–‡ä»¶çš„äº‹æƒ…ã€‚ä¸‹é¢å°†å¯åŠ¨linuxkitï¼Œåœ¨å…¶ä¸­è¿è¡Œdocker</p>

<p>https://blog.csdn.net/shenshouer/article/details/70251109</p>

<p>https://www.cnblogs.com/rongfengliang/p/9354092.html</p>

<p>https://www.docker.com/blog/introducing-linuxkit-container-os-toolkit/</p>

<p>LinuxKitå·¥ç¨‹æä¾›äº†å·¥å…·æ¥æ„å»ºæˆ‘ä»¬è‡ªå·±çš„æ“ä½œç³»ç»Ÿã€‚</p>

<p>moby é€šè¿‡ymlæ–‡ä»¶çš„æè¿°ï¼Œæ„å»ºè‡ªå®šä¹‰çš„æ“ä½œç³»ç»Ÿã€‚
linuxkit ç”¨æ¥å¸®å¿™åœ¨ä¸åŒå¹³å°å¯åŠ¨é•œåƒçš„å·¥å…·ã€‚
é¦–å…ˆå®‰è£…mobyå’Œlinuxkitå·¥å…·å’Œä¸‹è½½linuxkitä»£ç </p>

<p>go get -u github.com/linuxkit/linuxkit/src/cmd/moby
go get -u github.com/linuxkit/linuxkit/src/cmd/linuxkit
git clone https://github.com/linuxkit/linuxkit
ç„¶åå¼€å§‹ç¼–è¯‘å®šåˆ¶åŒ–çš„linuxæ“ä½œç³»ç»Ÿï¼Œæˆ‘ä»¬ä½¿ç”¨LinuxKitæä¾›çš„linuxkit.ymlæ¥è¿›è¡Œç¼–è¯‘</p>

<p>cd linuxkit
moby build linuxkit.yml
ç¼–è¯‘å®Œæˆåï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ–°å‡ºç°çš„æ–‡ä»¶ï¼Œè¿™å°±æ˜¯é€šè¿‡linuxkit.ymlç¼–è¯‘å‡ºæ¥çš„å†…æ ¸å’Œramdisk</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>linuxkit-bzImage  ç¼–è¯‘å‡ºçš„kernel
linuxkit-cmdline  å¯åŠ¨æ—¶å€™çš„grubéœ€è¦å¸¦çš„å‚æ•°ã€‚
linuxkit-efi.iso  EFIå¯åŠ¨é•œåƒ
linuxkit-initrd.img ä¸€ä¸ªramdisk
linuxkit.iso  BIOSå¯åŠ¨é•œåƒ æ¥ä¸‹æ¥å¯ä»¥é€šè¿‡linuxkitå·¥å…·æ¥å¯åŠ¨è¿™ä¸ªç³»ç»Ÿã€‚
</code></pre></div></div>

<p>linuxkit run linuxkit
linuxkit ä¼šæ ¹æ®ç³»ç»Ÿè‡ªåŠ¨é€‰æ‹©åˆé€‚çš„hypervisoræ¥å¯åŠ¨é•œåƒã€‚ ç”±äºæˆ‘åœ¨linuxä¸Šï¼Œæ‰€ä»¥å¯åŠ¨çš„æ—¶å€™ä½¿ç”¨äº†kvmæ¥å¯åŠ¨è™šæ‹Ÿæœºã€‚</p>

<p>linuxkitä½¿ç”¨åœºæ™¯
ä»å®˜æ–¹çš„æè¿°æ¥çœ‹ï¼ŒLinuxkitä¸ºæ¯ç§å®¹å™¨æä¾›äº†ä¸€ä¸ªåŸºäºå®¹å™¨çš„æ–¹æ³•ï¼Œç”Ÿæˆè½»é‡çº§Linuxå­ç³»ç»Ÿã€‚å½“ä¸ºç‰¹å®šç¡¬ä»¶æˆ–è€…æ‹¥æœ‰ç‰¹å®šåŠŸèƒ½å®šåˆ¶ç³»ç»Ÿæ—¶éå¸¸æœ‰ç”¨ã€‚æ¯ä¸ªLinuxKitå­ç³»ç»Ÿéƒ½æœ‰å…¶è‡ªå·±çš„Linuxæ ¸å¿ƒï¼Œè€Œæ¯ä¸ªç³»ç»Ÿå®ˆæŠ¤è¿›ç¨‹æˆ–è€…ç³»ç»ŸæœåŠ¡éƒ½æ˜¯ä¸€ä¸ªå®¹å™¨ã€‚è¿™äº›Linuxå­ç³»ç»Ÿä¸€æ—¦è¢«æ‰“åŒ…æˆISOé•œåƒï¼Œå°±å¯ä»¥ç”¨æ¥å¯åŠ¨ç‰©ç†æœºæˆ–è€…è™šæ‹Ÿç¯å¢ƒã€‚Dockerä»¥æä¾›çš„æœåŠ¡æ–¹å¼ç»´æŠ¤è¿™äº›å­ç³»ç»Ÿã€‚</p>

<p>è¿™é‡Œå…¶å®å¯ä»¥çœ‹åˆ°Linuxkitè§£å†³äº†dockerä¸€ç›´ä»¥æ¥çš„é—®é¢˜å®¹å™¨å’Œhostå…±äº«å†…æ ¸ï¼Œä»¥è‡³äºæœ‰äº›åº”ç”¨ä¸èƒ½å¤Ÿå¾ˆå¥½çš„åœ¨dockerä¸Šä½¿ç”¨çš„é—®é¢˜ã€‚ linuxkitå…·æœ‰çš„ç‰¹ç‚¹ï¼š</p>

<p>Linuxkitä½œä¸ºä¸€ä¸ªæ“ä½œç³»ç»Ÿï¼Œæœ¬èº«å¯ä»¥åœ¨ç‰©ç†æœºæˆ–è€…è™šæ‹Ÿæœºä¸Šå¯åŠ¨ã€‚
linuxkitæ˜¯åªè¯»æ–‡ä»¶ç³»ç»Ÿï¼Œå¹¶ä¸”ç›¸å½“è½»é‡çº§åªæœ‰60Må·¦å³ï¼Œå¯ä»¥è¢«åº”ç”¨åœ¨æ— ç›˜å¯åŠ¨ç³»ç»Ÿä¸­ã€‚
linuxkitçš„ç†å¿µåŒdockerç†å¿µä¸€è„‰ç›¸æ‰¿ã€‚ä¸åŒçš„é•œåƒå¯¹åº”ä¸åŒçš„åº”ç”¨ï¼Œçµæ´»ï¼Œè½»é‡ï¼Œæ— çŠ¶æ€ã€‚
å¯ä»¥é¢„è§åˆ°ï¼Œå¯ä»¥ç›´æ¥åœ¨è£¸æœºä¸Šé€šè¿‡pxeæ¥å¯åŠ¨å¯¹åº”çš„linuxkité•œåƒï¼Œæˆ–è€…ä½¿ç”¨è™šæ‹Ÿæœºå¿«é€Ÿå¯åŠ¨linuxkité•œåƒï¼Œç”¨æˆ·å·²ç»æ— éœ€å†é¢„å…ˆæ­å»ºdockerå¹³å°æ¥å¯åŠ¨å®¹å™¨ã€‚å¯ä»¥è¯´linuxkitç»™å®¹å™¨åŒ–å¸¦æ¥äº†æ›´å¹¿é˜”çš„å‰æ™¯ã€‚</p>

<p>http://ssdxiao.github.io/linux/2017/04/25/Docker-LinuxKit.html</p>

<p>https://www.huaweicloud.com/articles/6f7b29ca6f921db5d163a8dd0cdef2b8.html</p>

:ET