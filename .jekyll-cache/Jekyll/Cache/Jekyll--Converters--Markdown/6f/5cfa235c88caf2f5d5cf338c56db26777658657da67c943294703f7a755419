I"˜q<p>GODEBUG å˜é‡å¯ä»¥æ§åˆ¶è¿è¡Œæ—¶å†…çš„è°ƒè¯•å˜é‡ï¼Œå‚æ•°ä»¥é€—å·åˆ†éš”ï¼Œæ ¼å¼ä¸ºï¼šname=valã€‚
https://github.com/mailgun/godebug æ˜¯ä¸€ä¸ªè·¨å¹³å°çš„è°ƒè¯•åŒ… 
godebugæ˜¯ä¸€ä¸ªè·¨å¹³å°çš„Goç¨‹åºè°ƒè¯•å·¥å…·ï¼Œä¼ ç»Ÿçš„ç¼–è¯‘å‹è¯­è¨€è°ƒè¯•å™¨ä½¿ç”¨åº•å±‚ç³»ç»Ÿè°ƒç”¨å¹¶è¯»å–äºŒè¿›åˆ¶æ–‡ä»¶ç”¨äºè°ƒè¯•å„ç±»ç¬¦å·ã€‚ä½¿ç”¨èµ·æ¥å¾ˆéº»çƒ¦è€Œä¸”å¾ˆéš¾ç§»æ¤ã€‚</p>

<p>godebugä½¿ç”¨ä¸åŒçš„æ–¹æ³•ï¼Œç›´æ¥æŠŠæºç ä½œä¸ºç›®æ ‡ç¨‹åºï¼Œåœ¨æ¯ä¸€è¡Œæ’å…¥è°ƒè¯•ä»£ç ï¼Œç„¶åç¼–è¯‘å¹¶è¿è¡Œã€‚ç»“æœå°±æ˜¯ä¸€ä¸ªå…¨åŠŸèƒ½çš„è°ƒè¯•å™¨ï¼Œå®Œå…¨å¯ä»¥ç§»æ¤åˆ°ä¸åŒå¹³å°ã€‚äº‹å®ä¸Šï¼Œç”±äºæœ‰äº†gopherjs ï¼Œä½ ä¹Ÿå¯ä»¥åœ¨æµè§ˆå™¨ä¸Šè¿›è¡Œè°ƒè¯•ï¼š
ç¬¬ä¸€æ¬¡godebugæ’å…¥è°ƒè¯•instrumentationï¼Œç„¶ågopherjså°†ç»“æœç¼–è¯‘æˆJavaScriptã€‚</p>

<p>è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹instrumentationæ­¥éª¤ï¼Œä»¥ä¸‹æ˜¯godebugæ’å…¥çš„è°ƒç”¨ï¼š</p>

<p>godebug.EnterFuncï¼šè®©godebugè¿è¡Œæ—¶åº“çŸ¥é“æˆ‘ä»¬åœ¨è¿›å…¥ä¸€ä¸ªå‡½æ•°ã€‚ç”±äºâ€œnextâ€ä¸åœæ­¢å†…éƒ¨å‡½æ•°è°ƒç”¨ï¼Œè¿è¡Œæ—¶åº“æ³¨æ„è¿™äº›è°ƒç”¨å¹¶çŸ¥é“ä½•æ—¶è·³è¿‡è¿™äº›è¡Œã€‚
godebug.ExitFuncï¼šè®©godebugè¿è¡Œæ—¶åº“çŸ¥é“æˆ‘ä»¬åœ¨ç¦»å¼€ä¸€ä¸ªå‡½æ•°ï¼Œmainä¸­çœç•¥ã€‚
godebugè¿è¡Œæ—¶åº“ï¼šå½“ä¸”ä»…å½“ç”¨æˆ·ç”¨å‘½ä»¤æˆ–ä¸€ä¸ªæ–­ç‚¹å‘ŠçŸ¥å…¶æ—¶ï¼Œä½¿ç¨‹åºæš‚åœå¹¶ç­‰å¾…è¾“å…¥ï¼Œæš‚åœæ—¶ï¼Œå®ƒä¼šæç¤ºç”¨æˆ·è¾“å…¥å¹¶å“åº”ä»»ä½•å‘½ä»¤ã€‚
godebug.Declareï¼šè®°å½•å˜é‡åå’Œå€¼çš„æ˜ å°„ã€‚è¯¥æ˜ å°„é€šè¿‡è¾“å‡ºå‘½ä»¤ä½¿ç”¨ã€‚
<!-- more -->
è®© Go æ›´å¼ºå¤§çš„åŸå› ä¹‹ä¸€è«è¿‡äºå®ƒçš„ GODEBUG å·¥å…·ï¼ŒGODEBUG çš„è®¾ç½®å¯ä»¥è®© Go ç¨‹åºåœ¨è¿è¡Œæ—¶è¾“å‡ºè°ƒè¯•ä¿¡æ¯ï¼Œå¯ä»¥æ ¹æ®ä½ çš„è¦æ±‚å¾ˆç›´è§‚çš„çœ‹åˆ°ä½ æƒ³è¦çš„è°ƒåº¦å™¨æˆ–åƒåœ¾å›æ”¶ç­‰è¯¦ç»†ä¿¡æ¯ï¼Œå¹¶ä¸”è¿˜ä¸éœ€è¦åŠ è£…å…¶å®ƒçš„æ’ä»¶ï¼Œéå¸¸æ–¹ä¾¿ï¼Œä»Šå¤©æˆ‘ä»¬å°†å…ˆè®²è§£ GODEBUG çš„è°ƒåº¦å™¨ç›¸å…³å†…å®¹ï¼Œå¸Œæœ›å¯¹ä½ æœ‰æ‰€å¸®åŠ©ã€‚</p>

<p>ä¸è¿‡åœ¨å¼€å§‹å‰ï¼Œæ²¡æ¥è§¦è¿‡çš„å°ä¼™ä¼´å¾—å…ˆè¡¥è¡¥å¦‚ä¸‹å‰ç½®çŸ¥è¯†ï¼Œä¾¿äºæ›´å¥½çš„äº†è§£è°ƒè¯•å™¨è¾“å‡ºçš„ä¿¡æ¯å†…å®¹ã€‚</p>

<p>å‰ç½®çŸ¥è¯†
Go scheduler çš„ä¸»è¦åŠŸèƒ½æ˜¯é’ˆå¯¹åœ¨å¤„ç†å™¨ä¸Šè¿è¡Œçš„ OS çº¿ç¨‹åˆ†å‘å¯è¿è¡Œçš„ Goroutineï¼Œè€Œæˆ‘ä»¬ä¸€æåˆ°è°ƒåº¦å™¨ï¼Œå°±ç¦»ä¸å¼€ä¸‰ä¸ªç»å¸¸è¢«æåˆ°çš„ç¼©å†™ï¼Œåˆ†åˆ«æ˜¯ï¼š</p>

<p>Gï¼šGoroutineï¼Œå®é™…ä¸Šæˆ‘ä»¬æ¯æ¬¡è°ƒç”¨ go func å°±æ˜¯ç”Ÿæˆäº†ä¸€ä¸ª Gã€‚</p>

<p>Pï¼šå¤„ç†å™¨ï¼Œä¸€èˆ¬ä¸ºå¤„ç†å™¨çš„æ ¸æ•°ï¼Œå¯ä»¥é€šè¿‡ GOMAXPROCS è¿›è¡Œä¿®æ”¹ã€‚</p>

<p>Mï¼šOS çº¿ç¨‹</p>

<p>è¿™ä¸‰è€…äº¤äº’å®é™…æ¥æºäº Go çš„ M: N è°ƒåº¦æ¨¡å‹ï¼Œä¹Ÿå°±æ˜¯ M å¿…é¡»ä¸ P è¿›è¡Œç»‘å®šï¼Œç„¶åä¸æ–­åœ°åœ¨ M ä¸Šå¾ªç¯å¯»æ‰¾å¯è¿è¡Œçš„ G æ¥æ‰§è¡Œç›¸åº”çš„ä»»åŠ¡ï¼Œå¦‚æœæƒ³å…·ä½“äº†è§£å¯ä»¥è¯¦ç»†é˜…è¯» ã€ŠGo Runtime Schedulerã€‹
å½“æˆ‘ä»¬æ‰§è¡Œ go func() æ—¶ï¼Œå®é™…ä¸Šå°±æ˜¯åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„ Goroutineï¼Œæˆ‘ä»¬ç§°å®ƒä¸º Gã€‚</p>

<p>æ–°åˆ›å»ºçš„ G ä¼šè¢«æ”¾å…¥ P çš„æœ¬åœ°é˜Ÿåˆ—ï¼ˆLocal Queueï¼‰æˆ–å…¨å±€é˜Ÿåˆ—ï¼ˆGlobal Queueï¼‰ä¸­ï¼Œå‡†å¤‡ä¸‹ä¸€æ­¥çš„åŠ¨ä½œã€‚</p>

<p>å”¤é†’æˆ–åˆ›å»º M ä»¥ä¾¿æ‰§è¡Œ Gã€‚</p>

<p>ä¸æ–­åœ°è¿›è¡Œäº‹ä»¶å¾ªç¯</p>

<p>å¯»æ‰¾åœ¨å¯ç”¨çŠ¶æ€ä¸‹çš„ G è¿›è¡Œæ‰§è¡Œä»»åŠ¡</p>

<p>æ¸…é™¤åï¼Œé‡æ–°è¿›å…¥äº‹ä»¶å¾ªç¯</p>

<p>è€Œåœ¨æè¿°ä¸­æœ‰æåˆ°å…¨å±€å’Œæœ¬åœ°è¿™ä¸¤ç±»é˜Ÿåˆ—ï¼Œå…¶å®åœ¨åŠŸèƒ½ä¸Šæ¥è®²éƒ½æ˜¯ç”¨äºå­˜æ”¾æ­£åœ¨ç­‰å¾…è¿è¡Œçš„ Gï¼Œä½†æ˜¯ä¸åŒç‚¹åœ¨äºï¼Œæœ¬åœ°é˜Ÿåˆ—æœ‰æ•°é‡é™åˆ¶ï¼Œä¸å…è®¸è¶…è¿‡ 256 ä¸ªã€‚å¹¶ä¸”åœ¨æ–°å»º G æ—¶ï¼Œä¼šä¼˜å…ˆé€‰æ‹© P çš„æœ¬åœ°é˜Ÿåˆ—ï¼Œå¦‚æœæœ¬åœ°é˜Ÿåˆ—æ»¡äº†ï¼Œåˆ™å°† P çš„æœ¬åœ°é˜Ÿåˆ—çš„ä¸€åŠçš„ G ç§»åŠ¨åˆ°å…¨å±€é˜Ÿåˆ—ï¼Œè¿™å…¶å®å¯ä»¥ç†è§£ä¸ºè°ƒåº¦èµ„æºçš„å…±äº«å’Œå†å¹³è¡¡ã€‚</p>

<p>å¦å¤–æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å›¾ä¸Šæœ‰ steal è¡Œä¸ºï¼Œè¿™æ˜¯ç”¨æ¥åšä»€ä¹ˆçš„å‘¢ï¼Œæˆ‘ä»¬éƒ½çŸ¥é“å½“ä½ åˆ›å»ºæ–°çš„ G æˆ–è€… G å˜æˆå¯è¿è¡ŒçŠ¶æ€æ—¶ï¼Œå®ƒä¼šè¢«æ¨é€åŠ å…¥åˆ°å½“å‰ P çš„æœ¬åœ°é˜Ÿåˆ—ä¸­ã€‚ä½†å…¶å®å½“ P æ‰§è¡Œ G å®Œæ¯•åï¼Œå®ƒä¹Ÿä¼š â€œå¹²æ´»â€ï¼Œå®ƒä¼šå°†å…¶ä»æœ¬åœ°é˜Ÿåˆ—ä¸­å¼¹å‡º Gï¼ŒåŒæ—¶ä¼šæ£€æŸ¥å½“å‰æœ¬åœ°é˜Ÿåˆ—æ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœä¸ºç©ºä¼šéšæœºçš„ä»å…¶ä»– P çš„æœ¬åœ°é˜Ÿåˆ—ä¸­å°è¯•çªƒå–ä¸€åŠå¯è¿è¡Œçš„ G åˆ°è‡ªå·±çš„åä¸‹ã€‚</p>

<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒP2 åœ¨æœ¬åœ°é˜Ÿåˆ—ä¸­æ‰¾ä¸åˆ°å¯ä»¥è¿è¡Œçš„ Gï¼Œå®ƒä¼šæ‰§è¡Œ work-stealing è°ƒåº¦ç®—æ³•ï¼Œéšæœºé€‰æ‹©å…¶å®ƒçš„å¤„ç†å™¨ P1ï¼Œå¹¶ä» P1 çš„æœ¬åœ°é˜Ÿåˆ—ä¸­çªƒå–äº†ä¸‰ä¸ª G åˆ°å®ƒè‡ªå·±çš„æœ¬åœ°é˜Ÿåˆ—ä¸­å»ã€‚è‡³æ­¤ï¼ŒP1ã€P2 éƒ½æ‹¥æœ‰äº†å¯è¿è¡Œçš„ Gï¼ŒP1 å¤šä½™çš„ G ä¹Ÿä¸ä¼šè¢«æµªè´¹ï¼Œè°ƒåº¦èµ„æºå°†ä¼šæ›´åŠ å¹³å‡çš„åœ¨å¤šä¸ªå¤„ç†å™¨ä¸­æµè½¬ã€‚</p>

<p>GODEBUG
GODEBUG å˜é‡å¯ä»¥æ§åˆ¶è¿è¡Œæ—¶å†…çš„è°ƒè¯•å˜é‡ï¼Œå‚æ•°ä»¥é€—å·åˆ†éš”ï¼Œæ ¼å¼ä¸ºï¼šname=valã€‚æœ¬æ–‡ç€é‡ç‚¹åœ¨è°ƒåº¦å™¨è§‚å¯Ÿä¸Šï¼Œå°†ä¼šä½¿ç”¨å¦‚ä¸‹ä¸¤ä¸ªå‚æ•°ï¼š</p>

<p>schedtraceï¼šè®¾ç½® schedtrace=X å‚æ•°å¯ä»¥ä½¿è¿è¡Œæ—¶åœ¨æ¯ X æ¯«ç§’å‘å‡ºä¸€è¡Œè°ƒåº¦å™¨çš„æ‘˜è¦ä¿¡æ¯åˆ°æ ‡å‡† err è¾“å‡ºä¸­ã€‚</p>

<p>scheddetailï¼šè®¾ç½® schedtrace=X å’Œ scheddetail=1 å¯ä»¥ä½¿è¿è¡Œæ—¶åœ¨æ¯ X æ¯«ç§’å‘å‡ºä¸€æ¬¡è¯¦ç»†çš„å¤šè¡Œä¿¡æ¯ï¼Œä¿¡æ¯å†…å®¹ä¸»è¦åŒ…æ‹¬è°ƒåº¦ç¨‹åºã€å¤„ç†å™¨ã€OS çº¿ç¨‹ å’Œ Goroutine çš„çŠ¶æ€ã€‚
package main</p>

<p>import â€œsyncâ€</p>

<p>func main() {
	wg := sync.WaitGroup{}
	wg.Add(10)
	for i := 0; i&lt;10; i++{
		go func(wg *sync.WaitGroup) {
			var counter int
			for i := 0; i &lt; 1e10; i++{
				counter++
			}
			wg.Done()
		}(&amp;wg)
	}</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>wg.Wait() }
</code></pre></div></div>

<p>schedtrace
$ GODEBUG=schedtrace=1000 ./awesomeProject
SCHED 0ms: gomaxprocs=4 idleprocs=1 threads=5 spinningthreads=1 idlethreads=0 runqueue=0 [0 0 0 0]
SCHED 1000ms: gomaxprocs=4 idleprocs=0 threads=5 spinningthreads=0 idlethreads=0 runqueue=0 [1 2 2 1]
SCHED 2000ms: gomaxprocs=4 idleprocs=0 threads=5 spinningthreads=0 idlethreads=0 runqueue=0 [1 2 2 1]
SCHED 3001ms: gomaxprocs=4 idleprocs=0 threads=5 spinningthreads=0 idlethreads=0 runqueue=0 [1 2 2 1]
SCHED 4010ms: gomaxprocs=4 idleprocs=0 threads=5 spinningthreads=0 idlethreads=0 runqueue=0 [1 2 2 1]
SCHED 5011ms: gomaxprocs=4 idleprocs=0 threads=5 spinningthreads=0 idlethreads=0 runqueue=0 [1 2 2 1]
SCHED 6012ms: gomaxprocs=4 idleprocs=0 threads=5 spinningthreads=0 idlethreads=0 runqueue=0 [1 2 2 1]
SCHED 7021ms: gomaxprocs=4 idleprocs=0 threads=5 spinningthreads=0 idlethreads=0 runqueue=4 [0 1 1 0]
SCHED 8023ms: gomaxprocs=4 idleprocs=0 threads=5 spinningthreads=0 idlethreads=0 runqueue=4 [0 1 1 0]
SCHED 9031ms: gomaxprocs=4 idleprocs=0 threads=5 spinningthreads=0 idlethreads=0 runqueue=4 [0 1 1 0]
SCHED 10033ms: gomaxprocs=4 idleprocs=0 threads=5 spinningthreads=0 idlethreads=0 runqueue=4 [0 1 1 0]
SCHED 11038ms: gomaxprocs=4 idleprocs=0 threads=5 spinningthreads=0 idlethreads=0 runqueue=4 [0 1 1 0]
SCHED 12044ms: gomaxprocs=4 idleprocs=0 threads=5 spinningthreads=0 idlethreads=0 runqueue=4 [0 1 1 0]
SCHED 13051ms: gomaxprocs=4 idleprocs=0 threads=5 spinningthreads=0 idlethreads=0 runqueue=4 [0 1 1 0]
SCHED 14052ms: gomaxprocs=4 idleprocs=2 threads=5</p>

<p>schedï¼šæ¯ä¸€è¡Œéƒ½ä»£è¡¨è°ƒåº¦å™¨çš„è°ƒè¯•ä¿¡æ¯ï¼Œåé¢æç¤ºçš„æ¯«ç§’æ•°è¡¨ç¤ºå¯åŠ¨åˆ°ç°åœ¨çš„è¿è¡Œæ—¶é—´ï¼Œè¾“å‡ºçš„æ—¶é—´é—´éš”å— schedtrace çš„å€¼å½±å“ã€‚</p>

<p>gomaxprocsï¼šå½“å‰çš„ CPU æ ¸å¿ƒæ•°ï¼ˆGOMAXPROCS çš„å½“å‰å€¼ï¼‰ã€‚</p>

<p>idleprocsï¼šç©ºé—²çš„å¤„ç†å™¨æ•°é‡ï¼Œåé¢çš„æ•°å­—è¡¨ç¤ºå½“å‰çš„ç©ºé—²æ•°é‡ã€‚</p>

<p>threadsï¼šOS çº¿ç¨‹æ•°é‡ï¼Œåé¢çš„æ•°å­—è¡¨ç¤ºå½“å‰æ­£åœ¨è¿è¡Œçš„çº¿ç¨‹æ•°é‡ã€‚</p>

<p>spinningthreadsï¼šè‡ªæ—‹çŠ¶æ€çš„ OS çº¿ç¨‹æ•°é‡ã€‚</p>

<p>idlethreadsï¼šç©ºé—²çš„çº¿ç¨‹æ•°é‡ã€‚</p>

<p>runqueueï¼šå…¨å±€é˜Ÿåˆ—ä¸­ä¸­çš„ Goroutine æ•°é‡ï¼Œè€Œåé¢çš„ [0 0 1 1] åˆ™åˆ†åˆ«ä»£è¡¨è¿™ 4 ä¸ª P çš„æœ¬åœ°é˜Ÿåˆ—æ­£åœ¨è¿è¡Œçš„ Goroutine æ•°é‡ã€‚</p>

<p>åœ¨ä¸Šé¢æˆ‘ä»¬æœ‰æåˆ° â€œè‡ªæ—‹çº¿ç¨‹â€ è¿™ä¸ªæ¦‚å¿µï¼Œå¦‚æœä½ ä¹‹å‰æ²¡æœ‰äº†è§£è¿‡ç›¸å…³æ¦‚å¿µï¼Œä¸€å¬ â€œè‡ªæ—‹â€ è‚¯å®šä¼šæ¯”è¾ƒæ‡µï¼Œæˆ‘ä»¬å¼•ç”¨ ã€ŠHead First of Golang Schedulerã€‹ çš„å†…å®¹æ¥è¯´æ˜ï¼š</p>

<p>è‡ªæ—‹çº¿ç¨‹çš„è¿™ä¸ªè¯´æ³•ï¼Œæ˜¯å› ä¸º Go Scheduler çš„è®¾è®¡è€…åœ¨è€ƒè™‘äº† â€œOS çš„èµ„æºåˆ©ç”¨ç‡â€ ä»¥åŠ â€œé¢‘ç¹çš„çº¿ç¨‹æŠ¢å ç»™ OS å¸¦æ¥çš„è´Ÿè½½â€ ä¹‹åï¼Œæå‡ºäº† â€œSpinning Threadâ€ çš„æ¦‚å¿µã€‚ä¹Ÿå°±æ˜¯å½“ â€œè‡ªæ—‹çº¿ç¨‹â€ æ²¡æœ‰æ‰¾åˆ°å¯ä¾›å…¶è°ƒåº¦æ‰§è¡Œçš„ Goroutine æ—¶ï¼Œå¹¶ä¸ä¼šé”€æ¯è¯¥çº¿ç¨‹ ï¼Œè€Œæ˜¯é‡‡å– â€œè‡ªæ—‹â€ çš„æ“ä½œä¿å­˜äº†ä¸‹æ¥ã€‚è™½ç„¶çœ‹èµ·æ¥è¿™æ˜¯æµªè´¹äº†ä¸€äº›èµ„æºï¼Œä½†æ˜¯è€ƒè™‘ä¸€ä¸‹ syscall çš„æƒ…æ™¯å°±å¯ä»¥çŸ¥é“ï¼Œæ¯”èµ· â€œè‡ªæ—‹â€ï¼Œçº¿ç¨‹é—´é¢‘ç¹çš„æŠ¢å ä»¥åŠé¢‘ç¹çš„åˆ›å»ºå’Œé”€æ¯æ“ä½œå¯èƒ½å¸¦æ¥çš„å±å®³ä¼šæ›´å¤§ã€‚</p>

<p>scheddetail
å¦‚æœæˆ‘ä»¬æƒ³è¦æ›´è¯¦ç»†çš„çœ‹åˆ°è°ƒåº¦å™¨çš„å®Œæ•´ä¿¡æ¯æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å¢åŠ  scheddetail å‚æ•°ï¼Œå°±èƒ½å¤Ÿæ›´è¿›ä¸€æ­¥çš„æŸ¥çœ‹è°ƒåº¦çš„ç»†èŠ‚é€»è¾‘ï¼Œå¦‚ä¸‹ï¼š
$ GODEBUG=scheddetail=1,schedtrace=1000 ./awesomeProject
SCHED 1000ms: gomaxprocs=4 idleprocs=0 threads=5 spinningthreads=0 idlethreads=0 runqueue=0 gcwaiting=0 nmidlelocked=0 stopwait=0 sysmonwait=0
  P0: status=1 schedtick=2 syscalltick=0 m=3 runqsize=3 gfreecnt=0
  P1: status=1 schedtick=2 syscalltick=0 m=4 runqsize=1 gfreecnt=0
  P2: status=1 schedtick=2 syscalltick=0 m=0 runqsize=1 gfreecnt=0
  P3: status=1 schedtick=1 syscalltick=0 m=2 runqsize=1 gfreecnt=0
  M4: p=1 curg=18 mallocing=0 throwing=0 preemptoff= locks=0 dying=0 spinning=false blocked=false lockedg=-1
  M3: p=0 curg=22 mallocing=0 throwing=0 preemptoff= locks=0 dying=0 spinning=false blocked=false lockedg=-1
  M2: p=3 curg=24 mallocing=0 throwing=0 preemptoff= locks=0 dying=0 spinning=false blocked=false lockedg=-1
  M1: p=-1 curg=-1 mallocing=0 throwing=0 preemptoff= locks=1 dying=0 spinning=false blocked=false lockedg=-1
  M0: p=2 curg=26 mallocing=0 throwing=0 preemptoff= locks=0 dying=0 spinning=false blocked=false lockedg=-1
  G1: status=4(semacquire) m=-1 lockedm=-1
  G2: status=4(force gc (idle)) m=-1 lockedm=-1
  G3: status=4(GC sweep wait) m=-1 lockedm=-1
  G17: status=1() m=-1 lockedm=-1
  G18: status=2() m=4 lockedm=-1
  G19: status=1() m=-1 lockedm=-1
  G20: status=1() m=-1 lockedm=-1
  G21: status=1() m=-1 lockedm=-1
  G22: status=2() m=3 lockedm=-1
  G23: status=1() m=-1 lockedm=-1
  G24: status=2() m=2 lockedm=-1
  G25: status=1() m=-1 lockedm=-1</p>

<p>åœ¨è¿™é‡Œæˆ‘ä»¬æŠ½å–äº† 1000ms æ—¶çš„è°ƒè¯•ä¿¡æ¯æ¥æŸ¥çœ‹ï¼Œä¿¡æ¯é‡æ¯”è¾ƒå¤§ï¼Œæˆ‘ä»¬å…ˆä»æ¯ä¸€ä¸ªå­—æ®µå¼€å§‹äº†è§£ã€‚å¦‚ä¸‹ï¼š</p>

<p>G
statusï¼šG çš„è¿è¡ŒçŠ¶æ€ã€‚</p>

<p>mï¼šéš¶å±å“ªä¸€ä¸ª Mã€‚</p>

<p>lockedmï¼šæ˜¯å¦æœ‰é”å®š Mã€‚</p>

<p>åœ¨ç¬¬ä¸€ç‚¹ä¸­æˆ‘ä»¬æœ‰æåˆ° G çš„è¿è¡ŒçŠ¶æ€ï¼Œè¿™å¯¹äºåˆ†æå†…éƒ¨æµè½¬éå¸¸çš„æœ‰ç”¨ï¼Œå…±æ¶‰åŠå¦‚ä¸‹ 9 ç§çŠ¶æ€ï¼š</p>

<p>çŠ¶æ€	å€¼	å«ä¹‰
_Gidle	0	åˆšåˆšè¢«åˆ†é…ï¼Œè¿˜æ²¡æœ‰è¿›è¡Œåˆå§‹åŒ–ã€‚
_Grunnable	1	å·²ç»åœ¨è¿è¡Œé˜Ÿåˆ—ä¸­ï¼Œè¿˜æ²¡æœ‰æ‰§è¡Œç”¨æˆ·ä»£ç ã€‚
_Grunning	2	ä¸åœ¨è¿è¡Œé˜Ÿåˆ—é‡Œä¸­ï¼Œå·²ç»å¯ä»¥æ‰§è¡Œç”¨æˆ·ä»£ç ï¼Œæ­¤æ—¶å·²ç»åˆ†é…äº† M å’Œ Pã€‚
_Gsyscall	3	æ­£åœ¨æ‰§è¡Œç³»ç»Ÿè°ƒç”¨ï¼Œæ­¤æ—¶åˆ†é…äº† Mã€‚
_Gwaiting	4	åœ¨è¿è¡Œæ—¶è¢«é˜»æ­¢ï¼Œæ²¡æœ‰æ‰§è¡Œç”¨æˆ·ä»£ç ï¼Œä¹Ÿä¸åœ¨è¿è¡Œé˜Ÿåˆ—ä¸­ï¼Œæ­¤æ—¶å®ƒæ­£åœ¨æŸå¤„é˜»å¡ç­‰å¾…ä¸­ã€‚
_Gmoribund_unused	5	å°šæœªä½¿ç”¨ï¼Œä½†æ˜¯åœ¨ gdb ä¸­è¿›è¡Œäº†ç¡¬ç¼–ç ã€‚
_Gdead	6	å°šæœªä½¿ç”¨ï¼Œè¿™ä¸ªçŠ¶æ€å¯èƒ½æ˜¯åˆšé€€å‡ºæˆ–æ˜¯åˆšè¢«åˆå§‹åŒ–ï¼Œæ­¤æ—¶å®ƒå¹¶æ²¡æœ‰æ‰§è¡Œç”¨æˆ·ä»£ç ï¼Œæœ‰å¯èƒ½æœ‰ä¹Ÿæœ‰å¯èƒ½æ²¡æœ‰åˆ†é…å †æ ˆã€‚
_Genqueue_unused	7	å°šæœªä½¿ç”¨ã€‚
_Gcopystack	8	æ­£åœ¨å¤åˆ¶å †æ ˆï¼Œå¹¶æ²¡æœ‰æ‰§è¡Œç”¨æˆ·ä»£ç ï¼Œä¹Ÿä¸åœ¨è¿è¡Œé˜Ÿåˆ—ä¸­ã€‚
åœ¨ç†è§£äº†å„ç±»çš„çŠ¶æ€çš„æ„æ€åï¼Œæˆ‘ä»¬ç»“åˆä¸Šè¿°æ¡ˆä¾‹çœ‹çœ‹ï¼Œå¦‚ä¸‹ï¼š</p>

<p>G1: status=4(semacquire) m=-1 lockedm=-1
G2: status=4(force gc (idle)) m=-1 lockedm=-1
G3: status=4(GC sweep wait) m=-1 lockedm=-1
G17: status=1() m=-1 lockedm=-1
G18: status=2() m=4 lockedm=-1
åœ¨è¿™ä¸ªç‰‡æ®µä¸­ï¼ŒG1 çš„è¿è¡ŒçŠ¶æ€ä¸º _Gwaitingï¼Œå¹¶æ²¡æœ‰åˆ†é… M å’Œé”å®šã€‚è¿™æ—¶å€™ä½ å¯èƒ½å¥½å¥‡åœ¨ç‰‡æ®µä¸­æ‹¬å·é‡Œçš„æ˜¯ä»€ä¹ˆä¸œè¥¿å‘¢ï¼Œå…¶å®æ˜¯å› ä¸ºè¯¥ status=4 æ˜¯è¡¨ç¤º Goroutine åœ¨è¿è¡Œæ—¶æ—¶è¢«é˜»æ­¢ï¼Œè€Œé˜»æ­¢å®ƒçš„äº‹ä»¶å°±æ˜¯ semacquire äº‹ä»¶ï¼Œæ˜¯å› ä¸º semacquire ä¼šæ£€æŸ¥ä¿¡å·é‡çš„æƒ…å†µï¼Œåœ¨åˆé€‚çš„æ—¶æœºå°±è°ƒç”¨ goparkunlock å‡½æ•°ï¼ŒæŠŠå½“å‰ Goroutine æ”¾è¿›ç­‰å¾…é˜Ÿåˆ—ï¼Œå¹¶æŠŠå®ƒè®¾ä¸º _Gwaiting çŠ¶æ€ã€‚</p>

<p>é‚£ä¹ˆåœ¨å®é™…è¿è¡Œä¸­è¿˜æœ‰ä»€ä¹ˆåŸå› ä¼šå¯¼è‡´è¿™ç§ç°è±¡å‘¢ï¼Œæˆ‘ä»¬ä¸€èµ·çœ‹çœ‹ï¼Œå¦‚ä¸‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>waitReasonZero                                    // ""
waitReasonGCAssistMarking                         // "GC assist marking"
waitReasonIOWait                                  // "IO wait"
waitReasonChanReceiveNilChan                      // "chan receive (nil chan)"
waitReasonChanSendNilChan                         // "chan send (nil chan)"
waitReasonDumpingHeap                             // "dumping heap"
waitReasonGarbageCollection                       // "garbage collection"
waitReasonGarbageCollectionScan                   // "garbage collection scan"
waitReasonPanicWait                               // "panicwait"
waitReasonSelect                                  // "select"
waitReasonSelectNoCases                           // "select (no cases)"
waitReasonGCAssistWait                            // "GC assist wait"
waitReasonGCSweepWait                             // "GC sweep wait"
waitReasonChanReceive                             // "chan receive"
waitReasonChanSend                                // "chan send"
waitReasonFinalizerWait                           // "finalizer wait"
waitReasonForceGGIdle                             // "force gc (idle)"
waitReasonSemacquire                              // "semacquire"
waitReasonSleep                                   // "sleep"
waitReasonSyncCondWait                            // "sync.Cond.Wait"
waitReasonTimerGoroutineIdle                      // "timer goroutine (idle)"
waitReasonTraceReaderBlocked                      // "trace reader (blocked)"
waitReasonWaitForGCCycle                          // "wait for GC cycle"
waitReasonGCWorkerIdle                            // "GC worker (idle)" æˆ‘ä»¬é€šè¿‡ä»¥ä¸Š waitReason å¯ä»¥äº†è§£åˆ° Goroutine ä¼šè¢«æš‚åœè¿è¡Œçš„åŸå› è¦ç´ ï¼Œä¹Ÿå°±æ˜¯ä¼šå‡ºç°åœ¨æ‹¬å·ä¸­çš„äº‹ä»¶ã€‚
</code></pre></div></div>

<p>M
pï¼šéš¶å±å“ªä¸€ä¸ª Pã€‚</p>

<p>curgï¼šå½“å‰æ­£åœ¨ä½¿ç”¨å“ªä¸ª Gã€‚</p>

<p>runqsizeï¼šè¿è¡Œé˜Ÿåˆ—ä¸­çš„ G æ•°é‡ã€‚</p>

<p>gfreecntï¼šå¯ç”¨çš„Gï¼ˆçŠ¶æ€ä¸º Gdeadï¼‰ã€‚</p>

<p>mallocingï¼šæ˜¯å¦æ­£åœ¨åˆ†é…å†…å­˜ã€‚</p>

<p>throwingï¼šæ˜¯å¦æŠ›å‡ºå¼‚å¸¸ã€‚</p>

<p>preemptoffï¼šä¸ç­‰äºç©ºå­—ç¬¦ä¸²çš„è¯ï¼Œä¿æŒ curg åœ¨è¿™ä¸ª m ä¸Šè¿è¡Œã€‚</p>

<p>P
statusï¼šP çš„è¿è¡ŒçŠ¶æ€ã€‚</p>

<p>schedtickï¼šP çš„è°ƒåº¦æ¬¡æ•°ã€‚</p>

<p>syscalltickï¼šP çš„ç³»ç»Ÿè°ƒç”¨æ¬¡æ•°ã€‚</p>

<p>mï¼šéš¶å±å“ªä¸€ä¸ª Mã€‚</p>

<p>runqsizeï¼šè¿è¡Œé˜Ÿåˆ—ä¸­çš„ G æ•°é‡ã€‚</p>

<p>gfreecntï¼šå¯ç”¨çš„Gï¼ˆçŠ¶æ€ä¸º Gdeadï¼‰ã€‚</p>

<p>çŠ¶æ€	å€¼	å«ä¹‰
_Pidle	0	åˆšåˆšè¢«åˆ†é…ï¼Œè¿˜æ²¡æœ‰è¿›è¡Œè¿›è¡Œåˆå§‹åŒ–ã€‚
_Prunning	1	å½“ M ä¸ P ç»‘å®šè°ƒç”¨ acquirep æ—¶ï¼ŒP çš„çŠ¶æ€ä¼šæ”¹å˜ä¸º _Prunningã€‚
_Psyscall	2	æ­£åœ¨æ‰§è¡Œç³»ç»Ÿè°ƒç”¨ã€‚
_Pgcstop	3	æš‚åœè¿è¡Œï¼Œæ­¤æ—¶ç³»ç»Ÿæ­£åœ¨è¿›è¡Œ GCï¼Œç›´è‡³ GC ç»“æŸåæ‰ä¼šè½¬å˜åˆ°ä¸‹ä¸€ä¸ªçŠ¶æ€é˜¶æ®µã€‚
_Pdead	4	åºŸå¼ƒï¼Œä¸å†ä½¿ç”¨ã€‚</p>

<p>å¦‚ä½•å¼€å¯æ‰“å°gcä¿¡æ¯
åªè¦åœ¨ç¨‹åºæ‰§è¡Œä¹‹å‰åŠ ä¸Šç¯å¢ƒå˜é‡GODEBUG gctrace =1 ï¼Œå¦‚ï¼š
GODEBUG gctrace =1 ./xxxx.exe or GODEBUG gctrace =1 go run main.go</p>

<p>ç¨‹åºå°†ä¼šæ˜¾ç¤ºgcä¿¡æ¯ï¼Œå¦‚ä¸‹</p>

<p>gc 1 @2.104s 0%: 0.018+1.3+0.076 ms clock, 0.054+0.35/1.0/3.0+0.23 ms cpu, 4-&gt;4-&gt;3 MB, 5 MB goal, 4 P
gc 2 @2.241s 0%: 0.019+2.4+0.077 ms clock, 0.079+0/2.4/6.4+0.30 ms cpu, 5-&gt;6-&gt;5 MB, 6 MB goal, 4 P
gc 3 @2.510s 0%: 0.011+3.2+0.063 ms clock, 0.047+0.10/2.9/9.0+0.25 ms cpu, 11-&gt;11-&gt;10 MB, 12 MB goal, 4 P
gc 4 @3.021s 0%: 0.013+6.6+0.076 ms clock, 0.053+0.34/6.2/18+0.30 ms cpu, 21-&gt;21-&gt;20 MB, 22 MB goal, 4 P
gc 5 @3.725s 0%: 0.015+15+0.079 ms clock, 0.062+0.35/15/45+0.31 ms cpu, 40-&gt;40-&gt;39 MB, 41 MB goal, 4 P
gc 6 @4.741s 0%: 0.008+35+0.17 ms clock, 0.035+0.19/35/100+0.70 ms cpu, 76-&gt;76-&gt;75 MB, 78 MB goal, 4 P
gc 7 @6.688s 0%: 0.020+117+0.34 ms clock, 0.082+11/117/330+1.3 ms cpu, 147-&gt;148-&gt;146 MB, 151 MB goal, 4 P
gc 8 @68.645s 0%: 0.019+146+0.30 ms clock, 0.078+0.006/146/407+1.2 ms cpu, 285-&gt;285-&gt;248 MB, 292 MB goal, 4 P
scvg0: inuse: 426, idle: 0, sys: 427, released: 0, consumed: 427 (MB)
gc 9 @175.448s 0%: 0.030+60+0.12 ms clock, 0.12+0.013/60/177+0.51 ms cpu, 484-&gt;484-&gt;248 MB, 496 MB goal, 4 P
gc 10 @236.621s 0%: 0.006+59+0.11 ms clock, 0.025+0/59/173+0.47 ms cpu, 484-&gt;484-&gt;248 MB, 496 MB goal, 4 P
gc 11 @285.967s 0%: 0.027+57+0.22 ms clock, 0.11+0/57/163+0.89 ms cpu, 484-&gt;484-&gt;248 MB, 496 MB goal, 4 P
scvg1: inuse: 331, idle: 175, sys: 507, released: 0, consumed: 507 (MB)
gc 12 @333.817s 0%: 0.009+52+0.18 ms clock, 0.036+0/52/155+0.72 ms cpu, 484-&gt;484-&gt;248 MB, 496 MB goal, 4 P</p>

<p>gcä¿¡æ¯çš„å«ä¹‰
æŸ¥çœ‹å®˜æ–¹çš„runtimeè¯´æ˜ï¼š</p>

<p>gctrace: setting gctrace=1 causes the garbage collector to emit a single line to standard
error at each collection, summarizing the amount of memory collected and the
length of the pause. Setting gctrace=2 emits the same summary but also
repeats each collection. The format of this line is subject to change.
Currently, it is:
	gc # @#s #%: #+#+# ms clock, #+#/#/#+# ms cpu, #-&gt;#-&gt;# MB, # MB goal, # P
where the fields are as follows:
	gc #        the GC number, incremented at each GC
	@#s         time in seconds since program start
	#%          percentage of time spent in GC since program start
	#+â€¦+#     wall-clock/CPU times for the phases of the GC
	#-&gt;#-&gt;# MB  heap size at GC start, at GC end, and live heap
	# MB goal   goal heap size
	# P         number of processors used
The phases are stop-the-world (STW) sweep termination, concurrent
mark and scan, and STW mark termination. The CPU times
for mark/scan are broken down in to assist time (GC performed in
line with allocation), background GC time, and idle GC time.
If the line ends with â€œ(forced)â€, this GC was forced by a
runtime.GC() call and all phases are STW.</p>

<p>Setting gctrace to any value &gt; 0 also causes the garbage collector
to emit a summary when memory is released back to the system.
This process of returning memory to the system is called scavenging.
The format of this summary is subject to change.
Currently it is:
	scvg#: # MB released  printed only if non-zero
	scvg#: inuse: # idle: # sys: # released: # consumed: # (MB)
where the fields are as follows:
	scvg#        the scavenge cycle number, incremented at each scavenge
	inuse: #     MB used or partially used spans
	idle: #      MB spans pending scavenging
	sys: #       MB mapped from the system
	released: #  MB released to the system
	consumed: #  MB allocated from the system
åƒåœ¾å›æ”¶ä¿¡æ¯
gc 1 @2.104s 0%: 0.018+1.3+0.076 ms clock, 0.054+0.35/1.0/3.0+0.23 ms cpu, 4-&gt;4-&gt;3 MB, 5 MB goal, 4 Pã€‚</p>

<p>1 è¡¨ç¤ºç¬¬ä¸€æ¬¡æ‰§è¡Œ
@2.104s è¡¨ç¤ºç¨‹åºæ‰§è¡Œçš„æ€»æ—¶é—´
0% åƒåœ¾å›æ”¶æ—¶é—´å ç”¨çš„ç™¾åˆ†æ¯”ï¼Œï¼ˆä¸çŸ¥é“å’Œè°æ¯”ï¼Ÿéš¾é“æ˜¯å’Œä¸Šé¢çš„ç¨‹åºæ‰§è¡Œæ€»æ—¶é—´ï¼Œè¿™æ ·æ¯”è¾ƒæ„Ÿè§‰æ²¡æ„ä¹‰ï¼‰
0.018+1.3+0.076 ms clock åƒåœ¾å›æ”¶çš„æ—¶é—´ï¼Œåˆ†åˆ«ä¸ºSTWï¼ˆstop-the-worldï¼‰æ¸…æ‰«çš„æ—¶é—´, å¹¶å‘æ ‡è®°å’Œæ‰«æçš„æ—¶é—´ï¼ŒSTWæ ‡è®°çš„æ—¶é—´
0.054+0.35/1.0/3.0+0.23 ms cpu åƒåœ¾å›æ”¶å ç”¨cpuæ—¶é—´
4-&gt;4-&gt;3 MB å †çš„å¤§å°ï¼Œgcåå †çš„å¤§å°ï¼Œå­˜æ´»å †çš„å¤§å°
5 MB goal æ•´ä½“å †çš„å¤§å°
4 P ä½¿ç”¨çš„å¤„ç†å™¨æ•°é‡</p>

<p>ç³»ç»Ÿå†…å­˜å›æ”¶ä¿¡æ¯,è¿™ä¸ªå¾ˆç›´ç™½ï¼Œçœ‹å•è¯å°±çŸ¥é“å¤§æ¦‚æ„æ€äº†
scvg0: inuse: 426, idle: 0, sys: 427, released: 0, consumed: 427 (MB)</p>

<p>426 ä½¿ç”¨å¤šå°‘Må†…å­˜
0 å‰©ä¸‹è¦æ¸…é™¤çš„å†…å­˜
427 ç³»ç»Ÿæ˜ å°„çš„å†…å­˜
0 é‡Šæ”¾çš„ç³»ç»Ÿå†…å­˜
427 ç”³è¯·çš„ç³»ç»Ÿå†…å­˜</p>

<p>golangçš„ç¯å¢ƒå˜é‡æœ‰ä¸å°‘ï¼Œå¹³æ—¶å®‰è£…å®Œgoä¹‹åï¼Œæˆ‘ä»¬å…³æ³¨çš„ä¸€èˆ¬åªæ˜¯GOPATHã€GOROOTè¿™äº›ï¼Œè¿˜æœ‰ä¸go modæœ‰å…³çš„å‡ ä¸ªç¯å¢ƒå˜é‡ï¼Œå¯¹äºå…¶ä»–å˜é‡äº†è§£ä¸å¤šï¼Œæƒ³è¦æ·±å…¥äº†è§£è¿™é—¨è¯­è¨€ï¼Œæœ‰å¿…è¦äº†è§£å…¶ä»–ç¯å¢ƒå˜é‡ã€‚</p>

<p>æˆ‘ä»¬å…ˆæ€»çš„æ¥äº†è§£ä¸‹æœ‰å“ªäº›ç¯å¢ƒå˜é‡ï¼Œä»¥åŠå®ƒä»¬ä»£è¡¨çš„å«ä¹‰ï¼š</p>

<p>$ go help environment
The go command and the tools it invokes consult environment variables
for configuration. If an environment variable is unset, the go command
uses a sensible default setting. To see the effective setting of the
variable <NAME>, run 'go env <NAME>'. To change the default setting,
run 'go env -w <NAME>=<VALUE>'. Defaults changed using 'go env -w'
are recorded in a Go environment configuration file stored in the
per-user configuration directory, as reported by os.UserConfigDir.
The location of the configuration file can be changed by setting
the environment variable GOENV, and 'go env GOENV' prints the
effective location, but 'go env -w' cannot change the default location.
See 'go help env' for details.</VALUE></NAME></NAME></NAME></p>

<p>General-purpose environment variables:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    GCCGO
            The gccgo command to run for 'go build -compiler=gccgo'.
    GOARCH
            The architecture, or processor, for which to compile code.
            Examples are amd64, 386, arm, ppc64.
    GOBIN
            The directory where 'go install' will install a command.
    GOCACHE
            The directory where the go command will store cached
            information for reuse in future builds.
    GODEBUG
            Enable various debugging facilities. See 'go doc runtime'
            for details.
    GOENV
            The location of the Go environment configuration file.
            Cannot be set using 'go env -w'.
    GOFLAGS
            A space-separated list of -flag=value settings to apply
            to go commands by default, when the given flag is known by
            the current command. Each entry must be a standalone flag.
            Because the entries are space-separated, flag values must
            not contain spaces. Flags listed on the command line
            are applied after this list and therefore override it.
    GOOS
            The operating system for which to compile code.
            Examples are linux, darwin, windows, netbsd.
    GOPATH
            For more details see: 'go help gopath'.
    GOPROXY
            URL of Go module proxy. See 'go help modules'.
    GOPRIVATE, GONOPROXY, GONOSUMDB
            Comma-separated list of glob patterns (in the syntax of Go's path.Match)
            of module path prefixes that should always be fetched directly
            or that should not be compared against the checksum database.
            See 'go help module-private'.
    GOROOT
            The root of the go tree.
    GOSUMDB
            The name of checksum database to use and optionally its public key and
            URL. See 'go help module-auth'.
    GOTMPDIR
            The directory where the go command will write
            temporary source files, packages, and binaries.
</code></pre></div></div>

<p>Environment variables for use with cgo:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    AR
            The command to use to manipulate library archives when
            building with the gccgo compiler.
            The default is 'ar'.
    CC
            The command to use to compile C code.
    CGO_ENABLED
            Whether the cgo command is supported. Either 0 or 1.
    CGO_CFLAGS
            Flags that cgo will pass to the compiler when compiling
            C code.
    CGO_CFLAGS_ALLOW
            A regular expression specifying additional flags to allow
            to appear in #cgo CFLAGS source code directives.
            Does not apply to the CGO_CFLAGS environment variable.
    CGO_CFLAGS_DISALLOW
            A regular expression specifying flags that must be disallowed
            from appearing in #cgo CFLAGS source code directives.
            Does not apply to the CGO_CFLAGS environment variable.
    CGO_CPPFLAGS, CGO_CPPFLAGS_ALLOW, CGO_CPPFLAGS_DISALLOW
            Like CGO_CFLAGS, CGO_CFLAGS_ALLOW, and CGO_CFLAGS_DISALLOW,
            but for the C preprocessor.
    CGO_CXXFLAGS, CGO_CXXFLAGS_ALLOW, CGO_CXXFLAGS_DISALLOW
            Like CGO_CFLAGS, CGO_CFLAGS_ALLOW, and CGO_CFLAGS_DISALLOW,
            but for the C++ compiler.
    CGO_FFLAGS, CGO_FFLAGS_ALLOW, CGO_FFLAGS_DISALLOW
            Like CGO_CFLAGS, CGO_CFLAGS_ALLOW, and CGO_CFLAGS_DISALLOW,
            but for the Fortran compiler.
    CGO_LDFLAGS, CGO_LDFLAGS_ALLOW, CGO_LDFLAGS_DISALLOW
            Like CGO_CFLAGS, CGO_CFLAGS_ALLOW, and CGO_CFLAGS_DISALLOW,
            but for the linker.
    CXX
            The command to use to compile C++ code.
    FC
            The command to use to compile Fortran code.
    PKG_CONFIG
            Path to pkg-config tool.
</code></pre></div></div>

<p>Architecture-specific environment variables:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    GOARM
            For GOARCH=arm, the ARM architecture for which to compile.
            Valid values are 5, 6, 7.
    GO386
            For GOARCH=386, the floating point instruction set.
            Valid values are 387, sse2.
    GOMIPS
            For GOARCH=mips{,le}, whether to use floating point instructions.
            Valid values are hardfloat (default), softfloat.
    GOMIPS64
            For GOARCH=mips64{,le}, whether to use floating point instructions.
            Valid values are hardfloat (default), softfloat.
    GOWASM
            For GOARCH=wasm, comma-separated list of experimental WebAssembly features to use.
            Valid values are satconv, signext.
</code></pre></div></div>

<p>Special-purpose environment variables:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    GCCGOTOOLDIR
            If set, where to find gccgo tools, such as cgo.
            The default is based on how gccgo was configured.
    GOROOT_FINAL
            The root of the installed Go tree, when it is
            installed in a location other than where it is built.
            File names in stack traces are rewritten from GOROOT to
            GOROOT_FINAL.
    GO_EXTLINK_ENABLED
            Whether the linker should use external linking mode
            when using -linkmode=auto with code that uses cgo.
            Set to 0 to disable external linking mode, 1 to enable it.
    GIT_ALLOW_PROTOCOL
            Defined by Git. A colon-separated list of schemes that are allowed
            to be used with git fetch/clone. If set, any scheme not explicitly
            mentioned will be considered insecure by 'go get'.
            Because the variable is defined by Git, the default value cannot
            be set using 'go env -w'.
</code></pre></div></div>

<p>Additional information available from â€˜go envâ€™ but not read from the environment:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    GOEXE
            The executable file name suffix (".exe" on Windows, "" on other systems).
    GOGCCFLAGS
            A space-separated list of arguments supplied to the CC command.
    GOHOSTARCH
            The architecture (GOARCH) of the Go toolchain binaries.
    GOHOSTOS
            The operating system (GOOS) of the Go toolchain binaries.
    GOMOD
            The absolute path to the go.mod of the main module,
            or the empty string if not using modules.
    GOTOOLDIR
            The directory where the go tools (compile, cover, doc, etc...) are installed. ä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹ä½ çš„goç¯å¢ƒå˜é‡ï¼š
</code></pre></div></div>

<p>$ go env
é™¤å¼€è·Ÿgo modæœ‰å…³çš„å‡ ä¸ªç¯å¢ƒå˜é‡è¿˜æœ‰è·ŸGOPATHæœ‰å…³çš„å‡ ä¸ªæˆ‘ä»¬ä¸è°ˆï¼Œå› ä¸ºæˆ‘å·²ç»åœ¨ä¸Šç¯‡æ–‡ç« è®²go modçš„æ—¶å€™èŠè¿‡äº†ï¼Œæ¥ä¸‹æ¥å°±æ¥äº†è§£ä¸€ä¸‹å…¶ä»–çš„ç¯å¢ƒå˜é‡ã€‚</p>

<p>GOARCH å’Œ GOOS
GOARCH ï¼šcpuæ¶æ„ï¼Œ386ã€amd64ã€armç­‰ï¼Œåœ¨äº¤å‰ç¼–è¯‘çš„æ—¶å€™è®¾ç½®ï¼Œå¯ä»¥ç¼–è¯‘ä¸åŒå¹³å°çš„åŒ…ã€‚
GOOSï¼šå¹³å°ï¼Œlinuxã€windowsç­‰ï¼Œé€šå¸¸å’ŒGOARCHæ­é…ä½¿ç”¨ã€‚
è¿™é‡Œè´´ä¸€ä¸‹åœ¨ä¸åŒå¹³å°ä¸‹äº¤å‰ç¼–è¯‘çš„å‘½ä»¤ï¼š</p>

<p>Macä¸‹ç¼–è¯‘Linux, Windowså¹³å°çš„64ä½å¯æ‰§è¡Œç¨‹åºï¼š
CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build test.go
CGO_ENABLED=0 GOOS=windows GOARCH=amd64 go build test.go</p>

<p>Linuxä¸‹ç¼–è¯‘Mac, Windowså¹³å°çš„64ä½å¯æ‰§è¡Œç¨‹åºï¼š
CGO_ENABLED=0 GOOS=darwin GOARCH=amd64 go build test.go
CGO_ENABLED=0 GOOS=windows GOARCH=amd64 go build test.go</p>

<p>Windowsä¸‹ç¼–è¯‘Mac, Linuxå¹³å°çš„64ä½å¯æ‰§è¡Œç¨‹åºï¼š
SET CGO_ENABLED=0
SET GOOS=darwin
SET GOARCH=amd64
go build test.go
SET CGO_ENABLED=0
SET GOOS=linux
SET GOARCH=amd64
go build test.go</p>

<p>GOCACHE
è¿™æ˜¯go buildäº§ç”Ÿçš„ç¼“å­˜ï¼Œè¿™å¯ä»¥åŠ å¿«ç¼–è¯‘é€Ÿåº¦ï¼Œæˆ‘åœ¨GOCACHEæ‰“å°å‡ºæ¥çš„è·¯å¾„ä¸‹çœ‹åˆ°äº†ä¸€ä¸ªREADMEæ–‡ä»¶ï¼Œå®ƒè§£é‡Šäº†GOCACHEã€‚</p>

<p>This directory holds cached build artifacts from the Go build system.
Run â€œgo clean -cacheâ€ if the directory is getting too large.
See golang.org to learn more about Go.
å¯ä»¥ä½¿ç”¨â€go clean -cacheâ€å‘½ä»¤æ¸…é™¤ç¼–è¯‘ç¼“å­˜ã€‚</p>

<p>GOENV
æœ¬åœ°çš„goç¯å¢ƒæ–‡ä»¶å­˜å‚¨ä½ç½®ï¼Œä¸å¯ä»¥ç”¨â€go env -wâ€è®¾ç½®å®ƒã€‚</p>

:ET