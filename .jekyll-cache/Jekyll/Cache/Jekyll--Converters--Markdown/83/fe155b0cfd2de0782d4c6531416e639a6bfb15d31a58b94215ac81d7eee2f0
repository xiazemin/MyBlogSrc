I"<p>https://github.com/spf13/cobra
 https://github.com/xiazemin/cobra
 Cobraæä¾›çš„åŠŸèƒ½
ç®€æ˜“çš„å­å‘½ä»¤è¡Œæ¨¡å¼ï¼Œå¦‚ app serverï¼Œ app fetchç­‰ç­‰
å®Œå…¨å…¼å®¹posixå‘½ä»¤è¡Œæ¨¡å¼
åµŒå¥—å­å‘½ä»¤subcommand
æ”¯æŒå…¨å±€ï¼Œå±€éƒ¨ï¼Œä¸²è”flags
ä½¿ç”¨Cobraå¾ˆå®¹æ˜“çš„ç”Ÿæˆåº”ç”¨ç¨‹åºå’Œå‘½ä»¤ï¼Œä½¿ç”¨cobra create appnameå’Œcobra add cmdname
å¦‚æœå‘½ä»¤è¾“å…¥é”™è¯¯ï¼Œå°†æä¾›æ™ºèƒ½å»ºè®®ï¼Œå¦‚ app srverï¼Œå°†æç¤ºsrveræ²¡æœ‰ï¼Œæ˜¯å¦æ˜¯app server
è‡ªåŠ¨ç”Ÿæˆcommandså’Œflagsçš„å¸®åŠ©ä¿¡æ¯
è‡ªåŠ¨ç”Ÿæˆè¯¦ç»†çš„helpä¿¡æ¯ï¼Œå¦‚app help
è‡ªåŠ¨è¯†åˆ«-hï¼Œâ€“helpå¸®åŠ©flag
è‡ªåŠ¨ç”Ÿæˆåº”ç”¨ç¨‹åºåœ¨bashä¸‹å‘½ä»¤è‡ªåŠ¨å®ŒæˆåŠŸèƒ½
è‡ªåŠ¨ç”Ÿæˆåº”ç”¨ç¨‹åºçš„manæ‰‹å†Œ
å‘½ä»¤è¡Œåˆ«å
è‡ªå®šä¹‰helpå’Œusageä¿¡æ¯
å¯é€‰çš„ç´§å¯†é›†æˆçš„viper apps
<!-- more -->
cobra init github.com/xiazemin/cobra/myapp
Error: required flag(s) â€œpkg-nameâ€ not set
Usage:
  cobra init [name] [flags]</p>

<p>Aliases:
  init, initialize, initialise, create</p>

<p>https://github.com/spf13/cobra/issues/901</p>

<p>Hi, I tried using the following: cobra init gitHub.com/pookah-net/test, from go/src, as specified in the README, to create a new Golang project using Cobra, and it kept telling me Error: required flag(s) â€œpkg-nameâ€ not set and giving me the help text.</p>

<p>I finally (!) figured out that cobra init â€“pkg-name gitHub.com/pookah-net/test was needed, instead. Is it supposed to be that way?</p>

<p>(Oh, it didnâ€™t create the src/github.com/pookah-net/test folder. Instead, it created src/cmd/root.go, and src/main.go and src/LICENSE files and folders!)</p>

<p>$ cobra init  â€“pkg-name github.com/xiazemin/cobra/gen
Your Cobra applicaton is ready at
/Users/didi/goLang/src/github.com/xiazemin/cobra/gen</p>

<p>$ tree
.
â”œâ”€â”€ LICENSE
â”œâ”€â”€ cmd
â”‚Â Â  â””â”€â”€ root.go
â””â”€â”€ main.go</p>

<p>ç”Ÿæˆäº†ä¸‰ä¸ªæ–‡ä»¶</p>

<p>$ cobra add serve
serve created at /Users/didi/goLang/src/github.com/xiazemin/cobra/gen</p>

<p>i$ go run main.go
A longer description that spans multiple lines and likely contains
examples and usage of using your application. For example:</p>

<p>Cobra is a CLI library for Go that empowers applications.
This application is a tool to generate the needed files
to quickly create a Cobra application.</p>

<p>Usage:
  gen [command]</p>

<p>Available Commands:
  help        Help about any command
  serve       A brief description of your command</p>

<p>Flags:
      â€“config string   config file (default is $HOME/.gen.yaml)
  -h, â€“help            help for gen
  -t, â€“toggle          Help message for toggle</p>

<p>Use â€œgen [command] â€“helpâ€ for more information about a command.</p>

<p>$ go build main.go
$ ./main serve
serve called</p>

<p>$ cobra add create -p â€˜configCmdâ€™
create created at /Users/didi/goLang/src/github.com/xiazemin/cobra/gen</p>

<p>i$ go build main.go</p>
<h1 id="githubcomxiazemincobragencmd">github.com/xiazemin/cobra/gen/cmd</h1>
<p>cmd/create.go:40:2: undefined: configCmd</p>

<p>$ cobra add -h
Add (cobra add) will create a new command, with a license and
the appropriate structure for a Cobra-based CLI application,
and register it to its parent (default rootCmd).</p>

<p>If you want your command to be public, pass in the command name
with an initial uppercase letter.</p>

<p>Example: cobra add server -&gt; resulting in a new cmd/server.go</p>

<p>Usage:
  cobra add [command name] [flags]</p>

<p>Aliases:
  add, command</p>

<p>Flags:
  -h, â€“help            help for add
  -p, â€“parent string   variable name of parent command for this command (default â€œrootCmdâ€)</p>

<p>Global Flags:
  -a, â€“author string    author name for copyright attribution (default â€œYOUR NAMEâ€)
      â€“config string    config file (default is $HOME/.cobra.yaml)
  -l, â€“license string   name of license for the project
      â€“viper            use Viper for configuration (default true)</p>

<p>-p æ˜¯æŒ‡å®šçˆ¶å‘½ä»¤çš„,çˆ¶å‘½ä»¤ä¸å­˜åœ¨,æ‰€ä»¥æŠ¥é”™äº†</p>

<p>$ cobra add create -p â€˜createCmdâ€™
create created at /Users/didi/goLang/src/github.com/xiazemin/cobra/gen</p>

<p>$ go build main.go
æˆåŠŸäº†</p>

<p>$ ./main create
panic: Command canâ€™t be a child of itself</p>

<p>goroutine 1 [running]:
github.com/spf13/cobra.(*Command).AddCommand(0x16df660, 0xc42012bf48, 0x1, 0x1)
        /Users/didi/goLang/src/github.com/spf13/cobra/command.go:1061 +0x2af
github.com/xiazemin/cobra/gen/cmd.init.0()
        /Users/didi/goLang/src/github.com/xiazemin/cobra/gen/cmd/create.go:40 +0x5e
github.com/xiazemin/cobra/gen/cmd.init()
        <autogenerated>:1 +0x5d
main.init()
        <autogenerated>:1 +0x44</autogenerated></autogenerated></p>

<p>å› ä¸ºæŒ‡å®šäº†å‘½ä»¤çš„çˆ¶å‘½ä»¤æ˜¯å®ƒæœ¬èº«,è¿è¡Œæ—¶æŠ¥é”™äº†</p>

<p>$ cobra add create -p â€˜serveCmdâ€™
create created at /Users/didi/goLang/src/github.com/xiazemin/cobra/gen</p>

<p>$ ./main create
Error: unknown command â€œcreateâ€ for â€œgenâ€
Run â€˜gen â€“helpâ€™ for usage.
unknown command â€œcreateâ€ for â€œgenâ€</p>

<p>$ ./main serve create
create called</p>

<p>ç»™å‘½ä»¤åŠ å‚æ•°
åˆ†ä¸¤ç§:
1,å…¨å±€å‚æ•°,å½“å‰å‘½ä»¤å’Œå­å‘½ä»¤å¯ç”¨
2,å±€éƒ¨å‚æ•°,å½“å‰å‘½ä»¤å¯ç”¨</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rootCmd.AddCommand(serveCmd)

// Here you will define your flags and configuration settings.

// Cobra supports Persistent Flags which will work for this command
// and all subcommands, e.g.:
// serveCmd.PersistentFlags().String("foo", "", "A help for foo")

// Cobra supports local flags which will only run when this command
// is called directly, e.g.:
// serveCmd.Flags().BoolP("toggle", "t", false, "Help message for toggle")
</code></pre></div></div>

<p>serveCmd.PersistentFlags().String(â€œfooâ€, â€œâ€, â€œA help for fooâ€)
serveCmd.Flags().BoolP(â€œtoggleâ€, â€œtâ€, false, â€œHelp message for toggleâ€)</p>

<p>$ ./main serve  â€“foo=â€abcâ€
serve called</p>

<p>$ ./main serve create â€“foo=â€abcâ€
create called</p>

<p>$ ./main serve  â€“foo=â€abcâ€ create
create called</p>

<p>$ ./main serve -t=true
serve called</p>

<p>$ ./main serve create -t=true
Error: unknown shorthand flag: â€˜tâ€™ in -t=true</p>

<p>cobra çš„å­å­™é“¾è·¯å¯ä»¥éå¸¸é•¿
$ cobra add  grandchild -p â€˜createCmdâ€™
grandchild created at /Users/didi/goLang/src/github.com/xiazemin/cobra/gen</p>

<p>$ ./main serve create grandchild â€“foo=â€abcâ€
grandchild called</p>

<p>åœ¨Runè¿™é‡Œæ¥è·å–å‚æ•°å¹¶æ‰§è¡Œæˆ‘ä»¬çš„å‘½ä»¤åŠŸèƒ½ã€‚</p>

<p>foo,err:=cmd.Flags().GetString(â€œfooâ€)
fmt.Println(foo,err)</p>

<p>$ ./main serve create grandchild â€“foo=â€abcâ€
grandchild called
abc <nil></nil></p>

<p>ç”Ÿæˆæ–‡æŒ¡
https://github.com/spf13/cobra/blob/master/doc/md_docs.md</p>

<p>ç”Ÿæˆæ–‡æ¡£
åœ¨root.goä¸­å¢åŠ 
func Get()*cobra.Command{
  return rootCmd
}
main.go ä¸­import
â€œgithub.com/spf13/cobra/docâ€</p>

<p>åœ¨mainä¸­å¢åŠ 
  err := doc.GenMarkdownTree(cmd.Get(), â€œ./â€)
  if err != nil {
    log.Fatal(err)
  }</p>

<p>$ go build main.go
../../../spf13/cobra/doc/man_docs.go:27:2: cannot find package â€œgithub.com/cpuguy83/go-md2man/md2manâ€ in any of:
        /usr/local/go/src/github.com/cpuguy83/go-md2man/md2man (from $GOROOT)
        /Users/didi/goLang/src/github.com/cpuguy83/go-md2man/md2man (from $GOPATH)
        /Users/didi/PhpstormProjects/go/src/github.com/cpuguy83/go-md2man/md2man</p>

<p>$ go get github.com/cpuguy83/go-md2man/md2man</p>

<p>$ ./main</p>

<p>ç”Ÿæˆ3ä¸ªæ–‡ä»¶
â”œâ”€â”€ gen.md
â”œâ”€â”€ gen_serve.md
â”œâ”€â”€ gen_serve_create.md
â”œâ”€â”€ gen_serve_create_grandchild.md</p>

:ET