I"õ<!-- more -->
<p>$brew install elasticsearch</p>

<p>ä½†å¯èƒ½é‡åˆ°é—®é¢˜ï¼Œæ¯”å¦‚è¦æ±‚Javaçš„ç‰ˆæœ¬æ˜¯1.8ï¼ˆæˆ‘å®‰è£…çš„Elasticsearchçš„æŒ‰æœ¬æ˜¯5.2.2ï¼‰ï¼Œè¿™é‡Œé¢å¯èƒ½æ¶‰åŠåˆ°è¿˜è¦å®‰è£…brew castç”¨æ¥å®‰è£…java8, ç„¶ååˆæç¤ºè¿˜æœ‰å…¶ä»–ä¾èµ–ï¼ˆåæ‚”æ²¡è®°å½•ä¸‹æ¥ã€‚ã€‚ã€‚ï¼‰ï¼Œè€Œéœ€è¦xcode-command-tool, æŠ˜è…¾äº†ä¸å°‘æ—¶é—´ã€‚</p>

<p>å®‰è£…å®Œæˆåï¼Œå¯ä»¥æŸ¥çœ‹elasticsearchçš„ç‰ˆæœ¬ï¼š
$elasticsearch â€“version
Java HotSpot(TM) 64-Bit Server VM warning: Cannot open file logs/gc.log due to No such file or directory</p>

<p>Version: 6.2.4, Build: ccec39f/2018-04-12T20:37:28.497551Z, JVM: 1.8.0_144</p>

<p>å¯åŠ¨å’Œåœæ­¢elasticsearchä¹Ÿå¾ˆç®€å•ï¼š</p>

<p>brew services start elasticsearch
brew services stop elasticsearch
$brew services start elasticsearch
==&gt; Successfully started <code class="language-plaintext highlighter-rouge">elasticsearch</code> (label: homebrew.mxcl.elasticsearch)</p>

<p>ä½¿ç”¨brewé‡å¯ä¼šå¯¼è‡´å½“å‰ç”¨æˆ·æ³¨é”€
æ”¹ç”¨ $elasticsearch -d å³å¯å¯åŠ¨
1.æŸ¥æ‰¾ESè¿›ç¨‹
ps -ef | grep elastic
2.æ€æ‰ESè¿›ç¨‹
kill -9 2382ï¼ˆè¿›ç¨‹å·ï¼‰</p>

<p>æµè§ˆå™¨è®¿é—®http://localhost:9200å¯ä»¥çœ‹åˆ°Elasticsearchçš„ä¿¡æ¯ï¼š
{
  â€œnameâ€ : â€œwd5Lx2câ€,
  â€œcluster_nameâ€ : â€œelasticsearch_didiâ€,
  â€œcluster_uuidâ€ : â€œjpL7o5esSX6tqg_DfzgNigâ€,
  â€œversionâ€ : {
    â€œnumberâ€ : â€œ6.2.4â€,
    â€œbuild_hashâ€ : â€œccec39fâ€,
    â€œbuild_dateâ€ : â€œ2018-04-12T20:37:28.497551Zâ€,
    â€œbuild_snapshotâ€ : false,
    â€œlucene_versionâ€ : â€œ7.2.1â€,
    â€œminimum_wire_compatibility_versionâ€ : â€œ5.6.0â€,
    â€œminimum_index_compatibility_versionâ€ : â€œ5.0.0â€
  },
  â€œtaglineâ€ : â€œYou Know, for Searchâ€
}</p>

<p>æ¥ç€å®‰è£…logstashï¼š</p>

<p>brew install logstash
å®‰è£…å¥½åæŸ¥çœ‹ç‰ˆæœ¬ï¼š
$ logstash â€“version
logstash 6.2.4
$  brew services start   logstash
==&gt; Successfully started <code class="language-plaintext highlighter-rouge">logstash</code> (label: homebrew.mxcl.logstash)</p>

<p>1.æŸ¥çœ‹kafkaå¯¹åº”çš„è¿›ç¨‹å·</p>

<table>
  <tbody>
    <tr>
      <td>ps aux</td>
      <td>grep kafka</td>
    </tr>
  </tbody>
</table>

<table>
  <tbody>
    <tr>
      <td>ps -ef</td>
      <td>grep kafka</td>
    </tr>
  </tbody>
</table>

<p>2.æŸ¥çœ‹ç«¯å£å¯¹åº”çš„è¿›ç¨‹å·</p>

<p>lsof  -i:9092</p>

<p>3.æ ¹æ®è¿›ç¨‹å·æŸ¥çœ‹å¯¹åº”çš„ä¿¡æ¯ï¼Œæ¯”å¦‚ç«¯å£å•¥çš„</p>

<table>
  <tbody>
    <tr>
      <td>netstat -anop</td>
      <td>grep PID</td>
    </tr>
  </tbody>
</table>

<p>æŸ¥çœ‹macç»ˆç«¯ç«¯å£å‘½ä»¤ netstat -AaLlnW</p>

<p>ä¸Šé¢å¤±è´¥äº†
$logstash -e â€˜input { stdin { } } output { stdout {} }â€™
æˆåŠŸäº†</p>

<p>æµè§ˆå™¨è®¿é—®http://localhost:9600å¯ä»¥çœ‹åˆ°å¦‚ä¸‹ä¿¡æ¯ï¼š</p>

<p>{â€œhostâ€:â€bogonâ€,â€versionâ€:â€6.2.4â€,â€http_addressâ€:â€127.0.0.1:9600â€,â€idâ€:â€d9a95526-d29d-40e0-8673-4b9177e437bcâ€,â€nameâ€:â€bogonâ€,â€build_dateâ€:â€2018-04-12T22:29:17Zâ€,â€build_shaâ€:â€a425a422e03087ac34ad6949f7c95ec6d27faf14â€,â€build_snapshotâ€:false}</p>

<p>Kibanaä¸éœ€è¦é€šè¿‡brewå®‰è£…ï¼Œç›´æ¥ä¸‹è½½å‹ç¼©åŒ…åï¼Œè§£å‹åæ‰§è¡Œ./kibanaå³å¯ã€‚ä¸è¿‡æˆ‘è¿˜æ˜¯åœ¨/usr/local/bin/ä¸‹åˆ›å»ºäº†kibanaå’Œkibana-pluginçš„è½¯è¿æ¥ï¼Œ elasticsearch,elasticsearch-plugin,logstashå’Œlogstash-pluginéƒ½åœ¨è¿™ä¸ªç›®å½•ä¸‹ï¼Œä»¥åå®‰è£…æ’ä»¶çš„è¯ï¼Œè¿˜éƒ½éœ€è¦ç”¨ä¸Šè¿™äº›*-plugin.</p>

<p>Kibanaå®‰è£…å®Œæˆåï¼Œéœ€è¦åœ¨config/kibana.ymlæ–‡ä»¶ä¸­ï¼Œç¡®è®¤elasticsearch.url: â€œhttp://localhost:9200â€</p>

<p>å¯åŠ¨kibana
$  bin/kibana
  log   [02:55:59.218] [info][status][plugin:kibana@6.3.0] Status changed from uninitialized to green - Ready</p>

<p>æŸ¥çœ‹ï¼šhttp://localhost:5601/
æç¤ºï¼š
Login is currently disabled. Administrators should consult the Kibana logs for more details.
æ—¥å¿—ï¼š
X-Pack plugin is not installed on the [data] Elasticsearch cluster
x-packæ˜¯elasticsearchçš„ä¸€ä¸ªæ‰©å±•åŒ…ï¼Œå°†å®‰å…¨ï¼Œè­¦å‘Šï¼Œç›‘è§†ï¼Œå›¾å½¢å’ŒæŠ¥å‘ŠåŠŸèƒ½æ†ç»‘åœ¨ä¸€ä¸ªæ˜“äºå®‰è£…çš„è½¯ä»¶åŒ…ä¸­ï¼Œè™½ç„¶x-packè¢«è®¾è®¡ä¸ºä¸€ä¸ªæ— ç¼çš„å·¥ä½œï¼Œä½†æ˜¯ä½ å¯ä»¥è½»æ¾çš„å¯ç”¨æˆ–è€…å…³é—­ä¸€äº›åŠŸèƒ½
1ã€elsaticsearch å®‰è£… x-pack
/usr/local/bin/elasticsearch-plugin install x-pack
Continue with installation? [y/N]y
ERROR: installation aborted by user</p>

<p>$sudo /usr/local/bin/elasticsearch-plugin install x-pack</p>

<p>WARNING: Improper use of the sudo command could lead to data loss
Continue with installation? [y/N]y
Elasticsearch keystore is required by plugin [x-pack-security], creatingâ€¦
-&gt; Installed x-pack with: x-pack-core,x-pack-deprecation,x-pack-graph,x-pack-logstash,x-pack-ml,x-pack-monitoring,x-pack-security,x-pack-upgrade,x-pack-watcher</p>

<p>2ã€kibana å®‰è£… x-pack
$bin/kibana-plugin install x-pack
Kibana now contains X-Pack by default, there is no longer any need to install it as it is already present.</p>

<p>æœªå®‰è£…å‰ï¼Œä½¿ç”¨elasticsearch-headã€kibanaã€å®¢æˆ·ç«¯è¿æ¥æ—¶éƒ½ä¸è¦ç”¨æˆ·å/å¯†ç éªŒè¯ã€‚è€Œå®‰è£…ä¹‹åï¼Œç»Ÿç»Ÿéœ€è¦ç”¨æˆ·å/å¯†ç éªŒè¯æ‰èƒ½è®¿é—®ã€‚</p>

<p>é»˜è®¤ç”¨æˆ·å/å¯†ç 
x-pack å®‰è£…å®Œåï¼Œæä¾›äº†å‡ ä¸ªé»˜è®¤çš„ç”¨æˆ·å/å¯†ç å¯ä»¥ä½¿ç”¨ï¼Œå¦‚ä¸‹ï¼š</p>

<p>elastic/changeme
kibana/changeme
logstash_system/changeme
elastic ç”¨æˆ·æ‹¥æœ‰å…¨éƒ¨çš„æƒé™ï¼Œæ˜¾ç„¶éœ€è¦æ›´æ”¹æ‰é»˜è®¤å¯†ç ï¼Œé€šè¿‡å¦‚ä¸‹çš„æ¥å£å¯ä»¥æ›´æ”¹å¯†ç ï¼Œç¤ºä¾‹ï¼š</p>

<p>curl -XPUT -u elastic â€˜localhost:9200/_xpack/security/user/{username}/_passwordâ€™ -H â€œContent-Type: application/jsonâ€ -d â€˜{
  â€œpasswordâ€ : â€œnewpasswordâ€
}â€™
{username} å ä½ç¬¦ä»£è¡¨éœ€è¦ä¿®æ”¹å¯†ç çš„ç”¨æˆ·ã€‚</p>

<p>head æ’ä»¶é…ç½®
ä¹‹å‰çš„è®¿é—®éƒ½æ˜¯é€šè¿‡http://127.0.0.1:9100å³å¯ï¼Œå®‰è£…x-packä¹‹åï¼Œé¦–å…ˆéœ€è¦æ›´æ”¹elasticsearch.ymlçš„é…ç½®ï¼š</p>

<p>http.cors.enabled: true
http.cors.allow-origin: â€œ*â€
http.cors.allow-headers: Authorization,Content-Type
å‰ä¸¤ä¸ªé…ç½®æ²¡ä»€ä¹ˆæ³¨æ„çš„ï¼Œå¾ˆå¤šäººéƒ½çŸ¥é“ã€‚å…³é”®æ˜¯ç¬¬ä¸‰ä¸ªï¼Œå®˜æ–¹æè¿°ä¸Šé¢ä¹Ÿåªæ˜¯è¯´äº†æ·»åŠ http.cors.allow-headers: Authorizationå³å¯</p>

<p>log   [03:14:49.412] [warning][license][xpack] License information from the X-Pack plugin could not be obtained from Elasticsearch for the [data] cluster. [invalid_index_name_exception] Invalid index name [<em>xpack], must not start with â€˜</em>â€™., with { index_uuid=â€<em>na</em>â€ &amp; index=â€<em>xpackâ€ } :: {â€œpathâ€:â€/_xpackâ€,â€statusCodeâ€:400,â€responseâ€:â€{"error":{"root_cause":[{"type":"invalid_index_name_exception","reason":"Invalid index name [_xpack], must not start with â€˜</em>â€™.","index_uuid":"<em>na</em>","index":"<em>xpack"}],"type":"invalid_index_name_exception","reason":"Invalid index name [_xpack], must not start with â€˜</em>â€™.","index_uuid":"<em>na</em>","index":"_xpack"},"status":400}â€}</p>

<p>ä¿®æ”¹kibana é…ç½®çš„ç”¨æˆ·åå¯†ç </p>

<p>vi config/kibana.yml</p>

<p>elasticsearch.username: â€œuserâ€
elasticsearch.password: â€œpassâ€</p>

<p>é…ç½®elasticsearch.yaml
xpack.security.enabled:(true/false)  æ˜¯å¦å¼€å¯å®‰å…¨éªŒè¯</p>

<p>xpack.monitoring.enabled               æ˜¯å¦å¼€å¯ç›‘æ§</p>

<p>xpack.graph.enabled                           æ˜¯å¦å¼€å¯å›¾å½¢</p>

<p>xpack.watcher.enabled               æ˜¯å¦å¼€å¯watcher ä»…ä»…esé…ç½®</p>

<p>xpack.reporting.enabled           æ˜¯å¦å¼€å¯æŠ¥è¡¨ä»…ä»…kibanaé…ç½®
$vi /usr/local/etc/elasticsearch/elasticsearch.yml
xpack.security.enabled: false
å¯ä»¥å…³é—­xpack</p>

<p>$ls -al /usr/local/bin/elasticsearch-plugin
lrwxr-xr-x  1 didi  admin  54  6 28 19:59 /usr/local/bin/elasticsearch-plugin -&gt; ../Cellar/elasticsearch/6.2.4/bin/elasticsearch-plugin</p>

<p>http://127.0.0.1:5601/app/kibana#?_g=()
<img src="https://xiazemin.github.io/MyBlog/img/kibaba.png" />
kibanaç‰ˆæœ¬è¿‡é«˜
https://www.elastic.co/guide/en/kibana/6.2/targz.html
curl -O https://artifacts.elastic.co/downloads/kibana/kibana-6.2.4-darwin-x86_64.tar.gz</p>

<p>$/Users/didi/elk/kibana-6.2.4ï¼bin/kibana
  log   [06:38:21.305] [info][listening] Server running at http://localhost:5601
  log   [06:38:21.342] [info][status][plugin:elasticsearch@6.2.4] Status changed from yellow to green - Ready</p>

<p><img src="https://xiazemin.github.io/MyBlog/img/kibana_right.png" />
è‡³æ­¤å®‰è£…å®Œæ¯•</p>

:ET