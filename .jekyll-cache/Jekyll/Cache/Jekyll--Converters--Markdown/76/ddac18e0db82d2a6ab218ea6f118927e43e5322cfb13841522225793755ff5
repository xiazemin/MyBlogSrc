I"ó%<p>https://mp.weixin.qq.com/s/sWDrVL0EsHzCDNDpGtpT-A
1</p>

<p>ä»€ä¹ˆæ˜¯æ–¹æ³•é›†</p>

<p>åœ¨goè¯­è¨€ä¸­ï¼Œæ¯ä¸ªç±»å‹éƒ½æœ‰ä¸ä¹‹å…³è”çš„æ–¹æ³•ï¼ŒæŠŠè¿™ä¸ªç±»å‹çš„æ‰€æœ‰æ–¹æ³•ç§°ä¸ºç±»å‹çš„æ–¹æ³•é›†ã€‚å¦‚ä¸‹ï¼š</p>

<p>type Student struct {
   age int8
   name string
}</p>

<p>func (s Student) showName() {
   fmt.Println(s.name)
}</p>

<p>func (s * Student) setName(newName string) {
   s.name = newName
}
ç±»å‹Studentæ–¹æ³•é›†åŒ…å«äº†showName()æ–¹æ³•ã€‚
ç±»å‹*Studentæ–¹æ³•é›†åŒ…å«äº†showName()æ–¹æ³•å’ŒsetName()æ–¹æ³•ã€‚
ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºï¼š
ç±»å‹ T æ–¹æ³•é›†ï¼ŒåŒ…å«å…¨éƒ¨ receiver T æ–¹æ³•ã€‚</p>

<p>ç±»å‹ *T æ–¹æ³•é›†ï¼ŒåŒ…å«å…¨éƒ¨ receiver T + *T æ–¹æ³•ã€‚
<!-- more -->
æ–¹æ³•é›†å’Œæ–¹æ³•æ¥å—è€…çš„å…³ç³»</p>

<p>åœ¨ä¸Šé¢çš„æ¡ˆä¾‹ä¸­ï¼Œç±»å‹Studentçš„æ–¹æ³•é›†å¹¶ä¸åŒ…å«äº†setName()æ–¹æ³•ï¼Œé‚£ä¹ˆæ˜¯ä¸æ˜¯Studentç±»å‹å˜é‡ï¼Œå°±ä¸èƒ½è°ƒç”¨setName()æ–¹æ³•å‘¢ï¼Ÿå³ä¸‹é¢è°ƒç”¨ï¼Œæ˜¯å¦ä¼šæŠ¥é”™å‘¢ï¼Ÿ</p>

<p>s := Student{}
s.setName(â€œdqâ€)
å…¶å®ï¼Œä¸Šé¢çš„è°ƒç”¨æ˜¯okçš„ã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿæˆ‘ä»¬æ¥å›é¡¾ä¸€ä¸‹goè¯­è¨€çš„æ–¹æ³•å®šä¹‰ã€‚
å‚æ•° receiver å¯ä»»æ„å‘½åï¼Œå¦‚æ–¹æ³•ä¸­ï¼Œä¸ä½¿ç”¨å‚æ•°ï¼Œå¯ä»¥çœç•¥å‚æ•°åã€‚
å‚æ•° receiver ç±»å‹å¯ä»¥æ˜¯ T æˆ– *Tï¼Œä½†ç±»å‹Tä¸èƒ½ä¸ºæ¥å£æˆ–æŒ‡é’ˆç±»å‹ã€‚
ä¸æ”¯æŒæ–¹æ³•é‡è½½ã€‚
å®ä¾‹valueæˆ–pointerå¯ä»¥è°ƒç”¨å…¨éƒ¨çš„æ–¹æ³•ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨è½¬æ¢ã€‚
å¦‚ä¸‹ï¼š</p>

<p>type Student struct {
   age int8
   name string
}
type StudentPoint *Student</p>

<p>func (Student) sayHello() {  //çœç•¥receiver çš„å‚æ•°å‚æ•°åå­—
   fmt.Println(â€œhello worldâ€)
}</p>

<p>func (s Student) showName() { 
   fmt.Println(s.name)
}</p>

<p>func (s * Student) setName(newName string) {
   s.name = newName
}</p>

<p>func (s StudentPoint) showName2(){ // Errorï¼šæ¥å—è€…(receiver)ä¸ºæŒ‡é’ˆç±»å‹
   fmt.Println(s.name)
}</p>

<p>s := Student{}
s.setName(â€œdqâ€) //goä¼šè‡ªåŠ¨è½¬ä¸º (&amp;s).setName(â€œdqâ€)</p>

<p>var s2 = &amp;s
s2.showName() //oä¼šè‡ªåŠ¨è½¬ä¸º (<em>s2).showName()
æ‰€ä»¥ï¼Œå½“ç±»å‹è°ƒç”¨è‡ªå·±ç”³æ˜çš„æ–¹æ³•çš„æ—¶å€™ï¼Œä¸éœ€è¦è€ƒè™‘æ–¹æ³•é›†ã€‚æ–¹æ³•æ¥å—è€…æ˜¯å€¼ç±»å‹ï¼ˆTï¼‰ï¼Œè¿˜æ˜¯æŒ‡é’ˆç±»å‹(</em>T)ï¼Œå½±å“Tç±»å‹çš„å®ä½“å˜é‡çš„æ–¹æ³•é›†ã€‚</p>

<p>3</p>

<p>æ–¹æ³•é›†å’Œæ¥å£</p>

<p>æ¥å£çš„å®šä¹‰</p>

<p>æ¥å£æ˜¯ä¸€ä¸ªæˆ–å¤šä¸ªæ–¹æ³•ç­¾åçš„é›†åˆã€‚ä»»ä½•ç±»å‹çš„æ–¹æ³•é›†ä¸­åªè¦æ‹¥æœ‰è¯¥æ¥å£â€œå¯¹åº”çš„å…¨éƒ¨æ–¹æ³•â€å£°åã€‚å°±è¡¨ç¤ºå®ƒ â€œå®ç°â€ äº†è¯¥æ¥å£ï¼Œæ— é¡»åœ¨è¯¥ç±»å‹ä¸Šæ˜¾å¼å£°æ˜å®ç°äº†å“ªä¸ªæ¥å£ã€‚
å¯¹åº”çš„å…¨éƒ¨æ–¹æ³•ï¼šæ˜¯æŒ‡æœ‰ç›¸åŒåç§°ã€å‚æ•°åˆ—è¡¨ (ä¸åŒ…æ‹¬å‚æ•°å) ä»¥åŠè¿”å›å€¼ã€‚
æ¥å£åªæœ‰æ–¹æ³•çš„å£°æ˜ï¼Œæ²¡æœ‰å®ç°ã€‚
æ¥å£å¯ä»¥åŒ¿ååµŒå…¥åˆ°å…¶ä»–æ¥å£ï¼Œæˆ–æ˜¯åµŒå…¥ç»“æ„ä½“ä¸­ã€‚
æ¥å£å‘½åä¹ æƒ¯ä»¥ er ç»“å°¾ã€‚
type Personer interface { //å®šä¹‰ä¸€ä¸ªæ¥å£
   showName()
}</p>

<p>type Student struct {
   Personer //åµŒå…¥æ¥å£
}
æ¥å£æ‰§è¡Œæœºåˆ¶</p>

<p>æ¥å£å¯¹è±¡ï¼Œæ˜¯ç”±æ¥å£è¡¨ï¼ˆinterface tableï¼‰å’Œæ•°æ®æŒ‡é’ˆç»„æˆã€‚
æ¥å£è¡¨å­˜å‚¨å…ƒæ•°æ®ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ¥å£ç±»å‹ã€åŠ¨æ€ç±»å‹ï¼Œä»¥åŠå®ç°æ¥å£çš„æ–¹æ³•æŒ‡é’ˆã€‚
æ•°æ®æŒ‡é’ˆæŒæœ‰çš„æ˜¯ç›®æ ‡å¯¹è±¡çš„åªè¯»å¤åˆ¶å“ï¼Œå¤åˆ¶å®Œæ•´å¯¹è±¡æˆ–æŒ‡é’ˆã€‚
package main</p>

<p>import (
   â€œfmtâ€
   â€œreflectâ€
)</p>

<p>type User struct {
   id   int
   name string
}</p>

<p>type Student struct {
   id   int
   name string
}</p>

<p>func main() {
   u := User{1, â€œTomâ€}
   var i interface{} = u // ç”±äºinterface{}ä¸åŒ…å«ä»»ä½•æ–¹æ³•ï¼Œæ‰€ä»¥ä»»ä½•ç±»å‹ï¼Œéƒ½å®ç°äº†interface{}æ¥å£
   fmt.Println(reflect.TypeOf(i)) //main.User</p>

<p>i = Student{}
   fmt.Println(reflect.TypeOf(i)) //main.Student
}
ä»¥å®ä½“ç±»å‹å’Œä»¥æŒ‡é’ˆç±»å‹å®ç°æ¥å£çš„åŒºåˆ«</p>

<p>è‹¥ä»¥å®ä½“ç±»å‹ï¼ˆTï¼‰å®ç°æ¥å£ï¼Œä¸ç®¡æ˜¯Tç±»å‹çš„å€¼ï¼Œè¿˜æ˜¯Tç±»å‹çš„æŒ‡é’ˆï¼Œéƒ½å®ç°äº†è¯¥æ¥å£ã€‚
è‹¥ä»¥æŒ‡é’ˆç±»å‹ï¼ˆ*Tï¼‰å®ç°æ¥å£ï¼Œåªæœ‰Tç±»å‹çš„æŒ‡é’ˆï¼Œæ‰å®ç°äº†è¯¥æ¥å£ã€‚
type Animal interface { //æ¥å£
   say()
}</p>

<p>type Dog struct {
   name string
}</p>

<p>type Cat struct {
   name string
}</p>

<p>func (_self Dog) say() {
   fmt.Println(â€œI amâ€, _self.name)
}</p>

<p>func (_self *Cat) say() {
   fmt.Println(â€œI amâ€, _self.name)
}</p>

<p>func main() {
   var d1 Animal= Dog{name:â€wangCai1â€}
   d1.say() //å› ä¸ºDog çš„valueç±»å‹å®ç°äº†Animalæ¥å£</p>

<p>var d2 Animal= &amp;Dog{name:â€wangCai2â€}
   d2.say() //å› ä¸ºdDog çš„æŒ‡é’ˆç±»å‹å®ç°äº†Animalæ¥å£</p>

<p>var c1 Animal= Cat{name:â€miaoMiao1â€}
   c1.say() //å› ä¸ºCat çš„valueç±»å‹æ²¡æœ‰å®ç°äº†Animalæ¥å£ï¼Œæ‰€ä»¥æŠ¥é”™</p>

<p>var c2 Animal= &amp;Cat{name:â€miaoMiao2â€}
   c2.say() //å› ä¸ºCat çš„æŒ‡é’ˆç±»å‹å®ç°äº†Animalæ¥å£
}
ç±»å‹å¿…é¡»å®ç°æ¥å£çš„æ‰€æœ‰æ–¹æ³•ï¼Œæ‰èƒ½è¡¨ç¤ºå®ƒ â€œå®ç°â€ äº†è¯¥æ¥å£ï¼Œå¦‚ä¸‹ï¼š</p>

<p>type Animal interface {
   say()
   doSome()
}</p>

<p>type Dog struct {
   name string
}
func (_self Dog) say() {
   fmt.Println(â€œI amâ€, _self.name)
}
func (_self *Dog) doSome() {
   fmt.Println(â€œI will do somethingâ€)
}</p>

<p>func main() {
   // æŠ¥é”™ï¼Œå› ä¸ºDogçš„valueç±»å‹å®ç°äº†Animalæ¥å£çš„sayæ–¹æ³•æ²¡æœ‰å®ç°doSomeæ–¹æ³•
   var d1 Animal= Dog{name:â€wangCai1â€} 
   d1.say()</p>

<p>//å› ä¸ºdDog çš„æŒ‡é’ˆç±»å‹å®ç°äº†Animalæ¥å£é›†çš„æ‰€æœ‰æ–¹æ³•
   var d2 Animal= &amp;Dog{name:â€wangCai2â€}
   d2.say() 
}</p>

<p>4</p>

<p>æ–¹æ³•é›†å’ŒåµŒå…¥</p>

<p>ä»€ä¹ˆæ˜¯åµŒå…¥</p>

<p>goè¯­è¨€ä¸­ï¼Œæ‰€è°“çš„åµŒå…¥ï¼Œå³æŠŠä¸€ä¸ªç±»å‹ä½œä¸ºå¦å¤–ä¸€ä¸ªç±»å‹çš„åŒ¿åå­—æ®µã€‚å¦‚ä¸‹ï¼š</p>

<p>type Person struct {
   age  int8
   name string
}</p>

<p>type Student struct {
   Person //åµŒäºº Persionç±»å‹
}
goè¯­è¨€é€šè¿‡åµŒå…¥ç»„åˆï¼Œæ¥å®ç°ç»§æ‰¿çš„è¡Œä¸ºã€‚äºæ˜¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡Studentç±»å‹çš„å®ä¾‹ï¼Œè®¿é—®Persionç±»å‹çš„å˜é‡å’Œæ–¹æ³•ã€‚å¦‚ä¸‹ï¼š</p>

<p>var s = Student{}
s.name = â€œdqâ€
å€¼ç±»å‹(T)åµŒå…¥å’ŒæŒ‡é’ˆç±»å‹(*T)åµŒå…¥çš„åŒºåˆ«</p>

<p>type Student1 struct {
   Person //å€¼ç±»å‹çš„åµŒå…¥
}
type Student2 struct {
   *Person //æŒ‡é’ˆç±»å‹çš„åµŒå…¥
}
è¦ç†è§£è¿™ä¸ªåŒºåˆ«ï¼Œå°±æœ‰çŸ¥é“goè¯­è¨€ä¸­ç±»å‹çš„é»˜è®¤å€¼ã€‚å¦‚ä¸‹ï¼š
æ•°å€¼ç±»å‹ï¼ˆå¦‚int8ã€int16ã€uintç­‰ï¼‰ï¼Œé»˜è®¤å€¼ä¸º0ï¼›
å¸ƒå°”ç±»å‹ï¼Œé»˜è®¤å€¼ä¸ºfalseï¼›
å­—ç¬¦ä¸²ç±»å‹ï¼Œé»˜è®¤å€¼ä¸ºâ€â€
æŒ‡é’ˆã€é€šé“ã€åˆ‡ç‰‡ã€å­—å…¸ç­‰ï¼Œé»˜è®¤å€¼ä¸ºnil
å¤åˆç±»å‹çš„é»˜è®¤å€¼ï¼Œä¸ºæ‰€åŒ…å«ç±»å‹çš„é»˜è®¤å€¼ã€‚
æ‰€ä»¥ï¼š
type Person struct {
   age  int8
   name string
}</p>

<p>func (s Person) showName() {
   fmt.Println(s.name)
}</p>

<p>func (s *Person) setName(newName string) {
   s.name = newName
}</p>

<p>type Student1 struct {
   Person //Student1åŒ…å«äº†Person,é‚£ä¹ˆStudent1å¯¹åº”çš„valueå’ŒpointeråŒ…å«Person
}</p>

<p>type Student2 struct {
   *Person
}</p>

<p>// å†…åµŒç±»å‹ Persioné»˜è®¤å€¼ä¸º Person{age:0, name:â€â€}
s1 := Student1{}
s1.setName(â€œstudent1_01â€) // ok
s1.showName()</p>

<p>// å†…åµŒç±»å‹ *Persioné»˜è®¤å€¼ä¸º nil
s2 := &amp;Student2{}
s2.setName(â€œstudent1_02â€) //Errorï¼Œç”±äºç›®å‰å†…åµŒç±»å‹çš„å€¼ä¸ºnilï¼Œä¼šè§¦å‘æŠ¥é”™
s2.showName()</p>

<p>// ç»™åµŒå…¥ç±»å‹ä¸€ä¸ªå¤åˆ¶ï¼Œå°±okäº†
s3 := &amp;Student2{Person:&amp;Person{age:3, name:â€s3â€}}
//s3 := &amp;Student2{&amp;Person{age:3, name:â€s3â€}} å’Œä¸Šä¸€è¡Œç­‰ä»·
s3.showName()
åœ¨ä¸Šé¢çš„æ¡ˆä¾‹ä¸­å˜é‡s2ä¸­åµŒå…¥ç±»å‹é»˜è®¤å€¼ä¸ºnilï¼Œæ•…ä¼šæŠ¥é”™ï¼španic: runtime error: invalid memory address or nil pointer dereference
æ‰€ä»¥ï¼Œé’ˆå¯¹æŒ‡é’ˆåµŒå…¥ç±»å‹ï¼Œåœ¨ä½¿ç”¨å‰ï¼Œéœ€è¦èµ‹å€¼ã€‚
åµŒå…¥å’Œæ–¹æ³•é›†çš„å…³ç³»</p>

<p>ç±»å‹ S åŒ…å«åŒ¿åå­—æ®µ Tï¼Œåˆ™ Så’Œ<em>S æ–¹æ³•é›†åŒ…å« T æ–¹æ³•ã€‚
ç±»å‹ S åŒ…å«åŒ¿åå­—æ®µ *Tï¼Œåˆ™ Så’Œ *S æ–¹æ³•é›†åŒ…å« T + *T æ–¹æ³•ã€‚
ä¸ç®¡åµŒå…¥çš„æ˜¯Tè¿˜æ˜¯</em>Tï¼Œ*Sæ–¹æ³•é›†ï¼ŒåŒ…å« T + *T æ–¹æ³•ã€‚
ä¸‹é¢ï¼Œé€šè¿‡æ¡ˆä¾‹æ¥è§£æï¼Œå¦‚ä¸‹ï¼Œæ€è€ƒStudent1çš„æŒ‡é’ˆå’Œå®ä¾‹ç±»å‹ï¼Œä»¥åŠStudent2çš„æŒ‡é’ˆå’Œå®ä¾‹ç±»å‹ï¼Œæ˜¯å¦å®ç°äº†Humanæ¥å£å‘¢ï¼Ÿ
type Human interface { //å®šä¹‰æ¥å£
   showName()
   setName(string)
}</p>

<p>type Person struct { 
   age  int8
   name string
}
func (s Person) showName() { // Personç±»å‹çš„å®ä¾‹å’ŒæŒ‡é’ˆï¼Œéƒ½å®ç°äº†Humançš„showNameæ–¹æ³•
   fmt.Println(s.name)
}
func (s *Person) setName(newName string) { // åªæœ‰Personç±»å‹çš„æŒ‡é’ˆï¼Œæ‰å®ç°äº†Humançš„setNanmeæ–¹æ³•
   s.name = newName
}</p>

<p>type Student1 struct { // ä»¥å€¼ç±»å‹ï¼ŒåµŒå…¥
   Person
}</p>

<p>type Student2 struct {  // ä»¥æŒ‡é’ˆç±»å‹ï¼ŒåµŒå…¥
   <em>Person
}
è§£æï¼š
åº”ç”¨ä¸Šé¢è§„åˆ™1ï¼Œç”±äºStudent1é€šè¿‡å®ä½“ç±»å‹(T)æ–¹å¼ï¼ŒåµŒå…¥Personï¼Œæ‰€ä»¥ Stuednt1çš„å®ä¾‹ç±»å‹ï¼Œä»…ä»…åŒ…å«äº†æ¥å—è€…ä¸ºPersonçš„æ–¹æ³•ï¼Œå³ä¸åŒ…å«setName()æ–¹æ³•ï¼Œæ‰€ä»¥Student1çš„å®ä¾‹ç±»å‹ï¼Œæ²¡æœ‰å®ç°Humanæ¥å£ï¼Œä¸èƒ½èµ‹å€¼ç»™Humanæ¥å£ï¼›åº”ç”¨ä¸Šé¢è§„åˆ™3ï¼Œ Stuednt1çš„æŒ‡é’ˆç±»å‹ï¼ŒåŒ…å«äº†æ¥å—è€…ä¸ºPersonå’Œæ¥å—è€…ä¸º</em>Personçš„æ–¹æ³•ï¼Œå³Stuednt1çš„æŒ‡é’ˆç±»å‹ï¼Œå®ç°äº†Humanæ¥å£ã€‚
åº”ç”¨ä¸Šé¢è§„åˆ™2ï¼Œç”±äºStudent2é€šè¿‡æŒ‡é’ˆç±»å‹(*T)æ–¹å¼ï¼ŒåµŒå…¥Personï¼Œæ‰€ä»¥Student2çš„æŒ‡é’ˆç±»å‹å’Œå®ä¾‹ç±»å‹ï¼Œéƒ½å®ç°äº†Humanæ¥å£ã€‚
æ‰€ä»¥ï¼š
// Error åº”ç”¨ä¸Šé¢çš„å…³ç³»åˆ¤æ–­ç¬¬1æ¡è§„åˆ™ï¼Œå› ä¸ºStudent1å®ä¾‹ç±»å‹çš„æ–¹æ³•é›†ä¸­ï¼Œä»…ä»…åŒ…å«Personçš„å®ä¾‹æ–¹æ³•é›†ï¼Œå³ä»…ä»…åŒ…å«showName()æ–¹æ³•ï¼Œæ‰€ä»¥Student1çš„å®ä¾‹ç±»å‹ï¼Œæ²¡æœ‰å®ç°Humanæ¥å£
var s1 Human = Student1{} //æŠ¥é”™:Student1 does not implement Human (setName method has pointer receiver)
s1.setName(â€œstudent1_01â€)
s1.showName()</p>

<p>var s2 Human = &amp;Student1{} //ok åº”ç”¨ç¬¬1æ¡å’Œå¼Ÿ3æ¡è§„åˆ™
s2.setName(â€œstudent1_02â€)
s2.showName()</p>

<p>var s3 Human = Student2{&amp;Person{}} //ok ï¼Œåº”ç”¨ç¬¬2æ¡è§„åˆ™
s3.setName(â€œstudent2_01â€)
s3.showName()</p>

<p>var s4 Human = &amp;Student2{&amp;Person{}} //ok ï¼Œåº”ç”¨ç¬¬2æ¡è§„åˆ™
s4.setName(â€œstudent2_02â€)
s4.showName()</p>
:ET