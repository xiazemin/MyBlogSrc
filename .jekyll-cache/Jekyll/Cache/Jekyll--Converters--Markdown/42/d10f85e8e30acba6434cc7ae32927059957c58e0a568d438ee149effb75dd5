I"Û<p>go-mysql-serveræ˜¯ä¸€ä¸ªgolang çš„mysql server åè®®å®ç°åŒ…ï¼Œä½¿ç”¨æ­¤å·¥å…·æˆ‘ä»¬å¯ä»¥ç”¨æ¥åšå¥½å¤šæ–¹ä¾¿çš„ä¸œè¥¿</p>

<p>åŸºäºmysql åè®®æš´éœ²è‡ªå·±çš„æœ¬åœ°æ–‡ä»¶ä¸ºsql æŸ¥è¯¢
åŸºäºmysql åè®®çµæ´»çš„æš´éœ²rest æœåŠ¡çš„æ¥å£æŸ¥è¯¢ä¸ºsql
åŸºäºmysql åè®®æ–¹ä¾¿å¯¹äºä¸€äº›æ•°æ®çš„æŸ¥è¯¢åˆ†æ
åŸºäºmysql åè®®æš´éœ²k8s èµ„æºä¸ºsql æŸ¥è¯¢ï¼ˆç±»ä¼¼fuse æ–‡ä»¶ç³»ç»Ÿï¼Ÿï¼‰
åŸºäºmysql åè®®æŸ¥è¯¢gitä»“åº“ä»£ç 
ã€‚ã€‚ã€‚
ä¸€ä¸ªç®€å•çš„demo
ä¸€ä¸ªgolang ç‰ˆçš„ç®€å•mysql server</p>

<p>é¡¹ç›®åˆå§‹åŒ–ï¼ˆgo mod ï¼‰
go mod init github.com/rongfengliang/my-mysqlserver
main.go
package main</p>

<p>import (
 â€œtimeâ€</p>

<p>â€œgopkg.in/src-d/go-mysql-server.v0â€
 â€œgopkg.in/src-d/go-mysql-server.v0/authâ€
 â€œgopkg.in/src-d/go-mysql-server.v0/memâ€
 â€œgopkg.in/src-d/go-mysql-server.v0/serverâ€
 â€œgopkg.in/src-d/go-mysql-server.v0/sqlâ€
)</p>

<p>// Example of how to implement a MySQL server based on a Engine:
//
// <code class="language-plaintext highlighter-rouge">
// &gt; mysql --host=127.0.0.1 --port=5123 -u user -ppass db -e "SELECT * FROM mytable"
// +----------+-------------------+-------------------------------+---------------------+
// | name | email | phone_numbers | created_at |
// +----------+-------------------+-------------------------------+---------------------+
// | John Doe | john@doe.com | ["555-555-555"] | 2018-04-18 09:41:13 |
// | John Doe | johnalt@doe.com | [] | 2018-04-18 09:41:13 |
// | Jane Doe | jane@doe.com | [] | 2018-04-18 09:41:13 |
// | Evil Bob | evilbob@gmail.com | ["555-666-555","666-666-666"] | 2018-04-18 09:41:13 |
// +----------+-------------------+-------------------------------+---------------------+
//</code>
func main() {
 engine := sqle.NewDefault()
 engine.AddDatabase(createTestDatabase())
 engine.AddDatabase(sql.NewInformationSchemaDatabase(engine.Catalog))</p>

<p>config := server.Config{
  Protocol: â€œtcpâ€,
  Address: â€œlocalhost:3306â€,
  Auth: auth.NewNativeSingle(â€œrootâ€, â€œâ€, auth.AllPermissions),
 }</p>

<p>s, err := server.NewDefaultServer(config, engine)
 if err != nil {
  panic(err)
 }</p>

<p>s.Start()
}</p>

<p>func createTestDatabase() *mem.Database {
 const (
  dbName = â€œmydbâ€
  tableName = â€œmytableâ€
 )</p>

<p>db := mem.NewDatabase(dbName)
 table := mem.NewTable(tableName, sql.Schema{
  {Name: â€œnameâ€, Type: sql.Text, Nullable: false, Source: tableName},
  {Name: â€œemailâ€, Type: sql.Text, Nullable: false, Source: tableName},
  {Name: â€œphone_numbersâ€, Type: sql.JSON, Nullable: false, Source: tableName},
  {Name: â€œcreated_atâ€, Type: sql.Timestamp, Nullable: false, Source: tableName},
 })</p>

<p>db.AddTable(tableName, table)
 ctx := sql.NewEmptyContext()
 table.Insert(ctx, sql.NewRow(â€œJohn Doeâ€, â€œjohn@doe.comâ€, []string{â€œ555-555-555â€}, time.Now()))
 table.Insert(ctx, sql.NewRow(â€œJohn Doeâ€, â€œjohnalt@doe.comâ€, []string{}, time.Now()))
 table.Insert(ctx, sql.NewRow(â€œJane Doeâ€, â€œjane@doe.comâ€, []string{}, time.Now()))
 table.Insert(ctx, sql.NewRow(â€œEvil Bobâ€, â€œevilbob@gmail.comâ€, []string{â€œ555-666-555â€, â€œ666-666-666â€}, time.Now()))
 return db
}
æ·»åŠ ä¾èµ–
go mod tidy
æ„å»º
go build my-server
è¿è¡Œ
./my-server
è¿æ¥æŸ¥è¯¢
mysql -uroot -h127.0.0.1
æ•ˆæœ</p>

<p>select * from mytable;
+â€”â€”â€”-+â€”â€”â€”â€”â€”â€”-+â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-+â€”â€”â€”â€”â€”â€”â€”+
| name | email | phone_numbers | created_at |
+â€”â€”â€”-+â€”â€”â€”â€”â€”â€”-+â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-+â€”â€”â€”â€”â€”â€”â€”+
| John Doe | john@doe.com | [â€œ555-555-555â€] | 2019-05-18 10:56:31 |
| John Doe | johnalt@doe.com | [] | 2019-05-18 10:56:31 |
| Jane Doe | jane@doe.com | [] | 2019-05-18 10:56:31 |
| Evil Bob | evilbob@gmail.com | [â€œ555-666-555â€,â€666-666-666â€] | 2019-05-18 10:56:31 |
è¯´æ˜
go-mysql-server å·²ç»åŒ…å¥½äº†å¥½å¤šå†…ç½®çš„sql å‡½ï¼ŒåŒæ—¶æˆ‘ä»¬ä¹Ÿå¯ä»¥è‡ªå·±æä¸€äº›æ‰©å±•å¼€å‘ï¼Œä¸€ä¸ªå¾ˆå¼ºå¤§çš„å·¥å…·</p>

<p>å‚è€ƒèµ„æ–™
https://github.com/src-d/go-mysql-server</p>

<p>https://www.cnblogs.com/rongfengliang/p/10886794.html
<!-- more -->
https://github.com/melbahja/got</p>

<p>https://github.com/src-d/go-mysql-server</p>

<p>https://www.dolthub.com/blog/2020-02-14-implementing-indexed-joins/</p>

<p>https://www.dolthub.com/blog/2020-08-05-implementing-subqueries/</p>
:ET