I"î <p>#åå°„æ“ä½œåˆ‡ç‰‡
é€šè¿‡ åå°„ ä¿®æ”¹ åˆ‡ç‰‡ çš„å€¼ï¼Œåˆ†ä¸ºä¸¤ç§æƒ…å†µï¼Œç¬¬ä¸€ç§æ˜¯æ•´ä½“ä¿®æ”¹æ•´ä¸ªåˆ‡ç‰‡çš„å€¼ï¼Œç¬¬äºŒç§æ˜¯å•ç‹¬ä¿®æ”¹åˆ‡ç‰‡çš„æŸä¸ªç´¢å¼•å¤„çš„å€¼ã€‚</p>

<p>æ•´ä½“ä¿®æ”¹åˆ‡ç‰‡çš„å€¼ï¼Œæˆ‘ä»¬ä½¿ç”¨ Set å‡½æ•°ï¼Œä¼ å…¥æ•´ä¸ªåˆ‡ç‰‡å³å¯ï¼Œä¿®æ”¹æŸä¸ªç´¢å¼•å¤„çš„å€¼ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦é€šè¿‡ Index æ‰¾åˆ°ç´¢å¼•ï¼Œç„¶åä½¿ç”¨ Set å‡½æ•°åšä¿®æ”¹ã€‚</p>

<p>åå°„ä¿®æ”¹æ•´ä¸ªåˆ‡ç‰‡
è¯­æ³•
intSliceElemValue := reflect.ValueOf(&amp;intSlice).Elem()
newVale := reflect.ValueOf(newSliceValue)
intSliceElemValue.Set(newVale)
è¯´æ˜
é¦–å…ˆï¼Œæˆ‘ä»¬ä½¿ç”¨ reflect.ValueOf ä¼ å…¥æˆ‘ä»¬è¦ä¿®æ”¹çš„åˆ‡ç‰‡çš„åœ°å€ï¼Œå¹¶ä¸”ä½¿ç”¨ Elem è·å–æŒ‡é’ˆä¿¡æ¯ï¼Œæ¥ç€ï¼Œæˆ‘ä»¬ä½¿ç”¨ reflect.ValueOf ä¼ å…¥ä¸€ä¸ªæ–°çš„åˆ‡ç‰‡ã€‚</p>

<p>æœ€åï¼Œæˆ‘ä»¬è°ƒç”¨ Set æ–¹æ³•ï¼Œä¼ å…¥æ–°çš„åˆ‡ç‰‡çš„ Value ä¿¡æ¯ï¼Œå³å¯å®ç°ä¿®æ”¹åŸæ¥çš„åˆ‡ç‰‡çš„å€¼ã€‚</p>

<p>åå°„ä¿®æ”¹åˆ‡ç‰‡ç´¢å¼•å¤„çš„å€¼
è¯­æ³•
intSliceValue := reflect.ValueOf(intSlice)
e := intSliceValue.Index(0)
e.SetInt(2560)
è¯´æ˜
é¦–å…ˆï¼Œæˆ‘ä»¬ä½¿ç”¨ reflect.ValueOf ä¼ å…¥æˆ‘ä»¬è¦ä¿®æ”¹çš„åˆ‡ç‰‡ï¼Œæ³¨æ„ï¼Œè¿™é‡Œä¼ å…¥çš„æ˜¯åˆ‡ç‰‡ï¼Œè€Œä¸æ˜¯åˆ‡ç‰‡çš„åœ°å€ï¼Œæ¥ç€ï¼Œæˆ‘ä»¬ä½¿ç”¨ Index è·å–éœ€è¦ä¿®æ”¹çš„ç´¢å¼•å¤„çš„å€¼ã€‚</p>

<p>æœ€åï¼Œæˆ‘ä»¬è°ƒç”¨ Set æ–¹æ³•ï¼Œä¼ å…¥æ–°çš„å€¼ï¼Œå³å¯å®ç°ä¿®æ”¹åˆ‡ç‰‡æŸä¸ªç´¢å¼•å¤„çš„å€¼ã€‚</p>

<p>https://haicoder.net/golang/golang-reflect-valueof.html
<!-- more -->
#Goè¯­è¨€åå°„è§£æç»“æ„ä½“
åœ¨ Golang ä¸­ï¼Œé€šè¿‡ åå°„ çš„ reflect.TypeOf() è·å¾—åå°„çš„å¯¹è±¡ä¿¡æ¯åï¼Œå¦‚æœæ˜¯ ç»“æ„ä½“ ç±»å‹ï¼Œå¯ä»¥é€šè¿‡åå°„å€¼å¯¹è±¡ï¼ˆreflect.Typeï¼‰çš„ NumField() å’Œ Field() æ–¹æ³•è·å¾—ç»“æ„ä½“æˆå‘˜çš„è¯¦ç»†ä¿¡æ¯ã€‚</p>

<p>person := Person{
		Name:â€HaiCoderâ€,
		Age:109,
	}
	personType := reflect.TypeOf(person)
	for i := 0; i &lt; personType.NumField(); i++ {
		// è·å–æ¯ä¸ªæˆå‘˜çš„ç»“æ„ä½“å­—æ®µç±»å‹
		fieldType := personType.Field(i)
		// è¾“å‡ºå­—æ®µå
		fmt.Println(â€œFiledName =â€, fieldType.Name)
}
https://haicoder.net/golang/golang-reflect-struct.html</p>

<p>#åå°„(reflect)è®¿é—®çš„ map
 slice ç´¢å¼•è¡¨è¾¾å¼æ˜¯å¯å¯»å€çš„(ä¾‹å¦‚ï¼Œ&amp;s[0] æ˜¯æœ‰æ•ˆçš„)ï¼Œå› æ­¤é€šè¿‡åå°„è·å¾—çš„ slice å…ƒç´ å°†æ˜¯å¯è®¾ç½®çš„ã€‚æ˜ å°„ç´¢å¼•è¡¨è¾¾å¼æ˜¯ è€Œä¸æ˜¯ å¯å¯»å€çš„(ä¾‹å¦‚ &amp;m[â€œaâ€] æ— æ•ˆ)ï¼Œå› æ­¤é€šè¿‡åå°„è·å¾—çš„é”®çš„å€¼å°†ä¸å¯è®¾ç½®ã€‚æŸ¥çœ‹ç›¸å…³How to update map values in Go</p>

<p>åªæœ‰å¯å¯»å€çš„å€¼æ˜¯å¯è®¾ç½®çš„ï¼Œå°è¯•â€œè®¾ç½®â€ä¸å¯å¯»å€çš„å€¼åªèƒ½ä¿®æ”¹å‰¯æœ¬(è€Œä¸æ˜¯åŸå§‹å€¼)ï¼Œå› æ­¤é¦–å…ˆä¸å…è®¸è¿™æ ·åšã€‚å¼•ç”¨ Value.CanSet()</p>

<p>å¦‚æœè¦ä½¿ç”¨åå°„æ›´æ”¹åˆ†é…ç»™æ˜ å°„ä¸­é”®çš„å€¼ï¼Œè¯·ä½¿ç”¨ Value.SetMapIndex() æ–¹æ³•:
mv.SetMapIndex(reflect.ValueOf(â€œaâ€), reflect.ValueOf(â€œ11â€))</p>

<p>https://article.docway.net/it/details/60f0fb797919366004f69814</p>

<p>golang é‡Œé¢çš„æ‰€æœ‰å‡½æ•°è°ƒç”¨éƒ½æ˜¯å€¼å¤åˆ¶ï¼Œæ‰€ä»¥è¿™é‡Œåœ¨è°ƒç”¨ reflect.ValueOf çš„æ—¶å€™ï¼Œå·²ç»å¤åˆ¶äº†ä¸€ä¸ª x ä¼ é€’è¿›å»äº†ï¼Œè¿™é‡Œè·å–åˆ°çš„ v æ˜¯ä¸€ä¸ª x å¤åˆ¶ä½“çš„ valueã€‚é‚£ä¹ˆè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å°±å¸Œæœ›çŸ¥é“æˆ‘èƒ½ä¸èƒ½é€šè¿‡ v æ¥è®¾ç½®è¿™é‡Œçš„ x å˜é‡ã€‚å°±éœ€è¦æœ‰ä¸ªæ–¹æ³•æ¥è¾…åŠ©æˆ‘ä»¬åšè¿™ä¸ªäº‹æƒ…ï¼š CanSet ()</p>

<p>è¿™ä¸ªæŒ‡é’ˆæŒ‡å‘çš„å…ƒç´ æ˜¯å¦å¯ä»¥è®¾ç½®ï¼Œæ‰€å¹¸ reflect æä¾›äº† Elem () æ–¹æ³•æ¥è·å–è¿™ä¸ª â€œæŒ‡é’ˆæŒ‡å‘çš„å…ƒç´ â€ã€‚
var x float64 = 3.4
v := reflect.ValueOf(&amp;x)
fmt.Println(v.CanSet()) // false</p>

<p>var x float64 = 3.4
v := reflect.ValueOf(&amp;x)
fmt.Println(v.Elem().CanSet()) // true</p>

<p>CanAddr
åœ¨ reflect åŒ…é‡Œé¢å¯ä»¥çœ‹åˆ°ï¼Œé™¤äº† CanSet ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ª CanAddr æ–¹æ³•ã€‚å®ƒä»¬ä¸¤ä¸ªæœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ</p>

<p>CanAddr æ–¹æ³•å’Œ CanSet æ–¹æ³•ä¸ä¸€æ ·çš„åœ°æ–¹åœ¨äºï¼šå¯¹äºä¸€äº›ç»“æ„ä½“å†…çš„ç§æœ‰å­—æ®µï¼Œæˆ‘ä»¬å¯ä»¥è·å–å®ƒçš„åœ°å€ï¼Œä½†æ˜¯ä¸èƒ½è®¾ç½®å®ƒã€‚</p>

<p>CanAddr æ˜¯ CanSet çš„å¿…è¦ä¸å……åˆ†æ¡ä»¶ã€‚ä¸€ä¸ª Value å¦‚æœ CanAddr, ä¸ä¸€å®š CanSetã€‚ä½†æ˜¯ä¸€ä¸ªå˜é‡å¦‚æœ CanSetï¼Œå®ƒä¸€å®š CanAddrã€‚</p>

<p>https://learnku.com/articles/51004</p>

<p>å½“éœ€è¦å¤„ç†å¤„ç†åŠ¨æ€æ•°æ®ç»“æ„æ—¶ï¼Œæˆ‘ä»¬æ— æ³•åœ¨ç¼–è¯‘é˜¶æ®µå°±çŸ¥é“æœªçŸ¥æ•°æ®çš„ç»“æ„ï¼Œå…¶ä¸­ä¸€ä¸ªéå¸¸ç»å…¸çš„ä½¿ç”¨æƒ…æ™¯å°±æ˜¯å¯¹Jsonä¸²çš„Marshalã€‚æ­¤æ—¶ï¼Œå°±è¯¥reflectåŒ…å‡ºåœºäº†ï¼Œå®ƒæä¾›äº†åœ¨è¿è¡Œæ—¶åˆ›å»ºã€æ›´æ–°æŸç§ç±»å‹ä»¥åŠè·å–è¯¥ç±»å‹çš„å„ç§ä¿¡æ¯çš„èƒ½åŠ›ï¼Œæœ‰äº†å®ƒï¼Œæˆ‘ä»¬ä¸ä»…èƒ½æœ‰æ•ˆå¤„ç†åŠ¨æ€æ•°æ®ç±»å‹ï¼Œè¿˜å¯ä»¥å¤§å¤§æé«˜ä»£ç çš„å¤ç”¨æ€§ã€å¯è¯»æ€§ã€‚</p>

<p>Type
åœ¨reflectåŒ…ä¸­ï¼Œæ˜¯ç”¨Typeæ¥æè¿°Goä¸­æŸä¸ªå¯¹è±¡çš„ç±»å‹ï¼Œå¹¶æä¾›äº†ä¸€ç³»åˆ—æ–¹æ³•ï¼Œæ¥è·å–ç±»å‹çš„ç›¸å…³ä¿¡æ¯ï¼Œä¸€èˆ¬é€šè¿‡è°ƒç”¨TypeOfæ¥è·å–ä¸€ä¸ªä»»æ„å˜é‡çš„ç±»å‹Type</p>

<p>Value
è€ŒValueæè¿°äº†åœ¨Goè¿è¡Œæ—¶æŸä¸ªå¯¹è±¡çš„å€¼ï¼Œæˆ‘ä»¬å¯ä»¥é’ˆå¯¹å®ƒè¿›è¡Œå¢åˆ æ”¹æŸ¥ä¹‹ç±»çš„æ“ä½œï¼Œä¸€èˆ¬é€šè¿‡ValueOfæ–¹æ³•æ¥è·å–å¯¹è±¡çš„Valueã€‚</p>

<p>åŠ¨æ€åˆå§‹åŒ–ç»“æ„ä½“
unc NewDS() *DS {
	ds := &amp;DS{}
	initStruct(ds)
	fmt.Printf(â€œFieldOne = %sâ€, ds.FieldOne)
	return ds
}</p>

<p>func initStruct(v interface{}) error {
   e := reflect.Indirect(reflect.ValueOf(v))
   if e.Kind() != reflect.Struct {
      return errors.New(â€œv must be structâ€)
   }
   et, ev := e.Type(), e
   for i := 0; i &lt; et.NumField(); i++ {
      field, val := et.Field(i), ev.Field(i)
      defaultValue, ok := field.Tag.Lookup(â€œdefaultâ€)
      if !ok {
         continue
      }
      switch field.Type.Kind() {
      case reflect.String:
         val.SetString(defaultValue)
      case reflect.Int:
         if x, err := strconv.ParseInt(defaultValue, 10, 64); err != nil {
            val.SetInt(x)
         }
      // é’ˆå¯¹ä¸åŒKindï¼Œå°†defaultValueè½¬æ¢ä¸ºå¯¹åº”ç±»å‹å¹¶èµ‹å€¼
      â€¦
      }
   }
   return nil
}</p>

<p>åŠ¨æ€åˆ›å»ºMap
é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ˜¯é€šè¿‡makeæ¥åˆ›å»ºä¸€ä¸ªmapï¼Œè€Œæœ‰äº†reflectåŒ…åï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡refletåŒ…æ¥åŠ¨æ€åœ°åˆ›å»ºä¸€ä¸ªmapã€‚
func convert(rectangle *Rectangle) (res map[string]string, err error) {
	e := reflect.Indirect(reflect.ValueOf(rectangle))
	if e.Kind() != reflect.Struct {
		return nil, errors.New(â€œv must be structâ€)
	}
	et, ev := e.Type(), e</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var mapStringType = reflect.TypeOf(make(map[string]string))
mapReflect := reflect.MakeMap(mapStringType)
for i := 0; i &lt; et.NumField(); i++ {
	field, val := et.Field(i), ev.Field(i)
	switch field.Type.Kind() {
	case reflect.String:
		mapReflect.SetMapIndex(reflect.ValueOf(field.Name), reflect.ValueOf(val.String()))
	case reflect.Float64:
		s := strconv.FormatFloat(val.Float(), 'f', 2, 64)
		mapReflect.SetMapIndex(reflect.ValueOf(field.Name), reflect.ValueOf(s))
	// other cases
	...
	}
}
return mapReflect.Interface().(map[string]string), nil }
</code></pre></div></div>

<p>https://my.oschina.net/u/4339343/blog/4268374</p>

<p>ä¸€ä¸ªå¯å–åœ°å€çš„reflect.Valueä¼šè®°å½•ä¸€ä¸ªç»“æ„ä½“æˆå‘˜æ˜¯å¦æ˜¯æœªå¯¼å‡ºæˆå‘˜ï¼Œå¦‚æœæ˜¯çš„è¯åˆ™æ‹’ç»ä¿®æ”¹æ“ä½œã€‚å› æ­¤ï¼ŒCanAddræ–¹æ³•å¹¶ä¸èƒ½æ­£ç¡®åæ˜ ä¸€ä¸ªå˜é‡æ˜¯å¦æ˜¯å¯ä»¥è¢«ä¿®æ”¹çš„ã€‚å¦ä¸€ä¸ªç›¸å…³çš„æ–¹æ³•CanSetæ˜¯ç”¨äºæ£€æŸ¥å¯¹åº”çš„reflect.Valueæ˜¯å¦æ˜¯å¯å–åœ°å€å¹¶å¯è¢«ä¿®æ”¹çš„ï¼š</p>

<p>fmt.Println(fd.CanAddr(), fd.CanSet()) // â€œtrue falseâ€</p>

<p>https://docs.hacknode.org/gopl-zh/ch12/ch12-05.html
https://www.kancloud.cn/wizardforcel/gopl-zh/106470</p>

<p>åå°„å€¼å¯¹è±¡ä¿®æ”¹å€¼çš„æ–¹æ³•
Set(x Value)	å°†å€¼è®¾ç½®ä¸ºä¼ å…¥çš„åå°„å€¼å¯¹è±¡çš„å€¼
Setlnt(x int64)	ä½¿ç”¨ int64 è®¾ç½®å€¼ã€‚å½“å€¼çš„ç±»å‹ä¸æ˜¯ intã€int8ã€int16ã€ int32ã€int64 æ—¶ä¼šå‘ç”Ÿå®•æœº
SetUint(x uint64)	ä½¿ç”¨ uint64 è®¾ç½®å€¼ã€‚å½“å€¼çš„ç±»å‹ä¸æ˜¯ uintã€uint8ã€uint16ã€uint32ã€uint64 æ—¶ä¼šå‘ç”Ÿå®•æœº
SetFloat(x float64)	ä½¿ç”¨ float64 è®¾ç½®å€¼ã€‚å½“å€¼çš„ç±»å‹ä¸æ˜¯ float32ã€float64 æ—¶ä¼šå‘ç”Ÿå®•æœº
SetBool(x bool)	ä½¿ç”¨ bool è®¾ç½®å€¼ã€‚å½“å€¼çš„ç±»å‹ä¸æ˜¯ bod æ—¶ä¼šå‘ç”Ÿå®•æœº
SetBytes(x []byte)	è®¾ç½®å­—èŠ‚æ•°ç»„ []byteså€¼ã€‚å½“å€¼çš„ç±»å‹ä¸æ˜¯ []byte æ—¶ä¼šå‘ç”Ÿå®•æœº
SetString(x string)	è®¾ç½®å­—ç¬¦ä¸²å€¼ã€‚å½“å€¼çš„ç±»å‹ä¸æ˜¯ string æ—¶ä¼šå‘ç”Ÿå®•æœº</p>

<p>å€¼å¯ä¿®æ”¹æ¡ä»¶ä¹‹ä¸€ï¼šå¯è¢«å¯»å€
é€šè¿‡åå°„ä¿®æ”¹å˜é‡å€¼çš„å‰ææ¡ä»¶ä¹‹ä¸€ï¼šè¿™ä¸ªå€¼å¿…é¡»å¯ä»¥è¢«å¯»å€ã€‚
å€¼å¯ä¿®æ”¹æ¡ä»¶ä¹‹ä¸€ï¼šè¢«å¯¼å‡º
ç»“æ„ä½“æˆå‘˜ä¸­ï¼Œå¦‚æœå­—æ®µæ²¡æœ‰è¢«å¯¼å‡ºï¼Œå³ä¾¿ä¸ä½¿ç”¨åå°„ä¹Ÿå¯ä»¥è¢«è®¿é—®ï¼Œä½†ä¸èƒ½é€šè¿‡åå°„ä¿®æ”¹</p>

<p>http://c.biancheng.net/view/116.html
https://www.yisu.com/zixun/452275.html</p>
:ET