I"ñ*<p>https://github.com/future-architect/vuls
inux vuls æ¼æ´æ‰«æï¼Œæœ‰ä»¥ä¸‹ä¼˜ç‚¹</p>

<p>æ¨èå‡ ä¸ªæ¼æ´åº“</p>

<p>CVE :http://cve.mitre.orgÂ æ›´æ–°å¿«</p>

<p>cnnvd:http://www.cnnvd.org.cn/Â  ä¼šå®šæ—¶æ›´æ–°CVEåº“ï¼Œ ä½†æ–¹ä¾¿çš„æ˜¯å…¨ä¸­æ–‡Â Â </p>

<p>1ã€æ£€æµ‹æ¼æ´æ•°é‡å¤š
å¯ä¸CVEåº“åŒæ­¥ã€‚CVEåº“ç›®å‰æœ‰1999-2018çš„å…¬å…±æ¼æ´åº“ã€‚å¹¶ä¸”CVEåº“ä¼šå®æ—¶æ›´æ–°æ¼æ´ã€‚</p>

<p>2ã€å¯æ ¹æ®CVEId æŸ¥è¯¢å‡ºè§£å†³æ–¹æ³•
å°†CVEId ç™¾åº¦ æˆ–googleéƒ½èƒ½æ‰¾å‡ºå¯¹åº”çš„è§£å†³æ–¹æ³•ã€‚(psï¼Œæ›´æ–°versionæ¯”è¾ƒç®€å•ï¼Œä½†æœ‰ç¼ºç‚¹è‡ªè¡Œè„‘è¡¥)</p>

<p>3ã€æä¾›webç•Œé¢å‘½ä»¤è¡Œç•Œé¢æ–¹ä¾¿æŸ¥çœ‹
å…·ä½“å›¾æ–‡ä»‹ç»è¯·å»ï¼Œwww.vuls.io æ‰§è¡Œäº†è§£
å®‰è£…æ–¹å¼
æå‰è®¾ç½®HTTP_PROXYï¼ï¼ï¼ åœ¨ç¼–è¯‘æ—¶éœ€è¦connect googleï¼</p>

<p>https://vuls.io/docs/en/abstract.html è‡ªè¡ŒæŸ¥çœ‹ï¼Œå®˜æ–¹æ–‡æ¡£ç®€æ´æ–¹ä¾¿
<!-- more -->
https://vuls.io/</p>

<p>ä¸€. å®‰è£…</p>

<p>ç³»ç»Ÿç®¡ç†å‘˜æœ‰è´£ä»»å®šæœŸå»æ£€æŸ¥ç³»ç»Ÿçš„å¼±ç‚¹å’Œæ›´æ–°è½¯ä»¶, vuls å¯ä»¥æä¾›å¦‚ä¸‹åŠŸèƒ½:</p>

<p>é€šçŸ¥ç®¡ç†å‘˜æœºå™¨æœ‰å®‰å…¨éšæ‚£
æ”¯æŒæœ¬åœ°å’Œè¿œç¨‹æ‰«æ(éœ€è¦æœ‰ ssh æƒé™)
å¯ä»¥å®šæœŸå»åŒæ­¥æœ€æ–°çš„å®‰å…¨æ•°æ®åº“</p>

<p>å‚ç…§å®˜æ–¹è¯´æ˜åœ¨ centos å®‰è£…å°±å¯ä»¥äº†, è¿™ä¸ªè½¯ä»¶æ˜¯ golang å†™çš„æ‰€ä»¥å…ˆå®‰è£… golang</p>

<p>https://vuls.io/docs/en/install-manually-centos.html</p>

<p>ä¸ºäº†ä½¿æˆ‘ä»¬ç¼–è¯‘çš„ç¨‹åºå¯ä»¥ä¸ä¾èµ–å…·ä½“çš„ç³»ç»Ÿåº“æ–‡ä»¶,æˆ‘ä»¬ä½¿ç”¨é™æ€ç¼–è¯‘,è¿™æ ·å°±èƒ½åœ¨ centos6å’Œ centos7è¿è¡Œäº†</p>

<p>GOOS=linux GOARCH=amd64 go build -a -ldflags â€˜-linkmode external -extldflags -staticâ€™ -o vuls
GOOS=linux GOARCH=amd64 go build -a -ldflags â€˜-linkmode external -extldflags -staticâ€™ -o go-cve-dictionary
GOOS=linux GOARCH=amd64 go build -a -ldflags â€˜-linkmode external -extldflags -staticâ€™ -o goval-dictionary
vulsrepo æ˜¯ä¸€ä¸ª web ui  ç”¨æ¥æ›´æ¸…æ¥šçš„å±•ç¤ºæ‰«æçš„ç»“æœ,æ¨èä½¿ç”¨ https://vuls.io/docs/en/vulsrepo.html</p>

<p>äºŒ. ä½¿ç”¨</p>

<p>go-cve-dictionaryå’Œgoval-dictionary è¿™ä¸¤ä¸ªç¨‹åºæ˜¯ä¸‹è½½ cve å’Œ oval æ¼æ´åº“ç”¨çš„</p>

<p>åœ¨å®‰è£… vulsrepo çš„æ–‡æ¡£ä¸­æœ‰ä¸ªé…ç½® å¦‚ä¸‹
$ vi vulsrepo-config.toml
[Server]
rootPath = â€œ/home/vuls-user/vulsrepoâ€
resultsPath  = â€œ/opt/vuls/resultsâ€    ä½ éœ€è¦æŠŠä½ æ‰«æçš„ç»“æœæ”¾åˆ°è¿™ä¸ªç›®å½•ä¸‹,æ–¹ä¾¿èµ·è§æˆ‘ä»¬ç›´æ¥å»è¿™ä¸ªç›®å½•æ‰«æ,æŠŠé‚£ä¸¤ä¸ªæ•°æ®åº“ä¹Ÿä¸‹è½½åˆ°è¿™ä¸ªä½ç½®
serverPort  = â€œ5111â€
 å¼€å§‹ä¸‹è½½æ•°æ®åº“</p>

<p>cd /opt/vuls/results</p>

<p>for i in <code class="language-plaintext highlighter-rouge">seq 2002 $(date +"%Y")</code>; do go-cve-dictionary fetchnvd -years $i; done</p>

<p>goval-dictionary fetch-redhat 7     #å¦‚æœç³»ç»Ÿæ˜¯6 è¿™é‡Œæ”¹æˆ6
å¼€å§‹æ‰«æ</p>

<p>vuls scan 
vuls report -format-json 
æ‰«æå®Œä»¥åçš„ç›®å½•ç»“æ„å¦‚ä¸‹</p>

<p>å¤åˆ¶ä»£ç 
[root@kube-node-01 report]# tree . -L 2
.
â”œâ”€â”€ config.toml
â”œâ”€â”€ cve.sqlite3
â”œâ”€â”€ cve.sqlite3-shm
â”œâ”€â”€ cve.sqlite3-wal
â”œâ”€â”€ oval.sqlite3
â””â”€â”€ results
    â”œâ”€â”€ 2018-06-07T17:30:03+08:00
    â””â”€â”€ 2018-06-08T12:03:05+08:00</p>

<p>[root@kube-node-01 report]# pwd
/data/app/vulsrepo/report
å¤åˆ¶ä»£ç 
è¿™æ—¶å€™æ‰“å¼€æµè§ˆå™¨ http://your_ip:5111</p>

<p>https://www.freebuf.com/sectool/101408.html</p>

<p>ä¸€ã€å®‰è£…æ‰€éœ€ç»„ä»¶
æ³¨æ„ï¼Œå› ä¸ºéœ€è¦è®¿é—®å¤–ç½‘ï¼Œå¯èƒ½è¢«å¢™ï¼Œæ‰€ä»¥è¯·è‡ªè¡Œè§£å†³ç§‘å­¦ä¸Šç½‘é—®é¢˜ã€‚</p>

<p>1.éœ€è¦ä»¥ä¸‹åŒ…</p>

<p>yum -y install sqlite git gcc make wget
wget https://dl.google.com/go/go1.10.1.linux-amd64.tar.gz
tar -C /usr/local -xzf  go1.10.1.linux-amd64.tar.gz
mkdir $HOME/go
2.æ·»åŠ ç¯å¢ƒå˜é‡</p>

<p>cat /etc/profile.d/goenv.sh
export GOROOT=/usr/local/go
export GOPATH=$HOME/go
export PATH=$PATH:$GOROOT/bin:$GOPATH/bin
ä½¿ä¹‹ç”Ÿæ•ˆ
source /etc/profile.d/goenv.sh
3.éƒ¨ç½²go-cve-dictionary</p>

<p>mkdir /var/log/vuls
chmod 700 /var/log/vuls
mkdir -p $GOPATH/src/github.com/kotakanbe
cd $GOPATH/src/github.com/kotakanbe
git clone https://github.com/kotakanbe/go-cve-dictionary.git
cd go-cve-dictionary
make install
æˆåŠŸçš„æ ‡å¿—æ˜¯åœ¨$GOPATH/binç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶</p>

<p>è·å–æ¼æ´æ•°æ®</p>

<p>$ cd $HOME
$ for i in <code class="language-plaintext highlighter-rouge">seq 2002 $(date +"%Y")</code>; do go-cve-dictionary fetchnvd -years $i; done
4.éƒ¨ç½²goval-dictionary</p>

<p>mkdir -p $GOPATH/src/github.com/kotakanbe
cd $GOPATH/src/github.com/kotakanbe
git clone https://github.com/kotakanbe/goval-dictionary.git
cd goval-dictionary
make install
æˆåŠŸçš„æ ‡å¿—æ˜¯åœ¨$GOPATH/binç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶</p>

<p>å¦‚æœä½ è¦æ‰«çš„æ˜¯centosï¼Œè¯·è·å–ç›¸åº”ç‰ˆæœ¬çš„OVALæ•°æ®ï¼Œ</p>

<p>goval-dictionary fetch-redhat 5 6 7
å¯¹åº”äºcentos5 6 7
å¦‚æœä½ è¦æ‰«çš„æ˜¯å…¶ä»–å‘è¡Œç‰ˆï¼Œé‚£ä¹ˆå¯ä»¥å‚è€ƒä»¥ä¸‹ç½‘é¡µ https://github.com/kotakanbe/goval-dictionary#usage-fetch-oval-data-from-redhat</p>

<p>5.éƒ¨ç½²gost</p>

<p>mkdir /var/log/gost
chmod 700 /var/log/gost
mkdir -p $GOPATH/src/github.com/knqyf263
cd $GOPATH/src/github.com/knqyf263
git clone https://github.com/knqyf263/gost.git
cd gost
make install
æˆåŠŸçš„æ ‡å¿—æ˜¯åœ¨$GOPATH/binç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶</p>

<p>å¦‚æœä½ è¦æ‰«çš„æ˜¯centosï¼Œè¦è·å–ç›¸åº”çš„å®‰å…¨æ•°æ®</p>

<p>gost fetch redhat â€“after 2016-01-01 
å½“ç„¶å¦‚æœä½ æƒ³è¦æ›´æ—©çš„æ•°æ®ï¼Œå˜åŠ¨æ—¶é—´å³å¯
å…¶ä»–å‘è¡Œç‰ˆçš„å®‰å…¨æ•°æ®å‚è€ƒä»¥ä¸‹ç½‘é¡µ https://github.com/knqyf263/gost#fetch-debian</p>

<p>6.éƒ¨ç½²go-exploitdb</p>

<p>è¿™æ˜¯ä¸ªæ¨¡å—ï¼Œå¯ä»¥æ¨¡æ‹Ÿä»£ç ï¼Œå¦‚æœä½ è§‰å¾—ä¸éœ€è¦ï¼Œå¯ä»¥ç•¥è¿‡æœ¬æ­¥ã€‚</p>

<p>mkdir /var/log/go-exploitdb
chmod 700 /var/log/go-exploitdb
mkdir -p $GOPATH/src/github.com/mozqnet
cd $GOPATH/src/github.com/mozqnet
git clone https://github.com/mozqnet/go-exploitdb.git
cd go-exploitdb
make install
æˆåŠŸçš„æ ‡å¿—æ˜¯åœ¨$GOPATH/binç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶</p>

<p>è·å–***æ¨¡å—æ•°æ®åº“
go-exploitdb fetch exploitdb
7.éƒ¨ç½²Vuls</p>

<p>mkdir -p $GOPATH/src/github.com/future-architect
cd $GOPATH/src/github.com/future-architect
git clone https://github.com/future-architect/vuls.git
cd vuls
make install
å¦‚æœä½ ä¹‹å‰è£…è¿‡vulsï¼Œç°åœ¨æƒ³å‡çº§ï¼Œé‚£ä¹ˆå¯ä»¥</p>

<p>rm -rf $GOPATH/pkg/linux_amd64/github.com/future-architect/vuls/
rm -rf $GOPATH/src/github.com/future-architect/vuls/
cd $GOPATH/src/github.com/future-architect
git clone https://github.com/future-architect/vuls.git
cd vuls
make install
æˆåŠŸçš„æ ‡å¿—æ˜¯åœ¨$GOPATH/binç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶</p>

<p>äºŒã€æœ¬åœ°æ‰«ææ¨¡å¼
1.å¯åŠ¨æœåŠ¡</p>

<p>[root@web05 ~]# go-cve-dictionary server
INFO[04-04|08:43:35] Starting HTTP Serverâ€¦ 
INFO[04-04|08:43:35] Listening on 127.0.0.1:1323</p>

<hr />
<p>/ <strong>/</strong><em>/ /  <strong>_
 / _// __/ _ \/ _ <br />
/</strong></em>/_<em>/</em>//<em>/_<strong>/ v3.3.10-dev
High performance, minimalist Go web framework
https://echo.labstack.com
__</strong></em><strong>__</strong><strong>__</strong><strong>__</strong><strong>__</strong><strong>__</strong><em>O/</em><strong>__</strong>
                                    O<br />
â‡¨ http server started on 127.0.0.1:1323</p>

<p>[root@web05 ~]# goval-dictionary server
INFO[04-04|08:43:49] Starting HTTP Serverâ€¦ 
INFO[04-04|08:43:49] Listeningâ€¦                             URL=127.0.0.1:1324</p>

<p>[root@web05 ~]# go-exploitdb server
INFO[04-04|10:28:54] Opening Database.                        db=sqlite3
INFO[04-04|10:28:54] Migrating DB.                            db=sqlite3
INFO[04-04|10:28:54] Starting HTTP Serverâ€¦ 
INFO[04-04|10:28:54] Listeningâ€¦                             URL=:</p>

<hr />
<p>/ <strong>/</strong><em>/ /  <strong>_
 / _// __/ _ \/ _ <br />
/</strong></em>/_<em>/</em>//<em>/_<strong>/ v3.3.10-dev
High performance, minimalist Go web framework
https://echo.labstack.com
__</strong></em><strong>__</strong><strong>__</strong><strong>__</strong><strong>__</strong><strong>__</strong><em>O/</em><strong>__</strong>
                                    O<br />
â‡¨ http server started on [::]:44649
2.ç¼–å†™é…ç½®æ–‡ä»¶</p>

<p>cd $HOME
cat config.toml
[servers]</p>

<p>[servers.localhost]
host = â€œlocalhostâ€
port = â€œlocalâ€
3.æ£€æŸ¥é…ç½®æ–‡ä»¶</p>

<p>$ vuls configtest
4.å¼€å§‹æ‰«æ</p>

<p>$ vuls scan
5.ç”¨tuiæŸ¥çœ‹æ‰«æç»“æœ</p>

<p>$ vuls tui</p>

<p>ä¸‰ã€è¿œç¨‹æ‰«ææ¨¡å¼
ä¸ºäº†å™è¿°æ–¹ä¾¿ï¼Œå®‰è£…äº†vulsçš„ç§°ä¸ºæœåŠ¡ç«¯ï¼Œè¢«æ‰«æçš„ç³»ç»Ÿç§°ä¸ºå®¢æˆ·ç«¯ã€‚</p>

<p>1.æœåŠ¡ç«¯è¦èƒ½é‡‡ç”¨ç§˜é’¥æ–¹å¼ç™»å½•å®¢æˆ·ç«¯ï¼Œvulsä¸æ”¯æŒå¯†ç éªŒè¯æ–¹å¼ã€‚</p>

<p>(1)æœåŠ¡ç«¯äº§ç”Ÿç§˜é’¥å¯¹</p>

<p>ssh-keygen -t dsa
Generating public/private dsa key pair.
    Enter file in which to save the key (/root/.ssh/id_dsa):      &lt;â€“ ç¡®è®¤ç§é’¥æ–‡ä»¶æ‰€ä¿å­˜çš„è·¯å¾„
    /root/.ssh/id_dsa already exists.
    Overwrite (y/n)? y                                            &lt;â€“ å¦‚æœå·²ç»å­˜åœ¨äº†å¯†é’¥å¯¹ä¿¡æ¯ï¼Œæ˜¯å¦è¿›è¡Œè¦†ç›–
    Enter passphrase (empty for no passphrase):                   &lt;â€“ ç¡®è®¤æ˜¯å¦ç»™ç§é’¥è®¾ç½®å¯†ç ä¿¡æ¯ï¼ˆä¸€èˆ¬ä¸ºç©ºï¼‰
ï¼ˆ2ï¼‰å°†ç®¡ç†ä¸»æœºä¸Šå…¬é’¥ä¿¡æ¯å‘é€ç»™è¢«ç®¡ç†ä¸»æœº</p>

<p>ssh-copy-id -i /root/.ssh/id_dsa.pub 172.16.1.31
ï¼ˆ3ï¼‰åŸºäºå¯†é’¥æ–¹å¼æµ‹è¯•</p>

<p>ssh 172.16.1.31 &lt;â€“ å¯ä»¥ä¸ç”¨è¾“å…¥å¯†ç ä¿¡æ¯ï¼Œå°±èƒ½ç™»é™†æˆåŠŸ
2.ç¼–å†™é…ç½®æ–‡ä»¶</p>

<p>$ cd $HOME
$ cat config.toml
[servers]</p>

<p>[servers.ubuntu]
host         = â€œ172.31.4.82â€
port        = â€œ22â€
user        = â€œrootâ€
keyPath     = â€œ/root/.ssh/id_dsaâ€
3.æ£€æŸ¥é…ç½®æ–‡ä»¶</p>

<p>vuls configtest ubuntu
4.å¼€å§‹æ‰«æ</p>

<p>ï¼ˆ1ï¼‰fastæ‰«ææ¨¡å¼</p>

<p>vuls scan ubuntu
é»˜è®¤æ˜¯ä½¿ç”¨fastæ¨¡å¼
ï¼ˆ2ï¼‰fast-rootæ‰«ææ¨¡å¼</p>

<p>æœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯éƒ½éœ€è¦</p>

<p>å‘è¡Œç‰ˆ	ç‰ˆæœ¬å·	ä¾èµ–
Alpine	3.2 and later	-
Ubuntu	14, 16, 18	debian-goodies
Debian	8,9	debian-goodies, reboot-notifier
CentOS	6,7	yum-plugin-ps
RHEL	5,6,7	yum-plugin-ps
Oracle	Linux 5,6,7	yum-plugin-ps
config.tomléœ€è¦åŠ ä¸€è¡Œ</p>

<p>[root@web05 ~]# cat config.toml 
[servers]</p>

<p>[servers.v4]
host         = â€œ192.168.17.239â€
port        = â€œ22â€
user        = â€œrootâ€
keyPath     = â€œ/root/.ssh/id_rsaâ€
scanMode    = [â€œfast-rootâ€]
åé¢å†æŒ‰ç…§ä¹‹å‰çš„ï¼Œæ£€æµ‹é…ç½®æ–‡ä»¶ï¼Œæ‰«æå³å¯ã€‚</p>

<p>ï¼ˆ3ï¼‰deepæ‰«ææ¨¡å¼</p>

<p>å®˜æ–¹çš„è¯´æ³•æ˜¯ä¼šå¯¹å®¢æˆ·ç«¯é€ æˆè´Ÿè½½ï¼Œæ‰«æçš„ä¹Ÿæ›´æ·±å…¥ã€‚</p>

<p>æœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯éƒ½éœ€è¦</p>

<p>å‘è¡Œç‰ˆ	ç‰ˆæœ¬å·	ä¾èµ–
Alpine	3.2 and later	-
Ubuntu	14, 16, 18	debian-goodies
Debian	7,8,9	aptitude, reboot-notifier, debian-goodies
CentOS	6,7	yum-plugin-changelog, yum-plugin-ps
RHEL	5	yum-changelog, yum-security, yum-plugin-ps
RHEL	6,7	yum-plugin-changelog, yum-plugin-ps
Oracle Linux	5	yum-changelog, yum-security, yum-plugin-ps
Oracle Linux	6,7	yum-plugin-changelog, yum-plugin-ps
é…ç½®æ–‡ä»¶å¦‚ä¸‹ï¼š</p>

<p>[root@web05 ~]# cat config.toml 
[servers]</p>

<p>[servers.v4]
host         = â€œ192.168.17.239â€
port        = â€œ22â€
user        = â€œrootâ€
keyPath     = â€œ/root/.ssh/id_dsaâ€
scanMode    = [â€œdeepâ€]
åé¢å†æŒ‰ç…§ä¹‹å‰çš„ï¼Œæ£€æµ‹é…ç½®æ–‡ä»¶ï¼Œæ‰«æå³å¯ã€‚</p>

<p>vuls è‹±æ–‡æŒ‡å¯¼ç½‘å€</p>

<p>https://vuls.io/docs/en/install-manually-centos.html</p>
:ET