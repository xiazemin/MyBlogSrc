I"¨k<p>Aviatoræ˜¯ä¸€ä¸ªé«˜æ€§èƒ½ã€è½»é‡çº§çš„javaè¯­è¨€å®ç°çš„è¡¨è¾¾å¼æ±‚å€¼å¼•æ“ï¼Œä¸»è¦ç”¨äºå„ç§è¡¨è¾¾å¼çš„åŠ¨æ€æ±‚å€¼ã€‚ç°åœ¨å·²ç»æœ‰å¾ˆå¤šå¼€æºå¯ç”¨çš„javaè¡¨è¾¾å¼æ±‚å€¼å¼•æ“ï¼Œä¸ºä»€ä¹ˆè¿˜éœ€è¦Avaitorå‘¢ï¼Ÿ</p>

<p>Aviatorçš„è®¾è®¡ç›®æ ‡æ˜¯è½»é‡çº§å’Œé«˜æ€§èƒ½ ï¼Œç›¸æ¯”äºGroovyã€JRubyçš„ç¬¨é‡ï¼ŒAviatoréå¸¸å°ï¼ŒåŠ ä¸Šä¾èµ–åŒ…ä¹Ÿæ‰450K,ä¸ç®—ä¾èµ–åŒ…çš„è¯åªæœ‰70Kï¼›å½“ç„¶ï¼ŒAviatorçš„è¯­æ³•æ˜¯å—é™çš„ï¼Œå®ƒä¸æ˜¯ä¸€é—¨å®Œæ•´çš„è¯­è¨€ï¼Œè€Œåªæ˜¯è¯­è¨€çš„ä¸€å°éƒ¨åˆ†é›†åˆã€‚</p>

<p>å…¶æ¬¡ï¼ŒAviatorçš„å®ç°æ€è·¯ä¸å…¶ä»–è½»é‡çº§çš„æ±‚å€¼å™¨å¾ˆä¸ç›¸åŒï¼Œå…¶ä»–æ±‚å€¼å™¨ä¸€èˆ¬éƒ½æ˜¯é€šè¿‡è§£é‡Šçš„æ–¹å¼è¿è¡Œï¼Œè€ŒAviatoråˆ™æ˜¯ç›´æ¥å°†è¡¨è¾¾å¼ç¼–è¯‘æˆJavaå­—èŠ‚ç ï¼Œäº¤ç»™JVMå»æ‰§è¡Œã€‚ç®€å•æ¥è¯´ï¼ŒAviatorçš„å®šä½æ˜¯ä»‹äºGroovyè¿™æ ·çš„é‡é‡çº§è„šæœ¬è¯­è¨€å’ŒIKExpressionè¿™æ ·çš„è½»é‡çº§è¡¨è¾¾å¼å¼•æ“ä¹‹é—´ã€‚
<!-- more -->
Aviatorçš„ç‰¹æ€§</p>

<p>æ”¯æŒå¤§éƒ¨åˆ†è¿ç®—æ“ä½œç¬¦ï¼ŒåŒ…æ‹¬ç®—æœ¯æ“ä½œç¬¦ã€å…³ç³»è¿ç®—ç¬¦ã€é€»è¾‘æ“ä½œç¬¦ã€æ­£åˆ™åŒ¹é…æ“ä½œç¬¦(=~)ã€ä¸‰å…ƒè¡¨è¾¾å¼?: ï¼Œå¹¶ä¸”æ”¯æŒæ“ä½œç¬¦çš„ä¼˜å…ˆçº§å’Œæ‹¬å·å¼ºåˆ¶ä¼˜å…ˆçº§ï¼Œå…·ä½“è¯·çœ‹åé¢çš„æ“ä½œç¬¦åˆ—è¡¨ã€‚</p>

<p>æ”¯æŒå‡½æ•°è°ƒç”¨å’Œè‡ªå®šä¹‰å‡½æ•°</p>

<p>æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ï¼Œç±»ä¼¼Rubyã€Perlçš„åŒ¹é…è¯­æ³•ï¼Œå¹¶ä¸”æ”¯æŒç±»Rubyçš„$digitæŒ‡å‘åŒ¹é…åˆ†ç»„ã€‚
è‡ªåŠ¨ç±»å‹è½¬æ¢ï¼Œå½“æ‰§è¡Œæ“ä½œçš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨åˆ¤æ–­æ“ä½œæ•°ç±»å‹å¹¶åšç›¸åº”è½¬æ¢ï¼Œæ— æ³•è½¬æ¢å³æŠ›å¼‚å¸¸ã€‚
æ”¯æŒä¼ å…¥å˜é‡ï¼Œæ”¯æŒç±»ä¼¼a.b.cçš„åµŒå¥—å˜é‡è®¿é—®ã€‚
æ€§èƒ½ä¼˜ç§€
Aviatorçš„é™åˆ¶ï¼š</p>

<p>æ²¡æœ‰if elseã€do whileç­‰è¯­å¥ï¼Œæ²¡æœ‰èµ‹å€¼è¯­å¥ï¼Œä»…æ”¯æŒé€»è¾‘è¡¨è¾¾å¼ã€ç®—æœ¯è¡¨è¾¾å¼ã€ä¸‰å…ƒè¡¨è¾¾å¼å’Œæ­£åˆ™åŒ¹é…ã€‚
æ²¡æœ‰ä½è¿ç®—ç¬¦
æ•´ä½“ç»“æ„Â¶
Aviatorçš„ç»“æ„éå¸¸ç®€å•ï¼Œä¸€ä¸ªå…¸å‹çš„æ±‚å€¼å™¨çš„ç»“æ„</p>

<p>ä¾èµ–åŒ…Â¶
commons-beanutilså’Œcommons-logging</p>

<p>ä½¿ç”¨æ‰‹å†ŒÂ¶
æ‰§è¡Œè¡¨è¾¾å¼Â¶
Aviatorçš„ä½¿ç”¨éƒ½æ˜¯é›†ä¸­é€šè¿‡com.googlecode.aviator.AviatorEvaluatorè¿™ä¸ªå…¥å£ç±»æ¥å¤„ç†ï¼Œæœ€ç®€å•çš„ä¾‹å­ï¼Œæ‰§è¡Œä¸€ä¸ªè®¡ç®—1+2+3çš„è¡¨è¾¾å¼ï¼š</p>

<p>import com.googlecode.aviator.AviatorEvaluator; 
public class SimpleExample { 
    public static void main(String[] args) { 
        Long result = (Long) AviatorEvaluator.execute(â€œ1+2+3â€); 
        System.out.println(result); 
    } 
}
ç»†å¿ƒçš„æœ‹å‹è‚¯å®šæ³¨æ„åˆ°ç»“æœæ˜¯Longï¼Œè€Œä¸æ˜¯Integerã€‚è¿™æ˜¯å› ä¸ºAviatorçš„æ•°å€¼ç±»å‹ä»…æ”¯æŒLongå’ŒDoubleï¼Œä»»ä½•æ•´æ•°éƒ½å°†è½¬æ¢æˆLongï¼Œä»»ä½•æµ®ç‚¹æ•°éƒ½å°†è½¬æ¢ä¸ºDoubleï¼ŒåŒ…æ‹¬ç”¨æˆ·ä¼ å…¥çš„å˜é‡æ•°å€¼ã€‚è¿™ä¸ªä¾‹å­çš„æ‰“å°ç»“æœå°†æ˜¯æ­£ç¡®ç­”æ¡ˆ6ã€‚</p>

<p>ä½¿ç”¨å˜é‡Â¶
æƒ³è®©Aviatorå¯¹ä½ say helloå—ï¼Ÿå¾ˆç®€å•ï¼Œä¼ å…¥ä½ çš„åå­—ï¼Œè®©Aviatorè´Ÿè´£å­—ç¬¦ä¸²çš„ç›¸åŠ ï¼š</p>

<p>import com.googlecode.aviator.AviatorEvaluator;</p>

<p>public class SayHello { 
    public static void main(String[] args) { 
        if (args.length &lt; 1) { 
            System.err.print(â€œUsesage: Java SayHello yournameâ€); 
        } 
        String yourname = args[0]; 
        Map&lt;String, Object&gt; env = new HashMap&lt;String, Object&gt;(); 
        env.put(â€œyournameâ€, yourname); 
        String result = (String) AviatorEvaluator.execute(â€œ â€˜hello â€˜ + yourname â€œ, env); 
        System.out.println(result); 
    } 
}
ä¸Šé¢çš„ä¾‹å­æ¼”ç¤ºäº†æ€ä¹ˆå‘è¡¨è¾¾å¼ä¼ å…¥å˜é‡å€¼ï¼Œè¡¨è¾¾å¼ä¸­çš„yournameæ˜¯ä¸€ä¸ªå˜é‡ï¼Œé»˜è®¤ä¸ºnullï¼Œé€šè¿‡ä¼ å…¥Map&lt;String,Object&gt;çš„å˜é‡ç»‘å®šç¯å¢ƒï¼Œå°†yournameè®¾ç½®ä¸ºä½ è¾“å…¥çš„åç§°ã€‚envçš„keyæ˜¯å˜é‡åï¼Œvalueæ˜¯å˜é‡çš„å€¼ã€‚</p>

<p>ä¸Šé¢ä¾‹å­ä¸­çš„â€™hello â€˜æ˜¯ä¸€ä¸ªAviatorçš„Stringï¼ŒAviatorçš„Stringæ˜¯ä»»ä½•ç”¨å•å¼•å·æˆ–è€…åŒå¼•å·æ‹¬èµ·æ¥çš„å­—ç¬¦åºåˆ—ï¼ŒStringå¯ä»¥æ¯”è¾ƒå¤§å°ï¼ˆåŸºäºunicodeé¡ºåºï¼‰ï¼Œå¯ä»¥å‚ä¸æ­£åˆ™åŒ¹é…ï¼Œå¯ä»¥ä¸ä»»ä½•å¯¹è±¡ç›¸åŠ ï¼Œä»»ä½•å¯¹è±¡ä¸Stringç›¸åŠ ç»“æœä¸ºStringã€‚Stringä¸­ä¹Ÿå¯ä»¥æœ‰è½¬ä¹‰å­—ç¬¦ï¼Œå¦‚/nã€//ã€/â€™ç­‰ã€‚</p>

<p>AviatorEvaluator.execute(â€œ â€˜a/â€bâ€™ â€œ);   //å­—ç¬¦ä¸² aâ€™b 
AviatorEvaluator.execute(â€œ /â€a/â€™b/â€ â€œ);  //å­—ç¬¦ä¸² aâ€b 
AviatorEvaluator.execute(â€œ â€˜helloâ€™+3 â€œ);  //å­—ç¬¦ä¸² hello 3 
AviatorEvaluator.execute(â€œ â€˜hello â€˜+ unknow â€œ);  //å­—ç¬¦ä¸² hello null
è°ƒç”¨å‡½æ•°Â¶
Aviatoræ”¯æŒå‡½æ•°è°ƒç”¨ï¼Œå‡½æ•°è°ƒç”¨çš„é£æ ¼ç±»ä¼¼luaï¼Œä¸‹é¢çš„ä¾‹å­è·å–å­—ç¬¦ä¸²çš„é•¿åº¦ï¼š</p>

<p>AviatorEvaluator.execute(â€œstring.length(â€˜helloâ€™)â€);
string.length(â€˜helloâ€™)æ˜¯ä¸€ä¸ªå‡½æ•°è°ƒç”¨ï¼Œstring.lengthæ˜¯ä¸€ä¸ªå‡½æ•°,â€™helloâ€™æ˜¯è°ƒç”¨çš„å‚æ•°ã€‚</p>

<p>å†ç”¨string.substringæ¥æˆªå–å­—ç¬¦ä¸²ï¼š</p>

<p>AviatorEvaluator.execute(â€œstring.contains(/â€test/â€,string.substring(â€˜helloâ€™,1,2))â€);
é€šè¿‡string.substring(â€˜helloâ€™,1,2)è·å–å­—ç¬¦ä¸²â€™eâ€™ï¼Œç„¶åé€šè¿‡å‡½æ•°string.containsåˆ¤æ–­eæ˜¯å¦åœ¨â€™testâ€™ä¸­ã€‚å¯ä»¥çœ‹åˆ°ï¼Œå‡½æ•°å¯ä»¥åµŒå¥—è°ƒç”¨ã€‚</p>

<p>Aviatorçš„å†…ç½®å‡½æ•°åˆ—è¡¨è¯·çœ‹åé¢ã€‚</p>

<p>è‡ªå®šä¹‰å‡½æ•°Â¶
Aviatoré™¤äº†å†…ç½®çš„å‡½æ•°ä¹‹å¤–ï¼Œè¿˜å…è®¸ç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°ï¼Œåªè¦å®ç°com.googlecode.aviator.runtime.type.AviatorFunctionæ¥å£ï¼Œå¹¶æ³¨å†Œåˆ°AviatorEvaluatorå³å¯ä½¿ç”¨</p>

<p>public interface AviatorFunction { 
    /** 
     * Get the function name 
     *<br />
     * @return 
     */ 
    public String getName();</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/** 
 * call function 
 *  
 * @param env 
 *            Variable environment 
 * @param args 
 *            Function arguments 
 * @return 
 */ 
public AviatorObject call(Map&lt;String, Object&gt; env, AviatorObject... args);  } å¯ä»¥çœ‹ä¸€ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å®ç°ä¸€ä¸ªaddå‡½æ•°æ¥åšæ•°å€¼çš„ç›¸åŠ ï¼š
</code></pre></div></div>

<p>import com.googlecode.aviator.runtime.function.FunctionUtils; 
  import com.googlecode.aviator.runtime.type.AviatorDouble; 
  import com.googlecode.aviator.runtime.type.AviatorFunction; 
  import com.googlecode.aviator.runtime.type.AviatorObject; 
  public class AddFunction implements AviatorFunction {</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    public AviatorObject call(Map&lt;String, Object&gt; env, AviatorObject... args) { 
        if (args.length != 2) { 
            throw new IllegalArgumentException("Add only supports two arguments"); 
        } 
        Number left = FunctionUtils.getNumberValue(0, args, env); 
        Number right = FunctionUtils.getNumberValue(1, args, env); 
        return new AviatorDouble(left.doubleValue() + right.doubleValue()); 
    } 
 
 
    public String getName() { 
        return "add"; 
    } 
 
} æ³¨å†Œåˆ°AviatorEvaluatorå¹¶è°ƒç”¨å¦‚ä¸‹ï¼š

    //æ³¨å†Œå‡½æ•° 
    AviatorEvaluator.addFunction(new AddFunction()); 
    System.out.println(AviatorEvaluator.execute("add(1,2)")); 
    System.out.println(AviatorEvaluator.execute("add(add(1,2),100)")); æ³¨å†Œå‡½æ•°é€šè¿‡AviatorEvaluator.addFunctionæ–¹æ³•ï¼Œç§»é™¤å¯ä»¥é€šè¿‡removeFunctionã€‚
</code></pre></div></div>

<p>ç¼–è¯‘è¡¨è¾¾å¼Â¶
ä¸Šé¢æåˆ°çš„ä¾‹å­éƒ½æ˜¯ç›´æ¥æ‰§è¡Œè¡¨è¾¾å¼ï¼Œäº‹å®ä¸ŠAviatorèƒŒåéƒ½å¸®ä½ åšäº†ç¼–è¯‘å¹¶æ‰§è¡Œçš„å·¥ä½œã€‚ä½ å¯ä»¥è‡ªå·±å…ˆç¼–è¯‘è¡¨è¾¾å¼ï¼Œè¿”å›ä¸€ä¸ªç¼–è¯‘çš„ç»“æœï¼Œç„¶åä¼ å…¥ä¸åŒçš„envæ¥å¤ç”¨ç¼–è¯‘ç»“æœï¼Œæé«˜æ€§èƒ½ï¼Œè¿™æ˜¯æ›´æ¨èçš„ä½¿ç”¨æ–¹å¼ï¼š</p>

<p>import java.util.HashMap; 
import java.util.Map;</p>

<p>import com.googlecode.aviator.AviatorEvaluator; 
import com.googlecode.aviator.Expression;</p>

<p>public class CompileExample { 
    public static void main(String[] args) { 
        String expression = â€œa-(b-c)&gt;100â€; 
        // ç¼–è¯‘è¡¨è¾¾å¼ 
        Expression compiledExp = AviatorEvaluator.compile(expression);</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    Map&lt;String, Object&gt; env = new HashMap&lt;String, Object&gt;(); 
    env.put("a", 100.3); 
    env.put("b", 45); 
    env.put("c", -199.100); 
 
    // æ‰§è¡Œè¡¨è¾¾å¼ 
    Boolean result = (Boolean) compiledExp.execute(env); 
    System.out.println(result); 
}  } é€šè¿‡compileæ–¹æ³•å¯ä»¥å°†è¡¨è¾¾å¼ç¼–è¯‘æˆExpressionçš„ä¸­é—´å¯¹è±¡ï¼Œå½“è¦æ‰§è¡Œè¡¨è¾¾å¼çš„æ—¶å€™ä¼ å…¥envå¹¶è°ƒç”¨Expressionçš„executeæ–¹æ³•å³å¯ã€‚è¡¨è¾¾å¼ä¸­ä½¿ç”¨äº†æ‹¬å·æ¥å¼ºåˆ¶ä¼˜å…ˆçº§ï¼Œè¿™ä¸ªä¾‹å­è¿˜ä½¿ç”¨äº†&gt;ç”¨äºæ¯”è¾ƒæ•°å€¼å¤§å°ï¼Œæ¯”è¾ƒè¿ç®—ç¬¦!=ã€==ã€&gt;ã€&gt;=ã€&lt;ã€&lt;=ä¸ä»…å¯ä»¥ç”¨äºæ•°å€¼ï¼Œä¹Ÿå¯ä»¥ç”¨äºStringã€Patternã€Booleanç­‰ç­‰ï¼Œç”šè‡³æ˜¯ä»»ä½•ç”¨æˆ·ä¼ å…¥çš„ä¸¤ä¸ªéƒ½å®ç°äº†java.langã€‚Comparableæ¥å£çš„å¯¹è±¡ä¹‹é—´ã€‚
</code></pre></div></div>

<p>ç¼–è¯‘åçš„ç»“æœä½ å¯ä»¥è‡ªå·±ç¼“å­˜ï¼Œä¹Ÿå¯ä»¥äº¤ç»™Aviatorå¸®ä½ ç¼“å­˜ï¼ŒAviatorEvaluatorå†…éƒ¨æœ‰ä¸€ä¸ªå…¨å±€çš„ç¼“å­˜æ± ï¼Œå¦‚æœä½ å†³å®šç¼“å­˜ç¼–è¯‘ç»“æœï¼Œå¯ä»¥é€šè¿‡ï¼š</p>

<p>public static Expression compile(String expression, boolean cached)
å°†cachedè®¾ç½®ä¸ºtrueå³å¯ï¼Œé‚£ä¹ˆä¸‹æ¬¡ç¼–è¯‘åŒä¸€ä¸ªè¡¨è¾¾å¼çš„æ—¶å€™å°†ç›´æ¥è¿”å›ä¸Šä¸€æ¬¡ç¼–è¯‘çš„ç»“æœã€‚ä½¿ç¼“å­˜å¤±æ•ˆé€šè¿‡ï¼š</p>

<p>public static void invalidateCache(String expression)
æ–¹æ³•ã€‚</p>

<p>è®¿é—®æ•°ç»„å’Œé›†åˆÂ¶
å¯ä»¥é€šè¿‡ä¸­æ‹¬å·å»è®¿é—®æ•°ç»„å’Œjava.util.Listå¯¹è±¡ï¼Œå¯ä»¥é€šè¿‡map.keyè®¿é—®java.util.Mapä¸­keyå¯¹åº”çš„valueï¼Œä¸€ä¸ªä¾‹å­ï¼š</p>

<p>import java.util.ArrayList; 
import java.util.Date; 
import java.util.HashMap; 
import java.util.List; 
import java.util.Map;</p>

<p>import com.googlecode.aviator.AviatorEvaluator;</p>

<p>public class CollectionExample { 
    public static void main(String[] args) { 
        final List<String> list = new ArrayList<String>(); 
        list.add("hello"); 
        list.add(" world");</String></String></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    final int[] array = new int[3]; 
    array[0] = 0; 
    array[1] = 1; 
    array[2] = 3; 
 
    final Map&lt;String, Date&gt; map = new HashMap&lt;String, Date&gt;(); 
    map.put("date", new Date()); 
 
    Map&lt;String, Object&gt; env = new HashMap&lt;String, Object&gt;(); 
    env.put("list", list); 
    env.put("array", array); 
    env.put("mmap", map); 
 
    System.out.println(AviatorEvaluator.execute( 
        "list[0]+list[1]+'/narray[0]+array[1]+array[2]='+(array[0]+array[1]+array[2]) +' /ntoday is '+mmap.date ", env)); 
}  } ä¸‰å…ƒæ“ä½œç¬¦Â¶ Aviatorä¸æä¾›if elseè¯­å¥ï¼Œä½†æ˜¯æä¾›äº†ä¸‰å…ƒæ“ä½œç¬¦?:ç”¨äºæ¡ä»¶åˆ¤æ–­ï¼Œä½¿ç”¨ä¸Šä¸javaæ²¡æœ‰ä»€ä¹ˆä¸åŒï¼š
</code></pre></div></div>

<p>import java.util.HashMap; 
import java.util.Map;</p>

<p>import com.googlecode.aviator.AviatorEvaluator;</p>

<p>public class TernaryOperatorExample { 
    public static void main(String[] args) { 
        if (args.length &lt; 1) { 
            System.err.println(â€œUsage: java TernaryOperatorExample [number]â€); 
            System.exit(1); 
        } 
        int num = Integer.parseInt(args[0]); 
        Map&lt;String, Object&gt; env = new HashMap&lt;String, Object&gt;(); 
        env.put(â€œaâ€, num); 
        String result = (String) AviatorEvaluator.execute(â€œa&gt;0? â€˜yesâ€™:â€™noâ€™â€, env); 
        System.out.println(result); 
    } 
}
è¿™ä¸ªä¾‹å­ç”¨æ¥åˆ¤æ–­ç”¨æˆ·ä¼ å…¥çš„æ•°å­—æ˜¯å¦æ˜¯æ­£æ•´æ•°ï¼Œæ˜¯çš„è¯æ‰“å°yesã€‚</p>

<p>Aviatorçš„ä¸‰å…ƒè¡¨è¾¾å¼å¯¹äºä¸¤ä¸ªåˆ†æ”¯çš„ç»“æœç±»å‹å¹¶ä¸è¦æ±‚ä¸€è‡´ï¼Œå¯ä»¥æ˜¯ä»»ä½•ç±»å‹ï¼Œè¿™ä¸€ç‚¹ä¸javaä¸åŒã€‚</p>

<p>æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…Â¶
Aviatoræ”¯æŒç±»Rubyå’ŒPerlé£æ ¼çš„è¡¨è¾¾å¼åŒ¹é…è¿ç®—ï¼Œé€šè¿‡=~æ“ä½œç¬¦ï¼Œå¦‚ä¸‹é¢è¿™ä¸ªä¾‹å­åŒ¹é…emailå¹¶æå–ç”¨æˆ·åè¿”å›ï¼š</p>

<p>import java.util.HashMap; 
import java.util.Map;</p>

<p>import com.googlecode.aviator.AviatorEvaluator;</p>

<p>public class RegularExpressionExample { 
    public static void main(String[] args) { 
        String email = â€œkillme2008@gmail.comâ€; 
        Map&lt;String, Object&gt; env = new HashMap&lt;String, Object&gt;(); 
        env.put(â€œemailâ€, email); 
        String username = (String) AviatorEvaluator.execute(â€œemail=~/([//w0-8]+@//w+[//.//w+]+)/ ? $1:â€™unknowâ€™â€, env); 
        System.out.println(username); 
    } 
}
emailä¸æ­£åˆ™è¡¨è¾¾å¼//(//w0-8+@//w+//.//w++)/é€šè¿‡=~æ“ä½œç¬¦æ¥åŒ¹é…ï¼Œç»“æœä¸ºä¸€ä¸ªBooleanç±»å‹ï¼Œå› æ­¤å¯ä»¥ç”¨äºä¸‰å…ƒè¡¨è¾¾å¼åˆ¤æ–­ï¼ŒåŒ¹é…æˆåŠŸçš„æ—¶å€™è¿”å›$1ï¼ŒæŒ‡ä»£æ­£åˆ™è¡¨è¾¾å¼çš„åˆ†ç»„1ï¼Œä¹Ÿå°±æ˜¯ç”¨æˆ·åï¼Œå¦åˆ™è¿”å›unknownã€‚è¿™ä¸ªä¾‹å­å°†æ‰“å°killme2008è¿™ä¸ªç”¨æˆ·åã€‚</p>

<p>Aviatoråœ¨è¡¨è¾¾å¼çº§åˆ«æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼ï¼Œé€šè¿‡//æ‹¬èµ·æ¥çš„å­—ç¬¦åºåˆ—æ„æˆä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œæ­£åˆ™è¡¨è¾¾å¼å¯ä»¥ç”¨äºåŒ¹é…ï¼ˆä½œä¸º=~çš„å³æ“ä½œæ•°)ã€æ¯”è¾ƒå¤§å°ï¼ŒåŒ¹é…ä»…èƒ½ä¸å­—ç¬¦ä¸²è¿›è¡ŒåŒ¹é…ã€‚åŒ¹é…æˆåŠŸåï¼ŒAviatorä¼šè‡ªåŠ¨å°†åŒ¹é…æˆåŠŸçš„åˆ†ç»„æ”¾å…¥$numçš„å˜é‡ä¸­ï¼Œå…¶ä¸­$0æŒ‡ä»£æ•´ä¸ªåŒ¹é…çš„å­—ç¬¦ä¸²ï¼Œè€Œ$1è¡¨ç¤ºç¬¬ä¸€ä¸ªåˆ†ç»„ï¼Œä»¥æ­¤ç±»æ¨ã€‚</p>

<p>Aviatorçš„æ­£åˆ™è¡¨è¾¾å¼è§„åˆ™è·ŸJavaå®Œå…¨ä¸€æ ·ï¼Œå› ä¸ºå†…éƒ¨å…¶å®å°±æ˜¯ä½¿ç”¨java.util.regex.Patternåšç¼–è¯‘çš„ã€‚</p>

<p>å˜é‡çš„è¯­æ³•ç³–è¡£Â¶
Aviatoræœ‰ä¸ªæ–¹ä¾¿ç”¨æˆ·ä½¿ç”¨å˜é‡çš„è¯­æ³•ç³–è¡£ï¼Œå½“ä½ è¦è®¿é—®å˜é‡aä¸­çš„æŸä¸ªå±æ€§bï¼Œé‚£ä¹ˆä½ å¯ä»¥é€šè¿‡a.bè®¿é—®åˆ°ï¼Œæ›´è¿›ä¸€æ­¥ï¼Œa.b.cå°†è®¿é—®å˜é‡açš„bå±æ€§ä¸­çš„cå±æ€§å€¼ï¼Œæ¨å¹¿å¼€æ¥ä¹Ÿå°±æ˜¯è¯´Aviatorå¯ä»¥å°†å˜é‡å£°æ˜ä¸ºåµŒå¥—è®¿é—®çš„å½¢å¼ï¼Œä¸€ä¸ªä¾‹å­ï¼ŒFooç±»æœ‰å±æ€§iã€fã€dateï¼š</p>

<p>public class Foo { 
        int i; 
        float f; 
        Date date = new Date();</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    public Foo(int i, float f, Date date) { 
        super(); 
        this.i = i; 
        this.f = f; 
        this.date = date; 
    } 
 
    public int getI() { 
        return i; 
    } 
 
    public void setI(int i) { 
        this.i = i; 
    } 
 
    public float getF() { 
        return f; 
    } 
 
    public void setF(float f) { 
        this.f = f; 
    } 
 
    public Date getDate() { 
        return date; 
    } 
 
    public void setDate(Date date) { 
        this.date = date; 
    } 
} Fooç±»ç¬¦åˆJavaBeanè§„èŒƒï¼Œå¹¶ä¸”æ˜¯publicçš„ï¼Œæˆ‘ä»¬æ‰§è¡Œä¸€ä¸ªè¡¨è¾¾å¼æ¥æè¿°Foo:
</code></pre></div></div>

<p>import java.util.Date; 
import java.util.HashMap; 
import java.util.Map;</p>

<p>import com.googlecode.aviator.AviatorEvaluator;</p>

<p>public class VariableExample { 
    public static void main(String[] args) { 
        Foo foo = new Foo(100, 3.14f, new Date()); 
        Map&lt;String, Object&gt; env = new HashMap&lt;String, Object&gt;(); 
        env.put(â€œfooâ€, foo);</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    String result = 
            (String) AviatorEvaluator.execute( 
                " '[foo i='+ foo.i + ' f='+foo.f+' year='+(foo.date.year+1900)+ ' month='+foo.date.month +']' ", 
                env); 
    System.out.println(result); 
 
}  } ç»†çœ‹ä¸‹è¡¨è¾¾å¼ï¼š
</code></pre></div></div>

<p>â€˜[foo i=â€™+ foo.i + â€˜ f=â€™+foo.f+â€™ year=â€™+(foo.date.year+1900)+ â€˜ month=â€™+foo.date.month +â€™]â€™
å¯ä»¥çœ‹åˆ°æˆ‘ä»¬é€šè¿‡foo.iå’Œfoo.fçš„æ–¹å¼æ¥è®¿é—®fooå˜é‡ä¸­çš„iå’Œfå±æ€§ï¼Œå¹¶ä¸”é€šè¿‡foo.date.yearçš„æ–¹å¼æ¥è®¿é—®fooä¸­dateå¯¹è±¡çš„yearå±æ€§ï¼ˆå…¶å®æ˜¯getYearæ–¹æ³•ï¼‰ã€‚</p>

<p>nilå¯¹è±¡Â¶
nilæ˜¯Aviatorå†…ç½®çš„å¸¸é‡ï¼Œç±»ä¼¼javaä¸­çš„nullï¼Œè¡¨ç¤ºç©ºçš„å€¼ã€‚nilè·Ÿnullä¸åŒçš„åœ¨äºï¼Œåœ¨javaä¸­nullåªèƒ½ä½¿ç”¨åœ¨==ã€!=çš„æ¯”è¾ƒè¿ç®—ç¬¦ï¼Œè€Œnilè¿˜å¯ä»¥ä½¿ç”¨&gt;ã€&gt;=ã€&lt;ã€&lt;=ç­‰æ¯”è¾ƒè¿ç®—ç¬¦ã€‚Aviatorè§„å®šï¼Œä»»ä½•å¯¹è±¡éƒ½æ¯”nilå¤§é™¤äº†nilæœ¬èº«ã€‚ç”¨æˆ·ä¼ å…¥çš„å˜é‡å¦‚æœä¸ºnullï¼Œå°†è‡ªåŠ¨ä»¥nilæ›¿ä»£ã€‚</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    AviatorEvaluator.execute("nil == nil");  //true 
    AviatorEvaluator.execute(" 3&gt; nil");    //true 
    AviatorEvaluator.execute(" true!= nil");    //true 
    AviatorEvaluator.execute(" ' '&gt;nil ");  //true 
    AviatorEvaluator.execute(" a==nil ");   //true,a is null nilä¸Stringç›¸åŠ çš„æ—¶å€™ï¼Œè·Ÿjavaä¸€æ ·æ˜¾ç¤ºä¸ºnull
</code></pre></div></div>

<p>æ—¥æœŸæ¯”è¾ƒÂ¶
Aviatorå¹¶ä¸æ”¯æŒæ—¥æœŸç±»å‹ï¼Œå¦‚æœè¦æ¯”è¾ƒæ—¥æœŸï¼Œä½ éœ€è¦å°†æ—¥æœŸå†™å­—ç¬¦ä¸²çš„å½¢å¼ï¼Œå¹¶ä¸”è¦æ±‚æ˜¯å½¢å¦‚â€yyyy-MM-dd HH:mm:ss:SSâ€çš„å­—ç¬¦ä¸²ï¼Œå¦åˆ™éƒ½å°†æŠ¥é”™ã€‚ å­—ç¬¦ä¸²è·Ÿjava.util.Dateæ¯”è¾ƒçš„æ—¶å€™å°†è‡ªåŠ¨è½¬æ¢ä¸ºDateå¯¹è±¡è¿›è¡Œæ¯”è¾ƒï¼š</p>

<p>import java.text.SimpleDateFormat; 
import java.util.Date; 
import java.util.HashMap; 
import java.util.Map;</p>

<p>import com.googlecode.aviator.AviatorEvaluator;</p>

<p>public class DateExample { 
    public static void main(String[] args) throws Exception { 
        Map&lt;String, Object&gt; env = new HashMap&lt;String, Object&gt;(); 
        final Date date = new Date(); 
        String dateStr = new SimpleDateFormat(â€œyyyy-MM-dd HH:mm:ss:SSâ€).format(date); 
        env.put(â€œdateâ€, date); 
        env.put(â€œdateStrâ€, dateStr);</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    Boolean result = (Boolean) AviatorEvaluator.execute("date==dateStr", env); 
    System.out.println(result); 
 
    result = (Boolean) AviatorEvaluator.execute("date &gt; '2009-12-20 00:00:00:00' ", env); 
    System.out.println(result); 
 
    result = (Boolean) AviatorEvaluator.execute("date &lt; '2200-12-20 00:00:00:00' ", env); 
    System.out.println(result); 
 
    result = (Boolean) AviatorEvaluator.execute("date ==date ", env); 
    System.out.println(result); 
} 
</code></pre></div></div>

<p>}
ä¹Ÿå°±æ˜¯è¯´Stringé™¤äº†èƒ½è·ŸStringæ¯”è¾ƒä¹‹å¤–ï¼Œè¿˜èƒ½è·Ÿnilå’Œdateå­—ç¬¦ä¸²æ¯”è¾ƒã€‚</p>

<p>ä¸¤ç§æ¨¡å¼Â¶
é»˜è®¤AviatorEvaluatorä»¥ç¼–è¯‘é€Ÿåº¦ä¼˜å…ˆï¼š</p>

<p>AviatorEvaluator.setOptimize(AviatorEvaluator.COMPILE);
ä½ å¯ä»¥ä¿®æ”¹ä¸ºè¿è¡Œé€Ÿåº¦ä¼˜å…ˆï¼Œè¿™ä¼šåšæ›´å¤šçš„ç¼–è¯‘ä¼˜åŒ–ï¼š</p>

<p>AviatorEvaluator.setOptimize(AviatorEvaluator.EVAL);
è¯­æ³•æ‰‹å†ŒÂ¶
ä¸‹é¢æ˜¯Aviatorè¯¦ç»†çš„è¯­æ³•è§„åˆ™å®šä¹‰ã€‚</p>

<p>æ•°æ®ç±»å‹Â¶
Numberç±»å‹ï¼šæ•°å­—ç±»å‹ï¼Œæ”¯æŒä¸¤ç§ç±»å‹ï¼Œåˆ†åˆ«å¯¹åº”Javaçš„Longå’ŒDoubleï¼Œä¹Ÿå°±æ˜¯è¯´ä»»ä½•æ•´æ•°éƒ½å°†è¢«è½¬æ¢ä¸ºLongï¼Œè€Œä»»ä½•æµ®ç‚¹æ•°éƒ½å°†è¢«è½¬æ¢ä¸ºDoubleï¼ŒåŒ…æ‹¬ç”¨æˆ·ä¼ å…¥çš„æ•°å€¼ä¹Ÿæ˜¯å¦‚æ­¤è½¬æ¢ã€‚ä¸æ”¯æŒç§‘å­¦è®¡æ•°æ³•ï¼Œä»…æ”¯æŒåè¿›åˆ¶ã€‚å¦‚-1ã€100ã€2.3ç­‰ã€‚
Stringç±»å‹ï¼š å­—ç¬¦ä¸²ç±»å‹ï¼Œå•å¼•å·æˆ–è€…åŒå¼•å·æ‹¬èµ·æ¥çš„æ–‡æœ¬ä¸²ï¼Œå¦‚â€™hello worldâ€™ï¼Œå˜é‡å¦‚æœä¼ å…¥çš„æ˜¯Stringæˆ–è€…Characterä¹Ÿå°†è½¬ä¸ºStringç±»å‹ã€‚
Boolç±»å‹ï¼š å¸¸é‡trueå’Œfalseï¼Œè¡¨ç¤ºçœŸå€¼å’Œå‡å€¼ï¼Œä¸javaçš„Boolean.TRUEå’ŒBoolean.Falseå¯¹åº”ã€‚
Patternç±»å‹ï¼š ç±»ä¼¼Rubyã€perlçš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œä»¥//æ‹¬èµ·æ¥çš„å­—ç¬¦ä¸²ï¼Œå¦‚//d+/ï¼Œå†…éƒ¨å®ç°ä¸ºjava.util.Patternã€‚
å˜é‡ç±»å‹ï¼š ä¸Javaçš„å˜é‡å‘½åè§„åˆ™ç›¸åŒï¼Œå˜é‡çš„å€¼ç”±ç”¨æˆ·ä¼ å…¥ï¼Œå¦‚â€aâ€ã€â€bâ€ç­‰
nilç±»å‹: å¸¸é‡nil,ç±»ä¼¼javaä¸­çš„nullï¼Œä½†æ˜¯nilæ¯”è¾ƒç‰¹æ®Šï¼Œnilä¸ä»…å¯ä»¥å‚ä¸==ã€!=çš„æ¯”è¾ƒï¼Œä¹Ÿå¯ä»¥å‚ä¸&gt;ã€&gt;=ã€&lt;ã€&lt;=çš„æ¯”è¾ƒï¼ŒAviatorè§„å®šä»»ä½•ç±»å‹éƒ½nå¤§äºnilé™¤äº†nilæœ¬èº«ï¼Œnil==nilè¿”å›trueã€‚ç”¨æˆ·ä¼ å…¥çš„å˜é‡å€¼å¦‚æœä¸ºnullï¼Œé‚£ä¹ˆä¹Ÿå°†ä½œä¸ºnilå¤„ç†ï¼Œnilæ‰“å°ä¸ºnullã€‚
æ“ä½œç¬¦Â¶
ç®—æœ¯è¿ç®—ç¬¦Â¶
Aviatoræ”¯æŒå¸¸è§çš„ç®—æœ¯è¿ç®—ç¬¦ï¼ŒåŒ…æ‹¬+ - * / % äº”ä¸ªäºŒå…ƒè¿ç®—ç¬¦ï¼Œå’Œä¸€å…ƒè¿ç®—ç¬¦â€-â€œã€‚å…¶ä¸­ - * / %å’Œä¸€å…ƒçš„â€-â€œä»…èƒ½ä½œç”¨äºNumberç±»å‹ã€‚</p>

<p>â€+â€ä¸ä»…èƒ½ç”¨äºNumberç±»å‹ï¼Œè¿˜å¯ä»¥ç”¨äºStringçš„ç›¸åŠ ï¼Œæˆ–è€…å­—ç¬¦ä¸²ä¸å…¶ä»–å¯¹è±¡çš„ç›¸åŠ ã€‚Aviatorè§„å®šï¼Œä»»ä½•ç±»å‹ä¸Stringç›¸åŠ ï¼Œç»“æœä¸ºStringã€‚</p>

<p>é€»è¾‘è¿ç®—ç¬¦Â¶
Avaitorçš„æ”¯æŒçš„é€»è¾‘è¿ç®—ç¬¦åŒ…æ‹¬ï¼Œä¸€å…ƒå¦å®šè¿ç®—ç¬¦â€!â€ï¼Œä»¥åŠé€»è¾‘ä¸çš„â€&amp;&amp;â€ï¼Œé€»è¾‘æˆ–çš„â€||â€ã€‚é€»è¾‘è¿ç®—ç¬¦çš„æ“ä½œæ•°åªèƒ½ä¸ºBooleanã€‚</p>

<p>å…³ç³»è¿ç®—ç¬¦Â¶
Aviatoræ”¯æŒçš„å…³ç³»è¿ç®—ç¬¦åŒ…æ‹¬â€&lt;â€ â€œ&lt;=â€ â€œ&gt;â€ â€œ&gt;=â€ ä»¥åŠâ€==â€å’Œâ€!=â€ ã€‚</p>

<table>
  <tbody>
    <tr>
      <td>&amp;&amp;å’Œ</td>
      <td>Â </td>
      <td>éƒ½æ‰§è¡ŒçŸ­è·¯è§„åˆ™ã€‚</td>
    </tr>
  </tbody>
</table>

<p>å…³ç³»è¿ç®—ç¬¦å¯ä»¥ä½œç”¨äºNumberä¹‹é—´ã€Stringä¹‹é—´ã€Patternä¹‹é—´ã€Booleanä¹‹é—´ã€å˜é‡ä¹‹é—´ä»¥åŠå…¶ä»–ç±»å‹ä¸nilä¹‹é—´çš„å…³ç³»æ¯”è¾ƒï¼Œä¸åŒç±»å‹é™¤äº†nilä¹‹å¤–ä¸èƒ½ç›¸äº’æ¯”è¾ƒã€‚</p>

<p>Aviatorè§„å®šä»»ä½•å¯¹è±¡éƒ½æ¯”nilå¤§é™¤äº†nilä¹‹å¤–ã€‚</p>

<p>åŒ¹é…è¿ç®—ç¬¦Â¶
åŒ¹é…è¿ç®—ç¬¦â€=~â€ç”¨äºStringå’ŒPatternçš„åŒ¹é…ï¼Œå®ƒçš„å·¦æ“ä½œæ•°å¿…é¡»ä¸ºStringï¼Œå³æ“ä½œæ•°å¿…é¡»ä¸ºPatternã€‚åŒ¹é…æˆåŠŸåï¼ŒPatternçš„åˆ†ç»„å°†å­˜äºå˜é‡$numï¼Œnumä¸ºåˆ†ç»„ç´¢å¼•ã€‚</p>

<p>ä¸‰å…ƒè¿ç®—ç¬¦Â¶
Aviatoræ²¡æœ‰æä¾›if elseè¯­å¥ï¼Œä½†æ˜¯æä¾›äº†ä¸‰å…ƒè¿ç®—ç¬¦ â€œ?:â€ï¼Œå½¢å¼ä¸º bool ? exp1: exp2ã€‚ å…¶ä¸­boolå¿…é¡»ä¸ºç»“æœä¸ºBooleanç±»å‹çš„è¡¨è¾¾å¼ï¼Œè€Œexp1å’Œexp2å¯ä»¥ä¸ºä»»ä½•åˆæ³•çš„Aviatorè¡¨è¾¾å¼ï¼Œå¹¶ä¸”ä¸è¦æ±‚exp1å’Œexp2è¿”å›çš„ç»“æœç±»å‹ä¸€è‡´ã€‚</p>

<p>æ“ä½œç¬¦åˆ—è¡¨Â¶
Aviatoræ”¯æŒæ“ä½œç¬¦çš„ä¼˜å…ˆçº§ï¼Œå¹¶ä¸”å…è®¸é€šè¿‡æ‹¬å·æ¥å¼ºåˆ¶ä¼˜å…ˆçº§ï¼Œä¸‹é¢æ˜¯å®Œæ•´çš„æ“ä½œç¬¦åˆ—è¡¨ï¼ŒæŒ‰ç…§ä¼˜å…ˆçº§ä»é«˜åˆ°ä½çš„é¡ºåºæ’åˆ—ï¼š</p>

<p>åºå·	æ“ä½œç¬¦	ç»“åˆæ€§	æ“ä½œæ•°é™åˆ¶
0	() [ ]	ä»å·¦åˆ°å³	()ç”¨äºå‡½æ•°è°ƒç”¨ï¼Œ[ ]ç”¨äºæ•°ç»„å’Œjava.util.Listçš„å…ƒç´ è®¿é—®ï¼Œè¦æ±‚[indx]ä¸­çš„indexå¿…é¡»ä¸ºæ•´å‹
1	! -	ä»å³åˆ°å·¦	! èƒ½ç”¨äºBoolean,- ä»…èƒ½ç”¨äºNumber
2	* / %	ä»å·¦åˆ°å³	Numberä¹‹é—´
3	+ -	ä»å·¦åˆ°å³	+ - éƒ½èƒ½ç”¨äºNumberä¹‹é—´, + è¿˜èƒ½ç”¨äºStringä¹‹é—´ï¼Œæˆ–è€…Stringå’Œå…¶ä»–å¯¹è±¡
4	&lt; &lt;= &gt; &gt;=	ä»å·¦åˆ°å³	Numberä¹‹é—´ã€Stringä¹‹é—´ã€Patternä¹‹é—´ã€å˜é‡ä¹‹é—´ã€å…¶ä»–ç±»å‹ä¸nilä¹‹é—´
5	== != =~	ä»å·¦åˆ°å³	==å’Œ!=ä½œç”¨äºNumberä¹‹é—´ã€Stringä¹‹é—´ã€Patternä¹‹é—´ã€å˜é‡ä¹‹é—´ã€å…¶ä»–ç±»å‹ä¸nilä¹‹é—´ä»¥åŠStringå’Œjava.util.Dateä¹‹é—´ï¼Œ=~ä»…èƒ½ä½œç”¨äºStringå’ŒPatternä¹‹é—´
6	&amp;&amp;	ä»å·¦åˆ°å³	Booleanä¹‹é—´ï¼ŒçŸ­è·¯
7	||	ä»å·¦åˆ°å³	Booleanä¹‹é—´ï¼ŒçŸ­è·¯
8	? :	ä»å³åˆ°å·¦	ç¬¬ä¸€ä¸ªæ“ä½œæ•°çš„ç»“æœå¿…é¡»ä¸ºBooleanï¼Œç¬¬äºŒå’Œç¬¬ä¸‰æ“ä½œæ•°ç»“æœæ— é™åˆ¶</p>

<p>ç±»å‹è½¬æ¢è§„åˆ™Â¶
Javaçš„byte short int longéƒ½è½¬åŒ–ä¸ºLongç±»å‹ï¼ŒJavaçš„float,doubleéƒ½å°†è½¬åŒ–ä¸ºDoubleç±»å‹ã€‚Javaçš„char Stringéƒ½å°†è½¬åŒ–ä¸ºStringã€‚Javaçš„nulléƒ½å°†è½¬ä¸ºnilã€‚
å½“ä¸¤ä¸ªæ“ä½œç¬¦éƒ½æ˜¯Doubleæˆ–è€…éƒ½æ˜¯Longçš„æ—¶å€™ï¼Œå„è‡ªæŒ‰ç…§Doubleæˆ–è€…Longçš„ç±»å‹æ‰§è¡Œ
å½“ä¸¤ä¸ªæ“ä½œç¬¦ä¸­æŸä¸€ä¸ªæ˜¯Doubleçš„æ—¶å€™ï¼Œå¦ä¸€ä¸ªæ“ä½œæ•°ä¹Ÿå°†è½¬æ¢æˆDoubleï¼ŒæŒ‰ç…§Doubleç±»å‹æ‰§è¡Œã€‚
ä»»ä½•ç±»å‹ä¸Stringç›¸åŠ ï¼Œç»“æœä¸ºString
ä»»ä½•ç±»å‹éƒ½æ¯”nilå¤§ï¼Œé™¤äº†nilæœ¬èº«ã€‚
nilåœ¨æ‰“å°æˆ–è€…ä¸å­—ç¬¦ä¸²ç›¸åŠ çš„æ—¶å€™ï¼Œæ˜¾ç¤ºä¸ºnull
å½¢å¦‚â€yyyy-MM-dd HH:mm:ss:SSâ€çš„å­—ç¬¦ä¸²ï¼Œåœ¨ä¸java.util.Dateåšæ¯”è¾ƒçš„æ—¶å€™å°†å°è¯•è½¬æ¢æˆjava.util.Dateå¯¹è±¡æ¯”è¾ƒã€‚</p>

<p>æ²¡æœ‰è§„å®šçš„ç±»å‹è½¬æ¢æ“ä½œï¼Œé™¤äº†æœªçŸ¥çš„å˜é‡ç±»å‹ä¹‹é—´ï¼Œéƒ½å°†æŠ›å‡ºå¼‚å¸¸ã€‚</p>

<p>å¸¸é‡å’Œå˜é‡Â¶</p>

<p>true	çœŸå€¼
false	å‡å€¼
nil	ç©ºå€¼
$digit	æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…æˆåŠŸåçš„åˆ†ç»„ï¼Œ$0è¡¨ç¤ºåŒ¹é…çš„å­—ç¬¦ä¸²ï¼Œ$1è¡¨ç¤ºç¬¬ä¸€ä¸ªåˆ†ç»„ etc.</p>

<p>å†…ç½®å‡½æ•°Â¶</p>

<p>å‡½æ•°åç§°	è¯´æ˜
sysdate()	è¿”å›å½“å‰æ—¥æœŸå¯¹è±¡java.util.Date
rand()	è¿”å›ä¸€ä¸ªä»‹äº0-1çš„éšæœºæ•°ï¼Œdoubleç±»å‹
print([out],obj)	æ‰“å°å¯¹è±¡ï¼Œå¦‚æœæŒ‡å®šoutï¼Œå‘outæ‰“å°ï¼Œå¦åˆ™è¾“å‡ºåˆ°æ§åˆ¶å°
println([out],obj)	ä¸printç±»ä¼¼ï¼Œä½†æ˜¯åœ¨è¾“å‡ºåæ¢è¡Œ
now()	è¿”å›System.currentTimeMillis
string.contains(s1,s2)	åˆ¤æ–­s1æ˜¯å¦åŒ…å«s2ï¼Œè¿”å›Boolean
string.length(s)	æ±‚å­—ç¬¦ä¸²é•¿åº¦,è¿”å›Long
string.startsWith(s1,s2)	s1æ˜¯å¦ä»¥s2å¼€å§‹ï¼Œè¿”å›Boolean
string.endsWith(s1,s2)	s1æ˜¯å¦ä»¥s2ç»“å°¾,è¿”å›Boolean
string.substring(s,begin[,end])	æˆªå–å­—ç¬¦ä¸²sï¼Œä»beginåˆ°endï¼Œendå¦‚æœå¿½ç•¥çš„è¯ï¼Œå°†ä»beginåˆ°ç»“å°¾ï¼Œä¸java.util.String.substringä¸€æ ·ã€‚
math.abs(d)	æ±‚dçš„ç»å¯¹å€¼
math.sqrt(d)	æ±‚dçš„å¹³æ–¹æ ¹
math.pow(d1,d2)	æ±‚d1çš„d2æ¬¡æ–¹
math.log(d)	æ±‚dçš„è‡ªç„¶å¯¹æ•°
math.log10(d)	æ±‚dä»¥10ä¸ºåº•çš„å¯¹æ•°
math.sin(d)	æ­£å¼¦å‡½æ•°
math.cos(d)	ä½™å¼¦å‡½æ•°
math.tan(d)	æ­£åˆ‡å‡½æ•°
map(seq,fun)	å°†å‡½æ•°funä½œç”¨åˆ°é›†åˆseqæ¯ä¸ªå…ƒç´ ä¸Šï¼Œè¿”å›æ–°å…ƒç´ ç»„æˆçš„é›†åˆ
filter(seq,predicate)	å°†è°“è¯predicateä½œç”¨åœ¨é›†åˆçš„æ¯ä¸ªå…ƒç´ ä¸Šï¼Œè¿”å›è°“è¯ä¸ºtrueçš„å…ƒç´ ç»„æˆçš„é›†åˆ
count(seq)	è¿”å›é›†åˆå¤§å°
include(seq,element)	åˆ¤æ–­elementæ˜¯å¦åœ¨é›†åˆseqä¸­ï¼Œè¿”å›booleanå€¼
sort(seq)	æ’åºé›†åˆï¼Œä»…å¯¹æ•°ç»„å’ŒListæœ‰æ•ˆï¼Œè¿”å›æ’åºåçš„æ–°é›†åˆ
reduce(seq,fun,init)	funæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯é›†åˆå…ƒç´ ï¼Œç¬¬äºŒä¸ªæ˜¯ç´¯ç§¯çš„initï¼Œæœ¬å‡½æ•°ç”¨äºå°†funä½œç”¨åœ¨é›†åˆæ¯ä¸ªå…ƒç´ å’Œåˆå§‹å€¼ä¸Šé¢ï¼Œè¿”å›æœ€ç»ˆçš„initå€¼
seq.eq(value)	è¿”å›ä¸€ä¸ªè°“è¯ï¼Œç”¨æ¥åˆ¤æ–­ä¼ å…¥çš„å‚æ•°æ˜¯å¦è·Ÿvalueç›¸ç­‰,ç”¨äºfilterå‡½æ•°ï¼Œå¦‚filter(seq,seq.eq(3)) è¿‡æ»¤è¿”å›ç­‰äº3çš„å…ƒç´ ç»„æˆçš„é›†åˆ
seq.neq(value)	ä¸seq.eqç±»ä¼¼ï¼Œè¿”å›åˆ¤æ–­ä¸ç­‰äºçš„è°“è¯
seq.gt(value)	è¿”å›åˆ¤æ–­å¤§äºvalueçš„è°“è¯
seq.ge(value)	è¿”å›åˆ¤æ–­å¤§äºç­‰äºvalueçš„è°“è¯
seq.lt(value)	è¿”å›åˆ¤æ–­å°äºvalueçš„è°“è¯
seq.le(value)	è¿”å›åˆ¤æ–­å°äºç­‰äºvalueçš„è°“è¯
seq.nil()	è¿”å›åˆ¤æ–­æ˜¯å¦ä¸ºnilçš„è°“è¯
seq.exists()	è¿”å›åˆ¤æ–­ä¸ä¸ºnilçš„è°“è¯</p>

<p>æ•°å­—æ”¯æŒç§‘å­¦è®¡æ•°æ³•ï¼Œå¦‚2e10,3e-3ç­‰ï¼Œå¤§å°å†™eçš†å¯ã€‚
æ”¯æŒå¤§æ•´æ•°è¿ç®—ï¼Œä»»æ„ä»¥å¤§å†™å­—æ¯Nç»“å°¾æˆ–è€…è¶…è¿‡longèŒƒå›´çš„æ•´æ•°éƒ½å°†è¢«è§£æä¸ºjava.math.BigIntegerå¹¶è¿›è¡Œç®—æœ¯ç­‰è¿ç®—ï¼Œå¦‚1N,999999999999999999999ç­‰ã€‚
æ”¯æŒé«˜ç²¾åº¦è¿ç®—ï¼Œä»»æ„ä»¥å¤§å†™å­—æ¯Mç»“å°¾çš„æ•°å­—éƒ½å°†è¢«è§£æä¸ºjava.math.BigDecimalç±»å‹å¹¶è¿›è¡Œç®—æœ¯ç­‰è¿ç®—ï¼Œå¦‚1.1M,3.5Mç­‰ã€‚
æ›´æ–°mathåº“æ”¯æŒè¿™ä¸¤ç§æ–°æ•°å­—ç±»å‹ã€‚
æ›´æ–°ç”¨æˆ·æŒ‡å—ï¼Œæ·»åŠ å¤§æ•°è¿ç®—å’Œç²¾åº¦è¿ç®—ä¸€èŠ‚ã€‚
AviatorEvaluatoræ–°å¢API:setMathContext(java.math.MathContext) 
ç”¨äºè®¾ç½®decimalç±»å‹çš„è¿ç®—ç²¾åº¦ã€‚
Maven æ”¯æŒï¼š</p>

<dependency>  
       <groupId>com.googlecode.aviator</groupId>  
       <artifactId>aviator</artifactId>  
       <version>2.3.0</version>  
  </dependency>

<p>Aviatoræ˜¯ä¸€ä¸ªé«˜æ€§èƒ½ã€è½»é‡çº§çš„javaè¯­è¨€å®ç°çš„è¡¨è¾¾å¼æ±‚å€¼å¼•æ“ï¼Œä¸»è¦ç”¨äºå„ç§è¡¨è¾¾å¼çš„åŠ¨æ€æ±‚å€¼ã€‚
Aviatorçš„è®¾è®¡ç›®æ ‡æ˜¯è½»é‡çº§å’Œé«˜æ€§èƒ½ ï¼Œç›¸æ¯”äºGroovyã€JRubyçš„ç¬¨é‡ï¼ŒAviatoréå¸¸å°ï¼ŒåŠ ä¸Šä¾èµ–åŒ…ä¹Ÿæ‰450K,ä¸ç®—ä¾èµ–åŒ…çš„è¯åªæœ‰70Kï¼›å½“ç„¶ï¼ŒAviatorçš„è¯­æ³•æ˜¯å—é™çš„ï¼Œå®ƒä¸æ˜¯ä¸€é—¨å®Œæ•´çš„è¯­è¨€ï¼Œè€Œåªæ˜¯è¯­è¨€çš„ä¸€å°éƒ¨åˆ†é›†åˆã€‚
å…¶æ¬¡ï¼ŒAviatorçš„å®ç°æ€è·¯ä¸å…¶ä»–è½»é‡çº§çš„æ±‚å€¼å™¨å¾ˆä¸ç›¸åŒï¼Œå…¶ä»–æ±‚å€¼å™¨ä¸€èˆ¬éƒ½æ˜¯é€šè¿‡è§£é‡Šçš„æ–¹å¼è¿è¡Œï¼Œè€ŒAviatoråˆ™æ˜¯ç›´æ¥å°†è¡¨è¾¾å¼ç¼–è¯‘æˆJavaå­—èŠ‚ç ï¼Œäº¤ç»™JVMå»æ‰§è¡Œã€‚ç®€å•æ¥è¯´ï¼ŒAviatorçš„å®šä½æ˜¯ä»‹äºGroovyè¿™æ ·çš„é‡é‡çº§è„šæœ¬è¯­è¨€å’ŒIKExpressionè¿™æ ·çš„è½»é‡çº§è¡¨è¾¾å¼å¼•æ“ä¹‹é—´ã€‚
ç‰¹æ€§
Aviatorçš„ç‰¹æ€§</p>

<p>æ”¯æŒå¤§éƒ¨åˆ†è¿ç®—æ“ä½œç¬¦ï¼ŒåŒ…æ‹¬ç®—æœ¯æ“ä½œç¬¦ã€å…³ç³»è¿ç®—ç¬¦ã€é€»è¾‘æ“ä½œç¬¦ã€æ­£åˆ™åŒ¹é…æ“ä½œç¬¦(=~)ã€ä¸‰å…ƒè¡¨è¾¾å¼?: ï¼Œå¹¶ä¸”æ”¯æŒæ“ä½œç¬¦çš„ä¼˜å…ˆçº§å’Œæ‹¬å·å¼ºåˆ¶ä¼˜å…ˆçº§ï¼Œå…·ä½“è¯·çœ‹åé¢çš„æ“ä½œç¬¦åˆ—è¡¨ã€‚</p>

<p>æ”¯æŒå‡½æ•°è°ƒç”¨å’Œè‡ªå®šä¹‰å‡½æ•°</p>

<p>æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ï¼Œç±»ä¼¼Rubyã€Perlçš„åŒ¹é…è¯­æ³•ï¼Œå¹¶ä¸”æ”¯æŒç±»Rubyçš„$digitæŒ‡å‘åŒ¹é…åˆ†ç»„ã€‚</p>

<p>è‡ªåŠ¨ç±»å‹è½¬æ¢ï¼Œå½“æ‰§è¡Œæ“ä½œçš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨åˆ¤æ–­æ“ä½œæ•°ç±»å‹å¹¶åšç›¸åº”è½¬æ¢ï¼Œæ— æ³•è½¬æ¢å³æŠ›å¼‚å¸¸ã€‚</p>

<p>æ”¯æŒä¼ å…¥å˜é‡ï¼Œæ”¯æŒç±»ä¼¼a.b.cçš„åµŒå¥—å˜é‡è®¿é—®ã€‚</p>

<p>æ€§èƒ½ä¼˜ç§€
Aviatorçš„é™åˆ¶ï¼š</p>

<p>æ²¡æœ‰if elseã€do whileç­‰è¯­å¥ï¼Œæ²¡æœ‰èµ‹å€¼è¯­å¥ï¼Œä»…æ”¯æŒé€»è¾‘è¡¨è¾¾å¼ã€ç®—æœ¯è¡¨è¾¾å¼ã€ä¸‰å…ƒè¡¨è¾¾å¼å’Œæ­£åˆ™åŒ¹é…ã€‚</p>

<p>æ²¡æœ‰ä½è¿ç®—ç¬¦ æ–‡æ¡£åœ°å€ï¼šhttp://www.slideshare.net/killme2008/aviator</p>

<p>ä¸‹è½½ï¼šhttps://code.google.com/p/aviator/downloads/list</p>

<p>é¡¹ç›®ä¸»é¡µï¼š https://code.google.com/p/aviator/</p>

<p>ç”¨æˆ·æŒ‡å—ï¼šhttps://code.google.com/p/aviator/wiki/User_Guide_zh</p>
:ET