<!DOCTYPE html>
<html>

  <head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Sci blog jekyll theme">
    <meta name="author" content="AIR RAYA Group">
    <link href='/MyBlog/img/favicon.ico' type='image/icon' rel='shortcut icon'/>

    <title>泽民博客 | Jekyll theme</title>

    <link rel="stylesheet" href="/MyBlog/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
    <link rel="stylesheet" href="/MyBlog/css/font-awesome.min.css">
    <link href="/MyBlog/css/simple-sidebar.css" rel="stylesheet">
	<link href="/MyBlog/css/classic-10_7.css" rel="stylesheet" type="text/css">
    <!-- Custom CSS -->
    <link href="/MyBlog/css/style.css" rel="stylesheet">
    <link href="/MyBlog/css/pygments.css" rel="stylesheet">
    <!-- Fonts -->
 <link href="/MyBlog/css/front.css" rel="stylesheet" type="text/css">
 <link href="/MyBlog/css/Josefin_Slab.css" rel="stylesheet" type="text/css">
<link href="/MyBlog/css/Architects_Daughter.css" rel="stylesheet" type="text/css">
<link href="/MyBlog/css/Schoolbell.css" rel="stylesheet" type="text/css">
<link href="/MyBlog/css/Codystar.css" rel="stylesheet" type="text/css">

 <script type="text/javascript" src="/MyBlog/js/jquery-1.12.0.min.js"></script>	

<link href="/MyBlog/css/calendar/common.css" type="text/css"  rel="stylesheet">
<script type="text/javascript" src="/MyBlog/js/calendar/calendar.js"></script>
	<!-- share this -->
	<script type="text/javascript">var switchTo5x=true;</script>
	<script type="text/javascript" src="/MyBlog/js/buttons.js"></script>
	<script type="text/javascript">stLight.options({publisher: "b28464c3-d287-4257-ad18-058346dd35f7", doNotHash: false, doNotCopy: false, hashAddressBar: false});</script>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="/MyBlog/js/html5shiv.js"></script>
        <script src="/MyBlog/js/respond.min.js"></script>
    <![endif]-->
   
   <!--百度统计-->
    <script>
    var _hmt = _hmt || [];
    (function() {
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?e965cab8c73512b8b23939e7051d93bd";
    var s = document.getElementsByTagName("script")[0]; 
    s.parentNode.insertBefore(hm, s);
    })();
    </script>
    <script async src="/MyBlog/katex/katex.js"></script>
    <link rel="stylesheet" href="/MyBlog/katex/katex.css">

    <!--轮播图片-->
    <!--script type="text/javascript" src="https://xiazemin.github.io/MyBlog/js/jquery.js"></script>
    <script type="text/javascript" src="https://xiazemin.github.io/MyBlog/js/jquery.stripesrotator.js"></script>
    <script type="text/javascript">
                    $(document).ready(function() {
                    alert($('#rotator_xzm'));
                     alert($('#rotator_xzm').fn);
                    $('#rotator_xzm').stripesRotator({ images: [ "https://xiazemin.github.io/MyBlog/img/BPlusTree.png", "https://xiazemin.github.io/MyBlog/img/linuxMMap.jpeg"] });
                    });
    </script-->

    <!--水印-->
    <script type="text/javascript" src="/MyBlog/js/waterMark.js"></script>
    <script type="text/javascript">
    $(document).ready(function(){
    watermark({watermark_txt0:'泽民博客',watermark_txt1:'zemin',watermark_txt2:(new Date()).Format("yyyy-MM-dd hh:mm:ss.S")});
    })
    </script>
     <!--水印-->
     <!--adscene-->
    <script data-ad-client="ca-pub-6672721494777557" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

</head>

 <body>
<div id="wrapper">
 <!-- Navigation -->
    <!-- Sidebar -->
        <div id="sidebar-wrapper">
            <ul class="sidebar-nav">
                <li class="sidebar-brand">
                    <a href="/MyBlog">
                        Home
                    </a>
                </li>
                <li>
                    <a href="#">About</a>
                </li>
                <li>
                    <a href="#">Services</a>
                </li>
                <li>
                    <a href="#">Portfolio</a>
                </li>
                <li>
                    <a href="#">Events</a>
                </li>
                <li>
                    <a href="#">Blog</a>
                </li>
                <li>
                    <a href="#">FAQ</a>
                </li>
                <li>
                    <a href="#">Contact</a>
                </li>
            </ul>
        </div>


    <header class="intro-header">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <div class="heading text-center">
                        <a href="https://xiazemin.github.io/MyBlog/" style="color: #fff; font-size: 4em; font-family: 'Schoolbell', cursive;">泽民博客</a>
                        <a href="#menu-toggle" class="btn btn-default sciblog" id="menu-toggle" style="font-weight: bold;">&#9776; Menu</a>
                    </div>
                </div>
            </div>
        </div>
    </header>

     <script async src="/MyBlog/js/busuanzi.pure.mini.js"></script>

    <script type="text/javascript" src="/MyBlog/js/jquery.js"></script>
    <script type="text/javascript" src="/MyBlog/js/jquery.stripesrotator.js"></script>


 <div class="container">
	<div class="row">
        <div class="box">
                <div class="col-lg-12">
                    <div class="intro-text text-center">
					<h1 class="post-title" itemprop="name headline">compile link</h1>
					<p class="post-meta"> <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">by 夏泽民</span></span> <time datetime="2019-07-21T00:00:00+08:00" itemprop="datePublished"><i class="fa fa-calendar"></i> Jul 21, 2019</time></p>
					</div>
					 <p>go build<br />
-gcflags: 传递给编译器的参数</p><br />
<br />
<p>-ldflags: 传递给链接器的参数</p><br />
<br />
<p>-work: 查看编译临时目录</p><br />
<br />
<p>-race: 允许数据竞争检测(仅支持amd64)</p><br />
<br />
<p>-n: 查看但不执行编译指令</p><br />
<br />
<p>-x: 查看并执行编译命令</p><br />
<br />
<p>-a: 强制重新编译所有依赖包</p><br />
<br />
<p>-v: 查看被编译的包名，包括依赖包</p><br />
<br />
<p>-p n:并行编译所使用的CPU数，默认为全部</p><br />
<br />
<p>-o:输出文件名</p><br />
<br />
<p>gcflags:</p><br />
<br />
<p>-B 禁用边界检查</p><br />
<br />
<p>-N 禁用优化</p><br />
<br />
<p>-l 禁用函数内联</p><br />
<br />
<p>-u 禁用unsafe代码</p><br />
<br />
<p>-m 输出优化信息</p><br />
<br />
<p>-S 输出汇编代码</p><br />
<br />
<p>ldflags:</p><br />
<br />
<p>-w 禁用DRAWF调试信息，但不包括符号表</p><br />
<br />
<p>-s 禁用符号表</p><br />
<br />
<p>-X 修改字符串符号值  -X main.VER ‘0.99’  -X main.S ‘abc’</p><br />
<br />
<p>-H 链接文件类型，其中包括windowsgui.   cmd/ld/doc.go<br />
<!-- more --><br />
$ go build -x cal/cal.go<br /><br />
看到输出的编译链接详细过程：<br />
WORK=/var/folders/r9/35q9g3d56_d9g0v59w9x2l9w0000gn/T/go-build742754584<br />
mkdir -p $WORK/github.com/xiazemin/gocompiler/cal/token/_obj/<br />
mkdir -p $WORK/github.com/xiazemin/gocompiler/cal/<br />
cd /Users/didi/goLang/src/github.com/xiazemin/gocompiler/cal/token<br />
/usr/local/go/pkg/tool/darwin_amd64/compile -o $WORK/github.com/xiazemin/gocompiler/cal/token.a -trimpath $WORK -goversion go1.9.2 -p github.com/xiazemin/gocompiler/cal/token -complete -buildid 818f9d05a7ef841770191e9e6dcde887edc2e57d -D _/Users/didi/goLang/src/github.com/xiazemin/gocompiler/cal/token -I $WORK -pack ./token.go<br />
mkdir -p $WORK/github.com/xiazemin/gocompiler/cal/lexer/_obj/<br />
cd /Users/didi/goLang/src/github.com/xiazemin/gocompiler/cal/lexer<br />
/usr/local/go/pkg/tool/darwin_amd64/compile -o $WORK/github.com/xiazemin/gocompiler/cal/lexer.a -trimpath $WORK -goversion go1.9.2 -p github.com/xiazemin/gocompiler/cal/lexer -complete -buildid e360f0a5c7b69033acc446663e32a2b662f3fbae -D _/Users/didi/goLang/src/github.com/xiazemin/gocompiler/cal/lexer -I $WORK -I /Users/didi/goLang/pkg/darwin_amd64 -pack ./lex.go<br />
mkdir -p $WORK/github.com/xiazemin/gocompiler/cal/syntax/_obj/<br />
cd /Users/didi/goLang/src/github.com/xiazemin/gocompiler/cal/syntax<br />
/usr/local/go/pkg/tool/darwin_amd64/compile -o $WORK/github.com/xiazemin/gocompiler/cal/syntax.a -trimpath $WORK -goversion go1.9.2 -p github.com/xiazemin/gocompiler/cal/syntax -complete -buildid 0b0315d6be705c9851f978c4cc4c6a286fba491e -D _/Users/didi/goLang/src/github.com/xiazemin/gocompiler/cal/syntax -I $WORK -I /Users/didi/goLang/pkg/darwin_amd64 -pack ./parser.go ./preference.go ./syntax.go<br />
mkdir -p $WORK/command-line-arguments/_obj/<br />
mkdir -p $WORK/command-line-arguments/_obj/exe/<br />
cd /Users/didi/goLang/src/github.com/xiazemin/gocompiler/cal<br />
/usr/local/go/pkg/tool/darwin_amd64/compile -o $WORK/command-line-arguments.a -trimpath $WORK -goversion go1.9.2 -p main -complete -buildid b38705aafc4497f1a7a755e4048b8a0e9dd073a4 -D _/Users/didi/goLang/src/github.com/xiazemin/gocompiler/cal -I $WORK -I /Users/didi/goLang/pkg/darwin_amd64 -pack ./cal.go<br />
cd .<br />
/usr/local/go/pkg/tool/darwin_amd64/link -o $WORK/command-line-arguments/_obj/exe/a.out -L $WORK -L /Users/didi/goLang/pkg/darwin_amd64 -extld=clang -buildmode=exe -buildid=b38705aafc4497f1a7a755e4048b8a0e9dd073a4 $WORK/command-line-arguments.a<br />
cp $WORK/command-line-arguments/_obj/exe/a.out cal<br />
go install command-line-arguments: build output “cal” already exists and is a directory</p><br />
<br />
<p>忽略路径相关操作，可以看到有下面几步<br />
1，compile -o cal/token.a -trimpath $WORK -goversion go1.9.2 -p github.com/xiazemin/gocompiler/cal/token -complete -buildid 818f9d05a7ef841770191e9e6dcde887edc2e57d -D _/Users/didi/goLang/src/github.com/xiazemin/gocompiler/cal/token -I $WORK -pack ./token.go</p><br />
<br />
<p>2，compile -o cal/lexer.a -trimpath $WORK -goversion go1.9.2 -p github.com/xiazemin/gocompiler/cal/lexer -complete -buildid e360f0a5c7b69033acc446663e32a2b662f3fbae -D _/Users/didi/goLang/src/github.com/xiazemin/gocompiler/cal/lexer -I $WORK -I /Users/didi/goLang/pkg/darwin_amd64 -pack ./lex.go</p><br />
<br />
<p>3，compile -o $WORK/github.com/xiazemin/gocompiler/cal/syntax.a -trimpath $WORK -goversion go1.9.2 -p github.com/xiazemin/gocompiler/cal/syntax -complete -buildid 0b0315d6be705c9851f978c4cc4c6a286fba491e -D _/Users/didi/goLang/src/github.com/xiazemin/gocompiler/cal/syntax -I $WORK -I /Users/didi/goLang/pkg/darwin_amd64 -pack ./parser.go ./preference.go ./syntax.go</p><br />
<br />
<p>4，compile -o $WORK/command-line-arguments.a -trimpath $WORK -goversion go1.9.2 -p main -complete -buildid b38705aafc4497f1a7a755e4048b8a0e9dd073a4 -D _/Users/didi/goLang/src/github.com/xiazemin/gocompiler/cal -I $WORK -I /Users/didi/goLang/pkg/darwin_amd64 -pack ./cal.go</p><br />
<br />
<p>5，link -o $WORK/command-line-arguments/_obj/exe/a.out -L $WORK -L /Users/didi/goLang/pkg/darwin_amd64 -extld=clang -buildmode=exe -buildid=b38705aafc4497f1a7a755e4048b8a0e9dd073a4 $WORK/command-line-arguments.a</p><br />
<br />
<p>6，go install command-line-arguments: build output</p><br />
<br />
<p>先根据import 依次编译各个package，然后链接生成目标文件，最后goinsall</p><br />
<br />
<p>$ go tool 可以看到所有的tool<br />
addr2line<br />
asm<br />
cgo<br />
compile<br />
cover<br />
dist<br />
doc<br />
fix<br />
link<br />
nm<br />
objdump<br />
pack<br />
pprof<br />
tour<br />
trace<br />
vet</p><br />
<br />
<p>$ go tool compile -h<br />
usage: compile [options] file.go…<br />
  -%    debug non-static initializers<br />
  -+    compiling runtime<br />
  -B    disable bounds checking<br />
  -C    disable printing of columns in error messages<br />
  -D path<br />
        set relative path for local imports<br />
  -E    debug symbol export<br />
  -I directory<br />
        add directory to import search path<br />
  -K    debug missing line numbers<br />
  -N    disable optimizations<br />
  -S    print assembly listing<br />
  -V    print compiler version<br />
  -W    debug parse tree after type checking<br />
  -asmhdr file<br />
        write assembly header to file<br />
  -bench file<br />
        append benchmark times to file<br />
  -blockprofile file<br />
        write block profile to file<br />
  -buildid id<br />
        record id as the build id in the export metadata<br />
  -c int<br />
        concurrency during compilation, 1 means no concurrency (default 1)<br />
  -complete<br />
        compiling complete package (no C or assembly)<br />
  -cpuprofile file<br />
        write cpu profile to file<br />
  -d list<br />
        print debug information about items in list; try -d help<br />
  -dolinkobj<br />
        generate linker-specific objects; if false, some invalid code may compile (default true)<br />
  -dwarf<br />
        generate DWARF symbols (default true)<br />
  -dynlink<br />
        support references to Go symbols defined in other shared libraries<br />
  -e    no limit on number of errors reported<br />
  -f    debug stack frames<br />
  -goversion string<br />
        required version of the runtime<br />
  -h    halt on error<br />
  -i    debug line number stack<br />
  -importcfg file<br />
        read import configuration from file<br />
  -importmap definition<br />
        add definition of the form source=actual to import map<br />
  -installsuffix suffix<br />
        set pkg directory suffix<br />
  -j    debug runtime-initialized variables<br />
  -l    disable inlining<br />
  -linkobj file<br />
        write linker-specific object to file<br />
  -live<br />
        debug liveness analysis<br />
  -m    print optimization decisions<br />
  -memprofile file<br />
        write memory profile to file<br />
  -memprofilerate rate<br />
        set runtime.MemProfileRate to rate<br />
  -msan<br />
        build code compatible with C/C++ memory sanitizer<br />
  -mutexprofile file<br />
        write mutex profile to file<br />
  -nolocalimports<br />
        reject local (relative) imports<br />
  -o file<br />
        write output to file<br />
  -p path<br />
        set expected package import path<br />
  -pack<br />
        write package file instead of object file<br />
  -r    debug generated wrappers<br />
  -race<br />
        enable race detector<br />
  -s    warn about composite literals that can be simplified<br />
  -shared<br />
        generate code that can be linked into a shared library<br />
  -std<br />
        compiling standard library<br />
  -traceprofile file<br />
        write an execution trace to file<br />
  -trimpath prefix<br />
        remove prefix from recorded source file paths<br />
  -u    reject unsafe code<br />
  -v    increase debug verbosity<br />
  -w    debug type checking<br />
  -wb<br />
        enable write barrier (default true)</p><br />
<br />
<p>package main</p><br />
<br />
<p>import “demo”</p><br />
<br />
<p>func main() {<br />
    demo.Demo()<br />
}</p><br />
<br />
<p>demo包中的demo.go代码如下：<br />
package demo</p><br />
<br />
<p>import “fmt”</p><br />
<br />
<p>func Demo() {<br />
    fmt.Println(“call demo …”)<br />
}</p><br />
<br />
<p>由于demo.go是在%GOPATH%\src目录下的一个包，main.go在import该包后，可以直接使用，运行main.go：</p><br />
<blockquote><br />
  <p>go run main.go<br />
call demo …</p><br />
</blockquote><br />
<br />
<p>现在，需要将demo.go编译成静态库demo.a，不提供demo.go的源代码，让main.go也能正常编译运行，详细步骤如下：<br />
 1,编译静态库demo.a<br />
在命令行运行go install demo命令，会在%GOPATH%目录下生相应的静态库文件demo.a<br />
$ go install github.com/xiazemin/gocompiler/static/demo<br />
$ ls ~/goLang/pkg/darwin_amd64/github.com/xiazemin/gocompiler/static/<br />
demo.a<br />
2 编译main.go<br />
进入main.go所在目录，编译main.go：<br />
go tool compile -I ~/goLang/pkg/darwin_amd64 main.go<br />
-I选项指定了demo包的安装路径，供main.go导入使用<br />
dows_amd64目录，编译成功后会生成相应的目标文件main.o。<br />
$ go tool compile -I ~/goLang/pkg/darwin_amd64 -o main.o  main.go<br />
$ ls<br />
demo    main.go main.o<br />
3 链接main.o<br />
$go tool link -o main.exe -L ~/goLang/pkg/darwin_amd64 main.o<br />
-L选项指定了静态库demo.a的路径，即~/goLang/pkg/darwin_amd64目录，链接成功后会生成相应的可执行文件main.exe。<br />
$ ls<br />
demo            main.exe        main.go         main.o</p><br />
<br />
<p>发现程序没有导入任何包直接调用了print函数，这是因为所有go程序<br />
都默认链接runtime.a这个包，而print这个函数就在这个包里拉,相当于c的libc库</p><br />
<br />
<p>golang中链接器首先使用objfile这个函数来将所有的object文件加载，这个函数位于src/cmd/ld/lib.c<br />
新版本位于src/cmd/link/internal/ld/ld.go</p><br />
<br />
<p>1、链接器收集main包引用的所有其它包中的符号信息，并将它们装载到一个大的字节数组中<br />
2、对于每个符号，链接器计算它在（数组）镜像中的地址。<br />
3、然后他为每个符号应用重定位，<br />
4、链接器准备所有ELF格式（linux系统中）文件或者PE格式文件（windows系统中）所需的文件头。然后它再生成一个可执行的文件。</p><br />
<br />
<p>语法解析树处理完成后，再执行真正的编译，将结点翻译成汇编代码。<br />
 在磁盘上创建目标文件，并将翻译生成的汇编代码以及一些额外的数据结构，如符号表等，写入目标文件中。<br />
目标代码的形式可以是绝对指令代码或可重定位的指令代码或汇编指令代码。如目标代码是绝对指令代码，则这种目标代码可立即执行。如果目标代码是汇编指令代码，则需汇编器汇编之后才行运行。必须指出，现在多数实用编译程序所产生的目标代码都是一种可重定位的指令代码。golang编译后是可重定位的指令代码。这种目标代码在运行前必须借助于一个连接装配程序把各个目标模块（包括系统提供的库函数）连接在一起，确定程序变量（或常数）在主存中的位置，装入内存中指定的起始地址，使之成为一个可以运行的绝对指令代码程序。<br />
go目标文件</p><br />
<br />
<p>1、符号表</p><br />
<br />
<p>go程序编译后生成目标文件，目标文件中有一个Syms数组，这个数组是一个符号表，程序中定义的所有东西，包括函数，全局变量，类型，常量等等，都写在这个表里。</p><br />
<br />
<p>&amp;goobj.Sym{<br />
            SymID: goobj.SymID{Name:”main.main”, Version:0},<br />
            Kind:  1,<br />
            DupOK: false,<br />
            Size:  48,<br />
            Type:  goobj.SymID{},<br />
            Data:  goobj.Data{Offset:137, Size:44},<br />
            Reloc: …,<br />
            Func:  …,<br />
}<br />
SymID	唯一的符号 ID。这个 ID 值包含了符号的名称与版本号。版本信息可以帮助区分同名称的符号。<br />
Kind	标识符号的所属的类型（稍后会有更加详细的介绍）<br />
DupOK	标识是否允许符号冗余（同名符号）。<br />
Size	符号数据的大小。<br />
Type	引用另外一个表示符号类型的符号（如果存在）。<br />
Data	包含二进制数据。不同类型的符号该域的含义不同。例如，对于函数该域表示汇编代码，对于字符串符号该域表示原始字符串，等等。<br />
Reloc	重定位列表（稍后会有详细介绍）。<br />
Func	<br />
包含函数符号的元数据（稍会有详细介绍）。</p><br />
<br />
<p>2、Reloc-go重定位</p><br />
<br />
<p>go目标文件中符号表中有Reloc数组，结构如下：</p><br />
<br />
<p>type Reloc struct {<br />
    Offset int<br />
    Size   int<br />
    Sym    SymID<br />
    Add    int<br />
    Type int<br />
}<br />
3、函数元数据的结构体：</p><br />
<br />
<p>Func: &amp;goobj.Func{<br />
    Args:    0,<br />
    Frame:   8,<br />
    Leaf:    false,<br />
    NoSplit: false,<br />
    Var:     {<br />
    },<br />
    PCSP:   goobj.Data{Offset:255, Size:7},<br />
    PCFile: goobj.Data{Offset:263, Size:3},<br />
    PCLine: goobj.Data{Offset:267, Size:7},<br />
    PCData: {<br />
        {Offset:276, Size:5},<br />
    },<br />
    FuncData: {<br />
        {<br />
            Sym:    goobj.SymID{Name:”gclocals·3280bececceccd33cb74587feedb1f9f”, Version:0},<br />
         Offset: 0,<br />
     },<br />
     {<br />
         Sym:    goobj.SymID{Name:”gclocals·3280bececceccd33cb74587feedb1f9f”, Version:0},<br />
               Offset: 0,<br />
           },<br />
       },<br />
       File: {“/home/adminone/temp/test.go”},<br />
   },<br />
如上的结构体是由编译器在目标文件中创建的函数元数据，在go运行时会用到这个数据结构。在运行时包内，这个结构体被映射为如下的结构体：</p><br />
<br />
<p>type _func struct {<br />
	entry   uintptr // start pc<br />
	nameoff int32   // function name</p><br />
<br />
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>args  int32 // in/out args size<br />
frame int32 // legacy frame size; use pcsp if possible<br />
 <br />
pcsp      int32<br />
pcfile    int32<br />
pcln      int32<br />
npcdata   int32<br />
nfuncdata int32 } 其中 pcsp、pcfile 与 pln。在程序计数器（program counter）被转换成栈指针、文件名、以及行号时会分别用到这三个域。<br />
</code></pre></div></div><br />
<br />
<p>4、垃圾收集（GC）是如何使用函数元数据</p><br />
<br />
<p>Go语言使用标记-清除垃圾收集器，这种垃圾收集器分为两个阶段工作。第一阶段为标记阶段，GC遍历所有仍在使用的对象，并将其标记为可达。第二阶段为清除阶段，所有没有被标记的对象在该阶段被删除。</p><br />
<br />
<p>垃圾收集器从几个位置搜索可达的对象，包括全局变量，寄存器，栈帧以及可达对象的指针。它到底是如何区分栈中的变量是一个指针还是非指针类型呢？这就需要FuncData来发挥作用了。编译器都会为其创建两个位图向量。其中一个表示函数的参数的范围。另一个则表示栈帧中存储局部变量的区域。这两个位图变量可以告诉垃圾收集器栈帧中哪些位置上是指针，这些信息就可以帮助垃圾收集器完成垃圾收集工作了。</p><br />
<br />
<p>五、go链接器</p><br />
<br />
<p>1、链接器收集main包引用的所有其它包中的符号信息，并将它们装载到一个大的字节数组中</p><br />
<br />
<p>2、对于每个符号，链接器计算它在（数组）镜像中的地址。</p><br />
<br />
<p>3、然后他为每个符号应用重定位，</p><br />
<br />
<p>4、链接器准备所有ELF格式（linux系统中）文件或者PE格式文件（windows系统中）所需的文件头。然后它再生成一个可执行的文件。</p><br />
<br />
<p>链接器的工作原理：</p><br />
<br />
<p>链接器收集 main 包引用的所有其它包中的符号信息，并将它们装载到一个大的字节数组（或者二进制镜像）中。<br />
对于每个符号，链接器计算它在镜像中的地址。<br />
然后它为每一个符号应用重定位。这就非常简单了，因为链接器已经知道所有重定位项引用的符号的精确地址。<br />
链接器准备所有 ELF 格式（Linux 系统中）文件或者 PE 格式文件（windows 系统中）所需的文件头。然后它再生成一个可执行的文件。</p><br />
<br />

					 <span class='st_sharethis_large' displayText='ShareThis'></span>
						<span class='st_facebook_large' displayText='Facebook'></span>
						<span class='st_twitter_large' displayText='Tweet'></span>
						<span class='st_linkedin_large' displayText='LinkedIn'></span>
						<span class='st_pinterest_large' displayText='Pinterest'></span>
						<span class='st_email_large' displayText='Email'></span>
                </div>
                Category golang
        </div>
	</div>
  
  
       <!--赞-->
    	  <div class="row">
            <div class="col-lg-6">
                <img src="https://xiazemin.github.io/MyBlog/img/webwxgetmsgimg.jpeg"  height="400" width="auto" />
            </div>
          </div>

        <div class="row">
                <div class="col-md-12">
			<div id="disqus_thread"></div>

<div id="gitmentContainer"></div>
<link rel="stylesheet" href="/MyBlog/css/default.css">
<script src="/MyBlog/js/gitment.browser.js"></script>
<script type="text/javascript" src="/MyBlog/js/json2.js"></script>
<script>
var gitment = new Gitment({
    owner: 'xiazemin',
    repo: 'MyBlogComment',
    oauth: {
        client_id: '981ba8c916c262631ea0',
        client_secret: 'a52260ef92de69011ccd1cf355b973ef11d6da0e',
    },
});

var MyGitmentContainer=gitment.render('gitmentContainer');
window.setTimeout(MyGitMentBtnclick,1000); 
//document.ready(function(){ 
//window.onload=function(){}

function MyGitMentBtnclick(){
//var MyGitmentContainer=document.getElementById('gitmentContainer');
	var ele=[],all=MyGitmentContainer.getElementsByTagName("*");
	for(var i=0;i<all.length;i++){
	  if(all[i].className=='gitment-comments-init-btn'){
		MyGitMentBtn=all[i];
		console.log(MyGitMentBtn);
		MyGitMentBtn.click();
	  }
	}
}

</script>



			<!--script>
			/**
			* RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
			* LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
			*/
			/*
			var disqus_config = function () {
			this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable
			this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
			};
			*/
			(function() { // DON'T EDIT BELOW THIS LINE
			var d = document, s = d.createElement('script');

			s.src = '//airrayagroup.disqus.com/embed.js';

			s.setAttribute('data-timestamp', +new Date());
			(d.head || d.body).appendChild(s);
			})();
			</script>
			<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
			<script id="dsq-count-scr" src="//airrayagroup.disqus.com/count.js" async></script-->
          </div>
       </div>

</div>
<hr>
     <footer>
        <div class="container">
             <a href="/MyBlog/" style="color: green; font-size: 2em; font-family: 'Schoolbell', cursive;">首页</a>
            <div class="row">
                <div class="col-lg-6">
                    <p>Copyright &copy; 2017 465474307@qq.com <p>
                </div>
                <div class="col-lg-6">
                    <p style="float: right;">Jekyll theme by <a href="https://github.com/xiazemin/">夏泽民</a></p>
                </div>
            </div>
        </div>
    </footer>
	
    <!-- jQuery -->
    <script src="/MyBlog/js/jquery-1.12.0.min.js"></script>
    <script src="/MyBlog/js/jquery-migrate-1.2.1.min.js"></script>

    <!-- Latest compiled and minified JavaScript -->
    <script src="/MyBlog/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
        <!-- Menu Toggle Script -->
    <script>
    $("#menu-toggle").click(function(e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled");
    });
    </script>
    <script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"16"},"slide":{"type":"slide","bdImg":"6","bdPos":"right","bdTop":"100"},"image":{"viewList":["qzone","tsina","tqq","renren","weixin"],"viewText":"分享到：","viewSize":"16"}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='/MyBlog/shareapi/js/share.js?v=89860593.js?'];</script>


<!-- 2d  -->
<script type="text/javascript" charset="utf-8"  src="/MyBlog/js/L2Dwidget.0.min.js"></script>
<script type="text/javascript" charset="utf-8"  src="/MyBlog/js/L2Dwidget.min.js"></script>
<script type="text/javascript">
 setTimeout(()=> {
/*L2Dwidget.init({"display": {
        "superSample": 2,
        "width": 200,
        "height": 400,
             "position": "right",
                 "hOffset": 0,
        "vOffset": 0
          }
     });
*/
 L2Dwidget
        .on('*', (name) => {
          console.log('%c EVENT ' + '%c -> ' + name, 'background: #222; color: yellow', 'background: #fff; color: #000')
        })
        .init({
          dialog: {
            // 开启对话框
            enable: true,
            script: {
              // 每空闲 10 秒钟，显示一条一言
              'every idle 10s': '$hitokoto$',
              // 当触摸到星星图案
              'hover .star': '星星在天上而你在我心里 (*/ω＼*)',
              // 当触摸到角色身体
              'tap body': '哎呀！别碰我！',
              // 当触摸到角色头部
              'tap face': '人家已经不是小孩子了！'
            }
          }
        });

})
</script>



    <!--html xmlns:wb="http://open.weibo.com/wb">
    <script src="http://tjs.sjs.sinajs.cn/open/api/js/wb.js" type="text/javascript" charset="utf-8"></script>
    <wb:follow-button uid="2165491993" type="red_1" width="67" height="24" ></wb:follow-button-->

      <!--本文来自-->
     <script type="text/javascript">
      /* 仅IE
     document.body.oncopy = function(){
        setTimeout( 
            function () { 
        var text =window.clipboardData.getData("text"); 
        if (text) { 
            text = text + "/r/n本篇文章来源于 xiazemin 的 泽民博客|https://xiazemin.github.io/MyBlog/index.html 原文链接："+location.href; clipboardData.setData("text", text); 
          }
       },
     100 )
    }
     */
     //绑定在了body上，也可以绑定在其他可用元素行，但是不是所有元素都支持copy和past事件。

     /*
$(document.body).bind({
    copy: function(event) {//copy事件
        //var cpTxt = "复制的数据";
        var clipboardData = window.clipboardData; //for IE
        if (!clipboardData) { // for chrome
            clipboardData = event.originalEvent.clipboardData;
        }

        if (event.clipboardData != null/false/undefined) { //ignore the incorrectness of the truncation
        clipboarddata = event.clipboardData;
        } else if (window.clipboardData != null/false/undefined) {
         clipboarddata = window.clipboardData;
        } else { //default to the last option even if it is null/false/undefined
         clipboarddata = event.originalEvent.clipboardData;
        }

        //e.clipboardData.getData('text');//可以获取用户选中复制的数据
        //clipboardData.setData('Text', cpTxt);
        alert(clipboarddata.getData('text'));
        //$('#message').text('Copy Data : ' + cpTxt);
        return false;//否则设不生效
    },paste: function(e) {//paste事件
        var eve = e.originalEvent
        var cp = eve.clipboardData;
        var data = null;
        var clipboardData = window.clipboardData; // IE
        if (!clipboardData) { //chrome
            clipboardData = e.originalEvent.clipboardData
        }
        data = clipboardData.getData('Text');
        //$('#message').html(data);
    }
});     
*/
function addLink() {
    var body_element = document.getElementsByTagName('body')[0];
    var selection;
    selection = window.getSelection();
    var pagelink = "<br /><br />本文来源：xiazemin 的 泽民博客 <a href='"+document.location.href+"'>"+document.location.href+"</a>";
//+document.location.href+当前页面链接
    var copy_text = selection + pagelink;
    console.log(copy_text);
    var new_div = document.createElement('div');
    new_div.style.left='-99999px';
    new_div.style.position='absolute';
    body_element.appendChild(new_div );
    new_div.innerHTML = copy_text ;
    selection.selectAllChildren(new_div );
    window.setTimeout(function() {
        body_element.removeChild(new_div );
    },0);
}
document.oncopy = addLink;
     </script>
    <!--本文来自-->

</div>
  </body>

</html>