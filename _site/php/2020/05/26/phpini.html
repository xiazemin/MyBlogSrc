<!DOCTYPE html>
<html>

  <head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Sci blog jekyll theme">
    <meta name="author" content="AIR RAYA Group">
    <link href='/MyBlog/img/favicon.ico' type='image/icon' rel='shortcut icon'/>

    <title>泽民博客 | Jekyll theme</title>

    <link rel="stylesheet" href="/MyBlog/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
    <link rel="stylesheet" href="/MyBlog/css/font-awesome.min.css">
    <link href="/MyBlog/css/simple-sidebar.css" rel="stylesheet">
	<link href="/MyBlog/css/classic-10_7.css" rel="stylesheet" type="text/css">
    <!-- Custom CSS -->
    <link href="/MyBlog/css/style.css" rel="stylesheet">
    <link href="/MyBlog/css/pygments.css" rel="stylesheet">
    <!-- Fonts -->
 <link href="/MyBlog/css/front.css" rel="stylesheet" type="text/css">
 <link href="/MyBlog/css/Josefin_Slab.css" rel="stylesheet" type="text/css">
<link href="/MyBlog/css/Architects_Daughter.css" rel="stylesheet" type="text/css">
<link href="/MyBlog/css/Schoolbell.css" rel="stylesheet" type="text/css">
<link href="/MyBlog/css/Codystar.css" rel="stylesheet" type="text/css">

 <script type="text/javascript" src="/MyBlog/js/jquery-1.12.0.min.js"></script>	

<link href="/MyBlog/css/calendar/common.css" type="text/css"  rel="stylesheet">
<script type="text/javascript" src="/MyBlog/js/calendar/calendar.js"></script>
	<!-- share this -->
	<script type="text/javascript">var switchTo5x=true;</script>
	<script type="text/javascript" src="/MyBlog/js/buttons.js"></script>
	<script type="text/javascript">stLight.options({publisher: "b28464c3-d287-4257-ad18-058346dd35f7", doNotHash: false, doNotCopy: false, hashAddressBar: false});</script>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="/MyBlog/js/html5shiv.js"></script>
        <script src="/MyBlog/js/respond.min.js"></script>
    <![endif]-->
   
   <!--百度统计-->
    <script>
    var _hmt = _hmt || [];
    (function() {
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?e965cab8c73512b8b23939e7051d93bd";
    var s = document.getElementsByTagName("script")[0]; 
    s.parentNode.insertBefore(hm, s);
    })();
    </script>
    <script async src="/MyBlog/katex/katex.js"></script>
    <link rel="stylesheet" href="/MyBlog/katex/katex.css">

    <!--轮播图片-->
    <!--script type="text/javascript" src="https://xiazemin.github.io/MyBlog/js/jquery.js"></script>
    <script type="text/javascript" src="https://xiazemin.github.io/MyBlog/js/jquery.stripesrotator.js"></script>
    <script type="text/javascript">
                    $(document).ready(function() {
                    alert($('#rotator_xzm'));
                     alert($('#rotator_xzm').fn);
                    $('#rotator_xzm').stripesRotator({ images: [ "https://xiazemin.github.io/MyBlog/img/BPlusTree.png", "https://xiazemin.github.io/MyBlog/img/linuxMMap.jpeg"] });
                    });
    </script-->

    <!--水印-->
    <script type="text/javascript" src="/MyBlog/js/waterMark.js"></script>
    <script type="text/javascript">
    $(document).ready(function(){
    watermark({watermark_txt0:'泽民博客',watermark_txt1:'zemin',watermark_txt2:(new Date()).Format("yyyy-MM-dd hh:mm:ss.S")});
    })
    </script>
     <!--水印-->
     <!--adscene-->
    <script data-ad-client="ca-pub-6672721494777557" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

</head>

 <body>
<div id="wrapper">
 <!-- Navigation -->
    <!-- Sidebar -->
        <div id="sidebar-wrapper">
            <ul class="sidebar-nav">
                <li class="sidebar-brand">
                    <a href="/MyBlog">
                        Home
                    </a>
                </li>
                <li>
                    <a href="#">About</a>
                </li>
                <li>
                    <a href="#">Services</a>
                </li>
                <li>
                    <a href="#">Portfolio</a>
                </li>
                <li>
                    <a href="#">Events</a>
                </li>
                <li>
                    <a href="#">Blog</a>
                </li>
                <li>
                    <a href="#">FAQ</a>
                </li>
                <li>
                    <a href="#">Contact</a>
                </li>
            </ul>
        </div>


    <header class="intro-header">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <div class="heading text-center">
                        <a href="https://xiazemin.github.io/MyBlog/" style="color: #fff; font-size: 4em; font-family: 'Schoolbell', cursive;">泽民博客</a>
                        <a href="#menu-toggle" class="btn btn-default sciblog" id="menu-toggle" style="font-weight: bold;">&#9776; Menu</a>
                    </div>
                </div>
            </div>
        </div>
    </header>

     <script async src="/MyBlog/js/busuanzi.pure.mini.js"></script>

    <script type="text/javascript" src="/MyBlog/js/jquery.js"></script>
    <script type="text/javascript" src="/MyBlog/js/jquery.stripesrotator.js"></script>


 <div class="container">
	<div class="row">
        <div class="box">
                <div class="col-lg-12">
                    <div class="intro-text text-center">
					<h1 class="post-title" itemprop="name headline">解决mac 没有php.ini 文件问题</h1>
					<p class="post-meta"> <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">by 夏泽民</span></span> <time datetime="2020-05-26T00:00:00+08:00" itemprop="datePublished"><i class="fa fa-calendar"></i> May 26, 2020</time></p>
					</div>
					 <p>php -v<br />
PHP 7.2.0-dev (cli) (built: May 20 2020 23:46:30) ( NTS DEBUG )<br />
Copyright (c) 1997-2016 The PHP Group</p><br />
<br />
<p>vi  test.php<br />
&lt;?php<br />
//php -S localhost:8000  test.php<br />
echo phpinfo();<br />
var_dump($a[‘1213’]==0);</p><br />
<br />
<p>php -S localhost:8000  test.php<br />
<!-- more --></p><br />
<br />
<p>Configuration File (php.ini) Path	/usr/local/lib<br />
Loaded Configuration File  (none)</p><br />
<br />
<p>ls /usr/local/lib<br />
确实没有php.ini,可能是老版本没有卸载干净，congfigure 的时候没有指定路径原因。</p><br />
<br />
<p>查找一份可用的配置<br />
find /usr -name php.ini<br />
/usr/local/etc/php/7.0/php.ini<br />
cp /usr/local/etc/php/7.0/php.ini /usr/local/lib/</p><br />
<br />
<p>重启问题解决<br />
Configuration File (php.ini) Path	/usr/local/lib<br />
Loaded Configuration File	/usr/local/lib/php.ini</p><br />
<br />
<p>composer.phar -version<br />
You are running Composer with SSL/TLS protection disabled.<br />
Error: “curl” PHP extension not loaded; Nuwa Composer keep-alive plugin disabled.<br />
Error: “curl” PHP extension not loaded; Prestissmo Composer plugin disabled.</p><br />
<br />
<p>vi /usr/local/lib/php.ini<br />
extension=php_curl.dll<br />
extension=php_openssl.dll</p><br />
<br />
<p>OpenSSL support =&gt; disabled (install ext/openssl) apache2.4 php7.4</p><br />
<br />
<h1 id="编辑phpini文件在文件最后添加">编辑php.ini文件，在文件最后添加</h1><br />
<br />
<p>extension=openssl.so</p><br />
<br />
<p>php7.2安装curl 扩展坑<br />
1 安装依赖yum -y install  libcurl-devel</p><br />
<br />
<p>需要安装第一步不然会报错</p><br />
<br />
<p>2、cd /home/tmp/php-7.2.11/ext/curl/</p><br />
<br />
<p>3、/usr/local/php7.2/bin/phpize (使用phpize)</p><br />
<br />
<p>4、./configure –with-php-config=/usr/local/php7.2/bin/php-config</p><br />
<br />
<p>5、make</p><br />
<br />
<p>6、make install</p><br />
<br />
<p>7、php.ini中添加extension=curl</p><br />
<br />
<p>php -m 查看php扩展</p><br />
<br />
<p>通过phpinfo()查看配置信息：<br />
发现Loaded Configuration File =&gt; (none) ，表明没有载入php.ini文件。然而/usr/local/php7/etc/php.ini这个文件确实是存在的。</p><br />
<br />
<p>解决</p><br />
<br />
<p>用strace去跟踪一下：</p><br />
<br />
<p>strace /usr/local/php7/sbin/php-fpm -i 2&gt;1.log</p><br />
<br />
<p>打开文件发现：<br />
它会去找 /usr/local/lib/php.ini ,我也不知道为什么，我编译是有设置–with-config-file-path=/xxx/xxx 。反正找到具体路径了，把php.ini拷过去就解决了。</p><br />
<br />
<p>另外我strace /usr/local/php7/bin/php -i 2&gt;1.log发现，如果不是php-fpm而是php，它会找/usr/local/php7/bin/php.ini</p><br />
<br />
<p>#1 启动Web服务器  服务于当前目录</p><br />
<br />
<p>$ php -S localhost:8000</p><br />
<br />
<p>Example #2 启动时指定根目录<br />
$ php -S localhost:8000 -t foo/</p><br />
<br />
<p>Example #3 使用路由（Router）脚本<br />
$ php -S localhost:8000 router.php</p><br />
<br />
<p>php-扩展编译安装扩展（通用版）<br />
这里以安装redis扩展为例，其它扩展可以大体仿照如此过程：</p><br />
<br />
<p>1.到 pecl.php.net 搜索 redis<br />
2.下载 stable 版（稳定版）扩展<br />
3.解压<br />
4.执行 /php/path/bin/phpize (作用是检测 php 的内核版本，并为扩展生成相应的编译配置)<br />
5.configure –with-php-config=/php/path/bin/php-config<br />
6.make &amp;&amp; make install<br />
引入编译出的 redis.so 插件<br />
编辑php.ini配置文件，<br />
并在<br />
;;;;;;;;;;;;;;;;;;;;;;<br />
; Dynamic Extensions ;<br />
;;;;;;;;;;;;;;;;;;;;;;<br />
下方新增：<br />
extension=/usr/local/php7.0.1/lib/extensions/debug-non-zts-20151012/redis.so</p><br />
<br />
<p>https://www.cnblogs.com/lalalagq/p/9973716.html</p><br />
<br />
<p>PHP Warning:  PHP Startup: Unable to load dynamic library ‘ext/php_curl.dll’ - dlopen(ext/php_curl.dll, 9): image not found in Unknown on line 0</p><br />
<br />
<p>Warning: PHP Startup: Unable to load dynamic library ‘ext/php_openssl.dll’ - dlopen(ext/php_openssl.dll, 9): image not found in Unknown on line 0</p><br />
<br />
<p>pecl install 无反应</p><br />
<br />
<p>解决<br />
可以先去 http://pecl.php.net/ 找到源码下载地址</p><br />
<br />
<p>比如redis<br />
找到下载链接<br />
pecl install http://pecl.php.net/get/redis-4.1.0RC2.tgz</p><br />
<br />
<p>PECL 的全称是 The PHP Extension Community Library ，是一个开放的并通过 PEAR(PHP Extension and Application Repository，PHP 扩展和应用仓库)打包格式来打包安装的 PHP扩展库仓库。通过 PEAR 的 Package Manager 的安装管理方式，可以对 PECL 模块进行下载和安装</p><br />
<br />
<p>https://pear.php.net/package/Net_Curl/download<br />
http://download.pear.php.net/package/Net_Curl-1.2.5.tgz</p><br />
<br />
<p>1 自己从源码编译一个新的openssl<br />
下载源码下来解压到 /mnt/soft/openssl-1.0.2m （openssl 安装到）</p><br />
<br />
<p>./config -h<br />
/usr/bin/perl ./Configure  -h</p><br />
<br />
<p>./config shared –prefix=/usr/mylibs –openssldir=/usr/mylibs/ssl <br /><br />
-Wl,-rpath=/usr/mylibs/lib</p><br />
<br />
<p>make clean<br />
make<br />
make install</p><br />
<br />
<p>2 编译php_openssl，链接新的openssl<br />
prefix 是安装目录，openssldir 是配置文件目录，另外建议安装两次，shared 作用是生成动态连接库。</p><br />
<br />
<p>wget ftp://ftp.openssl.org/source/openssl-1.0.0c.tar.gz<br />
tar -zxf openssl-1.0.0c.tar.gz<br />
cd openssl-1.0.0c/</p><br />
<br />
<p>运行php安装目录下的phpize文件，这时候会在extension目录下生成相应的configure文件。(php71为指定的PHP版本)</p><br />
<br />
<p>/usr/local/php71/bin/phpize</p><br />
<br />
<p>必须：指定openssl 目录<br />
export PKG_CONFIG_PATH=/usr/mylibs/lib/pkgconfig<br /><br />
pkg-config –cflags –libs libssl</p><br />
<br />
<p>./configure –with-openssl=/usr/mylibs –with-php-config=/usr/local/php71/bin/php-config</p><br />
<br />
<p>LDFLAGS=”-Wl,-rpath-link=/usr/mylibs/lib -Wl,–verbose”<br />
 make &amp;&amp; make install</p><br />
<br />
<p>PHP Fatal error:  Allowed memory size of 1073741824 bytes exhausted at /Users/didi/PhpstormProjects/c/php-src/Zend/zend_objects.c:171 (tried to allocate 128 bytes) in phar:///Users/didi/composer.phar/src/Composer/DependencyResolver/Solver.php on line 220</p><br />
<br />
<p>Fatal error: Allowed memory size of 1073741824 bytes exhausted at /Users/didi/PhpstormProjects/c/php-src/Zend/zend_objects.c:171 (tried to allocate 128 bytes) in phar:///Users/didi/composer.phar/src/Composer/DependencyResolver/Solver.php on line 220</p><br />
<br />
<p>出错原因：</p><br />
<br />
<p>因为php页面消耗的最大内存默认是为8M (在PHP的php.ini配置文件里可以看到) ,如果文件太大或图片太大，在读取的时候会发生上述提示错误。</p><br />
<br />
<p>解决办法，个人目前知道的有三种解决方案：</p><br />
<br />
<p>第一中解决方案是：在PHP文件中加入ini_set(”memory_limit”,”80M”);当然80M可以根据自己的情况改动，也不要太大哦，否则系统其它资源会遇到问题哦，其中-1为不设限。</p><br />
<br />
<p>第二中解决方案是：修改 php.ini配置文件，在php.ini中找到<br />
复制代码代码如下:<br />
; Maximum amount of memory a script may consume (128MB)<br />
; http://php.net/memory-limit<br />
memory_limit = 16M，将前面的分号去掉，改动值的大小，将memory_limit由8M改成16M（或更大），重启apache服务即可。</p><br />
<br />
<p>第三种解决方案是：修改.htaccess分布式配置文件（注意哦：前提是该目录支持.htaccess）。在文档中新增一句：php_value memory_limit 16M(或更大)</p><br />
<br />
<ul><br />
  <li>illuminate/support v5.5.39 requires ext-mbstring * -&gt; the requested PHP extension mbstring is missing from your system.</li><br />
</ul><br />
<br />
<p>cd <br />
~/PhpstormProjects/c/php-src <br />
$ls ext/openssl/<br />
CREDITS		config.w32	openssl.c	php_openssl.h	xp_ssl.c<br />
README		config0.m4	openssl.mak	tests</p><br />
<br />
<p>$ls ext/curl/<br />
CREDITS		config.w32	interface.c	package.xml	share.c<br />
config.m4	curl_file.c	multi.c		php_curl.h	tests</p><br />
<br />
<p>执行phpize：进入解压后的包后，（如果是ext下面的扩展包直接进入）执行phpize，如果服务器上安装了多个PHP，一定要找对路径（一般都是/usr/local/php/bin/phpize,看自己的PHP安装目录写对路径即可）<br />
（phpize是用来扩展php扩展模块的，通过phpize可以建立php的外挂模块）<br />
（当php编译完成后，php的bin目录下会有phpize这个脚本文件）<br />
为什么要执行phpize？</p><br />
<br />
<p>因为当我们需要再添加一些模块，但是又不想重新编译php时，这时我们就可以使用phpize命令。<br />
指定php-config路径（执行完phpize会出现这些文件：）</p><br />
<br />
<p>./configure –with-php-config=/usr/local/php/bin/php-config<br />
1<br />
ps：这里还要多嘴一句：一定要找对php-config的所在位置（尤其是服务器上有多个PHP实例）</p><br />
<br />
<p>make(编译) make install(安装)<br />
如果没有报错会提示以下信息：</p><br />
<br />
<p>[root@localhost imagick-3.4.0RC4]# make install<br />
Installing shared extensions:     /usr/local/php/lib/php/extensions/no-debug-non-zts-20121212/<br />
Installing header files:          /usr/local/php/include/php/</p><br />
<br />
<p>这时候扩展就安装完成啦，此时还需要在php.ini里面加入extension=xxx(扩展名)</p><br />
<br />
<p>重启php，查看phpinfo</p><br />
<br />
<p>$phpize<br />
Cannot find config.m4.<br />
Make sure that you run ‘/usr/local/bin/phpize’ in the top level source directory of the module</p><br />
<br />
<p>https://github.com/php/php-src</p><br />
<br />
<p>https://pecl.php.net</p><br />
<br />
<p>https://www.php.net/manual/zh/curl.installation.php</p><br />
<br />
<p>却少这么多库一定是安装到别的位置了</p><br />
<br />
<p>$sudo find / -name curl.so<br />
find: /dev/fd/4: No such file or directory<br />
/Users/didi/blog/php-src/ext/curl/.libs/curl.so<br />
/Users/didi/blog/php-src/ext/curl/.libs/curl.so.dSYM/Contents/Resources/DWARF/curl.so<br />
/Users/didi/blog/php-src/ext/curl/modules/curl.so</p><br />
<br />
<p>$vi /usr/local/lib/php.ini<br />
extension=/Users/didi/blog/php-src/ext/curl/modules/curl.so</p><br />
<br />
<p>Warning: PHP Startup: curl: Unable to initialize module<br />
Module compiled with module API=20151012<br />
PHP    compiled with module API=20160303</p><br />
<br />
<p>https://www.cnblogs.com/cbryge/p/6140570.html</p><br />
<br />
<p>https://www.laruence.com/2011/09/13/2139.html</p><br />
<br />
<p>php-7.2.0源码安装及扩展安装<br />
https://blog.csdn.net/Just_shunjian/article/details/78686776</p><br />
<br />
<p>一、安装环境<br />
ubuntu 16.04</p><br />
<br />
<p>一、源码安装前准备工作</p><br />
<br />
<p>1.1、下载源码<br />
下载地址：http://www.php.net/downloads.php<br />
可自行选择版本，这里我选择的最新版本PHP 7.2.0，下载地址为：http://cn2.php.net/distributions/php-7.2.0.tar.gz<br />
wget http://cn2.php.net/distributions/php-7.2.0.tar.gz</p><br />
<br />
<p>1.2、解压<br />
tar -zxvf php-7.2.0.tar.gz</p><br />
<br />
<p>1.3、准备安装目标文件夹<br />
mkdir /usr/local/php<br />
注：也就是源码安装的php到这个路径中</p><br />
<br />
<p>二、编译安装<br />
2.1、配置<br />
cd cd php-7.2.0/</p><br />
<br />
<p>A、如果PHP搭配Apache使用，那么配置如下<br />
./configure –prefix=/usr/local/php <br /><br />
–with-apxs2=/usr/local/apache2/bin/apxs</p><br />
<br />
<p>注：<br />
/usr/local/apache2/bin/apxs，其中apxs是在安装Apache时产生的，apxs是一个为Apache HTTP服务器编译和安装扩展模块的工具，使之可以用由mod_so提供的LoadModule指令在运行时加载到Apache服务器中</p><br />
<br />
<p>B、如果只是单独安装PHP以及MySQL的扩展，而不安装MySQL服务，那么需要添加下面的配置<br />
–enable-sockets=shared  <br /><br />
–with-pdo-mysql=shared,mysqlnd 或者 –with-mysql=shared,mysqlnd</p><br />
<br />
<p>此处可以选择使用PHP的 mysql 还是 pdo 扩展，两者选择其一即可</p><br />
<br />
<p>C、启动配置php-fpm</p><br />
<br />
<p>–enable-fpm</p><br />
<br />
<p>总结：执行A或者B此时可能出现错误<br />
configure: error: xml2-config not found. Please check your libxml2 installation.<br />
解决方法：<br />
CentOS<br />
yum install libxml2<br />
yum install libxml2-devel</p><br />
<br />
<p>ubuntu：<br />
apt-get install libxml2<br />
apt-get install libxml2-dev</p><br />
<br />
<p>安装成功后，重新运行上面的./configure命令</p><br />
<br />
<p>示例：我安装的是不带Apache 和 Mysql 服务器，并且使用PDO扩展，那么配置如下<br />
./configure –prefix=/usr/local/php <br /><br />
–enable-sockets=shared  <br /><br />
–enable-fpm <br /><br />
–with-pdo-mysql=shared,mysqlnd</p><br />
<br />
<p>2.2、编译<br />
make</p><br />
<br />
<p>2.3、测试<br />
make test</p><br />
<br />
<p>2.4、安装<br />
make install</p><br />
<br />
<p>2.5、复制ini<br />
cp /php-7.2.0/php.ini-development  /usr/local/php/lib/php.ini<br />
    把原来位于源代码里面的php.ini-development拷贝到/usr/local/php/lib/php.ini下，并且重命名为php.ini</p><br />
<br />
<p>三、把php加入到系统环境变量<br />
echo “export PATH=$PATH:/usr/local/php/bin/php”  » /etc/profile<br />
source /etc/profile</p><br />
<br />
<p>四、查看php版本<br />
/usr/local/php/bin/php –version</p><br />
<br />
<p>五、安装扩展<br />
首先，请确保已经安装了autoconf，如未安装，请执行apt-get install autoconf<br />
编译完成之后，将会自动把mysql.so放到了默认的php扩展目录下（phpinfo可查看，我的为 /usr/local/php/lib/php/extensions/no-debug-zts-20090626），再修改php.ini<br />
修改php.ini,添加一句extension=mbstring.so</p><br />
<br />
<p>5.1、mbstring扩展<br />
1、进入源码mbstring文件夹<br />
cd /php-7.2.0/ext/mbstring<br />
2、执行生成configure（假设php安装在/usr/local/php目录下）<br />
/usr/local/php/bin/phpize <br />
3、生成makefile文件<br />
./configure –with-php-config=/usr/local/php/bin/php-config<br />
4、编译&amp;安装<br />
make &amp;&amp; make install</p><br />
<br />
<p>5.2、pdo_mysql扩展<br />
1、进入源码pdo_mysql文件夹<br />
cd /php-7.2.0/ext/pdo_mysql<br />
2、执行生成configure（假设php安装在/usr/local/php目录下）<br />
/usr/local/php/bin/phpize <br />
3、生成makefile文件<br />
./configure –with-php-config=/usr/local/php/bin/php-config<br />
假如你在本地安装了mysql服务，那么需执行下面命令<br />
./configure –with-php-config=/usr/local/php/bin/php-config –with-pdo-mysql=/usr/local/mysql/<br />
4、编译&amp;安装<br />
make &amp;&amp; make install<br />
5、修改php.ini,添加一句extension=pdo_mysql.so</p><br />
<br />
<p>5.3、zlib扩展<br />
此扩展进入源码/php-7.2.0/ext/zlib安装会出错，因此先执行下面语句<br />
1、 http://www.zlib.net/下载zlib源码<br />
wget http://www.zlib.net/zlib-1.2.11.tar.gz<br />
2、解压，配置，编译，安装<br />
tar -zxvf zlib-1.2.11.tar.gz<br />
cd zlib-1.2.11/<br />
./configure –prefix=/usr/local/zlib<br />
make &amp;&amp; make install<br />
3、重新配置、编译、安装PHP,增加参数–with-zlib-dir=/usr/local/zlib<br />
./configure –prefix=/usr/local/php <br /><br />
–enable-sockets=shared  <br /><br />
–with-pdo-mysql=shared,mysqlnd <br /><br />
–with-zlib-dir=/usr/local/zlib</p><br />
<br />
<p>5.4、curl扩展<br />
方法一：<br />
1、去网站 http://curl.haxx.se/download/ <br />
下载libcurl源码。我用的版本是curl-7.28.0.tar.gz<br />
    2、解压，配置，编译，安装<br />
tar -zxvf curl-7.28.0.tar.gz<br />
cd usr/src/curl-7.28.0<br />
./configure –prefix=/usr/local/curl；<br />
make &amp;&amp; make install<br />
   （3）重新编译php，增加参数–with-curl=/usr/local/curl<br />
./configure –prefix=/usr/local/php <br /><br />
–enable-sockets=shared  <br /><br />
–with-pdo-mysql=shared,mysqlnd <br /><br />
–with-zlib-dir=/usr/local/zlib  <br /><br />
–with-curl=/usr/local/curl</p><br />
<br />
<p>方法二：<br />
1、安装apt-get install libcurl4-gnutls-dev，如果出错，请先apt-get update<br />
2、进入源码curl文件夹<br />
cd /php-7.2.0/ext/curl<br />
3、执行生成configure（假设php安装在/usr/local/php目录下）<br />
/usr/local/php/bin/phpize <br />
4、生成makefile文件<br />
./configure –with-php-config=/usr/local/php/bin/php-config<br />
5、编译&amp;安装<br />
make &amp;&amp; make install<br />
6、修改php.ini,添加一句extension=curl.so</p><br />
<br />
<p>5.5、pcntl扩展<br />
1、进入源码pcntl文件夹<br />
cd /php-7.2.0/ext/pcntl<br />
2、执行生成configure（假设php安装在/usr/local/php目录下）<br />
/usr/local/php/bin/phpize <br />
3、生成makefile文件<br />
./configure –with-php-config=/usr/local/php/bin/php-config<br />
4、编译&amp;安装<br />
make &amp;&amp; make install<br />
5、修改php.ini,添加一句extension=pcntl.so</p><br />
<br />
<p>5.6、libevent/event 扩展<br />
由于PHP5.7以后只支持event，因此我安装的event，但是libevent的安装方法和event方法一样<br />
扩展依赖于原始的libevent库，必须先把libevent库安装<br />
1)、安装libevent库(http://libevent.org/)</p><br />
<ol><br />
  <li>wget https://github.com/libevent/libevent/releases/download/release-2.1.8-stable/libevent-2.1.8-stable.tar.gz</li><br />
  <li>tar -zxvf libevent-2.1.8-stable.tar.gz</li><br />
  <li>cd libevent-2.1.8-stable/</li><br />
  <li>./configure –prefix=/usr/local/libevent-2.1.8/</li><br />
  <li>make &amp;&amp; make install<br />
2)、安装event扩展(http://pecl.php.net/package/event)<br />
1、wget http://pecl.php.net/get/event-2.3.0.tgz<br />
2、tar -zxvf event-2.3.0.tgz <br />
3、cd event-2.3.0/<br />
4、/usr/local/php/bin/phpize <br />
5、./configure –with-php-config=/usr/local/php/bin/php-config –with-event-libevent-dir=/usr/local/libevent-2.1.8/<br />
如果是libevent<br />
./configure –with-php-config=/usr/local/php/bin/php-config –with-libevent=/usr/local/libevent-2.1.8/<br />
6、make &amp;&amp; make install</li><br />
</ol><br />
<br />
<p>注：此处安装可能遇到的问题及解决方案<br />
问题1：configure: error: Cannot find OpenSSL’s <evp.h><br />
解决方案：apt-get install libssl-dev</evp.h></p><br />
<br />
<p>问题2：configure: error: Cannot find OpenSSL’s libraries<br />
解决方案：<br />
find / -name libssl.so<br />
输出结果为：/usr/lib/x86_64-linux-gnu/libssl.so<br />
初步判断它可能只会在 /usr/lib/ 下寻找 libssl.so 文件，于是：<br />
ln -s/usr/lib/x86_64-linux-gnu/libssl.so /usr/lib<br />
重新编译安装即通过。</p><br />
<br />
<p>5.7、redis扩展(phpredis)<br />
1、下载源码https://github.com/phpredis/phpredis/releases<br />
wget https://github.com/phpredis/phpredis/archive/3.1.4.tar.gz<br />
2、mv 3.1.4.tar.gz phpredis.tar.gz<br />
3、tar -zxvf phpredis.tar.gz<br />
4、cd phpredis-3.1.4/<br />
5、/usr/local/php/bin/phpize <br />
6、./configure –with-php-config=/usr/local/php/bin/php-config<br />
7、 make &amp;&amp; make install</p><br />
<br />
<p>5.8、openssl扩展<br />
1、进入源码openssl文件夹<br />
cd /php-7.2.0/ext/openssl<br />
2、执行生成configure（假设php安装在/usr/local/php目录下）<br />
cp config0.m4 config.m4<br />
/usr/local/php/bin/phpize <br />
3、生成makefile文件<br />
./configure –with-php-config=/usr/local/php/bin/php-config<br />
4、编译&amp;安装<br />
make &amp;&amp; make install</p><br />
<br />
<p>注：此处安装可能遇到的问题及解决方案<br />
问题1：configure: error: Cannot find OpenSSL’s <evp.h><br />
解决方案：apt-get install libssl-dev</evp.h></p><br />
<br />
<p>问题2：configure: error: Cannot find OpenSSL’s libraries<br />
解决方案：<br />
find / -name libssl.so<br />
输出结果为：/usr/lib/x86_64-linux-gnu/libssl.so<br />
初步判断它可能只会在 /usr/lib/ 下寻找 libssl.so 文件，于是：<br />
ln -s/usr/lib/x86_64-linux-gnu/libssl.so /usr/lib<br />
重新编译安装即通过。</p><br />
<br />
<p>~/PhpstormProjects/c/php-src/ext/mbstring</p><br />
<br />
<p>$phpize<br />
Configuring for:<br />
PHP Api Version:         20151012<br />
Zend Module Api No:      20160303<br />
Zend Extension Api No:   320160303<br />
Cannot find autoconf. Please check your autoconf installation and the<br />
$PHP_AUTOCONF environment variable. Then, rerun this script.</p><br />
<br />
<p>$brew install autoconf<br />
$phpize<br />
Configuring for:<br />
PHP Api Version:         20151012<br />
Zend Module Api No:      20160303<br />
Zend Extension Api No:   320160303</p><br />
<br />
<p>$ ./configure –with-php-config=/usr/local/php/man/man1/php-config.1<br />
configure: WARNING: unrecognized options: –with-php-config<br />
checking for grep that handles long lines and -e… /usr/bin/grep<br />
checking for egrep… /usr/bin/grep -E</p><br />
<br />
<p>configure: error: Cannot find php-config. Please use –with-php-config=PATH</p><br />
<br />
<p>$which php-config<br />
/usr/local/bin/php-config</p><br />
<br />
<p>$./configure –with-php-config=/usr/local/php/man/man1/php-config.1 -with-php-config=/usr/local/bin/php-config</p><br />
<br />
<p>$make<br />
Build complete.<br />
Don’t forget to run ‘make test’.</p><br />
<br />
<p>$make install<br />
Installing shared extensions:     /usr/local/lib/php/extensions/debug-non-zts-20160303/</p><br />
<br />
<p>$vi /usr/local/lib/php.ini<br />
extension=/usr/local/lib/php/extensions/debug-non-zts-20160303/curl.so</p><br />
<br />
<p>cURL support	enabled</p><br />
<br />
<p>~/PhpstormProjects/c/php-src/ext/openssl$</p><br />
<br />
<p>可能会报错：Cannot find config.m4. 其实该目录下面的config0.m4就是，所以将config0.m4改名为config.m4：</p><br />
<br />
<p>$phpize<br />
Cannot find config.m4.<br />
Make sure that you run ‘/usr/local/bin/phpize’ in the top level source directory of the module</p><br />
<br />
<p>$cp config0.m4 config.m4</p><br />
<br />
<p>$phpize<br />
Configuring for:<br />
PHP Api Version:         20151012<br />
Zend Module Api No:      20160303<br />
Zend Extension Api No:   320160303</p><br />
<br />
<p>./configure –with-php-config=/usr/local/php/man/man1/php-config.1 -with-php-config=/usr/local/bin/php-config</p><br />
<br />
<p>checking for RAND_egd… no<br />
checking for pkg-config… no<br />
configure: error: Cannot find OpenSSL’s <evp.h></evp.h></p><br />
<br />
<p>configure: error: Cannot find OpenSSL’s <evp.h> 错误解决</evp.h></p><br />
<br />
<p>开始以为是没有安装openssl, openssl-devel，安装后发现还是提示这个错误，搜索了一下evp.h，这个文件也存在。<br />
GOOGLE 了一下，在stackoverflow，找到了答案，原来是 phpize 生成的configure脚本有问题。</p><br />
<br />
<p>解决方法：</p><br />
<br />
<p>export PHP_OPENSSL_DIR=yes<br />
./configure -with-openssl-dir=/usr/include/openssl</p><br />
<br />
<p>$   which openssl<br />
/usr/bin/openssl</p><br />
<br />
<p>$./configure –with-php-config=/usr/local/php/man/man1/php-config.1 -with-php-config=/usr/local/bin/php-config -with-openssl-dir=/usr/bin/openssl</p><br />
<br />
<p>失败了</p><br />
<br />
<p>$sudo find / -name openssl<br />
find: /dev/fd/4: No such file or directory<br />
find: /home: No such file or directory<br />
find: /Library: No such file or directory<br />
find: /net: No such file or directory<br />
find: /Network: No such file or directory<br />
find: /opt: No such file or directory<br />
find: /private: No such file or directory<br />
find: /sbin: No such file or directory<br />
find: /System: No such file or directory<br />
find: /Users: No such file or directory<br />
find: /usr: No such file or directory<br />
find: /Volumes: No such file or directory<br />
08:29:53-didi@localhost:~/PhpstormProjects/c/php-src/ext/openssl$sudo find /usr/local -name openssl<br />
/usr/local/etc/openssl<br />
/usr/local/Homebrew/Library/Homebrew/vendor/portable-ruby/2.6.3/lib/ruby/2.6.0/openssl<br />
/usr/local/Homebrew/Library/Taps/homebrew/homebrew-core/Aliases/openssl<br />
/usr/local/lib/python2.7/site-packages/cryptography/hazmat/backends/openssl<br />
/usr/local/lib/python2.7/site-packages/cryptography/hazmat/bindings/openssl<br />
/usr/local/octave/3.8.0/bin/openssl<br />
/usr/local/octave/3.8.0/etc/openssl<br />
/usr/local/octave/3.8.0/include/openssl</p><br />
<br />
<p>$ls /usr/local/octave/3.8.0/include/openssl/evp.h<br />
/usr/local/octave/3.8.0/include/openssl/evp.h</p><br />
<br />
<p>./configure –with-php-config=/usr/local/php/man/man1/php-config.1 -with-php-config=/usr/local/bin/php-config -with-openssl-dir=/usr/local/octave/3.8.0/include/openssl</p><br />
<br />
<p>失败</p><br />
<br />
<p>https://blog.csdn.net/Leadyang/article/details/89966697<br />
$ find / -name libssl.so</p><br />
<br />
<p>$gem env<br />
得到gem的PATH路径，比如</p><br />
<ul><br />
  <li>GEM PATHS:<br />
    <ul><br />
      <li>/Users/didi/.rvm/gems/ruby-2.4.1</li><br />
      <li>/Users/didi/.rvm/rubies/ruby-2.4.1/lib/ruby/gems/2.4.0</li><br />
    </ul><br />
  </li><br />
</ul><br />
<br />
<p>将其下的cache目录删除，再次执行gem安装的时候就不会出错了<br />
ls /Users/didi/.rvm/rubies/ruby-2.4.1/lib/ruby/gems/2.4.0/cache/</p><br />
<br />
<p>rm -rf  /Users/didi/.rvm/rubies/ruby-2.4.1/lib/ruby/gems/2.4.0/cache</p><br />
<br />
<p>$brew install openssl<br />
==&gt; Downloading https://www.openssl.org/source/openssl-1.1.1g.tar.gz<br />
Already downloaded: /Users/didi/Library/Caches/Homebrew/downloads/1178a9e293b3f8231b3a09a91b1a4cc8bf765526148a37a720ba4a89d49e3aff–openssl-1.1.1g.tar.gz<br />
Error: An exception occurred within a child process:<br />
  NoMethodError: undefined method `source’ for nil:NilClass</p><br />
<br />
<p>$brew upgrade openssl<br />
Error: openssl not installed</p><br />
<br />
<p>https://blog.csdn.net/Just_shunjian/article/details/78686776</p><br />
<br />
<p>开始以为是没有安装openssl, openssl-devel，安装后发现还是提示这个错误，搜索了一下evp.h，这个文件也存在。GOOGLE 了一下，在stackoverflow，找到了答案，原来是 phpize 生成的configure脚本有问题。</p><br />
<br />
<p>解决方法：修改configure 文件加入  export PHP_OPENSSL_DIR=yes</p><br />
<br />
<p>https://www.jb51.net/article/37487.htm</p><br />
<br />
<p>vi configure ＋17<br />
17 export PHP_OPENSSL_DIR=yes</p><br />
<br />
<p>源码安装openssl</p><br />
<br />
<p>下载openssl 地址 ftp://ftp.openssl.org/source/openssl-1.0.1c.tar.gz<br />
tar -zxf openssl-1.0.1c.tar.gz<br />
cd openssl-1.0.1c/<br />
./config –prefix=/usr/local –openssldir=/usr/local/ssl<br />
sudo make &amp;&amp; sudo make install<br />
./config shared –prefix=/usr/local –openssldir=/usr/local/ssl<br />
sudo make clean<br />
sudo make &amp;&amp; sudo make install<br />
命令使用</p><br />
<br />
<p>openssl genrsa -des3 -out server.key 1024<br />
openssl req -new -key server.key -out server.csr<br />
openssl x509 -req -days 365 -in server.csr -signkey server.key -out<br />
server.crt</p><br />
<br />
<p>旧版mac  brew 支持不是特别好，还是选择源码安装吧<br />
cp /Users/didi/Library/Caches/Homebrew/downloads/1178a9e293b3f8231b3a09a91b1a4cc8bf765526148a37a720ba4a89d49e3aff–openssl-1.1.1g.tar.gz /Users/didi/PhpstormProjects/c/</p><br />
<br />
<p>tar -zxvf 1178a9e293b3f8231b3a09a91b1a4cc8bf765526148a37a720ba4a89d49e3aff–openssl-1.1.1g.tar.gz</p><br />
<br />
<p>$cd openssl-1.1.1g/</p><br />
<br />
<p>$./config –prefix=/usr/local –openssldir=/usr/local/ssl</p><br />
<br />
<p>sudo make &amp;&amp; sudo make install</p><br />
<br />
<p>./config shared –prefix=/usr/local –openssldir=/usr/local/ssl</p><br />
<br />
<p>sudo make clean<br />
sudo make &amp;&amp; sudo make install</p><br />
<br />
<p>~/PhpstormProjects/c/php-src/ext/openssl$./configure –with-php-config=/usr/local/php/man/man1/php-config.1 -with-php-config=/usr/local/bin/php-config</p><br />
<br />
<p>成功了</p><br />
<br />
<p>make &amp; $make install<br />
Installing shared extensions:     /usr/local/lib/php/extensions/debug-non-zts-20160303/</p><br />
<br />
<p>vi /usr/local/lib/php.ini<br />
extension=/usr/local/lib/php/extensions/debug-non-zts-20160303/openssl.so</p><br />
<br />
<p>php -v<br />
Warning: PHP Startup: Unable to load dynamic library ‘ext/php_openssl.dll’ - dlopen(ext/php_openssl.dll, 9): image not found in Unknown on line 0<br />
Segmentation fault: 11</p><br />
<br />
<p>vi /usr/local/lib/php.ini 注释掉<br />
;extension=php_curl.dll<br />
;extension=php_openssl.dll<br />
;extension=php_mbstring.dll</p><br />
<br />
<p>php 需要 openssl.so 模块，于是去 php.net 下载了源码编译出，配置好以后，就出现这个报错了，运行什么命令都是Segmentation fault: 11报错，</p><br />
<br />
<p>特别补充， 扩展的加载顺序也会导致 php 报 segment fault 错误。 需要先加载 openssl 模块再加载其他模块。</p><br />
<br />
<p>vi /usr/local/lib/php.ini  把openssl.so放到前面<br />
extension=/usr/local/lib/php/extensions/debug-non-zts-20160303/openssl.so<br />
extension=/usr/local/lib/php/extensions/debug-non-zts-20160303/curl.so</p><br />
<br />
<p>OpenSSL support	enabled<br />
OpenSSL Library Version	OpenSSL 1.1.1g 21 Apr 2020</p><br />
<br />
<p>问题解决</p><br />
<br />
<p>cd ../mbstring/<br />
autoconf<br />
phpize<br />
./configure –with-php-config=/usr/local/php/man/man1/php-config.1 -with-php-config=/usr/local/bin/php-config<br />
  615  make &amp; make install</p><br />
<br />
<p>libtool: link: <code class="language-plaintext highlighter-rouge">libmbfl/filters/mbfilter_cp936.lo' is not a valid libtool object<br />
make: *** [mbstring.la] Error 1<br />
libtool: link: </code>libmbfl/filters/mbfilter_cp936.lo’ is not a valid libtool object<br />
make: *** [mbstring.la] Error 1<br />
[1]+  Exit 2                  make</p><br />
<br />
<p>$make clean<br />
$make &amp; make install</p><br />
<br />
<p>libtool: link: `oniguruma/regparse.lo’ is not a valid libtool object<br />
make: *** [mbstring.la] Error 1</p><br />
<br />
<p>make clean <br />
make<br />
问题解决</p><br />
<br />
<p>$make install<br />
Installing shared extensions:     /usr/local/lib/php/extensions/debug-non-zts-20160303/<br />
Installing header files:           /usr/local/include/php/</p><br />
<br />
<p>vi /usr/local/lib/php.ini<br />
extension=/usr/local/lib/php/extensions/debug-non-zts-20160303/mbstring.so</p><br />
<br />
<p>Update failed (unable to decompress gzipped phar archive “xxx” to temporary file, enable zlib extension in php.ini)</p><br />
<br />
<p>https://stackoverflow.com/questions/24988022/php-enable-bz2-extension-in-php-ini</p><br />
<br />
<p>cd ../zlib/<br />
$autoconf<br />
autoconf: error: no input file<br />
cp config0.m4 config.m4<br />
$phpize <br />
./configure –with-php-config=/usr/local/php/man/man1/php-config.1 -with-php-config=/usr/local/bin/php-config</p><br />
<br />
<p>make &amp; make install</p><br />
<br />
<p>Installing shared extensions:     /usr/local/lib/php/extensions/debug-non-zts-20160303/</p><br />
<br />

					 <span class='st_sharethis_large' displayText='ShareThis'></span>
						<span class='st_facebook_large' displayText='Facebook'></span>
						<span class='st_twitter_large' displayText='Tweet'></span>
						<span class='st_linkedin_large' displayText='LinkedIn'></span>
						<span class='st_pinterest_large' displayText='Pinterest'></span>
						<span class='st_email_large' displayText='Email'></span>
                </div>
                Category php
        </div>
	</div>
  
  
       <!--赞-->
    	  <div class="row">
            <div class="col-lg-6">
                <img src="https://xiazemin.github.io/MyBlog/img/webwxgetmsgimg.jpeg"  height="400" width="auto" />
            </div>
          </div>

        <div class="row">
                <div class="col-md-12">
			<div id="disqus_thread"></div>

<div id="gitmentContainer"></div>
<link rel="stylesheet" href="/MyBlog/css/default.css">
<script src="/MyBlog/js/gitment.browser.js"></script>
<script type="text/javascript" src="/MyBlog/js/json2.js"></script>
<script>
var gitment = new Gitment({
    owner: 'xiazemin',
    repo: 'MyBlogComment',
    oauth: {
        client_id: '981ba8c916c262631ea0',
        client_secret: 'a52260ef92de69011ccd1cf355b973ef11d6da0e',
    },
});

var MyGitmentContainer=gitment.render('gitmentContainer');
window.setTimeout(MyGitMentBtnclick,1000); 
//document.ready(function(){ 
//window.onload=function(){}

function MyGitMentBtnclick(){
//var MyGitmentContainer=document.getElementById('gitmentContainer');
	var ele=[],all=MyGitmentContainer.getElementsByTagName("*");
	for(var i=0;i<all.length;i++){
	  if(all[i].className=='gitment-comments-init-btn'){
		MyGitMentBtn=all[i];
		console.log(MyGitMentBtn);
		MyGitMentBtn.click();
	  }
	}
}

</script>



			<!--script>
			/**
			* RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
			* LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
			*/
			/*
			var disqus_config = function () {
			this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable
			this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
			};
			*/
			(function() { // DON'T EDIT BELOW THIS LINE
			var d = document, s = d.createElement('script');

			s.src = '//airrayagroup.disqus.com/embed.js';

			s.setAttribute('data-timestamp', +new Date());
			(d.head || d.body).appendChild(s);
			})();
			</script>
			<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
			<script id="dsq-count-scr" src="//airrayagroup.disqus.com/count.js" async></script-->
          </div>
       </div>

</div>
<hr>
     <footer>
        <div class="container">
             <a href="/MyBlog/" style="color: green; font-size: 2em; font-family: 'Schoolbell', cursive;">首页</a>
            <div class="row">
                <div class="col-lg-6">
                    <p>Copyright &copy; 2017 465474307@qq.com <p>
                </div>
                <div class="col-lg-6">
                    <p style="float: right;">Jekyll theme by <a href="https://github.com/xiazemin/">夏泽民</a></p>
                </div>
            </div>
        </div>
    </footer>
	
    <!-- jQuery -->
    <script src="/MyBlog/js/jquery-1.12.0.min.js"></script>
    <script src="/MyBlog/js/jquery-migrate-1.2.1.min.js"></script>

    <!-- Latest compiled and minified JavaScript -->
    <script src="/MyBlog/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
        <!-- Menu Toggle Script -->
    <script>
    $("#menu-toggle").click(function(e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled");
    });
    </script>
    <script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"16"},"slide":{"type":"slide","bdImg":"6","bdPos":"right","bdTop":"100"},"image":{"viewList":["qzone","tsina","tqq","renren","weixin"],"viewText":"分享到：","viewSize":"16"}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='/MyBlog/shareapi/js/share.js?v=89860593.js?'];</script>


<!-- 2d  -->
<script type="text/javascript" charset="utf-8"  src="/MyBlog/js/L2Dwidget.0.min.js"></script>
<script type="text/javascript" charset="utf-8"  src="/MyBlog/js/L2Dwidget.min.js"></script>
<script type="text/javascript">
 setTimeout(()=> {
/*L2Dwidget.init({"display": {
        "superSample": 2,
        "width": 200,
        "height": 400,
             "position": "right",
                 "hOffset": 0,
        "vOffset": 0
          }
     });
*/
 L2Dwidget
        .on('*', (name) => {
          console.log('%c EVENT ' + '%c -> ' + name, 'background: #222; color: yellow', 'background: #fff; color: #000')
        })
        .init({
          dialog: {
            // 开启对话框
            enable: true,
            script: {
              // 每空闲 10 秒钟，显示一条一言
              'every idle 10s': '$hitokoto$',
              // 当触摸到星星图案
              'hover .star': '星星在天上而你在我心里 (*/ω＼*)',
              // 当触摸到角色身体
              'tap body': '哎呀！别碰我！',
              // 当触摸到角色头部
              'tap face': '人家已经不是小孩子了！'
            }
          }
        });

})
</script>



    <!--html xmlns:wb="http://open.weibo.com/wb">
    <script src="http://tjs.sjs.sinajs.cn/open/api/js/wb.js" type="text/javascript" charset="utf-8"></script>
    <wb:follow-button uid="2165491993" type="red_1" width="67" height="24" ></wb:follow-button-->

      <!--本文来自-->
     <script type="text/javascript">
      /* 仅IE
     document.body.oncopy = function(){
        setTimeout( 
            function () { 
        var text =window.clipboardData.getData("text"); 
        if (text) { 
            text = text + "/r/n本篇文章来源于 xiazemin 的 泽民博客|https://xiazemin.github.io/MyBlog/index.html 原文链接："+location.href; clipboardData.setData("text", text); 
          }
       },
     100 )
    }
     */
     //绑定在了body上，也可以绑定在其他可用元素行，但是不是所有元素都支持copy和past事件。

     /*
$(document.body).bind({
    copy: function(event) {//copy事件
        //var cpTxt = "复制的数据";
        var clipboardData = window.clipboardData; //for IE
        if (!clipboardData) { // for chrome
            clipboardData = event.originalEvent.clipboardData;
        }

        if (event.clipboardData != null/false/undefined) { //ignore the incorrectness of the truncation
        clipboarddata = event.clipboardData;
        } else if (window.clipboardData != null/false/undefined) {
         clipboarddata = window.clipboardData;
        } else { //default to the last option even if it is null/false/undefined
         clipboarddata = event.originalEvent.clipboardData;
        }

        //e.clipboardData.getData('text');//可以获取用户选中复制的数据
        //clipboardData.setData('Text', cpTxt);
        alert(clipboarddata.getData('text'));
        //$('#message').text('Copy Data : ' + cpTxt);
        return false;//否则设不生效
    },paste: function(e) {//paste事件
        var eve = e.originalEvent
        var cp = eve.clipboardData;
        var data = null;
        var clipboardData = window.clipboardData; // IE
        if (!clipboardData) { //chrome
            clipboardData = e.originalEvent.clipboardData
        }
        data = clipboardData.getData('Text');
        //$('#message').html(data);
    }
});     
*/
function addLink() {
    var body_element = document.getElementsByTagName('body')[0];
    var selection;
    selection = window.getSelection();
    var pagelink = "<br /><br />本文来源：xiazemin 的 泽民博客 <a href='"+document.location.href+"'>"+document.location.href+"</a>";
//+document.location.href+当前页面链接
    var copy_text = selection + pagelink;
    console.log(copy_text);
    var new_div = document.createElement('div');
    new_div.style.left='-99999px';
    new_div.style.position='absolute';
    body_element.appendChild(new_div );
    new_div.innerHTML = copy_text ;
    selection.selectAllChildren(new_div );
    window.setTimeout(function() {
        body_element.removeChild(new_div );
    },0);
}
document.oncopy = addLink;
     </script>
    <!--本文来自-->

</div>
  </body>

</html>