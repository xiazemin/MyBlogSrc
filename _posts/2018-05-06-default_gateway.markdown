---
title: default_gateway 默认网关
layout: post
category: web
author: 夏泽民
---
一个用于 TCP/IP 协议的配置项，是一个可直接到达的 IP 路由器的 IP 地址。配置默认网关可以在 IP 路由表中创建一个默认路径。 一台主机可以有多个网关。默认网关的意思是一台主机如果找不到可用的网关，就把数据包发给默认指定的网关，由这个网关来处理数据包。现在主机使用的网关，一般指的是默认网关。 一台电脑的默认网关是不可以随随便便指定的，必须正确地指定，否则一台电脑就会将数据包发给不是网关的电脑，从而无法与其他网络的电脑通信。默认网关的设定有手动设置和自动设置两种方式
<!-- more -->
网关实质上是一个网络通向其他网络的IP地址。比如有网络A和网络B，网络A的IP地址范围为“192.168.1.1~192. 168.1.254”，子网掩码为255.255.255.0；网络B的IP地址范围为“192.168.2.1~192.168.2.254”，子网掩码为255.255.255.0。在没有路由器的情况下，两个网络之间是不能进行TCP/IP通信的，即使是两个网络连接在同一台交换机（或集线器）上，TCP/IP协议也会根据子网掩码（255.255.255.0）判定两个网络中的主机处在不同的网络里。而要实现这两个网络之间的通信，则必须通过网关。如果网络A中的主机发现数据包的目的主机不在本地网络中，就把数据包转发给它自己的网关，再由网关转发给网络B的网关，网络B的网关再转发给网络B的某个主机。网络B向网络A转发数据包的过程也是如此。所以说，只有设置好网关的IP地址，TCP/IP协议才能实现不同网络之间的相互通信。那么这个IP地址是哪台机器的IP地址呢？网关的IP地址是具有路由功能的设备的IP地址，具有路由功能的设备有路由器、启用了路由协议的服务器（实质上相当于一台路由器）、代理服务器（也相当于一台路由器）。
自动设置就是利用DHCP服务器来自动给网络中的电脑分配IP地址、子网掩码和默认网关。这样做的好处是一旦网络的默认网关发生了变化时，只要更改了DHCP服务器中默认网关的设置，那么网络中所有的电脑均获得了新的默认网关的IP地址。这种方法适用于网络规模较大、TCP/IP参数有可能变动的网络。
另外一种自动获得网关的办法是通过安装代理服务器软件（如MS Proxy）的客户端程序来自动获得，其原理和方法和DHCP有相似之处。
如果您有多个接口并为每个接口配置了一个默认网关，那么默认情况下 TCP/IP 将根据接口速度自动计算接口跃点数。此接口跃点数将成为所配置的默认网关的路由表中的默认路由的跃点数。最高速度的接口具有默认路由的最低跃点数。这样，只要在多个接口上配置多个默认网关，就会使用最快速度的接口将通信转发到其默认网关。
如果相同速度的多个接口具有相同的最低接口跃点数，那么根据绑定顺序，将使用第一个网络适配器的默认网关。如果第一个网络适配器不可用，则使用第二个网络适配器的默认网关。
在 TCP/IP 的早期版本中，多个默认网关都具有设置为1的默认路由跃点数，并且使用的默认网关将取决于接口顺序。有时，这会给确定TCP/IP协议正在使用哪一个默认网关带来一些困难。
默认情况下，接口跃点数的自动确定已经通过“Internet 协议（TCP/IP）”协议高级属性的“IP 设置”选项卡上的“自动跃点计数”复选框启用。
可以禁用接口跃点数的自动确定并键入新的接口跃点数。
网关技术
现行的IPV4的IP地址是32位的，根据头几位再划分为A、B、C三类地址；但由于INTERNET的迅猛发展，IP资源日渐枯竭，可供分配的IP地越来越少，跟一日千里的INTERNET发展严重冲突，在IPV6还远未能全面升级的情况下，惟有以代理服务器的方式，实行内部网地址跟公网地址进行转化而实现接入INTERNET。
中介作用的代理服务器就是一个网关，也就是这个网关带给现阶段的多媒体通讯系统无尽的烦恼。在IP资源可怜的情况下，惟有以网关甚至多层网关的方式接入宽带网， 因为多媒体通讯系统的协议如H.323等要进行业务的双方必须有一方有公网的IP地址，但是现在的宽带有几个用户能符合这个要求？microsoft的NETMEETING等等多媒体通讯系统就是处于这种尴尬的位置；跨网关成为头疼的难题。